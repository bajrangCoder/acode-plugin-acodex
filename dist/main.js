"use strict";(()=>{var Id=Object.create;var ua=Object.defineProperty;var Td=Object.getOwnPropertyDescriptor;var Rd=Object.getOwnPropertyNames;var Md=Object.getPrototypeOf,Fd=Object.prototype.hasOwnProperty;var se=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);var Pd=(e,i,r,s)=>{if(i&&typeof i=="object"||typeof i=="function")for(let l of Rd(i))!Fd.call(e,l)&&l!==r&&ua(e,l,{get:()=>i[l],enumerable:!(s=Td(i,l))||s.enumerable});return e};var lt=(e,i,r)=>(r=e!=null?Id(Md(e)):{},Pd(i||!e||!e.__esModule?ua(r,"default",{value:e,enumerable:!0}):r,e));var bn=se(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.toSigned32bit=nf;Lr.toUnsigned32bit=sf;function sf(e){return e>>>0}function nf(e){return e|0}});var xt=se(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.Warn=Me.Info=Me.Error=Me.Debug=void 0;Me.getLogging=of;Me.initLogging=Xa;var An="warn",Oa=Me.Debug=function(){},Ha=Me.Info=function(){},Qa=Me.Warn=function(){},Ka=Me.Error=function(){};function Xa(e){if(typeof e>"u"?e=An:An=e,Me.Debug=Oa=Me.Info=Ha=Me.Warn=Qa=Me.Error=Ka=function(){},typeof window.console<"u")switch(e){case"debug":Me.Debug=Oa=console.debug.bind(window.console);case"info":Me.Info=Ha=console.info.bind(window.console);case"warn":Me.Warn=Qa=console.warn.bind(window.console);case"error":Me.Error=Ka=console.error.bind(window.console);case"none":break;default:throw new window.Error("invalid logging type '"+e+"'")}}function of(){return An}Xa()});var wn=se(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.decodeUTF8=af;Dr.encodeUTF8=lf;function af(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;try{return decodeURIComponent(escape(e))}catch(r){if(r instanceof URIError&&i)return e;throw r}}function lf(e){return unescape(encodeURIComponent(e))}});var Oi=se(xe=>{"use strict";function Sn(e){"@babel/helpers - typeof";return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Sn(e)}Object.defineProperty(xe,"__esModule",{value:!0});xe.hasScrollbarGutter=xe.dragThreshold=void 0;xe.isAndroid=_f;xe.isBlink=xf;xe.isChrome=mf;xe.isChromeOS=gf;xe.isChromium=yf;xe.isEdge=Af;xe.isFirefox=vf;xe.isGecko=wf;xe.isIOS=ff;xe.isMac=uf;xe.isOpera=bf;xe.isSafari=pf;xe.isTouchDevice=void 0;xe.isWebKit=Cf;xe.isWindows=df;xe.supportsCursorURIs=void 0;var Ir=hf(xt());function Ua(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Ua=function(l){return l?r:i})(e)}function hf(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Sn(e)!="object"&&typeof e!="function")return{default:e};var r=Ua(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var cf=xe.isTouchDevice="ontouchstart"in document.documentElement||document.ontouchstart!==void 0||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;window.addEventListener("touchstart",function e(){xe.isTouchDevice=cf=!0,window.removeEventListener("touchstart",e,!1)},!1);var hm=xe.dragThreshold=10*(window.devicePixelRatio||1),$a=!1;try{Cn=document.createElement("canvas"),Cn.style.cursor='url("data:image/x-icon;base64,AAACAAEACAgAAAIAAgA4AQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AAAAAAAAAAAAAAAAAAAAAA==") 2 2, default',Cn.style.cursor.indexOf("url")===0?(Ir.Info("Data URI scheme cursor supported"),$a=!0):Ir.Warn("Data URI scheme cursor not supported")}catch(e){Ir.Error("Data URI scheme cursor test exception: "+e)}var Cn,cm=xe.supportsCursorURIs=$a,Wa=!0;try{Rt=document.createElement("div"),Rt.style.visibility="hidden",Rt.style.overflow="scroll",document.body.appendChild(Rt),xn=document.createElement("div"),Rt.appendChild(xn),Na=Rt.offsetWidth-xn.offsetWidth,Rt.parentNode.removeChild(Rt),Wa=Na!=0}catch(e){Ir.Error("Scrollbar test exception: "+e)}var Rt,xn,Na,um=xe.hasScrollbarGutter=Wa;function uf(){return!!/mac/i.exec(navigator.platform)}function df(){return!!/win/i.exec(navigator.platform)}function ff(){return!!/ipad/i.exec(navigator.platform)||!!/iphone/i.exec(navigator.platform)||!!/ipod/i.exec(navigator.platform)}function _f(){return!!navigator.userAgent.match("Android ")}function gf(){return!!navigator.userAgent.match(" CrOS ")}function pf(){return!!navigator.userAgent.match("Safari/...")&&!navigator.userAgent.match("Chrome/...")&&!navigator.userAgent.match("Chromium/...")&&!navigator.userAgent.match("Epiphany/...")}function vf(){return!!navigator.userAgent.match("Firefox/...")&&!navigator.userAgent.match("Seamonkey/...")}function mf(){return!!navigator.userAgent.match("Chrome/...")&&!navigator.userAgent.match("Chromium/...")&&!navigator.userAgent.match("Edg/...")&&!navigator.userAgent.match("OPR/...")}function yf(){return!!navigator.userAgent.match("Chromium/...")}function bf(){return!!navigator.userAgent.match("OPR/...")}function Af(){return!!navigator.userAgent.match("Edg/...")}function wf(){return!!navigator.userAgent.match("Gecko/...")}function Cf(){return!!navigator.userAgent.match("AppleWebKit/...")&&!navigator.userAgent.match("Chrome/...")}function xf(){return!!navigator.userAgent.match("Chrome/...")}});var za=se(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.clientToElement=Sf;function Sf(e,i,r){var s=r.getBoundingClientRect(),l={x:0,y:0};return e<s.left?l.x=0:e>=s.right?l.x=s.width-1:l.x=e-s.left,i<s.top?l.y=0:i>=s.bottom?l.y=s.height-1:l.y=i-s.top,l}});var Ln=se(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.getPointerEvent=Ef;di.releaseCapture=Bn;di.setCapture=Bf;di.stopEvent=kf;function Ef(e){return e.changedTouches?e.changedTouches[0]:e.touches?e.touches[0]:e}function kf(e){e.stopPropagation(),e.preventDefault()}var kn=!1,ja=null;document.captureElement=null;function Vt(e){if(!kn){var i=new e.constructor(e.type,e);kn=!0,document.captureElement?document.captureElement.dispatchEvent(i):ja.dispatchEvent(i),kn=!1,e.stopPropagation(),i.defaultPrevented&&e.preventDefault(),e.type==="mouseup"&&Bn()}}function Ga(){var e=document.getElementById("noVNC_mouse_capture_elem");e.style.cursor=window.getComputedStyle(document.captureElement).cursor}var qa=new MutationObserver(Ga);function Bf(e){if(e.setCapture)e.setCapture(),document.captureElement=e;else{Bn();var i=document.getElementById("noVNC_mouse_capture_elem");i===null&&(i=document.createElement("div"),i.id="noVNC_mouse_capture_elem",i.style.position="fixed",i.style.top="0px",i.style.left="0px",i.style.width="100%",i.style.height="100%",i.style.zIndex=1e4,i.style.display="none",document.body.appendChild(i),i.addEventListener("contextmenu",Vt),i.addEventListener("mousemove",Vt),i.addEventListener("mouseup",Vt)),document.captureElement=e,qa.observe(e,{attributes:!0}),Ga(),i.style.display="",window.addEventListener("mousemove",Vt),window.addEventListener("mouseup",Vt)}}function Bn(){if(document.releaseCapture)document.releaseCapture(),document.captureElement=null;else{if(!document.captureElement)return;ja=document.captureElement,document.captureElement=null,qa.disconnect();var e=document.getElementById("noVNC_mouse_capture_elem");e.style.display="none",window.removeEventListener("mousemove",Vt),window.removeEventListener("mouseup",Vt)}}});var Dn=se(Tr=>{"use strict";Object.defineProperty(Tr,"__esModule",{value:!0});Tr.default=void 0;function Hi(e){"@babel/helpers - typeof";return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Hi(e)}function Lf(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Va(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,If(s.key),s)}}function Df(e,i,r){return i&&Va(e.prototype,i),r&&Va(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function If(e){var i=Tf(e,"string");return Hi(i)=="symbol"?i:i+""}function Tf(e,i){if(Hi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Hi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var gm=Tr.default=function(){function e(){Lf(this,e),this._listeners=new Map}return Df(e,[{key:"addEventListener",value:function(r,s){this._listeners.has(r)||this._listeners.set(r,new Set),this._listeners.get(r).add(s)}},{key:"removeEventListener",value:function(r,s){this._listeners.has(r)&&this._listeners.get(r).delete(s)}},{key:"dispatchEvent",value:function(r){var s=this;return this._listeners.has(r.type)?(this._listeners.get(r.type).forEach(function(l){return l.call(s,r)}),!r.defaultPrevented):!0}}])}()});var Tn=se(Rr=>{"use strict";function In(e){"@babel/helpers - typeof";return In=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},In(e)}Object.defineProperty(Rr,"__esModule",{value:!0});Rr.default=void 0;var Rf=Mf(xt());function Ya(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Ya=function(l){return l?r:i})(e)}function Mf(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||In(e)!="object"&&typeof e!="function")return{default:e};var r=Ya(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var vm=Rr.default={toBase64Table:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".split(""),base64Pad:"=",encode:function(i){"use strict";for(var r="",s=i.length,l=s%3,t=0;t<s-2;t+=3)r+=this.toBase64Table[i[t]>>2],r+=this.toBase64Table[((i[t]&3)<<4)+(i[t+1]>>4)],r+=this.toBase64Table[((i[t+1]&15)<<2)+(i[t+2]>>6)],r+=this.toBase64Table[i[t+2]&63];var n=s-l;return l===2?(r+=this.toBase64Table[i[n]>>2],r+=this.toBase64Table[((i[n]&3)<<4)+(i[n+1]>>4)],r+=this.toBase64Table[(i[n+1]&15)<<2],r+=this.toBase64Table[64]):l===1&&(r+=this.toBase64Table[i[n]>>2],r+=this.toBase64Table[(i[n]&3)<<4],r+=this.toBase64Table[64],r+=this.toBase64Table[64]),r},toBinaryTable:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],decode:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=i.indexOf("=")-r;s<0&&(s=i.length-r);for(var l=(s>>2)*3+Math.floor(s%4/1.5),t=new Array(l),n=0,h=0,g=0,o=r;o<i.length;o++){var c=this.toBinaryTable[i.charCodeAt(o)&127],f=i.charAt(o)===this.base64Pad;if(c===-1){Rf.Error("Illegal character code "+i.charCodeAt(o)+" at position "+o);continue}h=h<<6|c,n+=6,n>=8&&(n-=8,f||(t[g++]=h>>n&255),h&=(1<<n)-1)}if(n){var v=new Error("Corrupted base64 string");throw v.name="Base64-Error",v}return t}}});var tl=se(Mr=>{"use strict";Object.defineProperty(Mr,"__esModule",{value:!0});Mr.default=void 0;var fi=Of(xt()),Ff=Pf(Tn()),Ja=bn();function Pf(e){return e&&e.__esModule?e:{default:e}}function el(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(el=function(l){return l?r:i})(e)}function Of(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||_i(e)!="object"&&typeof e!="function")return{default:e};var r=el(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function _i(e){"@babel/helpers - typeof";return _i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_i(e)}function Hf(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Za(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Kf(s.key),s)}}function Qf(e,i,r){return i&&Za(e.prototype,i),r&&Za(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Kf(e){var i=Xf(e,"string");return _i(i)=="symbol"?i:i+""}function Xf(e,i){if(_i(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(_i(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var ym=Mr.default=function(){function e(i){if(Hf(this,e),this._drawCtx=null,this._renderQ=[],this._flushPromise=null,this._fbWidth=0,this._fbHeight=0,this._prevDrawStyle="",fi.Debug(">> Display.constructor"),this._target=i,!this._target)throw new Error("Target must be set");if(typeof this._target=="string")throw new Error("target must be a DOM element");if(!this._target.getContext)throw new Error("no getContext method");this._targetCtx=this._target.getContext("2d"),this._viewportLoc={x:0,y:0,w:this._target.width,h:this._target.height},this._backbuffer=document.createElement("canvas"),this._drawCtx=this._backbuffer.getContext("2d"),this._damageBounds={left:0,top:0,right:this._backbuffer.width,bottom:this._backbuffer.height},fi.Debug("User Agent: "+navigator.userAgent),fi.Debug("<< Display.constructor"),this._scale=1,this._clipViewport=!1}return Qf(e,[{key:"scale",get:function(){return this._scale},set:function(r){this._rescale(r)}},{key:"clipViewport",get:function(){return this._clipViewport},set:function(r){this._clipViewport=r;var s=this._viewportLoc;this.viewportChangeSize(s.w,s.h),this.viewportChangePos(0,0)}},{key:"width",get:function(){return this._fbWidth}},{key:"height",get:function(){return this._fbHeight}},{key:"viewportChangePos",value:function(r,s){var l=this._viewportLoc;r=Math.floor(r),s=Math.floor(s),this._clipViewport||(r=-l.w,s=-l.h);var t=l.x+l.w-1,n=l.y+l.h-1;r<0&&l.x+r<0&&(r=-l.x),t+r>=this._fbWidth&&(r-=t+r-this._fbWidth+1),l.y+s<0&&(s=-l.y),n+s>=this._fbHeight&&(s-=n+s-this._fbHeight+1),!(r===0&&s===0)&&(fi.Debug("viewportChange deltaX: "+r+", deltaY: "+s),l.x+=r,l.y+=s,this._damage(l.x,l.y,l.w,l.h),this.flip())}},{key:"viewportChangeSize",value:function(r,s){(!this._clipViewport||typeof r>"u"||typeof s>"u")&&(fi.Debug("Setting viewport to full display region"),r=this._fbWidth,s=this._fbHeight),r=Math.floor(r),s=Math.floor(s),r>this._fbWidth&&(r=this._fbWidth),s>this._fbHeight&&(s=this._fbHeight);var l=this._viewportLoc;if(l.w!==r||l.h!==s){l.w=r,l.h=s;var t=this._target;t.width=r,t.height=s,this.viewportChangePos(0,0),this._damage(l.x,l.y,l.w,l.h),this.flip(),this._rescale(this._scale)}}},{key:"absX",value:function(r){return this._scale===0?0:(0,Ja.toSigned32bit)(r/this._scale+this._viewportLoc.x)}},{key:"absY",value:function(r){return this._scale===0?0:(0,Ja.toSigned32bit)(r/this._scale+this._viewportLoc.y)}},{key:"resize",value:function(r,s){this._prevDrawStyle="",this._fbWidth=r,this._fbHeight=s;var l=this._backbuffer;if(l.width!==r||l.height!==s){var t=null;l.width>0&&l.height>0&&(t=this._drawCtx.getImageData(0,0,l.width,l.height)),l.width!==r&&(l.width=r),l.height!==s&&(l.height=s),t&&this._drawCtx.putImageData(t,0,0)}var n=this._viewportLoc;this.viewportChangeSize(n.w,n.h),this.viewportChangePos(0,0)}},{key:"getImageData",value:function(){return this._drawCtx.getImageData(0,0,this.width,this.height)}},{key:"toDataURL",value:function(r,s){return this._backbuffer.toDataURL(r,s)}},{key:"toBlob",value:function(r,s,l){return this._backbuffer.toBlob(r,s,l)}},{key:"_damage",value:function(r,s,l,t){r<this._damageBounds.left&&(this._damageBounds.left=r),s<this._damageBounds.top&&(this._damageBounds.top=s),r+l>this._damageBounds.right&&(this._damageBounds.right=r+l),s+t>this._damageBounds.bottom&&(this._damageBounds.bottom=s+t)}},{key:"flip",value:function(r){if(this._renderQ.length!==0&&!r)this._renderQPush({type:"flip"});else{var s=this._damageBounds.left,l=this._damageBounds.top,t=this._damageBounds.right-s,n=this._damageBounds.bottom-l,h=s-this._viewportLoc.x,g=l-this._viewportLoc.y;h<0&&(t+=h,s-=h,h=0),g<0&&(n+=g,l-=g,g=0),h+t>this._viewportLoc.w&&(t=this._viewportLoc.w-h),g+n>this._viewportLoc.h&&(n=this._viewportLoc.h-g),t>0&&n>0&&this._targetCtx.drawImage(this._backbuffer,s,l,t,n,h,g,t,n),this._damageBounds.left=this._damageBounds.top=65535,this._damageBounds.right=this._damageBounds.bottom=0}}},{key:"pending",value:function(){return this._renderQ.length>0}},{key:"flush",value:function(){var r=this;return this._renderQ.length===0?Promise.resolve():(this._flushPromise===null&&(this._flushPromise=new Promise(function(s){r._flushResolve=s})),this._flushPromise)}},{key:"fillRect",value:function(r,s,l,t,n,h){this._renderQ.length!==0&&!h?this._renderQPush({type:"fill",x:r,y:s,width:l,height:t,color:n}):(this._setFillColor(n),this._drawCtx.fillRect(r,s,l,t),this._damage(r,s,l,t))}},{key:"copyImage",value:function(r,s,l,t,n,h,g){this._renderQ.length!==0&&!g?this._renderQPush({type:"copy",oldX:r,oldY:s,x:l,y:t,width:n,height:h}):(this._drawCtx.mozImageSmoothingEnabled=!1,this._drawCtx.webkitImageSmoothingEnabled=!1,this._drawCtx.msImageSmoothingEnabled=!1,this._drawCtx.imageSmoothingEnabled=!1,this._drawCtx.drawImage(this._backbuffer,r,s,n,h,l,t,n,h),this._damage(l,t,n,h))}},{key:"imageRect",value:function(r,s,l,t,n,h){if(!(l===0||t===0)){var g=new Image;g.src="data: "+n+";base64,"+Ff.default.encode(h),this._renderQPush({type:"img",img:g,x:r,y:s,width:l,height:t})}}},{key:"blitImage",value:function(r,s,l,t,n,h,g){if(this._renderQ.length!==0&&!g){var o=new Uint8Array(l*t*4);o.set(new Uint8Array(n.buffer,0,o.length)),this._renderQPush({type:"blit",data:o,x:r,y:s,width:l,height:t})}else{var c=new Uint8ClampedArray(n.buffer,n.byteOffset+h,l*t*4),f=new ImageData(c,l,t);this._drawCtx.putImageData(f,r,s),this._damage(r,s,l,t)}}},{key:"drawImage",value:function(r,s,l){this._drawCtx.drawImage(r,s,l),this._damage(s,l,r.width,r.height)}},{key:"autoscale",value:function(r,s){var l;if(r===0||s===0)l=0;else{var t=this._viewportLoc,n=r/s,h=t.w/t.h;h>=n?l=r/t.w:l=s/t.h}this._rescale(l)}},{key:"_rescale",value:function(r){this._scale=r;var s=this._viewportLoc,l=r*s.w+"px",t=r*s.h+"px";(this._target.style.width!==l||this._target.style.height!==t)&&(this._target.style.width=l,this._target.style.height=t)}},{key:"_setFillColor",value:function(r){var s="rgb("+r[0]+","+r[1]+","+r[2]+")";s!==this._prevDrawStyle&&(this._drawCtx.fillStyle=s,this._prevDrawStyle=s)}},{key:"_renderQPush",value:function(r){this._renderQ.push(r),this._renderQ.length===1&&this._scanRenderQ()}},{key:"_resumeRenderQ",value:function(){this.removeEventListener("load",this._noVNCDisplay._resumeRenderQ),this._noVNCDisplay._scanRenderQ()}},{key:"_scanRenderQ",value:function(){for(var r=!0;r&&this._renderQ.length>0;){var s=this._renderQ[0];switch(s.type){case"flip":this.flip(!0);break;case"copy":this.copyImage(s.oldX,s.oldY,s.x,s.y,s.width,s.height,!0);break;case"fill":this.fillRect(s.x,s.y,s.width,s.height,s.color,!0);break;case"blit":this.blitImage(s.x,s.y,s.width,s.height,s.data,0,!0);break;case"img":if(s.img.complete){if(s.img.width!==s.width||s.img.height!==s.height){fi.Error("Decoded image has incorrect dimensions. Got "+s.img.width+"x"+s.img.height+". Expected "+s.width+"x"+s.height+".");return}this.drawImage(s.img,s.x,s.y)}else s.img._noVNCDisplay=this,s.img.addEventListener("load",this._resumeRenderQ),r=!1;break}r&&this._renderQ.shift()}this._renderQ.length===0&&this._flushPromise!==null&&(this._flushResolve(),this._flushPromise=null,this._flushResolve=null)}}])}()});var Qi=se(ht=>{"use strict";Object.defineProperty(ht,"__esModule",{value:!0});ht.Buf8=ht.Buf32=ht.Buf16=void 0;ht.arraySet=Uf;ht.flattenChunks=$f;ht.shrinkBuf=Nf;function Nf(e,i){return e.length===i?e:e.subarray?e.subarray(0,i):(e.length=i,e)}function Uf(e,i,r,s,l){if(i.subarray&&e.subarray){e.set(i.subarray(r,r+s),l);return}for(var t=0;t<s;t++)e[l+t]=i[r+t]}function $f(e){var i,r,s,l,t,n;for(s=0,i=0,r=e.length;i<r;i++)s+=e[i].length;for(n=new Uint8Array(s),l=0,i=0,r=e.length;i<r;i++)t=e[i],n.set(t,l),l+=t.length;return n}var Am=ht.Buf8=Uint8Array,wm=ht.Buf16=Uint16Array,Cm=ht.Buf32=Int32Array});var Mn=se(Rn=>{"use strict";Object.defineProperty(Rn,"__esModule",{value:!0});Rn.default=Wf;function Wf(e,i,r,s){for(var l=e&65535|0,t=e>>>16&65535|0,n=0;r!==0;){n=r>2e3?2e3:r,r-=n;do l=l+i[s++]|0,t=t+l|0;while(--n);l%=65521,t%=65521}return l|t<<16|0}});var Pn=se(Fn=>{"use strict";Object.defineProperty(Fn,"__esModule",{value:!0});Fn.default=il;function il(){for(var e,i=[],r=0;r<256;r++){e=r;for(var s=0;s<8;s++)e=e&1?3988292384^e>>>1:e>>>1;i[r]=e}return i}var Em=il()});var rl=se(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.default=jf;var Fr=30,zf=12;function jf(e,i){var r,s,l,t,n,h,g,o,c,f,v,u,a,d,_,p,m,w,b,S,A,x,E,D,L;r=e.state,s=e.next_in,D=e.input,l=s+(e.avail_in-5),t=e.next_out,L=e.output,n=t-(i-e.avail_out),h=t+(e.avail_out-257),g=r.dmax,o=r.wsize,c=r.whave,f=r.wnext,v=r.window,u=r.hold,a=r.bits,d=r.lencode,_=r.distcode,p=(1<<r.lenbits)-1,m=(1<<r.distbits)-1;e:do{a<15&&(u+=D[s++]<<a,a+=8,u+=D[s++]<<a,a+=8),w=d[u&p];t:for(;;){if(b=w>>>24,u>>>=b,a-=b,b=w>>>16&255,b===0)L[t++]=w&65535;else if(b&16){S=w&65535,b&=15,b&&(a<b&&(u+=D[s++]<<a,a+=8),S+=u&(1<<b)-1,u>>>=b,a-=b),a<15&&(u+=D[s++]<<a,a+=8,u+=D[s++]<<a,a+=8),w=_[u&m];i:for(;;){if(b=w>>>24,u>>>=b,a-=b,b=w>>>16&255,b&16){if(A=w&65535,b&=15,a<b&&(u+=D[s++]<<a,a+=8,a<b&&(u+=D[s++]<<a,a+=8)),A+=u&(1<<b)-1,A>g){e.msg="invalid distance too far back",r.mode=Fr;break e}if(u>>>=b,a-=b,b=t-n,A>b){if(b=A-b,b>c&&r.sane){e.msg="invalid distance too far back",r.mode=Fr;break e}if(x=0,E=v,f===0){if(x+=o-b,b<S){S-=b;do L[t++]=v[x++];while(--b);x=t-A,E=L}}else if(f<b){if(x+=o+f-b,b-=f,b<S){S-=b;do L[t++]=v[x++];while(--b);if(x=0,f<S){b=f,S-=b;do L[t++]=v[x++];while(--b);x=t-A,E=L}}}else if(x+=f-b,b<S){S-=b;do L[t++]=v[x++];while(--b);x=t-A,E=L}for(;S>2;)L[t++]=E[x++],L[t++]=E[x++],L[t++]=E[x++],S-=3;S&&(L[t++]=E[x++],S>1&&(L[t++]=E[x++]))}else{x=t-A;do L[t++]=L[x++],L[t++]=L[x++],L[t++]=L[x++],S-=3;while(S>2);S&&(L[t++]=L[x++],S>1&&(L[t++]=L[x++]))}}else if((b&64)===0){w=_[(w&65535)+(u&(1<<b)-1)];continue i}else{e.msg="invalid distance code",r.mode=Fr;break e}break}}else if((b&64)===0){w=d[(w&65535)+(u&(1<<b)-1)];continue t}else if(b&32){r.mode=zf;break e}else{e.msg="invalid literal/length code",r.mode=Fr;break e}break}}while(s<l&&t<h);S=a>>3,s-=S,a-=S<<3,u&=(1<<a)-1,e.next_in=s,e.next_out=t,e.avail_in=s<l?5+(l-s):5-(s-l),e.avail_out=t<h?257+(h-t):257-(t-h),r.hold=u,r.bits=a}});var cl=se(Kn=>{"use strict";function Qn(e){"@babel/helpers - typeof";return Qn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Qn(e)}Object.defineProperty(Kn,"__esModule",{value:!0});Kn.default=Zf;var sl=Gf(Qi());function hl(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(hl=function(l){return l?r:i})(e)}function Gf(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Qn(e)!="object"&&typeof e!="function")return{default:e};var r=hl(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var gi=15,nl=852,ol=592,al=0,Hn=1,ll=2,qf=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Vf=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Yf=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Jf=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function Zf(e,i,r,s,l,t,n,h){var g=h.bits,o=0,c=0,f=0,v=0,u=0,a=0,d=0,_=0,p=0,m=0,w,b,S,A,x,E=null,D=0,L,T=new sl.Buf16(gi+1),F=new sl.Buf16(gi+1),K=null,N=0,X,k,y;for(o=0;o<=gi;o++)T[o]=0;for(c=0;c<s;c++)T[i[r+c]]++;for(u=g,v=gi;v>=1&&T[v]===0;v--);if(u>v&&(u=v),v===0)return l[t++]=1<<24|64<<16|0,l[t++]=1<<24|64<<16|0,h.bits=1,0;for(f=1;f<v&&T[f]===0;f++);for(u<f&&(u=f),_=1,o=1;o<=gi;o++)if(_<<=1,_-=T[o],_<0)return-1;if(_>0&&(e===al||v!==1))return-1;for(F[1]=0,o=1;o<gi;o++)F[o+1]=F[o]+T[o];for(c=0;c<s;c++)i[r+c]!==0&&(n[F[i[r+c]]++]=c);if(e===al?(E=K=n,L=19):e===Hn?(E=qf,D-=257,K=Vf,N-=257,L=256):(E=Yf,K=Jf,L=-1),m=0,c=0,o=f,x=t,a=u,d=0,S=-1,p=1<<u,A=p-1,e===Hn&&p>nl||e===ll&&p>ol)return 1;for(;;){X=o-d,n[c]<L?(k=0,y=n[c]):n[c]>L?(k=K[N+n[c]],y=E[D+n[c]]):(k=96,y=0),w=1<<o-d,b=1<<a,f=b;do b-=w,l[x+(m>>d)+b]=X<<24|k<<16|y|0;while(b!==0);for(w=1<<o-1;m&w;)w>>=1;if(w!==0?(m&=w-1,m+=w):m=0,c++,--T[o]===0){if(o===v)break;o=i[r+n[c]]}if(o>u&&(m&A)!==S){for(d===0&&(d=u),x+=f,a=o-d,_=1<<a;a+d<v&&(_-=T[a+d],!(_<=0));)a++,_<<=1;if(p+=1<<a,e===Hn&&p>nl||e===ll&&p>ol)return 1;S=m&A,l[S]=u<<24|a<<16|x-t|0}}return m!==0&&(l[x+m]=o-d<<24|64<<16|0),h.bits=u,0}});var zl=se(fe=>{"use strict";function zn(e){"@babel/helpers - typeof";return zn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},zn(e)}Object.defineProperty(fe,"__esModule",{value:!0});fe.Z_TREES=fe.Z_STREAM_ERROR=fe.Z_STREAM_END=fe.Z_OK=fe.Z_NEED_DICT=fe.Z_MEM_ERROR=fe.Z_FINISH=fe.Z_DEFLATED=fe.Z_DATA_ERROR=fe.Z_BUF_ERROR=fe.Z_BLOCK=void 0;fe.inflate=g_;fe.inflateEnd=p_;fe.inflateGetHeader=v_;fe.inflateInfo=void 0;fe.inflateInit=f_;fe.inflateInit2=$l;fe.inflateReset=Nl;fe.inflateReset2=Ul;fe.inflateResetKeep=Xl;fe.inflateSetDictionary=m_;var Je=t_(Qi()),jn=Kr(Mn()),_t=Kr(Pn()),e_=Kr(rl()),Ki=Kr(cl());function Kr(e){return e&&e.__esModule?e:{default:e}}function Pl(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Pl=function(l){return l?r:i})(e)}function t_(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||zn(e)!="object"&&typeof e!="function")return{default:e};var r=Pl(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var i_=0,Ol=1,Hl=2,ul=fe.Z_FINISH=4,r_=fe.Z_BLOCK=5,Pr=fe.Z_TREES=6,Yt=fe.Z_OK=0,s_=fe.Z_STREAM_END=1,n_=fe.Z_NEED_DICT=2,it=fe.Z_STREAM_ERROR=-2,Ql=fe.Z_DATA_ERROR=-3,Gn=fe.Z_MEM_ERROR=-4,o_=fe.Z_BUF_ERROR=-5,dl=fe.Z_DEFLATED=8,Kl=1,fl=2,_l=3,gl=4,pl=5,vl=6,ml=7,yl=8,bl=9,Al=10,Qr=11,St=12,Xn=13,wl=14,Nn=15,Cl=16,xl=17,Sl=18,El=19,Or=20,Hr=21,kl=22,Bl=23,Ll=24,Dl=25,Il=26,Un=27,Tl=28,Rl=29,ke=30,qn=31,a_=32,l_=852,h_=592,c_=15,u_=c_;function Ml(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function d_(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Je.Buf16(320),this.work=new Je.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Xl(e){var i;return!e||!e.state?it:(i=e.state,e.total_in=e.total_out=i.total=0,e.msg="",i.wrap&&(e.adler=i.wrap&1),i.mode=Kl,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new Je.Buf32(l_),i.distcode=i.distdyn=new Je.Buf32(h_),i.sane=1,i.back=-1,Yt)}function Nl(e){var i;return!e||!e.state?it:(i=e.state,i.wsize=0,i.whave=0,i.wnext=0,Xl(e))}function Ul(e,i){var r,s;return!e||!e.state||(s=e.state,i<0?(r=0,i=-i):(r=(i>>4)+1,i<48&&(i&=15)),i&&(i<8||i>15))?it:(s.window!==null&&s.wbits!==i&&(s.window=null),s.wrap=r,s.wbits=i,Nl(e))}function $l(e,i){var r,s;return e?(s=new d_,e.state=s,s.window=null,r=Ul(e,i),r!==Yt&&(e.state=null),r):it}function f_(e){return $l(e,u_)}var Fl=!0,$n,Wn;function __(e){if(Fl){var i;for($n=new Je.Buf32(512),Wn=new Je.Buf32(32),i=0;i<144;)e.lens[i++]=8;for(;i<256;)e.lens[i++]=9;for(;i<280;)e.lens[i++]=7;for(;i<288;)e.lens[i++]=8;for((0,Ki.default)(Ol,e.lens,0,288,$n,0,e.work,{bits:9}),i=0;i<32;)e.lens[i++]=5;(0,Ki.default)(Hl,e.lens,0,32,Wn,0,e.work,{bits:5}),Fl=!1}e.lencode=$n,e.lenbits=9,e.distcode=Wn,e.distbits=5}function Wl(e,i,r,s){var l,t=e.state;return t.window===null&&(t.wsize=1<<t.wbits,t.wnext=0,t.whave=0,t.window=new Je.Buf8(t.wsize)),s>=t.wsize?(Je.arraySet(t.window,i,r-t.wsize,t.wsize,0),t.wnext=0,t.whave=t.wsize):(l=t.wsize-t.wnext,l>s&&(l=s),Je.arraySet(t.window,i,r-s,l,t.wnext),s-=l,s?(Je.arraySet(t.window,i,r-s,s,0),t.wnext=s,t.whave=t.wsize):(t.wnext+=l,t.wnext===t.wsize&&(t.wnext=0),t.whave<t.wsize&&(t.whave+=l))),0}function g_(e,i){var r,s,l,t,n,h,g,o,c,f,v,u,a,d,_=0,p,m,w,b,S,A,x,E,D=new Je.Buf8(4),L,T,F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return it;r=e.state,r.mode===St&&(r.mode=Xn),n=e.next_out,l=e.output,g=e.avail_out,t=e.next_in,s=e.input,h=e.avail_in,o=r.hold,c=r.bits,f=h,v=g,E=Yt;e:for(;;)switch(r.mode){case Kl:if(r.wrap===0){r.mode=Xn;break}for(;c<16;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(r.wrap&2&&o===35615){r.check=0,D[0]=o&255,D[1]=o>>>8&255,r.check=(0,_t.default)(r.check,D,2,0),o=0,c=0,r.mode=fl;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((o&255)<<8)+(o>>8))%31){e.msg="incorrect header check",r.mode=ke;break}if((o&15)!==dl){e.msg="unknown compression method",r.mode=ke;break}if(o>>>=4,c-=4,x=(o&15)+8,r.wbits===0)r.wbits=x;else if(x>r.wbits){e.msg="invalid window size",r.mode=ke;break}r.dmax=1<<x,e.adler=r.check=1,r.mode=o&512?Al:St,o=0,c=0;break;case fl:for(;c<16;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(r.flags=o,(r.flags&255)!==dl){e.msg="unknown compression method",r.mode=ke;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=ke;break}r.head&&(r.head.text=o>>8&1),r.flags&512&&(D[0]=o&255,D[1]=o>>>8&255,r.check=(0,_t.default)(r.check,D,2,0)),o=0,c=0,r.mode=_l;case _l:for(;c<32;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.head&&(r.head.time=o),r.flags&512&&(D[0]=o&255,D[1]=o>>>8&255,D[2]=o>>>16&255,D[3]=o>>>24&255,r.check=(0,_t.default)(r.check,D,4,0)),o=0,c=0,r.mode=gl;case gl:for(;c<16;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.head&&(r.head.xflags=o&255,r.head.os=o>>8),r.flags&512&&(D[0]=o&255,D[1]=o>>>8&255,r.check=(0,_t.default)(r.check,D,2,0)),o=0,c=0,r.mode=pl;case pl:if(r.flags&1024){for(;c<16;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.length=o,r.head&&(r.head.extra_len=o),r.flags&512&&(D[0]=o&255,D[1]=o>>>8&255,r.check=(0,_t.default)(r.check,D,2,0)),o=0,c=0}else r.head&&(r.head.extra=null);r.mode=vl;case vl:if(r.flags&1024&&(u=r.length,u>h&&(u=h),u&&(r.head&&(x=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),Je.arraySet(r.head.extra,s,t,u,x)),r.flags&512&&(r.check=(0,_t.default)(r.check,s,u,t)),h-=u,t+=u,r.length-=u),r.length))break e;r.length=0,r.mode=ml;case ml:if(r.flags&2048){if(h===0)break e;u=0;do x=s[t+u++],r.head&&x&&r.length<65536&&(r.head.name+=String.fromCharCode(x));while(x&&u<h);if(r.flags&512&&(r.check=(0,_t.default)(r.check,s,u,t)),h-=u,t+=u,x)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=yl;case yl:if(r.flags&4096){if(h===0)break e;u=0;do x=s[t+u++],r.head&&x&&r.length<65536&&(r.head.comment+=String.fromCharCode(x));while(x&&u<h);if(r.flags&512&&(r.check=(0,_t.default)(r.check,s,u,t)),h-=u,t+=u,x)break e}else r.head&&(r.head.comment=null);r.mode=bl;case bl:if(r.flags&512){for(;c<16;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(o!==(r.check&65535)){e.msg="header crc mismatch",r.mode=ke;break}o=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=St;break;case Al:for(;c<32;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}e.adler=r.check=Ml(o),o=0,c=0,r.mode=Qr;case Qr:if(r.havedict===0)return e.next_out=n,e.avail_out=g,e.next_in=t,e.avail_in=h,r.hold=o,r.bits=c,n_;e.adler=r.check=1,r.mode=St;case St:if(i===r_||i===Pr)break e;case Xn:if(r.last){o>>>=c&7,c-=c&7,r.mode=Un;break}for(;c<3;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}switch(r.last=o&1,o>>>=1,c-=1,o&3){case 0:r.mode=wl;break;case 1:if(__(r),r.mode=Or,i===Pr){o>>>=2,c-=2;break e}break;case 2:r.mode=xl;break;case 3:e.msg="invalid block type",r.mode=ke}o>>>=2,c-=2;break;case wl:for(o>>>=c&7,c-=c&7;c<32;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if((o&65535)!==(o>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ke;break}if(r.length=o&65535,o=0,c=0,r.mode=Nn,i===Pr)break e;case Nn:r.mode=Cl;case Cl:if(u=r.length,u){if(u>h&&(u=h),u>g&&(u=g),u===0)break e;Je.arraySet(l,s,t,u,n),h-=u,t+=u,g-=u,n+=u,r.length-=u;break}r.mode=St;break;case xl:for(;c<14;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(r.nlen=(o&31)+257,o>>>=5,c-=5,r.ndist=(o&31)+1,o>>>=5,c-=5,r.ncode=(o&15)+4,o>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ke;break}r.have=0,r.mode=Sl;case Sl:for(;r.have<r.ncode;){for(;c<3;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.lens[F[r.have++]]=o&7,o>>>=3,c-=3}for(;r.have<19;)r.lens[F[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,L={bits:r.lenbits},E=(0,Ki.default)(i_,r.lens,0,19,r.lencode,0,r.work,L),r.lenbits=L.bits,E){e.msg="invalid code lengths set",r.mode=ke;break}r.have=0,r.mode=El;case El:for(;r.have<r.nlen+r.ndist;){for(;_=r.lencode[o&(1<<r.lenbits)-1],p=_>>>24,m=_>>>16&255,w=_&65535,!(p<=c);){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(w<16)o>>>=p,c-=p,r.lens[r.have++]=w;else{if(w===16){for(T=p+2;c<T;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(o>>>=p,c-=p,r.have===0){e.msg="invalid bit length repeat",r.mode=ke;break}x=r.lens[r.have-1],u=3+(o&3),o>>>=2,c-=2}else if(w===17){for(T=p+3;c<T;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}o>>>=p,c-=p,x=0,u=3+(o&7),o>>>=3,c-=3}else{for(T=p+7;c<T;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}o>>>=p,c-=p,x=0,u=11+(o&127),o>>>=7,c-=7}if(r.have+u>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ke;break}for(;u--;)r.lens[r.have++]=x}}if(r.mode===ke)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ke;break}if(r.lenbits=9,L={bits:r.lenbits},E=(0,Ki.default)(Ol,r.lens,0,r.nlen,r.lencode,0,r.work,L),r.lenbits=L.bits,E){e.msg="invalid literal/lengths set",r.mode=ke;break}if(r.distbits=6,r.distcode=r.distdyn,L={bits:r.distbits},E=(0,Ki.default)(Hl,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,L),r.distbits=L.bits,E){e.msg="invalid distances set",r.mode=ke;break}if(r.mode=Or,i===Pr)break e;case Or:r.mode=Hr;case Hr:if(h>=6&&g>=258){e.next_out=n,e.avail_out=g,e.next_in=t,e.avail_in=h,r.hold=o,r.bits=c,(0,e_.default)(e,v),n=e.next_out,l=e.output,g=e.avail_out,t=e.next_in,s=e.input,h=e.avail_in,o=r.hold,c=r.bits,r.mode===St&&(r.back=-1);break}for(r.back=0;_=r.lencode[o&(1<<r.lenbits)-1],p=_>>>24,m=_>>>16&255,w=_&65535,!(p<=c);){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(m&&(m&240)===0){for(b=p,S=m,A=w;_=r.lencode[A+((o&(1<<b+S)-1)>>b)],p=_>>>24,m=_>>>16&255,w=_&65535,!(b+p<=c);){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}o>>>=b,c-=b,r.back+=b}if(o>>>=p,c-=p,r.back+=p,r.length=w,m===0){r.mode=Il;break}if(m&32){r.back=-1,r.mode=St;break}if(m&64){e.msg="invalid literal/length code",r.mode=ke;break}r.extra=m&15,r.mode=kl;case kl:if(r.extra){for(T=r.extra;c<T;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.length+=o&(1<<r.extra)-1,o>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Bl;case Bl:for(;_=r.distcode[o&(1<<r.distbits)-1],p=_>>>24,m=_>>>16&255,w=_&65535,!(p<=c);){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if((m&240)===0){for(b=p,S=m,A=w;_=r.distcode[A+((o&(1<<b+S)-1)>>b)],p=_>>>24,m=_>>>16&255,w=_&65535,!(b+p<=c);){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}o>>>=b,c-=b,r.back+=b}if(o>>>=p,c-=p,r.back+=p,m&64){e.msg="invalid distance code",r.mode=ke;break}r.offset=w,r.extra=m&15,r.mode=Ll;case Ll:if(r.extra){for(T=r.extra;c<T;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}r.offset+=o&(1<<r.extra)-1,o>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ke;break}r.mode=Dl;case Dl:if(g===0)break e;if(u=v-g,r.offset>u){if(u=r.offset-u,u>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ke;break}u>r.wnext?(u-=r.wnext,a=r.wsize-u):a=r.wnext-u,u>r.length&&(u=r.length),d=r.window}else d=l,a=n-r.offset,u=r.length;u>g&&(u=g),g-=u,r.length-=u;do l[n++]=d[a++];while(--u);r.length===0&&(r.mode=Hr);break;case Il:if(g===0)break e;l[n++]=r.length,g--,r.mode=Hr;break;case Un:if(r.wrap){for(;c<32;){if(h===0)break e;h--,o|=s[t++]<<c,c+=8}if(v-=g,e.total_out+=v,r.total+=v,v&&(e.adler=r.check=r.flags?(0,_t.default)(r.check,l,v,n-v):(0,jn.default)(r.check,l,v,n-v)),v=g,(r.flags?o:Ml(o))!==r.check){e.msg="incorrect data check",r.mode=ke;break}o=0,c=0}r.mode=Tl;case Tl:if(r.wrap&&r.flags){for(;c<32;){if(h===0)break e;h--,o+=s[t++]<<c,c+=8}if(o!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=ke;break}o=0,c=0}r.mode=Rl;case Rl:E=s_;break e;case ke:E=Ql;break e;case qn:return Gn;case a_:default:return it}return e.next_out=n,e.avail_out=g,e.next_in=t,e.avail_in=h,r.hold=o,r.bits=c,(r.wsize||v!==e.avail_out&&r.mode<ke&&(r.mode<Un||i!==ul))&&Wl(e,e.output,e.next_out,v-e.avail_out)?(r.mode=qn,Gn):(f-=e.avail_in,v-=e.avail_out,e.total_in+=f,e.total_out+=v,r.total+=v,r.wrap&&v&&(e.adler=r.check=r.flags?(0,_t.default)(r.check,l,v,e.next_out-v):(0,jn.default)(r.check,l,v,e.next_out-v)),e.data_type=r.bits+(r.last?64:0)+(r.mode===St?128:0)+(r.mode===Or||r.mode===Nn?256:0),(f===0&&v===0||i===ul)&&E===Yt&&(E=o_),E)}function p_(e){if(!e||!e.state)return it;var i=e.state;return i.window&&(i.window=null),e.state=null,Yt}function v_(e,i){var r;return!e||!e.state||(r=e.state,(r.wrap&2)===0)?it:(r.head=i,i.done=!1,Yt)}function m_(e,i){var r=i.length,s,l,t;return!e||!e.state||(s=e.state,s.wrap!==0&&s.mode!==Qr)?it:s.mode===Qr&&(l=1,l=(0,jn.default)(l,i,r,0),l!==s.check)?Ql:(t=Wl(e,i,r,r),t?(s.mode=qn,Gn):(s.havedict=1,Yt))}var Dm=fe.inflateInfo="pako inflate (from Nodeca project)"});var Yn=se(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.default=y_;function y_(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}});var Nr=se(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.default=void 0;var Jn=zl(),b_=A_(Yn());function A_(e){return e&&e.__esModule?e:{default:e}}function Xi(e){"@babel/helpers - typeof";return Xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Xi(e)}function w_(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function jl(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,x_(s.key),s)}}function C_(e,i,r){return i&&jl(e.prototype,i),r&&jl(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x_(e){var i=S_(e,"string");return Xi(i)=="symbol"?i:i+""}function S_(e,i){if(Xi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Xi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Rm=Xr.default=function(){function e(){w_(this,e),this.strm=new b_.default,this.chunkSize=1024*10*10,this.strm.output=new Uint8Array(this.chunkSize),(0,Jn.inflateInit)(this.strm)}return C_(e,[{key:"setInput",value:function(r){r?(this.strm.input=r,this.strm.avail_in=this.strm.input.length,this.strm.next_in=0):(this.strm.input=null,this.strm.avail_in=0,this.strm.next_in=0)}},{key:"inflate",value:function(r){r>this.chunkSize&&(this.chunkSize=r,this.strm.output=new Uint8Array(this.chunkSize)),this.strm.next_out=0,this.strm.avail_out=r;var s=(0,Jn.inflate)(this.strm,0);if(s<0)throw new Error("zlib inflate failed");if(this.strm.next_out!=r)throw new Error("Incomplete zlib block");return new Uint8Array(this.strm.output.buffer,0,this.strm.next_out)}},{key:"reset",value:function(){(0,Jn.inflateReset)(this.strm)}}])}()});var vh=se(Zt=>{"use strict";function ro(e){"@babel/helpers - typeof";return ro=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ro(e)}Object.defineProperty(Zt,"__esModule",{value:!0});Zt._tr_align=W_;Zt._tr_flush_block=z_;Zt._tr_init=$_;Zt._tr_stored_block=ph;Zt._tr_tally=j_;var E_=k_(Qi());function th(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(th=function(l){return l?r:i})(e)}function k_(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||ro(e)!="object"&&typeof e!="function")return{default:e};var r=th(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var B_=4,Gl=0,ql=1,L_=2;function vi(e){for(var i=e.length;--i>=0;)e[i]=0}var D_=0,ih=1,I_=2,T_=3,R_=258,oo=29,ji=256,Ui=ji+1+oo,pi=30,ao=19,rh=2*Ui+1,Jt=15,Zn=16,M_=7,lo=256,sh=16,nh=17,oh=18,so=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ur=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],F_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ah=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P_=512,Et=new Array((Ui+2)*2);vi(Et);var Ni=new Array(pi*2);vi(Ni);var $i=new Array(P_);vi($i);var Wi=new Array(R_-T_+1);vi(Wi);var ho=new Array(oo);vi(ho);var $r=new Array(pi);vi($r);function eo(e,i,r,s,l){this.static_tree=e,this.extra_bits=i,this.extra_base=r,this.elems=s,this.max_length=l,this.has_stree=e&&e.length}var lh,hh,ch;function to(e,i){this.dyn_tree=e,this.max_code=0,this.stat_desc=i}function uh(e){return e<256?$i[e]:$i[256+(e>>>7)]}function zi(e,i){e.pending_buf[e.pending++]=i&255,e.pending_buf[e.pending++]=i>>>8&255}function qe(e,i,r){e.bi_valid>Zn-r?(e.bi_buf|=i<<e.bi_valid&65535,zi(e,e.bi_buf),e.bi_buf=i>>Zn-e.bi_valid,e.bi_valid+=r-Zn):(e.bi_buf|=i<<e.bi_valid&65535,e.bi_valid+=r)}function gt(e,i,r){qe(e,r[i*2],r[i*2+1])}function dh(e,i){var r=0;do r|=e&1,e>>>=1,r<<=1;while(--i>0);return r>>>1}function O_(e){e.bi_valid===16?(zi(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function H_(e,i){var r=i.dyn_tree,s=i.max_code,l=i.stat_desc.static_tree,t=i.stat_desc.has_stree,n=i.stat_desc.extra_bits,h=i.stat_desc.extra_base,g=i.stat_desc.max_length,o,c,f,v,u,a,d=0;for(v=0;v<=Jt;v++)e.bl_count[v]=0;for(r[e.heap[e.heap_max]*2+1]=0,o=e.heap_max+1;o<rh;o++)c=e.heap[o],v=r[r[c*2+1]*2+1]+1,v>g&&(v=g,d++),r[c*2+1]=v,!(c>s)&&(e.bl_count[v]++,u=0,c>=h&&(u=n[c-h]),a=r[c*2],e.opt_len+=a*(v+u),t&&(e.static_len+=a*(l[c*2+1]+u)));if(d!==0){do{for(v=g-1;e.bl_count[v]===0;)v--;e.bl_count[v]--,e.bl_count[v+1]+=2,e.bl_count[g]--,d-=2}while(d>0);for(v=g;v!==0;v--)for(c=e.bl_count[v];c!==0;)f=e.heap[--o],!(f>s)&&(r[f*2+1]!==v&&(e.opt_len+=(v-r[f*2+1])*r[f*2],r[f*2+1]=v),c--)}}function fh(e,i,r){var s=new Array(Jt+1),l=0,t,n;for(t=1;t<=Jt;t++)s[t]=l=l+r[t-1]<<1;for(n=0;n<=i;n++){var h=e[n*2+1];h!==0&&(e[n*2]=dh(s[h]++,h))}}function Q_(){var e,i,r,s,l,t=new Array(Jt+1);for(r=0,s=0;s<oo-1;s++)for(ho[s]=r,e=0;e<1<<so[s];e++)Wi[r++]=s;for(Wi[r-1]=s,l=0,s=0;s<16;s++)for($r[s]=l,e=0;e<1<<Ur[s];e++)$i[l++]=s;for(l>>=7;s<pi;s++)for($r[s]=l<<7,e=0;e<1<<Ur[s]-7;e++)$i[256+l++]=s;for(i=0;i<=Jt;i++)t[i]=0;for(e=0;e<=143;)Et[e*2+1]=8,e++,t[8]++;for(;e<=255;)Et[e*2+1]=9,e++,t[9]++;for(;e<=279;)Et[e*2+1]=7,e++,t[7]++;for(;e<=287;)Et[e*2+1]=8,e++,t[8]++;for(fh(Et,Ui+1,t),e=0;e<pi;e++)Ni[e*2+1]=5,Ni[e*2]=dh(e,5);lh=new eo(Et,so,ji+1,Ui,Jt),hh=new eo(Ni,Ur,0,pi,Jt),ch=new eo(new Array(0),F_,0,ao,M_)}function _h(e){var i;for(i=0;i<Ui;i++)e.dyn_ltree[i*2]=0;for(i=0;i<pi;i++)e.dyn_dtree[i*2]=0;for(i=0;i<ao;i++)e.bl_tree[i*2]=0;e.dyn_ltree[lo*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function gh(e){e.bi_valid>8?zi(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function K_(e,i,r,s){gh(e),s&&(zi(e,r),zi(e,~r)),E_.arraySet(e.pending_buf,e.window,i,r,e.pending),e.pending+=r}function Vl(e,i,r,s){var l=i*2,t=r*2;return e[l]<e[t]||e[l]===e[t]&&s[i]<=s[r]}function io(e,i,r){for(var s=e.heap[r],l=r<<1;l<=e.heap_len&&(l<e.heap_len&&Vl(i,e.heap[l+1],e.heap[l],e.depth)&&l++,!Vl(i,s,e.heap[l],e.depth));)e.heap[r]=e.heap[l],r=l,l<<=1;e.heap[r]=s}function Yl(e,i,r){var s,l,t=0,n,h;if(e.last_lit!==0)do s=e.pending_buf[e.d_buf+t*2]<<8|e.pending_buf[e.d_buf+t*2+1],l=e.pending_buf[e.l_buf+t],t++,s===0?gt(e,l,i):(n=Wi[l],gt(e,n+ji+1,i),h=so[n],h!==0&&(l-=ho[n],qe(e,l,h)),s--,n=uh(s),gt(e,n,r),h=Ur[n],h!==0&&(s-=$r[n],qe(e,s,h)));while(t<e.last_lit);gt(e,lo,i)}function no(e,i){var r=i.dyn_tree,s=i.stat_desc.static_tree,l=i.stat_desc.has_stree,t=i.stat_desc.elems,n,h,g=-1,o;for(e.heap_len=0,e.heap_max=rh,n=0;n<t;n++)r[n*2]!==0?(e.heap[++e.heap_len]=g=n,e.depth[n]=0):r[n*2+1]=0;for(;e.heap_len<2;)o=e.heap[++e.heap_len]=g<2?++g:0,r[o*2]=1,e.depth[o]=0,e.opt_len--,l&&(e.static_len-=s[o*2+1]);for(i.max_code=g,n=e.heap_len>>1;n>=1;n--)io(e,r,n);o=t;do n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],io(e,r,1),h=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=h,r[o*2]=r[n*2]+r[h*2],e.depth[o]=(e.depth[n]>=e.depth[h]?e.depth[n]:e.depth[h])+1,r[n*2+1]=r[h*2+1]=o,e.heap[1]=o++,io(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],H_(e,i),fh(r,g,e.bl_count)}function Jl(e,i,r){var s,l=-1,t,n=i[0*2+1],h=0,g=7,o=4;for(n===0&&(g=138,o=3),i[(r+1)*2+1]=65535,s=0;s<=r;s++)t=n,n=i[(s+1)*2+1],!(++h<g&&t===n)&&(h<o?e.bl_tree[t*2]+=h:t!==0?(t!==l&&e.bl_tree[t*2]++,e.bl_tree[sh*2]++):h<=10?e.bl_tree[nh*2]++:e.bl_tree[oh*2]++,h=0,l=t,n===0?(g=138,o=3):t===n?(g=6,o=3):(g=7,o=4))}function Zl(e,i,r){var s,l=-1,t,n=i[0*2+1],h=0,g=7,o=4;for(n===0&&(g=138,o=3),s=0;s<=r;s++)if(t=n,n=i[(s+1)*2+1],!(++h<g&&t===n)){if(h<o)do gt(e,t,e.bl_tree);while(--h!==0);else t!==0?(t!==l&&(gt(e,t,e.bl_tree),h--),gt(e,sh,e.bl_tree),qe(e,h-3,2)):h<=10?(gt(e,nh,e.bl_tree),qe(e,h-3,3)):(gt(e,oh,e.bl_tree),qe(e,h-11,7));h=0,l=t,n===0?(g=138,o=3):t===n?(g=6,o=3):(g=7,o=4)}}function X_(e){var i;for(Jl(e,e.dyn_ltree,e.l_desc.max_code),Jl(e,e.dyn_dtree,e.d_desc.max_code),no(e,e.bl_desc),i=ao-1;i>=3&&e.bl_tree[ah[i]*2+1]===0;i--);return e.opt_len+=3*(i+1)+5+5+4,i}function N_(e,i,r,s){var l;for(qe(e,i-257,5),qe(e,r-1,5),qe(e,s-4,4),l=0;l<s;l++)qe(e,e.bl_tree[ah[l]*2+1],3);Zl(e,e.dyn_ltree,i-1),Zl(e,e.dyn_dtree,r-1)}function U_(e){var i=4093624447,r;for(r=0;r<=31;r++,i>>>=1)if(i&1&&e.dyn_ltree[r*2]!==0)return Gl;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return ql;for(r=32;r<ji;r++)if(e.dyn_ltree[r*2]!==0)return ql;return Gl}var eh=!1;function $_(e){eh||(Q_(),eh=!0),e.l_desc=new to(e.dyn_ltree,lh),e.d_desc=new to(e.dyn_dtree,hh),e.bl_desc=new to(e.bl_tree,ch),e.bi_buf=0,e.bi_valid=0,_h(e)}function ph(e,i,r,s){qe(e,(D_<<1)+(s?1:0),3),K_(e,i,r,!0)}function W_(e){qe(e,ih<<1,3),gt(e,lo,Et),O_(e)}function z_(e,i,r,s){var l,t,n=0;e.level>0?(e.strm.data_type===L_&&(e.strm.data_type=U_(e)),no(e,e.l_desc),no(e,e.d_desc),n=X_(e),l=e.opt_len+3+7>>>3,t=e.static_len+3+7>>>3,t<=l&&(l=t)):l=t=r+5,r+4<=l&&i!==-1?ph(e,i,r,s):e.strategy===B_||t===l?(qe(e,(ih<<1)+(s?1:0),3),Yl(e,Et,Ni)):(qe(e,(I_<<1)+(s?1:0),3),N_(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),Yl(e,e.dyn_ltree,e.dyn_dtree)),_h(e),s&&gh(e)}function j_(e,i,r){return e.pending_buf[e.d_buf+e.last_lit*2]=i>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=i&255,e.pending_buf[e.l_buf+e.last_lit]=r&255,e.last_lit++,i===0?e.dyn_ltree[r*2]++:(e.matches++,i--,e.dyn_ltree[(Wi[r]+ji+1)*2]++,e.dyn_dtree[uh(i)*2]++),e.last_lit===e.lit_bufsize-1}});var mh=se(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.default=void 0;var Pm=Wr.default={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var Lh=se(ae=>{"use strict";function fo(e){"@babel/helpers - typeof";return fo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},fo(e)}Object.defineProperty(ae,"__esModule",{value:!0});ae.Z_UNKNOWN=ae.Z_STREAM_ERROR=ae.Z_STREAM_END=ae.Z_RLE=ae.Z_PARTIAL_FLUSH=ae.Z_OK=ae.Z_NO_FLUSH=ae.Z_HUFFMAN_ONLY=ae.Z_FULL_FLUSH=ae.Z_FIXED=ae.Z_FINISH=ae.Z_FILTERED=ae.Z_DEFLATED=ae.Z_DEFAULT_STRATEGY=ae.Z_DEFAULT_COMPRESSION=ae.Z_DATA_ERROR=ae.Z_BUF_ERROR=ae.Z_BLOCK=void 0;ae.deflate=C0;ae.deflateEnd=x0;ae.deflateInfo=void 0;ae.deflateInit=w0;ae.deflateInit2=Bh;ae.deflateReset=kh;ae.deflateResetKeep=Eh;ae.deflateSetDictionary=S0;ae.deflateSetHeader=A0;var ze=xh(Qi()),rt=xh(vh()),wh=po(Mn()),Mt=po(Pn()),G_=po(mh());function po(e){return e&&e.__esModule?e:{default:e}}function Ch(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Ch=function(l){return l?r:i})(e)}function xh(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||fo(e)!="object"&&typeof e!="function")return{default:e};var r=Ch(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}var ri=ae.Z_NO_FLUSH=0,q_=ae.Z_PARTIAL_FLUSH=1,V_=ae.Z_FULL_FLUSH=3,Qt=ae.Z_FINISH=4,yh=ae.Z_BLOCK=5,vt=ae.Z_OK=0,bh=ae.Z_STREAM_END=1,st=ae.Z_STREAM_ERROR=-2,Y_=ae.Z_DATA_ERROR=-3,co=ae.Z_BUF_ERROR=-5,J_=ae.Z_DEFAULT_COMPRESSION=-1,Z_=ae.Z_FILTERED=1,zr=ae.Z_HUFFMAN_ONLY=2,e0=ae.Z_RLE=3,t0=ae.Z_FIXED=4,i0=ae.Z_DEFAULT_STRATEGY=0,r0=ae.Z_UNKNOWN=2,Vr=ae.Z_DEFLATED=8,s0=9,n0=15,o0=8,a0=29,l0=256,_o=l0+1+a0,h0=30,c0=19,u0=2*_o+1,d0=15,_e=3,Ot=258,ct=Ot+_e+1,f0=32,Yr=42,go=69,jr=73,Gr=91,qr=103,ei=113,qi=666,He=1,Vi=2,ti=3,bi=4,_0=3;function Ht(e,i){return e.msg=G_.default[i],i}function Ah(e){return(e<<1)-(e>4?9:0)}function Pt(e){for(var i=e.length;--i>=0;)e[i]=0}function Ft(e){var i=e.state,r=i.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(ze.arraySet(e.output,i.pending_buf,i.pending_out,r,e.next_out),e.next_out+=r,i.pending_out+=r,e.total_out+=r,e.avail_out-=r,i.pending-=r,i.pending===0&&(i.pending_out=0))}function Ke(e,i){rt._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,i),e.block_start=e.strstart,Ft(e.strm)}function me(e,i){e.pending_buf[e.pending++]=i}function Gi(e,i){e.pending_buf[e.pending++]=i>>>8&255,e.pending_buf[e.pending++]=i&255}function g0(e,i,r,s){var l=e.avail_in;return l>s&&(l=s),l===0?0:(e.avail_in-=l,ze.arraySet(i,e.input,e.next_in,l,r),e.state.wrap===1?e.adler=(0,wh.default)(e.adler,i,l,r):e.state.wrap===2&&(e.adler=(0,Mt.default)(e.adler,i,l,r)),e.next_in+=l,e.total_in+=l,l)}function Sh(e,i){var r=e.max_chain_length,s=e.strstart,l,t,n=e.prev_length,h=e.nice_match,g=e.strstart>e.w_size-ct?e.strstart-(e.w_size-ct):0,o=e.window,c=e.w_mask,f=e.prev,v=e.strstart+Ot,u=o[s+n-1],a=o[s+n];e.prev_length>=e.good_match&&(r>>=2),h>e.lookahead&&(h=e.lookahead);do if(l=i,!(o[l+n]!==a||o[l+n-1]!==u||o[l]!==o[s]||o[++l]!==o[s+1])){s+=2,l++;do;while(o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&o[++s]===o[++l]&&s<v);if(t=Ot-(v-s),s=v-Ot,t>n){if(e.match_start=i,n=t,t>=h)break;u=o[s+n-1],a=o[s+n]}}while((i=f[i&c])>g&&--r!==0);return n<=e.lookahead?n:e.lookahead}function ii(e){var i=e.w_size,r,s,l,t,n;do{if(t=e.window_size-e.lookahead-e.strstart,e.strstart>=i+(i-ct)){ze.arraySet(e.window,e.window,i,i,0),e.match_start-=i,e.strstart-=i,e.block_start-=i,s=e.hash_size,r=s;do l=e.head[--r],e.head[r]=l>=i?l-i:0;while(--s);s=i,r=s;do l=e.prev[--r],e.prev[r]=l>=i?l-i:0;while(--s);t+=i}if(e.strm.avail_in===0)break;if(s=g0(e.strm,e.window,e.strstart+e.lookahead,t),e.lookahead+=s,e.lookahead+e.insert>=_e)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=(e.ins_h<<e.hash_shift^e.window[n+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[n+_e-1])&e.hash_mask,e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<_e)););}while(e.lookahead<ct&&e.strm.avail_in!==0)}function p0(e,i){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ii(e),e.lookahead===0&&i===ri)return He;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var s=e.block_start+r;if((e.strstart===0||e.strstart>=s)&&(e.lookahead=e.strstart-s,e.strstart=s,Ke(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-ct&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=0,i===Qt?(Ke(e,!0),e.strm.avail_out===0?ti:bi):(e.strstart>e.block_start&&(Ke(e,!1),e.strm.avail_out===0),He)}function uo(e,i){for(var r,s;;){if(e.lookahead<ct){if(ii(e),e.lookahead<ct&&i===ri)return He;if(e.lookahead===0)break}if(r=0,e.lookahead>=_e&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_e-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-ct&&(e.match_length=Sh(e,r)),e.match_length>=_e)if(s=rt._tr_tally(e,e.strstart-e.match_start,e.match_length-_e),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=_e){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_e-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else s=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=e.strstart<_e-1?e.strstart:_e-1,i===Qt?(Ke(e,!0),e.strm.avail_out===0?ti:bi):e.last_lit&&(Ke(e,!1),e.strm.avail_out===0)?He:Vi}function mi(e,i){for(var r,s,l;;){if(e.lookahead<ct){if(ii(e),e.lookahead<ct&&i===ri)return He;if(e.lookahead===0)break}if(r=0,e.lookahead>=_e&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_e-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=_e-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ct&&(e.match_length=Sh(e,r),e.match_length<=5&&(e.strategy===Z_||e.match_length===_e&&e.strstart-e.match_start>4096)&&(e.match_length=_e-1)),e.prev_length>=_e&&e.match_length<=e.prev_length){l=e.strstart+e.lookahead-_e,s=rt._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-_e),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=l&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+_e-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=_e-1,e.strstart++,s&&(Ke(e,!1),e.strm.avail_out===0))return He}else if(e.match_available){if(s=rt._tr_tally(e,0,e.window[e.strstart-1]),s&&Ke(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return He}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=rt._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<_e-1?e.strstart:_e-1,i===Qt?(Ke(e,!0),e.strm.avail_out===0?ti:bi):e.last_lit&&(Ke(e,!1),e.strm.avail_out===0)?He:Vi}function v0(e,i){for(var r,s,l,t,n=e.window;;){if(e.lookahead<=Ot){if(ii(e),e.lookahead<=Ot&&i===ri)return He;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=_e&&e.strstart>0&&(l=e.strstart-1,s=n[l],s===n[++l]&&s===n[++l]&&s===n[++l])){t=e.strstart+Ot;do;while(s===n[++l]&&s===n[++l]&&s===n[++l]&&s===n[++l]&&s===n[++l]&&s===n[++l]&&s===n[++l]&&s===n[++l]&&l<t);e.match_length=Ot-(t-l),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=_e?(r=rt._tr_tally(e,1,e.match_length-_e),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=0,i===Qt?(Ke(e,!0),e.strm.avail_out===0?ti:bi):e.last_lit&&(Ke(e,!1),e.strm.avail_out===0)?He:Vi}function m0(e,i){for(var r;;){if(e.lookahead===0&&(ii(e),e.lookahead===0)){if(i===ri)return He;break}if(e.match_length=0,r=rt._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Ke(e,!1),e.strm.avail_out===0))return He}return e.insert=0,i===Qt?(Ke(e,!0),e.strm.avail_out===0?ti:bi):e.last_lit&&(Ke(e,!1),e.strm.avail_out===0)?He:Vi}function pt(e,i,r,s,l){this.good_length=e,this.max_lazy=i,this.nice_length=r,this.max_chain=s,this.func=l}var yi;yi=[new pt(0,0,0,0,p0),new pt(4,4,8,4,uo),new pt(4,5,16,8,uo),new pt(4,6,32,32,uo),new pt(4,4,16,16,mi),new pt(8,16,32,32,mi),new pt(8,16,128,128,mi),new pt(8,32,128,256,mi),new pt(32,128,258,1024,mi),new pt(32,258,258,4096,mi)];function y0(e){e.window_size=2*e.w_size,Pt(e.head),e.max_lazy_match=yi[e.level].max_lazy,e.good_match=yi[e.level].good_length,e.nice_match=yi[e.level].nice_length,e.max_chain_length=yi[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=_e-1,e.match_available=0,e.ins_h=0}function b0(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Vr,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ze.Buf16(u0*2),this.dyn_dtree=new ze.Buf16((2*h0+1)*2),this.bl_tree=new ze.Buf16((2*c0+1)*2),Pt(this.dyn_ltree),Pt(this.dyn_dtree),Pt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ze.Buf16(d0+1),this.heap=new ze.Buf16(2*_o+1),Pt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ze.Buf16(2*_o+1),Pt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Eh(e){var i;return!e||!e.state?Ht(e,st):(e.total_in=e.total_out=0,e.data_type=r0,i=e.state,i.pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?Yr:ei,e.adler=i.wrap===2?0:1,i.last_flush=ri,rt._tr_init(i),vt)}function kh(e){var i=Eh(e);return i===vt&&y0(e.state),i}function A0(e,i){return!e||!e.state||e.state.wrap!==2?st:(e.state.gzhead=i,vt)}function Bh(e,i,r,s,l,t){if(!e)return st;var n=1;if(i===J_&&(i=6),s<0?(n=0,s=-s):s>15&&(n=2,s-=16),l<1||l>s0||r!==Vr||s<8||s>15||i<0||i>9||t<0||t>t0)return Ht(e,st);s===8&&(s=9);var h=new b0;return e.state=h,h.strm=e,h.wrap=n,h.gzhead=null,h.w_bits=s,h.w_size=1<<h.w_bits,h.w_mask=h.w_size-1,h.hash_bits=l+7,h.hash_size=1<<h.hash_bits,h.hash_mask=h.hash_size-1,h.hash_shift=~~((h.hash_bits+_e-1)/_e),h.window=new ze.Buf8(h.w_size*2),h.head=new ze.Buf16(h.hash_size),h.prev=new ze.Buf16(h.w_size),h.lit_bufsize=1<<l+6,h.pending_buf_size=h.lit_bufsize*4,h.pending_buf=new ze.Buf8(h.pending_buf_size),h.d_buf=1*h.lit_bufsize,h.l_buf=3*h.lit_bufsize,h.level=i,h.strategy=t,h.method=r,kh(e)}function w0(e,i){return Bh(e,i,Vr,n0,o0,i0)}function C0(e,i){var r,s,l,t;if(!e||!e.state||i>yh||i<0)return e?Ht(e,st):st;if(s=e.state,!e.output||!e.input&&e.avail_in!==0||s.status===qi&&i!==Qt)return Ht(e,e.avail_out===0?co:st);if(s.strm=e,r=s.last_flush,s.last_flush=i,s.status===Yr)if(s.wrap===2)e.adler=0,me(s,31),me(s,139),me(s,8),s.gzhead?(me(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),me(s,s.gzhead.time&255),me(s,s.gzhead.time>>8&255),me(s,s.gzhead.time>>16&255),me(s,s.gzhead.time>>24&255),me(s,s.level===9?2:s.strategy>=zr||s.level<2?4:0),me(s,s.gzhead.os&255),s.gzhead.extra&&s.gzhead.extra.length&&(me(s,s.gzhead.extra.length&255),me(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=go):(me(s,0),me(s,0),me(s,0),me(s,0),me(s,0),me(s,s.level===9?2:s.strategy>=zr||s.level<2?4:0),me(s,_0),s.status=ei);else{var n=Vr+(s.w_bits-8<<4)<<8,h=-1;s.strategy>=zr||s.level<2?h=0:s.level<6?h=1:s.level===6?h=2:h=3,n|=h<<6,s.strstart!==0&&(n|=f0),n+=31-n%31,s.status=ei,Gi(s,n),s.strstart!==0&&(Gi(s,e.adler>>>16),Gi(s,e.adler&65535)),e.adler=1}if(s.status===go)if(s.gzhead.extra){for(l=s.pending;s.gzindex<(s.gzhead.extra.length&65535)&&!(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),Ft(e),l=s.pending,s.pending===s.pending_buf_size));)me(s,s.gzhead.extra[s.gzindex]&255),s.gzindex++;s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=jr)}else s.status=jr;if(s.status===jr)if(s.gzhead.name){l=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),Ft(e),l=s.pending,s.pending===s.pending_buf_size)){t=1;break}s.gzindex<s.gzhead.name.length?t=s.gzhead.name.charCodeAt(s.gzindex++)&255:t=0,me(s,t)}while(t!==0);s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),t===0&&(s.gzindex=0,s.status=Gr)}else s.status=Gr;if(s.status===Gr)if(s.gzhead.comment){l=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),Ft(e),l=s.pending,s.pending===s.pending_buf_size)){t=1;break}s.gzindex<s.gzhead.comment.length?t=s.gzhead.comment.charCodeAt(s.gzindex++)&255:t=0,me(s,t)}while(t!==0);s.gzhead.hcrc&&s.pending>l&&(e.adler=(0,Mt.default)(e.adler,s.pending_buf,s.pending-l,l)),t===0&&(s.status=qr)}else s.status=qr;if(s.status===qr&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&Ft(e),s.pending+2<=s.pending_buf_size&&(me(s,e.adler&255),me(s,e.adler>>8&255),e.adler=0,s.status=ei)):s.status=ei),s.pending!==0){if(Ft(e),e.avail_out===0)return s.last_flush=-1,vt}else if(e.avail_in===0&&Ah(i)<=Ah(r)&&i!==Qt)return Ht(e,co);if(s.status===qi&&e.avail_in!==0)return Ht(e,co);if(e.avail_in!==0||s.lookahead!==0||i!==ri&&s.status!==qi){var g=s.strategy===zr?m0(s,i):s.strategy===e0?v0(s,i):yi[s.level].func(s,i);if((g===ti||g===bi)&&(s.status=qi),g===He||g===ti)return e.avail_out===0&&(s.last_flush=-1),vt;if(g===Vi&&(i===q_?rt._tr_align(s):i!==yh&&(rt._tr_stored_block(s,0,0,!1),i===V_&&(Pt(s.head),s.lookahead===0&&(s.strstart=0,s.block_start=0,s.insert=0))),Ft(e),e.avail_out===0))return s.last_flush=-1,vt}return i!==Qt?vt:s.wrap<=0?bh:(s.wrap===2?(me(s,e.adler&255),me(s,e.adler>>8&255),me(s,e.adler>>16&255),me(s,e.adler>>24&255),me(s,e.total_in&255),me(s,e.total_in>>8&255),me(s,e.total_in>>16&255),me(s,e.total_in>>24&255)):(Gi(s,e.adler>>>16),Gi(s,e.adler&65535)),Ft(e),s.wrap>0&&(s.wrap=-s.wrap),s.pending!==0?vt:bh)}function x0(e){var i;return!e||!e.state?st:(i=e.state.status,i!==Yr&&i!==go&&i!==jr&&i!==Gr&&i!==qr&&i!==ei&&i!==qi?Ht(e,st):(e.state=null,i===ei?Ht(e,Y_):vt))}function S0(e,i){var r=i.length,s,l,t,n,h,g,o,c;if(!e||!e.state||(s=e.state,n=s.wrap,n===2||n===1&&s.status!==Yr||s.lookahead))return st;for(n===1&&(e.adler=(0,wh.default)(e.adler,i,r,0)),s.wrap=0,r>=s.w_size&&(n===0&&(Pt(s.head),s.strstart=0,s.block_start=0,s.insert=0),c=new ze.Buf8(s.w_size),ze.arraySet(c,i,r-s.w_size,s.w_size,0),i=c,r=s.w_size),h=e.avail_in,g=e.next_in,o=e.input,e.avail_in=r,e.next_in=0,e.input=i,ii(s);s.lookahead>=_e;){l=s.strstart,t=s.lookahead-(_e-1);do s.ins_h=(s.ins_h<<s.hash_shift^s.window[l+_e-1])&s.hash_mask,s.prev[l&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=l,l++;while(--t);s.strstart=l,s.lookahead=_e-1,ii(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=_e-1,s.match_available=0,e.next_in=g,e.input=o,e.avail_in=h,s.wrap=n,vt}var Hm=ae.deflateInfo="pako deflate (from Nodeca project)"});var Ih=se(Jr=>{"use strict";Object.defineProperty(Jr,"__esModule",{value:!0});Jr.default=void 0;var Ai=Lh(),E0=k0(Yn());function k0(e){return e&&e.__esModule?e:{default:e}}function Yi(e){"@babel/helpers - typeof";return Yi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Yi(e)}function B0(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Dh(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,D0(s.key),s)}}function L0(e,i,r){return i&&Dh(e.prototype,i),r&&Dh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D0(e){var i=I0(e,"string");return Yi(i)=="symbol"?i:i+""}function I0(e,i){if(Yi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Yi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Km=Jr.default=function(){function e(){B0(this,e),this.strm=new E0.default,this.chunkSize=1024*10*10,this.outputBuffer=new Uint8Array(this.chunkSize),(0,Ai.deflateInit)(this.strm,Ai.Z_DEFAULT_COMPRESSION)}return L0(e,[{key:"deflate",value:function(r){this.strm.input=r,this.strm.avail_in=this.strm.input.length,this.strm.next_in=0,this.strm.output=this.outputBuffer,this.strm.avail_out=this.chunkSize,this.strm.next_out=0;var s=(0,Ai.deflate)(this.strm,Ai.Z_FULL_FLUSH),l=new Uint8Array(this.strm.output.buffer,0,this.strm.next_out);if(s<0)throw new Error("zlib deflate failed");if(this.strm.avail_in>0){var t=[l],n=l.length;do{if(this.strm.output=new Uint8Array(this.chunkSize),this.strm.next_out=0,this.strm.avail_out=this.chunkSize,s=(0,Ai.deflate)(this.strm,Ai.Z_FULL_FLUSH),s<0)throw new Error("zlib deflate failed");var h=new Uint8Array(this.strm.output.buffer,0,this.strm.next_out);n+=h.length,t.push(h)}while(this.strm.avail_in>0);for(var g=new Uint8Array(n),o=0,c=0;c<t.length;c++)g.set(t[c],o),o+=t[c].length;l=g}return this.strm.input=null,this.strm.avail_in=0,this.strm.next_in=0,l}}])}()});var wi=se(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.default=void 0;var Nm=Zr.default={XK_VoidSymbol:16777215,XK_BackSpace:65288,XK_Tab:65289,XK_Linefeed:65290,XK_Clear:65291,XK_Return:65293,XK_Pause:65299,XK_Scroll_Lock:65300,XK_Sys_Req:65301,XK_Escape:65307,XK_Delete:65535,XK_Multi_key:65312,XK_Codeinput:65335,XK_SingleCandidate:65340,XK_MultipleCandidate:65341,XK_PreviousCandidate:65342,XK_Kanji:65313,XK_Muhenkan:65314,XK_Henkan_Mode:65315,XK_Henkan:65315,XK_Romaji:65316,XK_Hiragana:65317,XK_Katakana:65318,XK_Hiragana_Katakana:65319,XK_Zenkaku:65320,XK_Hankaku:65321,XK_Zenkaku_Hankaku:65322,XK_Touroku:65323,XK_Massyo:65324,XK_Kana_Lock:65325,XK_Kana_Shift:65326,XK_Eisu_Shift:65327,XK_Eisu_toggle:65328,XK_Kanji_Bangou:65335,XK_Zen_Koho:65341,XK_Mae_Koho:65342,XK_Home:65360,XK_Left:65361,XK_Up:65362,XK_Right:65363,XK_Down:65364,XK_Prior:65365,XK_Page_Up:65365,XK_Next:65366,XK_Page_Down:65366,XK_End:65367,XK_Begin:65368,XK_Select:65376,XK_Print:65377,XK_Execute:65378,XK_Insert:65379,XK_Undo:65381,XK_Redo:65382,XK_Menu:65383,XK_Find:65384,XK_Cancel:65385,XK_Help:65386,XK_Break:65387,XK_Mode_switch:65406,XK_script_switch:65406,XK_Num_Lock:65407,XK_KP_Space:65408,XK_KP_Tab:65417,XK_KP_Enter:65421,XK_KP_F1:65425,XK_KP_F2:65426,XK_KP_F3:65427,XK_KP_F4:65428,XK_KP_Home:65429,XK_KP_Left:65430,XK_KP_Up:65431,XK_KP_Right:65432,XK_KP_Down:65433,XK_KP_Prior:65434,XK_KP_Page_Up:65434,XK_KP_Next:65435,XK_KP_Page_Down:65435,XK_KP_End:65436,XK_KP_Begin:65437,XK_KP_Insert:65438,XK_KP_Delete:65439,XK_KP_Equal:65469,XK_KP_Multiply:65450,XK_KP_Add:65451,XK_KP_Separator:65452,XK_KP_Subtract:65453,XK_KP_Decimal:65454,XK_KP_Divide:65455,XK_KP_0:65456,XK_KP_1:65457,XK_KP_2:65458,XK_KP_3:65459,XK_KP_4:65460,XK_KP_5:65461,XK_KP_6:65462,XK_KP_7:65463,XK_KP_8:65464,XK_KP_9:65465,XK_F1:65470,XK_F2:65471,XK_F3:65472,XK_F4:65473,XK_F5:65474,XK_F6:65475,XK_F7:65476,XK_F8:65477,XK_F9:65478,XK_F10:65479,XK_F11:65480,XK_L1:65480,XK_F12:65481,XK_L2:65481,XK_F13:65482,XK_L3:65482,XK_F14:65483,XK_L4:65483,XK_F15:65484,XK_L5:65484,XK_F16:65485,XK_L6:65485,XK_F17:65486,XK_L7:65486,XK_F18:65487,XK_L8:65487,XK_F19:65488,XK_L9:65488,XK_F20:65489,XK_L10:65489,XK_F21:65490,XK_R1:65490,XK_F22:65491,XK_R2:65491,XK_F23:65492,XK_R3:65492,XK_F24:65493,XK_R4:65493,XK_F25:65494,XK_R5:65494,XK_F26:65495,XK_R6:65495,XK_F27:65496,XK_R7:65496,XK_F28:65497,XK_R8:65497,XK_F29:65498,XK_R9:65498,XK_F30:65499,XK_R10:65499,XK_F31:65500,XK_R11:65500,XK_F32:65501,XK_R12:65501,XK_F33:65502,XK_R13:65502,XK_F34:65503,XK_R14:65503,XK_F35:65504,XK_R15:65504,XK_Shift_L:65505,XK_Shift_R:65506,XK_Control_L:65507,XK_Control_R:65508,XK_Caps_Lock:65509,XK_Shift_Lock:65510,XK_Meta_L:65511,XK_Meta_R:65512,XK_Alt_L:65513,XK_Alt_R:65514,XK_Super_L:65515,XK_Super_R:65516,XK_Hyper_L:65517,XK_Hyper_R:65518,XK_ISO_Level3_Shift:65027,XK_ISO_Next_Group:65032,XK_ISO_Prev_Group:65034,XK_ISO_First_Group:65036,XK_ISO_Last_Group:65038,XK_space:32,XK_exclam:33,XK_quotedbl:34,XK_numbersign:35,XK_dollar:36,XK_percent:37,XK_ampersand:38,XK_apostrophe:39,XK_quoteright:39,XK_parenleft:40,XK_parenright:41,XK_asterisk:42,XK_plus:43,XK_comma:44,XK_minus:45,XK_period:46,XK_slash:47,XK_0:48,XK_1:49,XK_2:50,XK_3:51,XK_4:52,XK_5:53,XK_6:54,XK_7:55,XK_8:56,XK_9:57,XK_colon:58,XK_semicolon:59,XK_less:60,XK_equal:61,XK_greater:62,XK_question:63,XK_at:64,XK_A:65,XK_B:66,XK_C:67,XK_D:68,XK_E:69,XK_F:70,XK_G:71,XK_H:72,XK_I:73,XK_J:74,XK_K:75,XK_L:76,XK_M:77,XK_N:78,XK_O:79,XK_P:80,XK_Q:81,XK_R:82,XK_S:83,XK_T:84,XK_U:85,XK_V:86,XK_W:87,XK_X:88,XK_Y:89,XK_Z:90,XK_bracketleft:91,XK_backslash:92,XK_bracketright:93,XK_asciicircum:94,XK_underscore:95,XK_grave:96,XK_quoteleft:96,XK_a:97,XK_b:98,XK_c:99,XK_d:100,XK_e:101,XK_f:102,XK_g:103,XK_h:104,XK_i:105,XK_j:106,XK_k:107,XK_l:108,XK_m:109,XK_n:110,XK_o:111,XK_p:112,XK_q:113,XK_r:114,XK_s:115,XK_t:116,XK_u:117,XK_v:118,XK_w:119,XK_x:120,XK_y:121,XK_z:122,XK_braceleft:123,XK_bar:124,XK_braceright:125,XK_asciitilde:126,XK_nobreakspace:160,XK_exclamdown:161,XK_cent:162,XK_sterling:163,XK_currency:164,XK_yen:165,XK_brokenbar:166,XK_section:167,XK_diaeresis:168,XK_copyright:169,XK_ordfeminine:170,XK_guillemotleft:171,XK_notsign:172,XK_hyphen:173,XK_registered:174,XK_macron:175,XK_degree:176,XK_plusminus:177,XK_twosuperior:178,XK_threesuperior:179,XK_acute:180,XK_mu:181,XK_paragraph:182,XK_periodcentered:183,XK_cedilla:184,XK_onesuperior:185,XK_masculine:186,XK_guillemotright:187,XK_onequarter:188,XK_onehalf:189,XK_threequarters:190,XK_questiondown:191,XK_Agrave:192,XK_Aacute:193,XK_Acircumflex:194,XK_Atilde:195,XK_Adiaeresis:196,XK_Aring:197,XK_AE:198,XK_Ccedilla:199,XK_Egrave:200,XK_Eacute:201,XK_Ecircumflex:202,XK_Ediaeresis:203,XK_Igrave:204,XK_Iacute:205,XK_Icircumflex:206,XK_Idiaeresis:207,XK_ETH:208,XK_Eth:208,XK_Ntilde:209,XK_Ograve:210,XK_Oacute:211,XK_Ocircumflex:212,XK_Otilde:213,XK_Odiaeresis:214,XK_multiply:215,XK_Oslash:216,XK_Ooblique:216,XK_Ugrave:217,XK_Uacute:218,XK_Ucircumflex:219,XK_Udiaeresis:220,XK_Yacute:221,XK_THORN:222,XK_Thorn:222,XK_ssharp:223,XK_agrave:224,XK_aacute:225,XK_acircumflex:226,XK_atilde:227,XK_adiaeresis:228,XK_aring:229,XK_ae:230,XK_ccedilla:231,XK_egrave:232,XK_eacute:233,XK_ecircumflex:234,XK_ediaeresis:235,XK_igrave:236,XK_iacute:237,XK_icircumflex:238,XK_idiaeresis:239,XK_eth:240,XK_ntilde:241,XK_ograve:242,XK_oacute:243,XK_ocircumflex:244,XK_otilde:245,XK_odiaeresis:246,XK_division:247,XK_oslash:248,XK_ooblique:248,XK_ugrave:249,XK_uacute:250,XK_ucircumflex:251,XK_udiaeresis:252,XK_yacute:253,XK_thorn:254,XK_ydiaeresis:255,XK_Hangul:65329,XK_Hangul_Hanja:65332,XK_Hangul_Jeonja:65336,XF86XK_ModeLock:269025025,XF86XK_MonBrightnessUp:269025026,XF86XK_MonBrightnessDown:269025027,XF86XK_KbdLightOnOff:269025028,XF86XK_KbdBrightnessUp:269025029,XF86XK_KbdBrightnessDown:269025030,XF86XK_Standby:269025040,XF86XK_AudioLowerVolume:269025041,XF86XK_AudioMute:269025042,XF86XK_AudioRaiseVolume:269025043,XF86XK_AudioPlay:269025044,XF86XK_AudioStop:269025045,XF86XK_AudioPrev:269025046,XF86XK_AudioNext:269025047,XF86XK_HomePage:269025048,XF86XK_Mail:269025049,XF86XK_Start:269025050,XF86XK_Search:269025051,XF86XK_AudioRecord:269025052,XF86XK_Calculator:269025053,XF86XK_Memo:269025054,XF86XK_ToDoList:269025055,XF86XK_Calendar:269025056,XF86XK_PowerDown:269025057,XF86XK_ContrastAdjust:269025058,XF86XK_RockerUp:269025059,XF86XK_RockerDown:269025060,XF86XK_RockerEnter:269025061,XF86XK_Back:269025062,XF86XK_Forward:269025063,XF86XK_Stop:269025064,XF86XK_Refresh:269025065,XF86XK_PowerOff:269025066,XF86XK_WakeUp:269025067,XF86XK_Eject:269025068,XF86XK_ScreenSaver:269025069,XF86XK_WWW:269025070,XF86XK_Sleep:269025071,XF86XK_Favorites:269025072,XF86XK_AudioPause:269025073,XF86XK_AudioMedia:269025074,XF86XK_MyComputer:269025075,XF86XK_VendorHome:269025076,XF86XK_LightBulb:269025077,XF86XK_Shop:269025078,XF86XK_History:269025079,XF86XK_OpenURL:269025080,XF86XK_AddFavorite:269025081,XF86XK_HotLinks:269025082,XF86XK_BrightnessAdjust:269025083,XF86XK_Finance:269025084,XF86XK_Community:269025085,XF86XK_AudioRewind:269025086,XF86XK_BackForward:269025087,XF86XK_Launch0:269025088,XF86XK_Launch1:269025089,XF86XK_Launch2:269025090,XF86XK_Launch3:269025091,XF86XK_Launch4:269025092,XF86XK_Launch5:269025093,XF86XK_Launch6:269025094,XF86XK_Launch7:269025095,XF86XK_Launch8:269025096,XF86XK_Launch9:269025097,XF86XK_LaunchA:269025098,XF86XK_LaunchB:269025099,XF86XK_LaunchC:269025100,XF86XK_LaunchD:269025101,XF86XK_LaunchE:269025102,XF86XK_LaunchF:269025103,XF86XK_ApplicationLeft:269025104,XF86XK_ApplicationRight:269025105,XF86XK_Book:269025106,XF86XK_CD:269025107,XF86XK_Calculater:269025108,XF86XK_Clear:269025109,XF86XK_Close:269025110,XF86XK_Copy:269025111,XF86XK_Cut:269025112,XF86XK_Display:269025113,XF86XK_DOS:269025114,XF86XK_Documents:269025115,XF86XK_Excel:269025116,XF86XK_Explorer:269025117,XF86XK_Game:269025118,XF86XK_Go:269025119,XF86XK_iTouch:269025120,XF86XK_LogOff:269025121,XF86XK_Market:269025122,XF86XK_Meeting:269025123,XF86XK_MenuKB:269025125,XF86XK_MenuPB:269025126,XF86XK_MySites:269025127,XF86XK_New:269025128,XF86XK_News:269025129,XF86XK_OfficeHome:269025130,XF86XK_Open:269025131,XF86XK_Option:269025132,XF86XK_Paste:269025133,XF86XK_Phone:269025134,XF86XK_Q:269025136,XF86XK_Reply:269025138,XF86XK_Reload:269025139,XF86XK_RotateWindows:269025140,XF86XK_RotationPB:269025141,XF86XK_RotationKB:269025142,XF86XK_Save:269025143,XF86XK_ScrollUp:269025144,XF86XK_ScrollDown:269025145,XF86XK_ScrollClick:269025146,XF86XK_Send:269025147,XF86XK_Spell:269025148,XF86XK_SplitScreen:269025149,XF86XK_Support:269025150,XF86XK_TaskPane:269025151,XF86XK_Terminal:269025152,XF86XK_Tools:269025153,XF86XK_Travel:269025154,XF86XK_UserPB:269025156,XF86XK_User1KB:269025157,XF86XK_User2KB:269025158,XF86XK_Video:269025159,XF86XK_WheelButton:269025160,XF86XK_Word:269025161,XF86XK_Xfer:269025162,XF86XK_ZoomIn:269025163,XF86XK_ZoomOut:269025164,XF86XK_Away:269025165,XF86XK_Messenger:269025166,XF86XK_WebCam:269025167,XF86XK_MailForward:269025168,XF86XK_Pictures:269025169,XF86XK_Music:269025170,XF86XK_Battery:269025171,XF86XK_Bluetooth:269025172,XF86XK_WLAN:269025173,XF86XK_UWB:269025174,XF86XK_AudioForward:269025175,XF86XK_AudioRepeat:269025176,XF86XK_AudioRandomPlay:269025177,XF86XK_Subtitle:269025178,XF86XK_AudioCycleTrack:269025179,XF86XK_CycleAngle:269025180,XF86XK_FrameBack:269025181,XF86XK_FrameForward:269025182,XF86XK_Time:269025183,XF86XK_Select:269025184,XF86XK_View:269025185,XF86XK_TopMenu:269025186,XF86XK_Red:269025187,XF86XK_Green:269025188,XF86XK_Yellow:269025189,XF86XK_Blue:269025190,XF86XK_Suspend:269025191,XF86XK_Hibernate:269025192,XF86XK_TouchpadToggle:269025193,XF86XK_TouchpadOn:269025200,XF86XK_TouchpadOff:269025201,XF86XK_AudioMicMute:269025202,XF86XK_Switch_VT_1:269024769,XF86XK_Switch_VT_2:269024770,XF86XK_Switch_VT_3:269024771,XF86XK_Switch_VT_4:269024772,XF86XK_Switch_VT_5:269024773,XF86XK_Switch_VT_6:269024774,XF86XK_Switch_VT_7:269024775,XF86XK_Switch_VT_8:269024776,XF86XK_Switch_VT_9:269024777,XF86XK_Switch_VT_10:269024778,XF86XK_Switch_VT_11:269024779,XF86XK_Switch_VT_12:269024780,XF86XK_Ungrab:269024800,XF86XK_ClearGrab:269024801,XF86XK_Next_VMode:269024802,XF86XK_Prev_VMode:269024803,XF86XK_LogWindowTree:269024804,XF86XK_LogGrabInfo:269024805}});var vo=se(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.default=void 0;var T0={256:960,257:992,258:451,259:483,260:417,261:433,262:454,263:486,264:710,265:742,266:709,267:741,268:456,269:488,270:463,271:495,272:464,273:496,274:938,275:954,278:972,279:1004,280:458,281:490,282:460,283:492,284:728,285:760,286:683,287:699,288:725,289:757,290:939,291:955,292:678,293:694,294:673,295:689,296:933,297:949,298:975,299:1007,302:967,303:999,304:681,305:697,308:684,309:700,310:979,311:1011,312:930,313:453,314:485,315:934,316:950,317:421,318:437,321:419,322:435,323:465,324:497,325:977,326:1009,327:466,328:498,330:957,331:959,332:978,333:1010,336:469,337:501,338:5052,339:5053,340:448,341:480,342:931,343:947,344:472,345:504,346:422,347:438,348:734,349:766,350:426,351:442,352:425,353:441,354:478,355:510,356:427,357:443,358:940,359:956,360:989,361:1021,362:990,363:1022,364:733,365:765,366:473,367:505,368:475,369:507,370:985,371:1017,376:5054,377:428,378:444,379:431,380:447,381:430,382:446,402:2294,466:16777681,711:439,728:418,729:511,731:434,733:445,901:1966,902:1953,904:1954,905:1955,906:1956,908:1959,910:1960,911:1963,912:1974,913:1985,914:1986,915:1987,916:1988,917:1989,918:1990,919:1991,920:1992,921:1993,922:1994,923:1995,924:1996,925:1997,926:1998,927:1999,928:2e3,929:2001,931:2002,932:2004,933:2005,934:2006,935:2007,936:2008,937:2009,938:1957,939:1961,940:1969,941:1970,942:1971,943:1972,944:1978,945:2017,946:2018,947:2019,948:2020,949:2021,950:2022,951:2023,952:2024,953:2025,954:2026,955:2027,956:2028,957:2029,958:2030,959:2031,960:2032,961:2033,962:2035,963:2034,964:2036,965:2037,966:2038,967:2039,968:2040,969:2041,970:1973,971:1977,972:1975,973:1976,974:1979,1025:1715,1026:1713,1027:1714,1028:1716,1029:1717,1030:1718,1031:1719,1032:1720,1033:1721,1034:1722,1035:1723,1036:1724,1038:1726,1039:1727,1040:1761,1041:1762,1042:1783,1043:1767,1044:1764,1045:1765,1046:1782,1047:1786,1048:1769,1049:1770,1050:1771,1051:1772,1052:1773,1053:1774,1054:1775,1055:1776,1056:1778,1057:1779,1058:1780,1059:1781,1060:1766,1061:1768,1062:1763,1063:1790,1064:1787,1065:1789,1066:1791,1067:1785,1068:1784,1069:1788,1070:1760,1071:1777,1072:1729,1073:1730,1074:1751,1075:1735,1076:1732,1077:1733,1078:1750,1079:1754,1080:1737,1081:1738,1082:1739,1083:1740,1084:1741,1085:1742,1086:1743,1087:1744,1088:1746,1089:1747,1090:1748,1091:1749,1092:1734,1093:1736,1094:1731,1095:1758,1096:1755,1097:1757,1098:1759,1099:1753,1100:1752,1101:1756,1102:1728,1103:1745,1105:1699,1106:1697,1107:1698,1108:1700,1109:1701,1110:1702,1111:1703,1112:1704,1113:1705,1114:1706,1115:1707,1116:1708,1118:1710,1119:1711,1168:1725,1169:1709,1488:3296,1489:3297,1490:3298,1491:3299,1492:3300,1493:3301,1494:3302,1495:3303,1496:3304,1497:3305,1498:3306,1499:3307,1500:3308,1501:3309,1502:3310,1503:3311,1504:3312,1505:3313,1506:3314,1507:3315,1508:3316,1509:3317,1510:3318,1511:3319,1512:3320,1513:3321,1514:3322,1548:1452,1563:1467,1567:1471,1569:1473,1570:1474,1571:1475,1572:1476,1573:1477,1574:1478,1575:1479,1576:1480,1577:1481,1578:1482,1579:1483,1580:1484,1581:1485,1582:1486,1583:1487,1584:1488,1585:1489,1586:1490,1587:1491,1588:1492,1589:1493,1590:1494,1591:1495,1592:1496,1593:1497,1594:1498,1600:1504,1601:1505,1602:1506,1603:1507,1604:1508,1605:1509,1606:1510,1607:1511,1608:1512,1609:1513,1610:1514,1611:1515,1612:1516,1613:1517,1614:1518,1615:1519,1616:1520,1617:1521,1618:1522,3585:3489,3586:3490,3587:3491,3588:3492,3589:3493,3590:3494,3591:3495,3592:3496,3593:3497,3594:3498,3595:3499,3596:3500,3597:3501,3598:3502,3599:3503,3600:3504,3601:3505,3602:3506,3603:3507,3604:3508,3605:3509,3606:3510,3607:3511,3608:3512,3609:3513,3610:3514,3611:3515,3612:3516,3613:3517,3614:3518,3615:3519,3616:3520,3617:3521,3618:3522,3619:3523,3620:3524,3621:3525,3622:3526,3623:3527,3624:3528,3625:3529,3626:3530,3627:3531,3628:3532,3629:3533,3630:3534,3631:3535,3632:3536,3633:3537,3634:3538,3635:3539,3636:3540,3637:3541,3638:3542,3639:3543,3640:3544,3641:3545,3642:3546,3647:3551,3648:3552,3649:3553,3650:3554,3651:3555,3652:3556,3653:3557,3654:3558,3655:3559,3656:3560,3657:3561,3658:3562,3659:3563,3660:3564,3661:3565,3664:3568,3665:3569,3666:3570,3667:3571,3668:3572,3669:3573,3670:3574,3671:3575,3672:3576,3673:3577,8194:2722,8195:2721,8196:2723,8197:2724,8199:2725,8200:2726,8201:2727,8202:2728,8210:2747,8211:2730,8212:2729,8213:1967,8215:3295,8216:2768,8217:2769,8218:2813,8220:2770,8221:2771,8222:2814,8224:2801,8225:2802,8226:2790,8229:2735,8230:2734,8240:2773,8242:2774,8243:2775,8248:2812,8254:1150,8361:3839,8364:8364,8453:2744,8470:1712,8471:2811,8478:2772,8482:2761,8531:2736,8532:2737,8533:2738,8534:2739,8535:2740,8536:2741,8537:2742,8538:2743,8539:2755,8540:2756,8541:2757,8542:2758,8592:2299,8593:2300,8594:2301,8595:2302,8658:2254,8660:2253,8706:2287,8711:2245,8728:3018,8730:2262,8733:2241,8734:2242,8743:2270,8744:2271,8745:2268,8746:2269,8747:2239,8756:2240,8764:2248,8771:2249,8773:16785992,8800:2237,8801:2255,8804:2236,8805:2238,8834:2266,8835:2267,8866:3068,8867:3036,8868:3010,8869:3022,8968:3027,8970:3012,8981:2810,8992:2212,8993:2213,9109:3020,9115:2219,9117:2220,9118:2221,9120:2222,9121:2215,9123:2216,9124:2217,9126:2218,9128:2223,9132:2224,9143:2209,9146:2543,9147:2544,9148:2546,9149:2547,9225:2530,9226:2533,9227:2537,9228:2531,9229:2532,9251:2732,9252:2536,9472:2211,9474:2214,9484:2210,9488:2539,9492:2541,9496:2538,9500:2548,9508:2549,9516:2551,9524:2550,9532:2542,9618:2529,9642:2791,9643:2785,9644:2779,9645:2786,9646:2783,9647:2767,9650:2792,9651:2787,9654:2781,9655:2765,9660:2793,9661:2788,9664:2780,9665:2764,9670:2528,9675:2766,9679:2782,9702:2784,9734:2789,9742:2809,9747:2762,9756:2794,9758:2795,9792:2808,9794:2807,9827:2796,9829:2798,9830:2797,9837:2806,9839:2805,10003:2803,10007:2804,10013:2777,10016:2800,10216:2748,10217:2750,12289:1188,12290:1185,12300:1186,12301:1187,12443:1246,12444:1247,12449:1191,12450:1201,12451:1192,12452:1202,12453:1193,12454:1203,12455:1194,12456:1204,12457:1195,12458:1205,12459:1206,12461:1207,12463:1208,12465:1209,12467:1210,12469:1211,12471:1212,12473:1213,12475:1214,12477:1215,12479:1216,12481:1217,12483:1199,12484:1218,12486:1219,12488:1220,12490:1221,12491:1222,12492:1223,12493:1224,12494:1225,12495:1226,12498:1227,12501:1228,12504:1229,12507:1230,12510:1231,12511:1232,12512:1233,12513:1234,12514:1235,12515:1196,12516:1236,12517:1197,12518:1237,12519:1198,12520:1238,12521:1239,12522:1240,12523:1241,12524:1242,12525:1243,12527:1244,12530:1190,12531:1245,12539:1189,12540:1200},$m=es.default={lookup:function(i){if(i>=32&&i<=255)return i;var r=T0[i];return r!==void 0?r:16777216|i}}});var Th=se(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.default=void 0;var zm=ts.default={8:"Backspace",9:"Tab",10:"NumpadClear",13:"Enter",16:"ShiftLeft",17:"ControlLeft",18:"AltLeft",19:"Pause",20:"CapsLock",21:"Lang1",25:"Lang2",27:"Escape",28:"Convert",29:"NonConvert",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",44:"PrintScreen",45:"Insert",46:"Delete",47:"Help",48:"Digit0",49:"Digit1",50:"Digit2",51:"Digit3",52:"Digit4",53:"Digit5",54:"Digit6",55:"Digit7",56:"Digit8",57:"Digit9",91:"MetaLeft",92:"MetaRight",93:"ContextMenu",95:"Sleep",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",108:"NumpadDecimal",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",144:"NumLock",145:"ScrollLock",166:"BrowserBack",167:"BrowserForward",168:"BrowserRefresh",169:"BrowserStop",170:"BrowserSearch",171:"BrowserFavorites",172:"BrowserHome",173:"AudioVolumeMute",174:"AudioVolumeDown",175:"AudioVolumeUp",176:"MediaTrackNext",177:"MediaTrackPrevious",178:"MediaStop",179:"MediaPlayPause",180:"LaunchMail",181:"MediaSelect",182:"LaunchApp1",183:"LaunchApp2",225:"AltRight"}});var Rh=se(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.default=void 0;var Gm=is.default={Backspace:"Backspace",AltLeft:"Alt",AltRight:"Alt",CapsLock:"CapsLock",ContextMenu:"ContextMenu",ControlLeft:"Control",ControlRight:"Control",Enter:"Enter",MetaLeft:"Meta",MetaRight:"Meta",ShiftLeft:"Shift",ShiftRight:"Shift",Tab:"Tab",Delete:"Delete",End:"End",Help:"Help",Home:"Home",Insert:"Insert",PageDown:"PageDown",PageUp:"PageUp",ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowRight:"ArrowRight",ArrowUp:"ArrowUp",NumLock:"NumLock",NumpadBackspace:"Backspace",NumpadClear:"Clear",Escape:"Escape",F1:"F1",F2:"F2",F3:"F3",F4:"F4",F5:"F5",F6:"F6",F7:"F7",F8:"F8",F9:"F9",F10:"F10",F11:"F11",F12:"F12",F13:"F13",F14:"F14",F15:"F15",F16:"F16",F17:"F17",F18:"F18",F19:"F19",F20:"F20",F21:"F21",F22:"F22",F23:"F23",F24:"F24",F25:"F25",F26:"F26",F27:"F27",F28:"F28",F29:"F29",F30:"F30",F31:"F31",F32:"F32",F33:"F33",F34:"F34",F35:"F35",PrintScreen:"PrintScreen",ScrollLock:"ScrollLock",Pause:"Pause",BrowserBack:"BrowserBack",BrowserFavorites:"BrowserFavorites",BrowserForward:"BrowserForward",BrowserHome:"BrowserHome",BrowserRefresh:"BrowserRefresh",BrowserSearch:"BrowserSearch",BrowserStop:"BrowserStop",Eject:"Eject",LaunchApp1:"LaunchMyComputer",LaunchApp2:"LaunchCalendar",LaunchMail:"LaunchMail",MediaPlayPause:"MediaPlay",MediaStop:"MediaStop",MediaTrackNext:"MediaTrackNext",MediaTrackPrevious:"MediaTrackPrevious",Power:"Power",Sleep:"Sleep",AudioVolumeDown:"AudioVolumeDown",AudioVolumeMute:"AudioVolumeMute",AudioVolumeUp:"AudioVolumeUp",WakeUp:"WakeUp"}});var Mh=se(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.default=void 0;var Q=R0(wi());function R0(e){return e&&e.__esModule?e:{default:e}}var si={};function V(e,i){if(i===void 0)throw new Error('Undefined keysym for key "'+e+'"');if(e in si)throw new Error('Duplicate entry for key "'+e+'"');si[e]=[i,i,i,i]}function rs(e,i,r){if(i===void 0)throw new Error('Undefined keysym for key "'+e+'"');if(r===void 0)throw new Error('Undefined keysym for key "'+e+'"');if(e in si)throw new Error('Duplicate entry for key "'+e+'"');si[e]=[i,i,r,i]}function be(e,i,r){if(i===void 0)throw new Error('Undefined keysym for key "'+e+'"');if(r===void 0)throw new Error('Undefined keysym for key "'+e+'"');if(e in si)throw new Error('Duplicate entry for key "'+e+'"');si[e]=[i,i,i,r]}rs("Alt",Q.default.XK_Alt_L,Q.default.XK_Alt_R);V("AltGraph",Q.default.XK_ISO_Level3_Shift);V("CapsLock",Q.default.XK_Caps_Lock);rs("Control",Q.default.XK_Control_L,Q.default.XK_Control_R);rs("Meta",Q.default.XK_Super_L,Q.default.XK_Super_R);V("NumLock",Q.default.XK_Num_Lock);V("ScrollLock",Q.default.XK_Scroll_Lock);rs("Shift",Q.default.XK_Shift_L,Q.default.XK_Shift_R);be("Enter",Q.default.XK_Return,Q.default.XK_KP_Enter);V("Tab",Q.default.XK_Tab);be(" ",Q.default.XK_space,Q.default.XK_KP_Space);be("ArrowDown",Q.default.XK_Down,Q.default.XK_KP_Down);be("ArrowLeft",Q.default.XK_Left,Q.default.XK_KP_Left);be("ArrowRight",Q.default.XK_Right,Q.default.XK_KP_Right);be("ArrowUp",Q.default.XK_Up,Q.default.XK_KP_Up);be("End",Q.default.XK_End,Q.default.XK_KP_End);be("Home",Q.default.XK_Home,Q.default.XK_KP_Home);be("PageDown",Q.default.XK_Next,Q.default.XK_KP_Next);be("PageUp",Q.default.XK_Prior,Q.default.XK_KP_Prior);V("Backspace",Q.default.XK_BackSpace);be("Clear",Q.default.XK_Clear,Q.default.XK_KP_Begin);V("Copy",Q.default.XF86XK_Copy);V("Cut",Q.default.XF86XK_Cut);be("Delete",Q.default.XK_Delete,Q.default.XK_KP_Delete);be("Insert",Q.default.XK_Insert,Q.default.XK_KP_Insert);V("Paste",Q.default.XF86XK_Paste);V("Redo",Q.default.XK_Redo);V("Undo",Q.default.XK_Undo);V("Cancel",Q.default.XK_Cancel);V("ContextMenu",Q.default.XK_Menu);V("Escape",Q.default.XK_Escape);V("Execute",Q.default.XK_Execute);V("Find",Q.default.XK_Find);V("Help",Q.default.XK_Help);V("Pause",Q.default.XK_Pause);V("Select",Q.default.XK_Select);V("ZoomIn",Q.default.XF86XK_ZoomIn);V("ZoomOut",Q.default.XF86XK_ZoomOut);V("BrightnessDown",Q.default.XF86XK_MonBrightnessDown);V("BrightnessUp",Q.default.XF86XK_MonBrightnessUp);V("Eject",Q.default.XF86XK_Eject);V("LogOff",Q.default.XF86XK_LogOff);V("Power",Q.default.XF86XK_PowerOff);V("PowerOff",Q.default.XF86XK_PowerDown);V("PrintScreen",Q.default.XK_Print);V("Hibernate",Q.default.XF86XK_Hibernate);V("Standby",Q.default.XF86XK_Standby);V("WakeUp",Q.default.XF86XK_WakeUp);V("AllCandidates",Q.default.XK_MultipleCandidate);V("Alphanumeric",Q.default.XK_Eisu_toggle);V("CodeInput",Q.default.XK_Codeinput);V("Compose",Q.default.XK_Multi_key);V("Convert",Q.default.XK_Henkan);V("GroupFirst",Q.default.XK_ISO_First_Group);V("GroupLast",Q.default.XK_ISO_Last_Group);V("GroupNext",Q.default.XK_ISO_Next_Group);V("GroupPrevious",Q.default.XK_ISO_Prev_Group);V("NonConvert",Q.default.XK_Muhenkan);V("PreviousCandidate",Q.default.XK_PreviousCandidate);V("SingleCandidate",Q.default.XK_SingleCandidate);V("HangulMode",Q.default.XK_Hangul);V("HanjaMode",Q.default.XK_Hangul_Hanja);V("JunjaMode",Q.default.XK_Hangul_Jeonja);V("Eisu",Q.default.XK_Eisu_toggle);V("Hankaku",Q.default.XK_Hankaku);V("Hiragana",Q.default.XK_Hiragana);V("HiraganaKatakana",Q.default.XK_Hiragana_Katakana);V("KanaMode",Q.default.XK_Kana_Shift);V("KanjiMode",Q.default.XK_Kanji);V("Katakana",Q.default.XK_Katakana);V("Romaji",Q.default.XK_Romaji);V("Zenkaku",Q.default.XK_Zenkaku);V("ZenkakuHankaku",Q.default.XK_Zenkaku_Hankaku);V("F1",Q.default.XK_F1);V("F2",Q.default.XK_F2);V("F3",Q.default.XK_F3);V("F4",Q.default.XK_F4);V("F5",Q.default.XK_F5);V("F6",Q.default.XK_F6);V("F7",Q.default.XK_F7);V("F8",Q.default.XK_F8);V("F9",Q.default.XK_F9);V("F10",Q.default.XK_F10);V("F11",Q.default.XK_F11);V("F12",Q.default.XK_F12);V("F13",Q.default.XK_F13);V("F14",Q.default.XK_F14);V("F15",Q.default.XK_F15);V("F16",Q.default.XK_F16);V("F17",Q.default.XK_F17);V("F18",Q.default.XK_F18);V("F19",Q.default.XK_F19);V("F20",Q.default.XK_F20);V("F21",Q.default.XK_F21);V("F22",Q.default.XK_F22);V("F23",Q.default.XK_F23);V("F24",Q.default.XK_F24);V("F25",Q.default.XK_F25);V("F26",Q.default.XK_F26);V("F27",Q.default.XK_F27);V("F28",Q.default.XK_F28);V("F29",Q.default.XK_F29);V("F30",Q.default.XK_F30);V("F31",Q.default.XK_F31);V("F32",Q.default.XK_F32);V("F33",Q.default.XK_F33);V("F34",Q.default.XK_F34);V("F35",Q.default.XK_F35);V("Close",Q.default.XF86XK_Close);V("MailForward",Q.default.XF86XK_MailForward);V("MailReply",Q.default.XF86XK_Reply);V("MailSend",Q.default.XF86XK_Send);V("MediaFastForward",Q.default.XF86XK_AudioForward);V("MediaPause",Q.default.XF86XK_AudioPause);V("MediaPlay",Q.default.XF86XK_AudioPlay);V("MediaRecord",Q.default.XF86XK_AudioRecord);V("MediaRewind",Q.default.XF86XK_AudioRewind);V("MediaStop",Q.default.XF86XK_AudioStop);V("MediaTrackNext",Q.default.XF86XK_AudioNext);V("MediaTrackPrevious",Q.default.XF86XK_AudioPrev);V("New",Q.default.XF86XK_New);V("Open",Q.default.XF86XK_Open);V("Print",Q.default.XK_Print);V("Save",Q.default.XF86XK_Save);V("SpellCheck",Q.default.XF86XK_Spell);V("AudioVolumeDown",Q.default.XF86XK_AudioLowerVolume);V("AudioVolumeUp",Q.default.XF86XK_AudioRaiseVolume);V("AudioVolumeMute",Q.default.XF86XK_AudioMute);V("MicrophoneVolumeMute",Q.default.XF86XK_AudioMicMute);V("LaunchApplication1",Q.default.XF86XK_MyComputer);V("LaunchApplication2",Q.default.XF86XK_Calculator);V("LaunchCalendar",Q.default.XF86XK_Calendar);V("LaunchMail",Q.default.XF86XK_Mail);V("LaunchMediaPlayer",Q.default.XF86XK_AudioMedia);V("LaunchMusicPlayer",Q.default.XF86XK_Music);V("LaunchPhone",Q.default.XF86XK_Phone);V("LaunchScreenSaver",Q.default.XF86XK_ScreenSaver);V("LaunchSpreadsheet",Q.default.XF86XK_Excel);V("LaunchWebBrowser",Q.default.XF86XK_WWW);V("LaunchWebCam",Q.default.XF86XK_WebCam);V("LaunchWordProcessor",Q.default.XF86XK_Word);V("BrowserBack",Q.default.XF86XK_Back);V("BrowserFavorites",Q.default.XF86XK_Favorites);V("BrowserForward",Q.default.XF86XK_Forward);V("BrowserHome",Q.default.XF86XK_HomePage);V("BrowserRefresh",Q.default.XF86XK_Refresh);V("BrowserSearch",Q.default.XF86XK_Search);V("BrowserStop",Q.default.XF86XK_Stop);V("Dimmer",Q.default.XF86XK_BrightnessAdjust);V("MediaAudioTrack",Q.default.XF86XK_AudioCycleTrack);V("RandomToggle",Q.default.XF86XK_AudioRandomPlay);V("SplitScreenToggle",Q.default.XF86XK_SplitScreen);V("Subtitle",Q.default.XF86XK_Subtitle);V("VideoModeNext",Q.default.XF86XK_Next_VMode);be("=",Q.default.XK_equal,Q.default.XK_KP_Equal);be("+",Q.default.XK_plus,Q.default.XK_KP_Add);be("-",Q.default.XK_minus,Q.default.XK_KP_Subtract);be("*",Q.default.XK_asterisk,Q.default.XK_KP_Multiply);be("/",Q.default.XK_slash,Q.default.XK_KP_Divide);be(".",Q.default.XK_period,Q.default.XK_KP_Decimal);be(",",Q.default.XK_comma,Q.default.XK_KP_Separator);be("0",Q.default.XK_0,Q.default.XK_KP_0);be("1",Q.default.XK_1,Q.default.XK_KP_1);be("2",Q.default.XK_2,Q.default.XK_KP_2);be("3",Q.default.XK_3,Q.default.XK_KP_3);be("4",Q.default.XK_4,Q.default.XK_KP_4);be("5",Q.default.XK_5,Q.default.XK_KP_5);be("6",Q.default.XK_6,Q.default.XK_KP_6);be("7",Q.default.XK_7,Q.default.XK_KP_7);be("8",Q.default.XK_8,Q.default.XK_KP_8);be("9",Q.default.XK_9,Q.default.XK_KP_9);var Vm=ss.default=si});var Xh=se(tr=>{"use strict";function mo(e){"@babel/helpers - typeof";return mo=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},mo(e)}Object.defineProperty(tr,"__esModule",{value:!0});tr.getKey=Kh;tr.getKeycode=Zi;tr.getKeysym=P0;var Ji=er(wi()),M0=er(vo()),Fh=er(Th()),Ph=er(Rh()),Oh=er(Mh()),Hh=F0(Oi());function Qh(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Qh=function(l){return l?r:i})(e)}function F0(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||mo(e)!="object"&&typeof e!="function")return{default:e};var r=Qh(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function er(e){return e&&e.__esModule?e:{default:e}}function Zi(e){if(e.code){switch(e.code){case"OSLeft":return"MetaLeft";case"OSRight":return"MetaRight"}return e.code}if(e.keyCode in Fh.default){var i=Fh.default[e.keyCode];if(Hh.isMac()&&i==="ContextMenu"&&(i="MetaRight"),e.location===2)switch(i){case"ShiftLeft":return"ShiftRight";case"ControlLeft":return"ControlRight";case"AltLeft":return"AltRight"}if(e.location===3)switch(i){case"Delete":return"NumpadDecimal";case"Insert":return"Numpad0";case"End":return"Numpad1";case"ArrowDown":return"Numpad2";case"PageDown":return"Numpad3";case"ArrowLeft":return"Numpad4";case"ArrowRight":return"Numpad6";case"Home":return"Numpad7";case"ArrowUp":return"Numpad8";case"PageUp":return"Numpad9";case"Enter":return"NumpadEnter"}return i}return"Unidentified"}function Kh(e){if(e.key!==void 0&&e.key!=="Unidentified"){switch(e.key){case"OS":return"Meta";case"LaunchMyComputer":return"LaunchApplication1";case"LaunchCalculator":return"LaunchApplication2"}switch(e.key){case"UIKeyInputUpArrow":return"ArrowUp";case"UIKeyInputDownArrow":return"ArrowDown";case"UIKeyInputLeftArrow":return"ArrowLeft";case"UIKeyInputRightArrow":return"ArrowRight";case"UIKeyInputEscape":return"Escape"}return e.key==="\0"&&e.code==="NumpadDecimal"?"Delete":e.key}var i=Zi(e);return i in Ph.default?Ph.default[i]:e.charCode?String.fromCharCode(e.charCode):"Unidentified"}function P0(e){var i=Kh(e);if(i==="Unidentified")return null;if(i in Oh.default){var r=e.location;if(i==="Meta"&&r===0&&(r=2),i==="Clear"&&r===3){var s=Zi(e);s==="NumLock"&&(r=0)}if((r===void 0||r>3)&&(r=0),i==="Meta"){var l=Zi(e);if(l==="AltLeft")return Ji.default.XK_Meta_L;if(l==="AltRight")return Ji.default.XK_Meta_R}if(i==="Clear"){var t=Zi(e);if(t==="NumLock")return Ji.default.XK_Num_Lock}if(Hh.isWindows())switch(i){case"Zenkaku":case"Hankaku":return Ji.default.XK_Zenkaku_Hankaku;case"Romaji":case"KanaMode":return Ji.default.XK_Romaji}return Oh.default[i][r]}if(i.length!==1)return null;var n=i.charCodeAt();return n?M0.default.lookup(n):null}});var Wh=se(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.default=void 0;var yo=bo(xt()),Ci=Ln(),Nh=bo(Xh()),Ie=O0(wi()),Ze=bo(Oi());function O0(e){return e&&e.__esModule?e:{default:e}}function $h(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return($h=function(l){return l?r:i})(e)}function bo(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||xi(e)!="object"&&typeof e!="function")return{default:e};var r=$h(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function xi(e){"@babel/helpers - typeof";return xi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},xi(e)}function H0(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Uh(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,K0(s.key),s)}}function Q0(e,i,r){return i&&Uh(e.prototype,i),r&&Uh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function K0(e){var i=X0(e,"string");return xi(i)=="symbol"?i:i+""}function X0(e,i){if(xi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(xi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Zm=ns.default=function(){function e(i){H0(this,e),this._target=i||null,this._keyDownList={},this._altGrArmed=!1,this._eventHandlers={keyup:this._handleKeyUp.bind(this),keydown:this._handleKeyDown.bind(this),blur:this._allKeysUp.bind(this)},this.onkeyevent=function(){}}return Q0(e,[{key:"_sendKeyEvent",value:function(r,s,l){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null;if(l)this._keyDownList[s]=r;else{if(!(s in this._keyDownList))return;delete this._keyDownList[s]}yo.Debug("onkeyevent "+(l?"down":"up")+", keysym: "+r,", code: "+s+", numlock: "+t+", capslock: "+n),this.onkeyevent(r,s,l,t,n)}},{key:"_getKeyCode",value:function(r){var s=Nh.getKeycode(r);if(s!=="Unidentified")return s;if(r.keyCode&&r.keyCode!==229)return"Platform"+r.keyCode;if(r.keyIdentifier){if(r.keyIdentifier.substr(0,2)!=="U+")return r.keyIdentifier;var l=parseInt(r.keyIdentifier.substr(2),16),t=String.fromCharCode(l).toUpperCase();return"Platform"+t.charCodeAt()}return"Unidentified"}},{key:"_handleKeyDown",value:function(r){var s=this._getKeyCode(r),l=Nh.getKeysym(r),t=r.getModifierState("NumLock"),n=r.getModifierState("CapsLock");if((Ze.isMac()||Ze.isIOS())&&(t=null),this._altGrArmed&&(this._altGrArmed=!1,clearTimeout(this._altGrTimeout),s==="AltRight"&&r.timeStamp-this._altGrCtrlTime<50?l=Ie.default.XK_ISO_Level3_Shift:this._sendKeyEvent(Ie.default.XK_Control_L,"ControlLeft",!0,t,n)),s==="Unidentified"){l&&(this._sendKeyEvent(l,s,!0,t,n),this._sendKeyEvent(l,s,!1,t,n)),(0,Ci.stopEvent)(r);return}if(Ze.isMac()||Ze.isIOS())switch(l){case Ie.default.XK_Super_L:l=Ie.default.XK_Alt_L;break;case Ie.default.XK_Super_R:l=Ie.default.XK_Super_L;break;case Ie.default.XK_Alt_L:l=Ie.default.XK_Mode_switch;break;case Ie.default.XK_Alt_R:l=Ie.default.XK_ISO_Level3_Shift;break}if(s in this._keyDownList&&(l=this._keyDownList[s]),(Ze.isMac()||Ze.isIOS())&&r.metaKey&&s!=="MetaLeft"&&s!=="MetaRight"){this._sendKeyEvent(l,s,!0,t,n),this._sendKeyEvent(l,s,!1,t,n),(0,Ci.stopEvent)(r);return}if((Ze.isMac()||Ze.isIOS())&&s==="CapsLock"){this._sendKeyEvent(Ie.default.XK_Caps_Lock,"CapsLock",!0,t,n),this._sendKeyEvent(Ie.default.XK_Caps_Lock,"CapsLock",!1,t,n),(0,Ci.stopEvent)(r);return}var h=[Ie.default.XK_Zenkaku_Hankaku,Ie.default.XK_Eisu_toggle,Ie.default.XK_Katakana,Ie.default.XK_Hiragana,Ie.default.XK_Romaji];if(Ze.isWindows()&&h.includes(l)){this._sendKeyEvent(l,s,!0,t,n),this._sendKeyEvent(l,s,!1,t,n),(0,Ci.stopEvent)(r);return}if((0,Ci.stopEvent)(r),s==="ControlLeft"&&Ze.isWindows()&&!("ControlLeft"in this._keyDownList)){this._altGrArmed=!0,this._altGrTimeout=setTimeout(this._handleAltGrTimeout.bind(this),100),this._altGrCtrlTime=r.timeStamp;return}this._sendKeyEvent(l,s,!0,t,n)}},{key:"_handleKeyUp",value:function(r){(0,Ci.stopEvent)(r);var s=this._getKeyCode(r);if(this._altGrArmed&&(this._altGrArmed=!1,clearTimeout(this._altGrTimeout),this._sendKeyEvent(Ie.default.XK_Control_L,"ControlLeft",!0)),(Ze.isMac()||Ze.isIOS())&&s==="CapsLock"){this._sendKeyEvent(Ie.default.XK_Caps_Lock,"CapsLock",!0),this._sendKeyEvent(Ie.default.XK_Caps_Lock,"CapsLock",!1);return}this._sendKeyEvent(this._keyDownList[s],s,!1),Ze.isWindows()&&(s==="ShiftLeft"||s==="ShiftRight")&&("ShiftRight"in this._keyDownList&&this._sendKeyEvent(this._keyDownList.ShiftRight,"ShiftRight",!1),"ShiftLeft"in this._keyDownList&&this._sendKeyEvent(this._keyDownList.ShiftLeft,"ShiftLeft",!1))}},{key:"_handleAltGrTimeout",value:function(){this._altGrArmed=!1,clearTimeout(this._altGrTimeout),this._sendKeyEvent(Ie.default.XK_Control_L,"ControlLeft",!0)}},{key:"_allKeysUp",value:function(){yo.Debug(">> Keyboard.allKeysUp");for(var r in this._keyDownList)this._sendKeyEvent(this._keyDownList[r],r,!1);yo.Debug("<< Keyboard.allKeysUp")}},{key:"grab",value:function(){this._target.addEventListener("keydown",this._eventHandlers.keydown),this._target.addEventListener("keyup",this._eventHandlers.keyup),window.addEventListener("blur",this._eventHandlers.blur)}},{key:"ungrab",value:function(){this._target.removeEventListener("keydown",this._eventHandlers.keydown),this._target.removeEventListener("keyup",this._eventHandlers.keyup),window.removeEventListener("blur",this._eventHandlers.blur),this._allKeysUp()}}])}()});var qh=se(as=>{"use strict";Object.defineProperty(as,"__esModule",{value:!0});as.default=void 0;function or(e){"@babel/helpers - typeof";return or=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},or(e)}function N0(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function zh(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,$0(s.key),s)}}function U0(e,i,r){return i&&zh(e.prototype,i),r&&zh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function $0(e){var i=W0(e,"string");return or(i)=="symbol"?i:i+""}function W0(e,i){if(or(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(or(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var mt=0,ir=1,rr=2,sr=4,os=8,nr=16,Kt=32,Xt=64,Ao=127,jh=50,z0=90,Gh=250,j0=1e3,G0=1e3,q0=50,t1=as.default=function(){function e(){N0(this,e),this._target=null,this._state=Ao,this._tracked=[],this._ignored=[],this._waitingRelease=!1,this._releaseStart=0,this._longpressTimeoutId=null,this._twoTouchTimeoutId=null,this._boundEventHandler=this._eventHandler.bind(this)}return U0(e,[{key:"attach",value:function(r){this.detach(),this._target=r,this._target.addEventListener("touchstart",this._boundEventHandler),this._target.addEventListener("touchmove",this._boundEventHandler),this._target.addEventListener("touchend",this._boundEventHandler),this._target.addEventListener("touchcancel",this._boundEventHandler)}},{key:"detach",value:function(){this._target&&(this._stopLongpressTimeout(),this._stopTwoTouchTimeout(),this._target.removeEventListener("touchstart",this._boundEventHandler),this._target.removeEventListener("touchmove",this._boundEventHandler),this._target.removeEventListener("touchend",this._boundEventHandler),this._target.removeEventListener("touchcancel",this._boundEventHandler),this._target=null)}},{key:"_eventHandler",value:function(r){var s;switch(r.stopPropagation(),r.preventDefault(),r.type){case"touchstart":s=this._touchStart;break;case"touchmove":s=this._touchMove;break;case"touchend":case"touchcancel":s=this._touchEnd;break}for(var l=0;l<r.changedTouches.length;l++){var t=r.changedTouches[l];s.call(this,t.identifier,t.clientX,t.clientY)}}},{key:"_touchStart",value:function(r,s,l){if(this._hasDetectedGesture()||this._state===mt){this._ignored.push(r);return}if(this._tracked.length>0&&Date.now()-this._tracked[0].started>Gh){this._state=mt,this._ignored.push(r);return}if(this._waitingRelease){this._state=mt,this._ignored.push(r);return}switch(this._tracked.push({id:r,started:Date.now(),active:!0,firstX:s,firstY:l,lastX:s,lastY:l,angle:0}),this._tracked.length){case 1:this._startLongpressTimeout();break;case 2:this._state&=~(ir|os|nr),this._stopLongpressTimeout();break;case 3:this._state&=~(rr|Kt|Xt);break;default:this._state=mt}}},{key:"_touchMove",value:function(r,s,l){var t=this._tracked.find(function(f){return f.id===r});if(t!==void 0){t.lastX=s,t.lastY=l;var n=s-t.firstX,h=l-t.firstY;if((t.firstX!==t.lastX||t.firstY!==t.lastY)&&(t.angle=Math.atan2(h,n)*180/Math.PI),!this._hasDetectedGesture()){if(Math.hypot(n,h)<jh)return;if(this._state&=~(ir|rr|sr|nr),this._stopLongpressTimeout(),this._tracked.length!==1&&(this._state&=~os),this._tracked.length!==2&&(this._state&=~(Kt|Xt)),this._tracked.length===2){var g=this._tracked.find(function(f){return f.id!==r}),o=Math.hypot(g.firstX-g.lastX,g.firstY-g.lastY);if(o>jh){var c=Math.abs(t.angle-g.angle);c=Math.abs((c+180)%360-180),c>z0?this._state&=~Kt:this._state&=~Xt,this._isTwoTouchTimeoutRunning()&&this._stopTwoTouchTimeout()}else this._isTwoTouchTimeoutRunning()||this._startTwoTouchTimeout()}if(!this._hasDetectedGesture())return;this._pushEvent("gesturestart")}this._pushEvent("gesturemove")}}},{key:"_touchEnd",value:function(r,s,l){if(this._ignored.indexOf(r)!==-1){this._ignored.splice(this._ignored.indexOf(r),1),this._ignored.length===0&&this._tracked.length===0&&(this._state=Ao,this._waitingRelease=!1);return}if(!this._hasDetectedGesture()&&this._isTwoTouchTimeoutRunning()&&(this._stopTwoTouchTimeout(),this._state=mt),!this._hasDetectedGesture()&&(this._state&=~(os|Kt|Xt),this._state&=~nr,this._stopLongpressTimeout(),!this._waitingRelease))switch(this._releaseStart=Date.now(),this._waitingRelease=!0,this._tracked.length){case 1:this._state&=~(rr|sr);break;case 2:this._state&=~(ir|sr);break}if(this._waitingRelease){Date.now()-this._releaseStart>Gh&&(this._state=mt),this._tracked.some(function(h){return Date.now()-h.started>j0})&&(this._state=mt);var t=this._tracked.find(function(h){return h.id===r});if(t.active=!1,this._hasDetectedGesture())this._pushEvent("gesturestart");else if(this._state!==mt)return}this._hasDetectedGesture()&&this._pushEvent("gestureend");for(var n=0;n<this._tracked.length;n++)this._tracked[n].active&&this._ignored.push(this._tracked[n].id);this._tracked=[],this._state=mt,this._ignored.indexOf(r)!==-1&&this._ignored.splice(this._ignored.indexOf(r),1),this._ignored.length===0&&(this._state=Ao,this._waitingRelease=!1)}},{key:"_hasDetectedGesture",value:function(){return!(this._state===mt||this._state&this._state-1||this._state&(ir|rr|sr)&&this._tracked.some(function(r){return r.active}))}},{key:"_startLongpressTimeout",value:function(){var r=this;this._stopLongpressTimeout(),this._longpressTimeoutId=setTimeout(function(){return r._longpressTimeout()},G0)}},{key:"_stopLongpressTimeout",value:function(){clearTimeout(this._longpressTimeoutId),this._longpressTimeoutId=null}},{key:"_longpressTimeout",value:function(){if(this._hasDetectedGesture())throw new Error("A longpress gesture failed, conflict with a different gesture");this._state=nr,this._pushEvent("gesturestart")}},{key:"_startTwoTouchTimeout",value:function(){var r=this;this._stopTwoTouchTimeout(),this._twoTouchTimeoutId=setTimeout(function(){return r._twoTouchTimeout()},q0)}},{key:"_stopTwoTouchTimeout",value:function(){clearTimeout(this._twoTouchTimeoutId),this._twoTouchTimeoutId=null}},{key:"_isTwoTouchTimeoutRunning",value:function(){return this._twoTouchTimeoutId!==null}},{key:"_twoTouchTimeout",value:function(){if(this._tracked.length===0)throw new Error("A pinch or two drag gesture failed, no tracked touches");var r=this._getAverageMovement(),s=Math.abs(r.x),l=Math.abs(r.y),t=this._getAverageDistance(),n=Math.abs(Math.hypot(t.first.x,t.first.y)-Math.hypot(t.last.x,t.last.y));l<n&&s<n?this._state=Xt:this._state=Kt,this._pushEvent("gesturestart"),this._pushEvent("gesturemove")}},{key:"_pushEvent",value:function(r){var s={type:this._stateToGesture(this._state)},l=this._getPosition(),t=l.last;switch(r==="gesturestart"&&(t=l.first),this._state){case Kt:case Xt:t=l.first;break}if(s.clientX=t.x,s.clientY=t.y,this._state===Xt){var n=this._getAverageDistance();r==="gesturestart"?(s.magnitudeX=n.first.x,s.magnitudeY=n.first.y):(s.magnitudeX=n.last.x,s.magnitudeY=n.last.y)}else if(this._state===Kt)if(r==="gesturestart")s.magnitudeX=0,s.magnitudeY=0;else{var h=this._getAverageMovement();s.magnitudeX=h.x,s.magnitudeY=h.y}var g=new CustomEvent(r,{detail:s});this._target.dispatchEvent(g)}},{key:"_stateToGesture",value:function(r){switch(r){case ir:return"onetap";case rr:return"twotap";case sr:return"threetap";case os:return"drag";case nr:return"longpress";case Kt:return"twodrag";case Xt:return"pinch"}throw new Error("Unknown gesture state: "+r)}},{key:"_getPosition",value:function(){if(this._tracked.length===0)throw new Error("Failed to get gesture position, no tracked touches");for(var r=this._tracked.length,s=0,l=0,t=0,n=0,h=0;h<this._tracked.length;h++)s+=this._tracked[h].firstX,l+=this._tracked[h].firstY,t+=this._tracked[h].lastX,n+=this._tracked[h].lastY;return{first:{x:s/r,y:l/r},last:{x:t/r,y:n/r}}}},{key:"_getAverageMovement",value:function(){if(this._tracked.length===0)throw new Error("Failed to get gesture movement, no tracked touches");var r,s;r=s=0;for(var l=this._tracked.length,t=0;t<this._tracked.length;t++)r+=this._tracked[t].lastX-this._tracked[t].firstX,s+=this._tracked[t].lastY-this._tracked[t].firstY;return{x:r/l,y:s/l}}},{key:"_getAverageDistance",value:function(){if(this._tracked.length===0)throw new Error("Failed to get gesture distance, no tracked touches");var r=this._tracked[0],s=this._tracked[this._tracked.length-1],l=Math.abs(s.firstX-r.firstX),t=Math.abs(s.firstY-r.firstY),n=Math.abs(s.lastX-r.lastX),h=Math.abs(s.lastY-r.lastY);return{first:{x:l,y:t},last:{x:n,y:h}}}}])}()});var Jh=se(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.default=void 0;var Vh=Oi();function lr(e){"@babel/helpers - typeof";return lr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},lr(e)}function V0(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Yh(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,J0(s.key),s)}}function Y0(e,i,r){return i&&Yh(e.prototype,i),r&&Yh(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function J0(e){var i=Z0(e,"string");return lr(i)=="symbol"?i:i+""}function Z0(e,i){if(lr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(lr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var ar=!Vh.supportsCursorURIs||Vh.isTouchDevice,r1=ls.default=function(){function e(){V0(this,e),this._target=null,this._canvas=document.createElement("canvas"),ar&&(this._canvas.style.position="fixed",this._canvas.style.zIndex="65535",this._canvas.style.pointerEvents="none",this._canvas.style.userSelect="none",this._canvas.style.WebkitUserSelect="none",this._canvas.style.visibility="hidden"),this._position={x:0,y:0},this._hotSpot={x:0,y:0},this._eventHandlers={mouseover:this._handleMouseOver.bind(this),mouseleave:this._handleMouseLeave.bind(this),mousemove:this._handleMouseMove.bind(this),mouseup:this._handleMouseUp.bind(this)}}return Y0(e,[{key:"attach",value:function(r){if(this._target&&this.detach(),this._target=r,ar){document.body.appendChild(this._canvas);var s={capture:!0,passive:!0};this._target.addEventListener("mouseover",this._eventHandlers.mouseover,s),this._target.addEventListener("mouseleave",this._eventHandlers.mouseleave,s),this._target.addEventListener("mousemove",this._eventHandlers.mousemove,s),this._target.addEventListener("mouseup",this._eventHandlers.mouseup,s)}this.clear()}},{key:"detach",value:function(){if(this._target){if(ar){var r={capture:!0,passive:!0};this._target.removeEventListener("mouseover",this._eventHandlers.mouseover,r),this._target.removeEventListener("mouseleave",this._eventHandlers.mouseleave,r),this._target.removeEventListener("mousemove",this._eventHandlers.mousemove,r),this._target.removeEventListener("mouseup",this._eventHandlers.mouseup,r),document.contains(this._canvas)&&document.body.removeChild(this._canvas)}this._target=null}}},{key:"change",value:function(r,s,l,t,n){if(t===0||n===0){this.clear();return}this._position.x=this._position.x+this._hotSpot.x-s,this._position.y=this._position.y+this._hotSpot.y-l,this._hotSpot.x=s,this._hotSpot.y=l;var h=this._canvas.getContext("2d");this._canvas.width=t,this._canvas.height=n;var g=new ImageData(new Uint8ClampedArray(r),t,n);if(h.clearRect(0,0,t,n),h.putImageData(g,0,0),ar)this._updatePosition();else{var o=this._canvas.toDataURL();this._target.style.cursor="url("+o+")"+s+" "+l+", default"}}},{key:"clear",value:function(){this._target.style.cursor="none",this._canvas.width=0,this._canvas.height=0,this._position.x=this._position.x+this._hotSpot.x,this._position.y=this._position.y+this._hotSpot.y,this._hotSpot.x=0,this._hotSpot.y=0}},{key:"move",value:function(r,s){if(ar){window.visualViewport?(this._position.x=r+window.visualViewport.offsetLeft,this._position.y=s+window.visualViewport.offsetTop):(this._position.x=r,this._position.y=s),this._updatePosition();var l=document.elementFromPoint(r,s);this._updateVisibility(l)}}},{key:"_handleMouseOver",value:function(r){this._handleMouseMove(r)}},{key:"_handleMouseLeave",value:function(r){this._updateVisibility(r.relatedTarget)}},{key:"_handleMouseMove",value:function(r){this._updateVisibility(r.target),this._position.x=r.clientX-this._hotSpot.x,this._position.y=r.clientY-this._hotSpot.y,this._updatePosition()}},{key:"_handleMouseUp",value:function(r){var s=this,l=document.elementFromPoint(r.clientX,r.clientY);this._updateVisibility(l),this._captureIsActive()&&window.setTimeout(function(){s._target&&(l=document.elementFromPoint(r.clientX,r.clientY),s._updateVisibility(l))},0)}},{key:"_showCursor",value:function(){this._canvas.style.visibility==="hidden"&&(this._canvas.style.visibility="")}},{key:"_hideCursor",value:function(){this._canvas.style.visibility!=="hidden"&&(this._canvas.style.visibility="hidden")}},{key:"_shouldShowCursor",value:function(r){return r?r===this._target?!0:!(!this._target.contains(r)||window.getComputedStyle(r).cursor!=="none"):!1}},{key:"_updateVisibility",value:function(r){this._captureIsActive()&&(r=document.captureElement),this._shouldShowCursor(r)?this._showCursor():this._hideCursor()}},{key:"_updatePosition",value:function(){this._canvas.style.left=this._position.x+"px",this._canvas.style.top=this._position.y+"px"}},{key:"_captureIsActive",value:function(){return document.captureElement&&document.documentElement.contains(document.captureElement)}}])}()});var rc=se(us=>{"use strict";Object.defineProperty(us,"__esModule",{value:!0});us.default=void 0;var kt=eg(xt());function ic(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(ic=function(l){return l?r:i})(e)}function eg(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Si(e)!="object"&&typeof e!="function")return{default:e};var r=ic(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function Si(e){"@babel/helpers - typeof";return Si=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Si(e)}function Zh(e){return sg(e)||rg(e)||ig(e)||tg()}function tg(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ig(e,i){if(e){if(typeof e=="string")return Co(e,i);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Co(e,i):void 0}}function rg(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function sg(e){if(Array.isArray(e))return Co(e)}function Co(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,s=Array(i);r<i;r++)s[r]=e[r];return s}function ng(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function ec(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,ag(s.key),s)}}function og(e,i,r){return i&&ec(e.prototype,i),r&&ec(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ag(e){var i=lg(e,"string");return Si(i)=="symbol"?i:i+""}function lg(e,i){if(Si(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Si(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var wo=40*1024*1024,hs={CONNECTING:"connecting",OPEN:"open",CLOSING:"closing",CLOSED:"closed"},cs={CONNECTING:[WebSocket.CONNECTING,hs.CONNECTING],OPEN:[WebSocket.OPEN,hs.OPEN],CLOSING:[WebSocket.CLOSING,hs.CLOSING],CLOSED:[WebSocket.CLOSED,hs.CLOSED]},tc=["send","close","binaryType","onerror","onmessage","onopen","protocol","readyState"],n1=us.default=function(){function e(){ng(this,e),this._websocket=null,this._rQi=0,this._rQlen=0,this._rQbufferSize=1024*1024*4,this._rQ=null,this._sQbufferSize=1024*10,this._sQlen=0,this._sQ=null,this._eventHandlers={message:function(){},open:function(){},close:function(){},error:function(){}}}return og(e,[{key:"readyState",get:function(){var r;return this._websocket===null?"unused":(r=this._websocket.readyState,cs.CONNECTING.includes(r)?"connecting":cs.OPEN.includes(r)?"open":cs.CLOSING.includes(r)?"closing":cs.CLOSED.includes(r)?"closed":"unknown")}},{key:"rQpeek8",value:function(){return this._rQ[this._rQi]}},{key:"rQskipBytes",value:function(r){this._rQi+=r}},{key:"rQshift8",value:function(){return this._rQshift(1)}},{key:"rQshift16",value:function(){return this._rQshift(2)}},{key:"rQshift32",value:function(){return this._rQshift(4)}},{key:"_rQshift",value:function(r){for(var s=0,l=r-1;l>=0;l--)s+=this._rQ[this._rQi++]<<l*8;return s>>>0}},{key:"rQshiftStr",value:function(r){for(var s="",l=0;l<r;l+=4096){var t=this.rQshiftBytes(Math.min(4096,r-l),!1);s+=String.fromCharCode.apply(null,t)}return s}},{key:"rQshiftBytes",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return this._rQi+=r,s?this._rQ.slice(this._rQi-r,this._rQi):this._rQ.subarray(this._rQi-r,this._rQi)}},{key:"rQshiftTo",value:function(r,s){r.set(new Uint8Array(this._rQ.buffer,this._rQi,s)),this._rQi+=s}},{key:"rQpeekBytes",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return s?this._rQ.slice(this._rQi,this._rQi+r):this._rQ.subarray(this._rQi,this._rQi+r)}},{key:"rQwait",value:function(r,s,l){if(this._rQlen-this._rQi<s){if(l){if(this._rQi<l)throw new Error("rQwait cannot backup "+l+" bytes");this._rQi-=l}return!0}return!1}},{key:"sQpush8",value:function(r){this._sQensureSpace(1),this._sQ[this._sQlen++]=r}},{key:"sQpush16",value:function(r){this._sQensureSpace(2),this._sQ[this._sQlen++]=r>>8&255,this._sQ[this._sQlen++]=r>>0&255}},{key:"sQpush32",value:function(r){this._sQensureSpace(4),this._sQ[this._sQlen++]=r>>24&255,this._sQ[this._sQlen++]=r>>16&255,this._sQ[this._sQlen++]=r>>8&255,this._sQ[this._sQlen++]=r>>0&255}},{key:"sQpushString",value:function(r){var s=r.split("").map(function(l){return l.charCodeAt(0)});this.sQpushBytes(new Uint8Array(s))}},{key:"sQpushBytes",value:function(r){for(var s=0;s<r.length;){this._sQensureSpace(1);var l=this._sQbufferSize-this._sQlen;l>r.length-s&&(l=r.length-s),this._sQ.set(r.subarray(s,l),this._sQlen),this._sQlen+=l,s+=l}}},{key:"flush",value:function(){this._sQlen>0&&this.readyState==="open"&&(this._websocket.send(new Uint8Array(this._sQ.buffer,0,this._sQlen)),this._sQlen=0)}},{key:"_sQensureSpace",value:function(r){this._sQbufferSize-this._sQlen<r&&this.flush()}},{key:"off",value:function(r){this._eventHandlers[r]=function(){}}},{key:"on",value:function(r,s){this._eventHandlers[r]=s}},{key:"_allocateBuffers",value:function(){this._rQ=new Uint8Array(this._rQbufferSize),this._sQ=new Uint8Array(this._sQbufferSize)}},{key:"init",value:function(){this._allocateBuffers(),this._rQi=0,this._websocket=null}},{key:"open",value:function(r,s){this.attach(new WebSocket(r,s))}},{key:"attach",value:function(r){var s=this;this.init();for(var l=[].concat(Zh(Object.keys(r)),Zh(Object.getOwnPropertyNames(Object.getPrototypeOf(r)))),t=0;t<tc.length;t++){var n=tc[t];if(l.indexOf(n)<0)throw new Error("Raw channel missing property: "+n)}this._websocket=r,this._websocket.binaryType="arraybuffer",this._websocket.onmessage=this._recvMessage.bind(this),this._websocket.onopen=function(){kt.Debug(">> WebSock.onopen"),s._websocket.protocol&&kt.Info("Server choose sub-protocol: "+s._websocket.protocol),s._eventHandlers.open(),kt.Debug("<< WebSock.onopen")},this._websocket.onclose=function(h){kt.Debug(">> WebSock.onclose"),s._eventHandlers.close(h),kt.Debug("<< WebSock.onclose")},this._websocket.onerror=function(h){kt.Debug(">> WebSock.onerror: "+h),s._eventHandlers.error(h),kt.Debug("<< WebSock.onerror: "+h)}}},{key:"close",value:function(){this._websocket&&((this.readyState==="connecting"||this.readyState==="open")&&(kt.Info("Closing WebSocket connection"),this._websocket.close()),this._websocket.onmessage=function(){})}},{key:"_expandCompactRQ",value:function(r){var s=(this._rQlen-this._rQi+r)*8,l=this._rQbufferSize<s;if(l&&(this._rQbufferSize=Math.max(this._rQbufferSize*2,s)),this._rQbufferSize>wo&&(this._rQbufferSize=wo,this._rQbufferSize-(this._rQlen-this._rQi)<r))throw new Error("Receive Queue buffer exceeded "+wo+" bytes, and the new message could not fit");if(l){var t=this._rQ.buffer;this._rQ=new Uint8Array(this._rQbufferSize),this._rQ.set(new Uint8Array(t,this._rQi,this._rQlen-this._rQi))}else this._rQ.copyWithin(0,this._rQi,this._rQlen);this._rQlen=this._rQlen-this._rQi,this._rQi=0}},{key:"_recvMessage",value:function(r){this._rQlen==this._rQi&&(this._rQlen=0,this._rQi=0);var s=new Uint8Array(r.data);s.length>this._rQbufferSize-this._rQlen&&this._expandCompactRQ(s.length),this._rQ.set(s,this._rQlen),this._rQlen+=s.length,this._rQlen-this._rQi>0?this._eventHandlers.message():kt.Debug("Ignoring empty message")}}])}()});var sc=se(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.default=void 0;var a1=ds.default={Again:57349,AltLeft:56,AltRight:57400,ArrowDown:57424,ArrowLeft:57419,ArrowRight:57421,ArrowUp:57416,AudioVolumeDown:57390,AudioVolumeMute:57376,AudioVolumeUp:57392,Backquote:41,Backslash:43,Backspace:14,BracketLeft:26,BracketRight:27,BrowserBack:57450,BrowserFavorites:57446,BrowserForward:57449,BrowserHome:57394,BrowserRefresh:57447,BrowserSearch:57445,BrowserStop:57448,CapsLock:58,Comma:51,ContextMenu:57437,ControlLeft:29,ControlRight:57373,Convert:121,Copy:57464,Cut:57404,Delete:57427,Digit0:11,Digit1:2,Digit2:3,Digit3:4,Digit4:5,Digit5:6,Digit6:7,Digit7:8,Digit8:9,Digit9:10,Eject:57469,End:57423,Enter:28,Equal:13,Escape:1,F1:59,F10:68,F11:87,F12:88,F13:93,F14:94,F15:95,F16:85,F17:57347,F18:57463,F19:57348,F2:60,F20:90,F21:116,F22:57465,F23:109,F24:111,F3:61,F4:62,F5:63,F6:64,F7:65,F8:66,F9:67,Find:57409,Help:57461,Hiragana:119,Home:57415,Insert:57426,IntlBackslash:86,IntlRo:115,IntlYen:125,KanaMode:112,Katakana:120,KeyA:30,KeyB:48,KeyC:46,KeyD:32,KeyE:18,KeyF:33,KeyG:34,KeyH:35,KeyI:23,KeyJ:36,KeyK:37,KeyL:38,KeyM:50,KeyN:49,KeyO:24,KeyP:25,KeyQ:16,KeyR:19,KeyS:31,KeyT:20,KeyU:22,KeyV:47,KeyW:17,KeyX:45,KeyY:21,KeyZ:44,Lang1:114,Lang2:113,Lang3:120,Lang4:119,Lang5:118,LaunchApp1:57451,LaunchApp2:57377,LaunchMail:57452,MediaPlayPause:57378,MediaSelect:57453,MediaStop:57380,MediaTrackNext:57369,MediaTrackPrevious:57360,MetaLeft:57435,MetaRight:57436,Minus:12,NonConvert:123,NumLock:69,Numpad0:82,Numpad1:79,Numpad2:80,Numpad3:81,Numpad4:75,Numpad5:76,Numpad6:77,Numpad7:71,Numpad8:72,Numpad9:73,NumpadAdd:78,NumpadComma:126,NumpadDecimal:83,NumpadDivide:57397,NumpadEnter:57372,NumpadEqual:89,NumpadMultiply:55,NumpadParenLeft:57462,NumpadParenRight:57467,NumpadSubtract:74,Open:100,PageDown:57425,PageUp:57417,Paste:101,Pause:57414,Period:52,Power:57438,PrintScreen:84,Props:57350,Quote:40,ScrollLock:70,Semicolon:39,ShiftLeft:42,ShiftRight:54,Slash:53,Sleep:57439,Space:57,Suspend:57381,Tab:15,Undo:57351,WakeUp:57443}});var nc=se(hr=>{"use strict";Object.defineProperty(hr,"__esModule",{value:!0});hr.encodingName=hg;hr.encodings=void 0;var Nt=hr.encodings={encodingRaw:0,encodingCopyRect:1,encodingRRE:2,encodingHextile:5,encodingTight:7,encodingZRLE:16,encodingTightPNG:-260,encodingJPEG:21,pseudoEncodingQualityLevel9:-23,pseudoEncodingQualityLevel0:-32,pseudoEncodingDesktopSize:-223,pseudoEncodingLastRect:-224,pseudoEncodingCursor:-239,pseudoEncodingQEMUExtendedKeyEvent:-258,pseudoEncodingQEMULedEvent:-261,pseudoEncodingDesktopName:-307,pseudoEncodingExtendedDesktopSize:-308,pseudoEncodingXvp:-309,pseudoEncodingFence:-312,pseudoEncodingContinuousUpdates:-313,pseudoEncodingCompressLevel9:-247,pseudoEncodingCompressLevel0:-256,pseudoEncodingVMwareCursor:1464686180,pseudoEncodingExtendedClipboard:3231835598};function hg(e){switch(e){case Nt.encodingRaw:return"Raw";case Nt.encodingCopyRect:return"CopyRect";case Nt.encodingRRE:return"RRE";case Nt.encodingHextile:return"Hextile";case Nt.encodingTight:return"Tight";case Nt.encodingZRLE:return"ZRLE";case Nt.encodingTightPNG:return"TightPNG";case Nt.encodingJPEG:return"JPEG";default:return"[unknown encoding "+e+"]"}}});var cc=se(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});Ei.AESECBCipher=Ei.AESEAXCipher=void 0;function ni(e){"@babel/helpers - typeof";return ni=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ni(e)}function Se(){"use strict";Se=function(){return i};var e,i={},r=Object.prototype,s=r.hasOwnProperty,l=Object.defineProperty||function(k,y,C){k[y]=C.value},t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",h=t.asyncIterator||"@@asyncIterator",g=t.toStringTag||"@@toStringTag";function o(k,y,C){return Object.defineProperty(k,y,{value:C,enumerable:!0,configurable:!0,writable:!0}),k[y]}try{o({},"")}catch{o=function(C,B,I){return C[B]=I}}function c(k,y,C,B){var I=y&&y.prototype instanceof p?y:p,R=Object.create(I.prototype),H=new N(B||[]);return l(R,"_invoke",{value:L(k,C,H)}),R}function f(k,y,C){try{return{type:"normal",arg:k.call(y,C)}}catch(B){return{type:"throw",arg:B}}}i.wrap=c;var v="suspendedStart",u="suspendedYield",a="executing",d="completed",_={};function p(){}function m(){}function w(){}var b={};o(b,n,function(){return this});var S=Object.getPrototypeOf,A=S&&S(S(X([])));A&&A!==r&&s.call(A,n)&&(b=A);var x=w.prototype=p.prototype=Object.create(b);function E(k){["next","throw","return"].forEach(function(y){o(k,y,function(C){return this._invoke(y,C)})})}function D(k,y){function C(I,R,H,$){var q=f(k[I],k,R);if(q.type!=="throw"){var P=q.arg,M=P.value;return M&&ni(M)=="object"&&s.call(M,"__await")?y.resolve(M.__await).then(function(U){C("next",U,H,$)},function(U){C("throw",U,H,$)}):y.resolve(M).then(function(U){P.value=U,H(P)},function(U){return C("throw",U,H,$)})}$(q.arg)}var B;l(this,"_invoke",{value:function(R,H){function $(){return new y(function(q,P){C(R,H,q,P)})}return B=B?B.then($,$):$()}})}function L(k,y,C){var B=v;return function(I,R){if(B===a)throw Error("Generator is already running");if(B===d){if(I==="throw")throw R;return{value:e,done:!0}}for(C.method=I,C.arg=R;;){var H=C.delegate;if(H){var $=T(H,C);if($){if($===_)continue;return $}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(B===v)throw B=d,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);B=a;var q=f(k,y,C);if(q.type==="normal"){if(B=C.done?d:u,q.arg===_)continue;return{value:q.arg,done:C.done}}q.type==="throw"&&(B=d,C.method="throw",C.arg=q.arg)}}}function T(k,y){var C=y.method,B=k.iterator[C];if(B===e)return y.delegate=null,C==="throw"&&k.iterator.return&&(y.method="return",y.arg=e,T(k,y),y.method==="throw")||C!=="return"&&(y.method="throw",y.arg=new TypeError("The iterator does not provide a '"+C+"' method")),_;var I=f(B,k.iterator,y.arg);if(I.type==="throw")return y.method="throw",y.arg=I.arg,y.delegate=null,_;var R=I.arg;return R?R.done?(y[k.resultName]=R.value,y.next=k.nextLoc,y.method!=="return"&&(y.method="next",y.arg=e),y.delegate=null,_):R:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,_)}function F(k){var y={tryLoc:k[0]};1 in k&&(y.catchLoc=k[1]),2 in k&&(y.finallyLoc=k[2],y.afterLoc=k[3]),this.tryEntries.push(y)}function K(k){var y=k.completion||{};y.type="normal",delete y.arg,k.completion=y}function N(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(F,this),this.reset(!0)}function X(k){if(k||k===""){var y=k[n];if(y)return y.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var C=-1,B=function I(){for(;++C<k.length;)if(s.call(k,C))return I.value=k[C],I.done=!1,I;return I.value=e,I.done=!0,I};return B.next=B}}throw new TypeError(ni(k)+" is not iterable")}return m.prototype=w,l(x,"constructor",{value:w,configurable:!0}),l(w,"constructor",{value:m,configurable:!0}),m.displayName=o(w,g,"GeneratorFunction"),i.isGeneratorFunction=function(k){var y=typeof k=="function"&&k.constructor;return!!y&&(y===m||(y.displayName||y.name)==="GeneratorFunction")},i.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,o(k,g,"GeneratorFunction")),k.prototype=Object.create(x),k},i.awrap=function(k){return{__await:k}},E(D.prototype),o(D.prototype,h,function(){return this}),i.AsyncIterator=D,i.async=function(k,y,C,B,I){I===void 0&&(I=Promise);var R=new D(c(k,y,C,B),I);return i.isGeneratorFunction(y)?R:R.next().then(function(H){return H.done?H.value:R.next()})},E(x),o(x,g,"Generator"),o(x,n,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),i.keys=function(k){var y=Object(k),C=[];for(var B in y)C.push(B);return C.reverse(),function I(){for(;C.length;){var R=C.pop();if(R in y)return I.value=R,I.done=!1,I}return I.done=!0,I}},i.values=X,N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!y)for(var C in this)C.charAt(0)==="t"&&s.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=e)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var C=this;function B(P,M){return H.type="throw",H.arg=y,C.next=P,M&&(C.method="next",C.arg=e),!!M}for(var I=this.tryEntries.length-1;I>=0;--I){var R=this.tryEntries[I],H=R.completion;if(R.tryLoc==="root")return B("end");if(R.tryLoc<=this.prev){var $=s.call(R,"catchLoc"),q=s.call(R,"finallyLoc");if($&&q){if(this.prev<R.catchLoc)return B(R.catchLoc,!0);if(this.prev<R.finallyLoc)return B(R.finallyLoc)}else if($){if(this.prev<R.catchLoc)return B(R.catchLoc,!0)}else{if(!q)throw Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return B(R.finallyLoc)}}}},abrupt:function(y,C){for(var B=this.tryEntries.length-1;B>=0;--B){var I=this.tryEntries[B];if(I.tryLoc<=this.prev&&s.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var R=I;break}}R&&(y==="break"||y==="continue")&&R.tryLoc<=C&&C<=R.finallyLoc&&(R=null);var H=R?R.completion:{};return H.type=y,H.arg=C,R?(this.method="next",this.next=R.finallyLoc,_):this.complete(H)},complete:function(y,C){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&C&&(this.next=C),_},finish:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.finallyLoc===y)return this.complete(B.completion,B.afterLoc),K(B),_}},catch:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.tryLoc===y){var I=B.completion;if(I.type==="throw"){var R=I.arg;K(B)}return R}}throw Error("illegal catch attempt")},delegateYield:function(y,C,B){return this.delegate={iterator:X(y),resultName:C,nextLoc:B},this.method==="next"&&(this.arg=e),_}},i}function oc(e,i,r,s,l,t,n){try{var h=e[t](n),g=h.value}catch(o){return void r(o)}h.done?i(g):Promise.resolve(g).then(s,l)}function nt(e){return function(){var i=this,r=arguments;return new Promise(function(s,l){var t=e.apply(i,r);function n(g){oc(t,s,l,n,h,"next",g)}function h(g){oc(t,s,l,n,h,"throw",g)}n(void 0)})}}function lc(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function ac(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,cg(s.key),s)}}function hc(e,i,r){return i&&ac(e.prototype,i),r&&ac(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cg(e){var i=ug(e,"string");return ni(i)=="symbol"?i:i+""}function ug(e,i){if(ni(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(ni(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var c1=Ei.AESECBCipher=function(){function e(){lc(this,e),this._key=null}return hc(e,[{key:"algorithm",get:function(){return{name:"AES-ECB"}}},{key:"_importKey",value:function(){var i=nt(Se().mark(function s(l,t,n){return Se().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,window.crypto.subtle.importKey("raw",l,{name:"AES-CBC"},t,n);case 2:this._key=g.sent;case 3:case"end":return g.stop()}},s,this)}));function r(s,l,t){return i.apply(this,arguments)}return r}()},{key:"encrypt",value:function(){var i=nt(Se().mark(function s(l,t){var n,h,g,o;return Se().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(n=new Uint8Array(t),!(n.length%16!==0||this._key===null)){f.next=3;break}return f.abrupt("return",null);case 3:h=n.length/16,g=0;case 5:if(!(g<h)){f.next=15;break}return f.t0=Uint8Array,f.next=9,window.crypto.subtle.encrypt({name:"AES-CBC",iv:new Uint8Array(16)},this._key,n.slice(g*16,g*16+16));case 9:f.t1=f.sent,o=new f.t0(f.t1).slice(0,16),n.set(o,g*16);case 12:g++,f.next=5;break;case 15:return f.abrupt("return",n);case 16:case"end":return f.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()}],[{key:"importKey",value:function(){var i=nt(Se().mark(function s(l,t,n,h){var g;return Se().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return g=new e,c.next=3,g._importKey(l,n,h);case 3:return c.abrupt("return",g);case 4:case"end":return c.stop()}},s)}));function r(s,l,t,n){return i.apply(this,arguments)}return r}()}])}(),u1=Ei.AESEAXCipher=function(){function e(){lc(this,e),this._rawKey=null,this._ctrKey=null,this._cbcKey=null,this._zeroBlock=new Uint8Array(16),this._prefixBlock0=this._zeroBlock,this._prefixBlock1=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]),this._prefixBlock2=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2])}return hc(e,[{key:"algorithm",get:function(){return{name:"AES-EAX"}}},{key:"_encryptBlock",value:function(){var i=nt(Se().mark(function s(l){var t;return Se().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,window.crypto.subtle.encrypt({name:"AES-CBC",iv:this._zeroBlock},this._cbcKey,l);case 2:return t=h.sent,h.abrupt("return",new Uint8Array(t).slice(0,16));case 4:case"end":return h.stop()}},s,this)}));function r(s){return i.apply(this,arguments)}return r}()},{key:"_initCMAC",value:function(){var i=nt(Se().mark(function s(){var l,t,n,h,g;return Se().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._encryptBlock(this._zeroBlock);case 2:for(l=c.sent,t=new Uint8Array(16),n=l[0]>>>6,h=0;h<15;h++)t[h]=l[h+1]>>6|l[h]<<2,l[h]=l[h+1]>>7|l[h]<<1;g=[0,135,14,137],t[14]^=n>>>1,t[15]=l[15]<<2^g[n],l[15]=l[15]<<1^g[n>>1],this._k1=l,this._k2=t;case 12:case"end":return c.stop()}},s,this)}));function r(){return i.apply(this,arguments)}return r}()},{key:"_encryptCTR",value:function(){var i=nt(Se().mark(function s(l,t){var n;return Se().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,window.crypto.subtle.encrypt({name:"AES-CTR",counter:t,length:128},this._ctrKey,l);case 2:return n=g.sent,g.abrupt("return",new Uint8Array(n));case 4:case"end":return g.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"_decryptCTR",value:function(){var i=nt(Se().mark(function s(l,t){var n;return Se().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,window.crypto.subtle.decrypt({name:"AES-CTR",counter:t,length:128},this._ctrKey,l);case 2:return n=g.sent,g.abrupt("return",new Uint8Array(n));case 4:case"end":return g.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"_computeCMAC",value:function(){var i=nt(Se().mark(function s(l,t){var n,h,g,o,c,f,v,u;return Se().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t.length===16){d.next=2;break}return d.abrupt("return",null);case 2:if(n=Math.floor(l.length/16),h=Math.ceil(l.length/16),g=l.length-n*16,o=new Uint8Array((h+1)*16),o.set(t),o.set(l,16),g===0)for(c=0;c<16;c++)o[n*16+c]^=this._k1[c];else for(o[(n+1)*16+g]=128,f=0;f<16;f++)o[(n+1)*16+f]^=this._k2[f];return d.next=11,window.crypto.subtle.encrypt({name:"AES-CBC",iv:this._zeroBlock},this._cbcKey,o);case 11:return v=d.sent,v=new Uint8Array(v),u=v.slice(v.length-32,v.length-16),d.abrupt("return",u);case 15:case"end":return d.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"_importKey",value:function(){var i=nt(Se().mark(function s(l){return Se().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._rawKey=l,n.next=3,window.crypto.subtle.importKey("raw",l,{name:"AES-CTR"},!1,["encrypt","decrypt"]);case 3:return this._ctrKey=n.sent,n.next=6,window.crypto.subtle.importKey("raw",l,{name:"AES-CBC"},!1,["encrypt"]);case 6:return this._cbcKey=n.sent,n.next=9,this._initCMAC();case 9:case"end":return n.stop()}},s,this)}));function r(s){return i.apply(this,arguments)}return r}()},{key:"encrypt",value:function(){var i=nt(Se().mark(function s(l,t){var n,h,g,o,c,f,v,u;return Se().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return n=l.additionalData,h=l.iv,d.next=4,this._computeCMAC(h,this._prefixBlock0);case 4:return g=d.sent,d.next=7,this._encryptCTR(t,g);case 7:return o=d.sent,d.next=10,this._computeCMAC(n,this._prefixBlock1);case 10:return c=d.sent,d.next=13,this._computeCMAC(o,this._prefixBlock2);case 13:for(f=d.sent,v=0;v<16;v++)f[v]^=g[v]^c[v];return u=new Uint8Array(16+o.length),u.set(o),u.set(f,o.length),d.abrupt("return",u);case 19:case"end":return d.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"decrypt",value:function(){var i=nt(Se().mark(function s(l,t){var n,h,g,o,c,f,v,u,a,d;return Se().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return n=t.slice(0,t.length-16),h=l.additionalData,g=l.iv,o=t.slice(t.length-16),p.next=6,this._computeCMAC(g,this._prefixBlock0);case 6:return c=p.sent,p.next=9,this._computeCMAC(h,this._prefixBlock1);case 9:return f=p.sent,p.next=12,this._computeCMAC(n,this._prefixBlock2);case 12:for(v=p.sent,u=0;u<16;u++)v[u]^=c[u]^f[u];if(v.length===o.length){p.next=16;break}return p.abrupt("return",null);case 16:a=0;case 17:if(!(a<o.length)){p.next=23;break}if(v[a]===o[a]){p.next=20;break}return p.abrupt("return",null);case 20:a++,p.next=17;break;case 23:return p.next=25,this._decryptCTR(n,c);case 25:return d=p.sent,p.abrupt("return",d);case 27:case"end":return p.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()}],[{key:"importKey",value:function(){var i=nt(Se().mark(function s(l,t,n,h){var g;return Se().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return g=new e,c.next=3,g._importKey(l);case 3:return c.abrupt("return",g);case 4:case"end":return c.stop()}},s)}));function r(s,l,t,n){return i.apply(this,arguments)}return r}()}])}()});var wc=se(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.DESECBCipher=ki.DESCBCCipher=void 0;function cr(e){"@babel/helpers - typeof";return cr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},cr(e)}function xo(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function uc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dg(s.key),s)}}function So(e,i,r){return i&&uc(e.prototype,i),r&&uc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function dg(e){var i=fg(e,"string");return cr(i)=="symbol"?i:i+""}function fg(e,i){if(cr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(cr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var dc=[13,16,10,23,0,4,2,27,14,5,20,9,22,18,11,3,25,7,15,6,26,19,12,1,40,51,30,36,46,54,29,39,50,44,32,47,43,48,38,55,33,52,45,41,49,35,28,31],_g=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],O=0,W,z,Y,j,G,J;W=65536;z=1<<24;Y=W|z;j=4;G=1024;J=j|G;var fc=[Y|G,O|O,W|O,Y|J,Y|j,W|J,O|j,W|O,O|G,Y|G,Y|J,O|G,z|J,Y|j,z|O,O|j,O|J,z|G,z|G,W|G,W|G,Y|O,Y|O,z|J,W|j,z|j,z|j,W|j,O|O,O|J,W|J,z|O,W|O,Y|J,O|j,Y|O,Y|G,z|O,z|O,O|G,Y|j,W|O,W|G,z|j,O|G,O|j,z|J,W|J,Y|J,W|j,Y|O,z|J,z|j,O|J,W|J,Y|G,O|J,z|G,z|G,O|O,W|j,W|G,O|O,Y|j];W=1<<20;z=1<<31;Y=W|z;j=32;G=32768;J=j|G;var _c=[Y|J,z|G,O|G,W|J,W|O,O|j,Y|j,z|J,z|j,Y|J,Y|G,z|O,z|G,W|O,O|j,Y|j,W|G,W|j,z|J,O|O,z|O,O|G,W|J,Y|O,W|j,z|j,O|O,W|G,O|J,Y|G,Y|O,O|J,O|O,W|J,Y|j,W|O,z|J,Y|O,Y|G,O|G,Y|O,z|G,O|j,Y|J,W|J,O|j,O|G,z|O,O|J,Y|G,W|O,z|j,W|j,z|J,z|j,W|j,W|G,O|O,z|G,O|J,z|O,Y|j,Y|J,W|G];W=1<<17;z=1<<27;Y=W|z;j=8;G=512;J=j|G;var gc=[O|J,Y|G,O|O,Y|j,z|G,O|O,W|J,z|G,W|j,z|j,z|j,W|O,Y|J,W|j,Y|O,O|J,z|O,O|j,Y|G,O|G,W|G,Y|O,Y|j,W|J,z|J,W|G,W|O,z|J,O|j,Y|J,O|G,z|O,Y|G,z|O,W|j,O|J,W|O,Y|G,z|G,O|O,O|G,W|j,Y|J,z|G,z|j,O|G,O|O,Y|j,z|J,W|O,z|O,Y|J,O|j,W|J,W|G,z|j,Y|O,z|J,O|J,Y|O,W|J,O|j,Y|j,W|G];W=8192;z=1<<23;Y=W|z;j=1;G=128;J=j|G;var pc=[Y|j,W|J,W|J,O|G,Y|G,z|J,z|j,W|j,O|O,Y|O,Y|O,Y|J,O|J,O|O,z|G,z|j,O|j,W|O,z|O,Y|j,O|G,z|O,W|j,W|G,z|J,O|j,W|G,z|G,W|O,Y|G,Y|J,O|J,z|G,z|j,Y|O,Y|J,O|J,O|O,O|O,Y|O,W|G,z|G,z|J,O|j,Y|j,W|J,W|J,O|G,Y|J,O|J,O|j,W|O,z|j,W|j,Y|G,z|J,W|j,W|G,z|O,Y|j,O|G,z|O,W|O,Y|G];W=1<<25;z=1<<30;Y=W|z;j=256;G=1<<19;J=j|G;var vc=[O|j,W|J,W|G,Y|j,O|G,O|j,z|O,W|G,z|J,O|G,W|j,z|J,Y|j,Y|G,O|J,z|O,W|O,z|G,z|G,O|O,z|j,Y|J,Y|J,W|j,Y|G,z|j,O|O,Y|O,W|J,W|O,Y|O,O|J,O|G,Y|j,O|j,W|O,z|O,W|G,Y|j,z|J,W|j,z|O,Y|G,W|J,z|J,O|j,W|O,Y|G,Y|J,O|J,Y|O,Y|J,W|G,O|O,z|G,Y|O,O|J,W|j,z|j,O|G,O|O,z|G,W|J,z|j];W=1<<22;z=1<<29;Y=W|z;j=16;G=16384;J=j|G;var mc=[z|j,Y|O,O|G,Y|J,Y|O,O|j,Y|J,W|O,z|G,W|J,W|O,z|j,W|j,z|G,z|O,O|J,O|O,W|j,z|J,O|G,W|G,z|J,O|j,Y|j,Y|j,O|O,W|J,Y|G,O|J,W|G,Y|G,z|O,z|G,O|j,Y|j,W|G,Y|J,W|O,O|J,z|j,W|O,z|G,z|O,O|J,z|j,Y|J,W|G,Y|O,W|J,Y|G,O|O,Y|j,O|j,O|G,Y|O,W|J,O|G,W|j,z|J,O|O,Y|G,z|O,W|j,z|J];W=1<<21;z=1<<26;Y=W|z;j=2;G=2048;J=j|G;var yc=[W|O,Y|j,z|J,O|O,O|G,z|J,W|J,Y|G,Y|J,W|O,O|O,z|j,O|j,z|O,Y|j,O|J,z|G,W|J,W|j,z|G,z|j,Y|O,Y|G,W|j,Y|O,O|G,O|J,Y|J,W|G,O|j,z|O,W|G,z|O,W|G,W|O,z|J,z|J,Y|j,Y|j,O|j,W|j,z|O,z|G,W|O,Y|G,O|J,W|J,Y|G,O|J,z|j,Y|J,Y|O,W|G,O|O,O|j,Y|J,O|O,W|J,Y|O,O|G,z|j,z|G,O|G,W|j];W=1<<18;z=1<<28;Y=W|z;j=64;G=4096;J=j|G;var bc=[z|J,O|G,W|O,Y|J,z|O,z|J,O|j,z|O,W|j,Y|O,Y|J,W|G,Y|G,W|J,O|G,O|j,Y|O,z|j,z|G,O|J,W|G,W|j,Y|j,Y|G,O|J,O|O,O|O,Y|j,z|j,z|G,W|J,W|O,W|J,W|O,Y|G,O|G,O|j,Y|j,O|G,W|J,z|G,O|j,z|j,Y|O,Y|j,z|O,W|O,z|J,O|O,Y|J,W|j,z|j,Y|O,z|G,z|J,O|O,Y|J,W|G,W|G,O|J,O|J,W|j,z|O,Y|G],Ac=function(){function e(i){xo(this,e),this.keys=[];for(var r=[],s=[],l=[],t=0,n=56;t<56;++t,n-=8){n+=n<-5?65:n<-3?31:n<-1?63:n===27?35:0;var h=n&7;r[t]=(i[n>>>3]&1<<h)!==0?1:0}for(var g=0;g<16;++g){var o=g<<1,c=o+1;l[o]=l[c]=0;for(var f=28;f<59;f+=28)for(var v=f-28;v<f;++v){var u=v+_g[g];s[v]=u<f?r[u]:r[u-28]}for(var a=0;a<24;++a)s[dc[a]]!==0&&(l[o]|=1<<23-a),s[dc[a+24]]!==0&&(l[c]|=1<<23-a)}for(var d=0,_=0,p=0;d<16;++d){var m=l[_++],w=l[_++];this.keys[p]=(m&16515072)<<6,this.keys[p]|=(m&4032)<<10,this.keys[p]|=(w&16515072)>>>10,this.keys[p]|=(w&4032)>>>6,++p,this.keys[p]=(m&258048)<<12,this.keys[p]|=(m&63)<<16,this.keys[p]|=(w&258048)>>>4,this.keys[p]|=w&63,++p}}return So(e,[{key:"enc8",value:function(r){var s=r.slice(),l=0,t,n,h;t=s[l++]<<24|s[l++]<<16|s[l++]<<8|s[l++],n=s[l++]<<24|s[l++]<<16|s[l++]<<8|s[l++],h=(t>>>4^n)&252645135,n^=h,t^=h<<4,h=(t>>>16^n)&65535,n^=h,t^=h<<16,h=(n>>>2^t)&858993459,t^=h,n^=h<<2,h=(n>>>8^t)&16711935,t^=h,n^=h<<8,n=n<<1|n>>>31&1,h=(t^n)&2863311530,t^=h,n^=h,t=t<<1|t>>>31&1;for(var g=0,o=0;g<8;++g){h=n<<28|n>>>4,h^=this.keys[o++];var c=yc[h&63];c|=vc[h>>>8&63],c|=gc[h>>>16&63],c|=fc[h>>>24&63],h=n^this.keys[o++],c|=bc[h&63],c|=mc[h>>>8&63],c|=pc[h>>>16&63],c|=_c[h>>>24&63],t^=c,h=t<<28|t>>>4,h^=this.keys[o++],c=yc[h&63],c|=vc[h>>>8&63],c|=gc[h>>>16&63],c|=fc[h>>>24&63],h=t^this.keys[o++],c|=bc[h&63],c|=mc[h>>>8&63],c|=pc[h>>>16&63],c|=_c[h>>>24&63],n^=c}for(n=n<<31|n>>>1,h=(t^n)&2863311530,t^=h,n^=h,t=t<<31|t>>>1,h=(t>>>8^n)&16711935,n^=h,t^=h<<8,h=(t>>>2^n)&858993459,n^=h,t^=h<<2,h=(n>>>16^t)&65535,t^=h,n^=h<<16,h=(n>>>4^t)&252645135,t^=h,n^=h<<4,h=[n,t],l=0;l<8;l++)s[l]=(h[l>>>2]>>>8*(3-l%4))%256,s[l]<0&&(s[l]+=256);return s}}])}(),f1=ki.DESECBCipher=function(){function e(){xo(this,e),this._cipher=null}return So(e,[{key:"algorithm",get:function(){return{name:"DES-ECB"}}},{key:"_importKey",value:function(r,s,l){this._cipher=new Ac(r)}},{key:"encrypt",value:function(r,s){var l=new Uint8Array(s);if(l.length%8!==0||this._cipher===null)return null;for(var t=l.length/8,n=0;n<t;n++)l.set(this._cipher.enc8(l.slice(n*8,n*8+8)),n*8);return l}}],[{key:"importKey",value:function(r,s,l,t){var n=new e;return n._importKey(r),n}}])}(),_1=ki.DESCBCCipher=function(){function e(){xo(this,e),this._cipher=null}return So(e,[{key:"algorithm",get:function(){return{name:"DES-CBC"}}},{key:"_importKey",value:function(r){this._cipher=new Ac(r)}},{key:"encrypt",value:function(r,s){var l=new Uint8Array(s),t=new Uint8Array(r.iv);if(l.length%8!==0||this._cipher===null)return null;for(var n=l.length/8,h=0;h<n;h++){for(var g=0;g<8;g++)t[g]^=s[h*8+g];t=this._cipher.enc8(t),l.set(t,h*8)}return l}}],[{key:"importKey",value:function(r,s,l,t){var n=new e;return n._importKey(r),n}}])}()});var Eo=se(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.bigIntToU8Array=pg;ur.modPow=gg;ur.u8ArrayToBigInt=vg;function gg(e,i,r){var s=1n;for(e=e%r;i>0n;)(i&1n)===1n&&(s=s*e%r),i=i>>1n,e=e*e%r;return s}function pg(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e.toString(16);i===0&&(i=Math.ceil(r.length/2)),r=r.padStart(i*2,"0");for(var s=r.length/2,l=new Uint8Array(s),t=0;t<s;t++)l[t]=parseInt(r.slice(t*2,t*2+2),16);return l}function vg(e){for(var i="0x",r=0;r<e.length;r++)i+=e[r].toString(16).padStart(2,"0");return BigInt(i)}});var Sc=se(fs=>{"use strict";Object.defineProperty(fs,"__esModule",{value:!0});fs.RSACipher=void 0;var mg=yg(Tn()),ut=Eo();function yg(e){return e&&e.__esModule?e:{default:e}}function ai(e){"@babel/helpers - typeof";return ai=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ai(e)}function je(){"use strict";je=function(){return i};var e,i={},r=Object.prototype,s=r.hasOwnProperty,l=Object.defineProperty||function(k,y,C){k[y]=C.value},t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",h=t.asyncIterator||"@@asyncIterator",g=t.toStringTag||"@@toStringTag";function o(k,y,C){return Object.defineProperty(k,y,{value:C,enumerable:!0,configurable:!0,writable:!0}),k[y]}try{o({},"")}catch{o=function(C,B,I){return C[B]=I}}function c(k,y,C,B){var I=y&&y.prototype instanceof p?y:p,R=Object.create(I.prototype),H=new N(B||[]);return l(R,"_invoke",{value:L(k,C,H)}),R}function f(k,y,C){try{return{type:"normal",arg:k.call(y,C)}}catch(B){return{type:"throw",arg:B}}}i.wrap=c;var v="suspendedStart",u="suspendedYield",a="executing",d="completed",_={};function p(){}function m(){}function w(){}var b={};o(b,n,function(){return this});var S=Object.getPrototypeOf,A=S&&S(S(X([])));A&&A!==r&&s.call(A,n)&&(b=A);var x=w.prototype=p.prototype=Object.create(b);function E(k){["next","throw","return"].forEach(function(y){o(k,y,function(C){return this._invoke(y,C)})})}function D(k,y){function C(I,R,H,$){var q=f(k[I],k,R);if(q.type!=="throw"){var P=q.arg,M=P.value;return M&&ai(M)=="object"&&s.call(M,"__await")?y.resolve(M.__await).then(function(U){C("next",U,H,$)},function(U){C("throw",U,H,$)}):y.resolve(M).then(function(U){P.value=U,H(P)},function(U){return C("throw",U,H,$)})}$(q.arg)}var B;l(this,"_invoke",{value:function(R,H){function $(){return new y(function(q,P){C(R,H,q,P)})}return B=B?B.then($,$):$()}})}function L(k,y,C){var B=v;return function(I,R){if(B===a)throw Error("Generator is already running");if(B===d){if(I==="throw")throw R;return{value:e,done:!0}}for(C.method=I,C.arg=R;;){var H=C.delegate;if(H){var $=T(H,C);if($){if($===_)continue;return $}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(B===v)throw B=d,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);B=a;var q=f(k,y,C);if(q.type==="normal"){if(B=C.done?d:u,q.arg===_)continue;return{value:q.arg,done:C.done}}q.type==="throw"&&(B=d,C.method="throw",C.arg=q.arg)}}}function T(k,y){var C=y.method,B=k.iterator[C];if(B===e)return y.delegate=null,C==="throw"&&k.iterator.return&&(y.method="return",y.arg=e,T(k,y),y.method==="throw")||C!=="return"&&(y.method="throw",y.arg=new TypeError("The iterator does not provide a '"+C+"' method")),_;var I=f(B,k.iterator,y.arg);if(I.type==="throw")return y.method="throw",y.arg=I.arg,y.delegate=null,_;var R=I.arg;return R?R.done?(y[k.resultName]=R.value,y.next=k.nextLoc,y.method!=="return"&&(y.method="next",y.arg=e),y.delegate=null,_):R:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,_)}function F(k){var y={tryLoc:k[0]};1 in k&&(y.catchLoc=k[1]),2 in k&&(y.finallyLoc=k[2],y.afterLoc=k[3]),this.tryEntries.push(y)}function K(k){var y=k.completion||{};y.type="normal",delete y.arg,k.completion=y}function N(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(F,this),this.reset(!0)}function X(k){if(k||k===""){var y=k[n];if(y)return y.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var C=-1,B=function I(){for(;++C<k.length;)if(s.call(k,C))return I.value=k[C],I.done=!1,I;return I.value=e,I.done=!0,I};return B.next=B}}throw new TypeError(ai(k)+" is not iterable")}return m.prototype=w,l(x,"constructor",{value:w,configurable:!0}),l(w,"constructor",{value:m,configurable:!0}),m.displayName=o(w,g,"GeneratorFunction"),i.isGeneratorFunction=function(k){var y=typeof k=="function"&&k.constructor;return!!y&&(y===m||(y.displayName||y.name)==="GeneratorFunction")},i.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,o(k,g,"GeneratorFunction")),k.prototype=Object.create(x),k},i.awrap=function(k){return{__await:k}},E(D.prototype),o(D.prototype,h,function(){return this}),i.AsyncIterator=D,i.async=function(k,y,C,B,I){I===void 0&&(I=Promise);var R=new D(c(k,y,C,B),I);return i.isGeneratorFunction(y)?R:R.next().then(function(H){return H.done?H.value:R.next()})},E(x),o(x,g,"Generator"),o(x,n,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),i.keys=function(k){var y=Object(k),C=[];for(var B in y)C.push(B);return C.reverse(),function I(){for(;C.length;){var R=C.pop();if(R in y)return I.value=R,I.done=!1,I}return I.done=!0,I}},i.values=X,N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!y)for(var C in this)C.charAt(0)==="t"&&s.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=e)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var C=this;function B(P,M){return H.type="throw",H.arg=y,C.next=P,M&&(C.method="next",C.arg=e),!!M}for(var I=this.tryEntries.length-1;I>=0;--I){var R=this.tryEntries[I],H=R.completion;if(R.tryLoc==="root")return B("end");if(R.tryLoc<=this.prev){var $=s.call(R,"catchLoc"),q=s.call(R,"finallyLoc");if($&&q){if(this.prev<R.catchLoc)return B(R.catchLoc,!0);if(this.prev<R.finallyLoc)return B(R.finallyLoc)}else if($){if(this.prev<R.catchLoc)return B(R.catchLoc,!0)}else{if(!q)throw Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return B(R.finallyLoc)}}}},abrupt:function(y,C){for(var B=this.tryEntries.length-1;B>=0;--B){var I=this.tryEntries[B];if(I.tryLoc<=this.prev&&s.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var R=I;break}}R&&(y==="break"||y==="continue")&&R.tryLoc<=C&&C<=R.finallyLoc&&(R=null);var H=R?R.completion:{};return H.type=y,H.arg=C,R?(this.method="next",this.next=R.finallyLoc,_):this.complete(H)},complete:function(y,C){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&C&&(this.next=C),_},finish:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.finallyLoc===y)return this.complete(B.completion,B.afterLoc),K(B),_}},catch:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.tryLoc===y){var I=B.completion;if(I.type==="throw"){var R=I.arg;K(B)}return R}}throw Error("illegal catch attempt")},delegateYield:function(y,C,B){return this.delegate={iterator:X(y),resultName:C,nextLoc:B},this.method==="next"&&(this.arg=e),_}},i}function Cc(e,i,r,s,l,t,n){try{var h=e[t](n),g=h.value}catch(o){return void r(o)}h.done?i(g):Promise.resolve(g).then(s,l)}function oi(e){return function(){var i=this,r=arguments;return new Promise(function(s,l){var t=e.apply(i,r);function n(g){Cc(t,s,l,n,h,"next",g)}function h(g){Cc(t,s,l,n,h,"throw",g)}n(void 0)})}}function bg(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function xc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,wg(s.key),s)}}function Ag(e,i,r){return i&&xc(e.prototype,i),r&&xc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function wg(e){var i=Cg(e,"string");return ai(i)=="symbol"?i:i+""}function Cg(e,i){if(ai(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(ai(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var v1=fs.RSACipher=function(){function e(){bg(this,e),this._keyLength=0,this._keyBytes=0,this._n=null,this._e=null,this._d=null,this._nBigInt=null,this._eBigInt=null,this._dBigInt=null,this._extractable=!1}return Ag(e,[{key:"algorithm",get:function(){return{name:"RSA-PKCS1-v1_5"}}},{key:"_base64urlDecode",value:function(r){return r=r.replace(/-/g,"+").replace(/_/g,"/"),r=r.padEnd(Math.ceil(r.length/4)*4,"="),mg.default.decode(r)}},{key:"_padArray",value:function(r,s){var l=new Uint8Array(s);return l.set(r,s-r.length),l}},{key:"_generateKey",value:function(){var i=oi(je().mark(function s(l,t){var n,h;return je().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this._keyLength=l.modulusLength,this._keyBytes=Math.ceil(this._keyLength/8),o.next=4,window.crypto.subtle.generateKey({name:"RSA-OAEP",modulusLength:l.modulusLength,publicExponent:l.publicExponent,hash:{name:"SHA-256"}},!0,["encrypt","decrypt"]);case 4:return n=o.sent,o.next=7,window.crypto.subtle.exportKey("jwk",n.privateKey);case 7:h=o.sent,this._n=this._padArray(this._base64urlDecode(h.n),this._keyBytes),this._nBigInt=(0,ut.u8ArrayToBigInt)(this._n),this._e=this._padArray(this._base64urlDecode(h.e),this._keyBytes),this._eBigInt=(0,ut.u8ArrayToBigInt)(this._e),this._d=this._padArray(this._base64urlDecode(h.d),this._keyBytes),this._dBigInt=(0,ut.u8ArrayToBigInt)(this._d),this._extractable=t;case 15:case"end":return o.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"_importKey",value:function(){var i=oi(je().mark(function s(l,t){var n,h;return je().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(n=l.n,h=l.e,n.length===h.length){o.next=4;break}throw new Error("the sizes of modulus and public exponent do not match");case 4:this._keyBytes=n.length,this._keyLength=this._keyBytes*8,this._n=new Uint8Array(this._keyBytes),this._e=new Uint8Array(this._keyBytes),this._n.set(n),this._e.set(h),this._nBigInt=(0,ut.u8ArrayToBigInt)(this._n),this._eBigInt=(0,ut.u8ArrayToBigInt)(this._e),this._extractable=t;case 13:case"end":return o.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"encrypt",value:function(){var i=oi(je().mark(function s(l,t){var n,h,g,o,c;return je().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(t.length>this._keyBytes-11)){v.next=2;break}return v.abrupt("return",null);case 2:for(n=new Uint8Array(this._keyBytes-t.length-3),window.crypto.getRandomValues(n),h=0;h<n.length;h++)n[h]=Math.floor(n[h]*254/255+1);return g=new Uint8Array(this._keyBytes),g[1]=2,g.set(n,2),g.set(t,n.length+3),o=(0,ut.u8ArrayToBigInt)(g),c=(0,ut.modPow)(o,this._eBigInt,this._nBigInt),v.abrupt("return",(0,ut.bigIntToU8Array)(c,this._keyBytes));case 12:case"end":return v.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"decrypt",value:function(){var i=oi(je().mark(function s(l,t){var n,h,g,o;return je().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t.length===this._keyBytes){f.next=2;break}return f.abrupt("return",null);case 2:if(n=(0,ut.u8ArrayToBigInt)(t),h=(0,ut.modPow)(n,this._dBigInt,this._nBigInt),g=(0,ut.bigIntToU8Array)(h,this._keyBytes),!(g[0]!==0||g[1]!==2)){f.next=7;break}return f.abrupt("return",null);case 7:o=2;case 8:if(!(o<g.length)){f.next=14;break}if(g[o]!==0){f.next=11;break}return f.abrupt("break",14);case 11:o++,f.next=8;break;case 14:if(o!==g.length){f.next=16;break}return f.abrupt("return",null);case 16:return f.abrupt("return",g.slice(o+1,g.length));case 17:case"end":return f.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()},{key:"exportKey",value:function(){var i=oi(je().mark(function s(){return je().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this._extractable){t.next=2;break}throw new Error("key is not extractable");case 2:return t.abrupt("return",{n:this._n,e:this._e,d:this._d});case 3:case"end":return t.stop()}},s,this)}));function r(){return i.apply(this,arguments)}return r}()}],[{key:"generateKey",value:function(){var i=oi(je().mark(function s(l,t,n){var h;return je().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return h=new e,o.next=3,h._generateKey(l,t);case 3:return o.abrupt("return",{privateKey:h});case 4:case"end":return o.stop()}},s)}));function r(s,l,t){return i.apply(this,arguments)}return r}()},{key:"importKey",value:function(){var i=oi(je().mark(function s(l,t,n,h){var g;return je().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(!(h.length!==1||h[0]!=="encrypt")){c.next=2;break}throw new Error("only support importing RSA public key");case 2:return g=new e,c.next=5,g._importKey(l,n);case 5:return c.abrupt("return",g);case 6:case"end":return c.stop()}},s)}));function r(s,l,t,n){return i.apply(this,arguments)}return r}()}])}()});var Lc=se(_s=>{"use strict";Object.defineProperty(_s,"__esModule",{value:!0});_s.DHCipher=void 0;var Ut=Eo();function dr(e){"@babel/helpers - typeof";return dr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},dr(e)}function kc(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Ec(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,xg(s.key),s)}}function Bc(e,i,r){return i&&Ec(e.prototype,i),r&&Ec(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xg(e){var i=Sg(e,"string");return dr(i)=="symbol"?i:i+""}function Sg(e,i){if(dr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(dr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Eg=function(){function e(i){kc(this,e),this._key=i}return Bc(e,[{key:"algorithm",get:function(){return{name:"DH"}}},{key:"exportKey",value:function(){return this._key}}])}(),y1=_s.DHCipher=function(){function e(){kc(this,e),this._g=null,this._p=null,this._gBigInt=null,this._pBigInt=null,this._privateKey=null}return Bc(e,[{key:"algorithm",get:function(){return{name:"DH"}}},{key:"_generateKey",value:function(r){var s=r.g,l=r.p;this._keyBytes=l.length,this._gBigInt=(0,Ut.u8ArrayToBigInt)(s),this._pBigInt=(0,Ut.u8ArrayToBigInt)(l),this._privateKey=window.crypto.getRandomValues(new Uint8Array(this._keyBytes)),this._privateKeyBigInt=(0,Ut.u8ArrayToBigInt)(this._privateKey),this._publicKey=(0,Ut.bigIntToU8Array)((0,Ut.modPow)(this._gBigInt,this._privateKeyBigInt,this._pBigInt),this._keyBytes)}},{key:"deriveBits",value:function(r,s){var l=Math.ceil(s/8),t=new Uint8Array(r.public),n=l>this._keyBytes?l:this._keyBytes,h=(0,Ut.modPow)((0,Ut.u8ArrayToBigInt)(t),this._privateKeyBigInt,this._pBigInt);return(0,Ut.bigIntToU8Array)(h,n).slice(0,n)}}],[{key:"generateKey",value:function(r,s){var l=new e;return l._generateKey(r),{privateKey:l,publicKey:new Eg(l._publicKey)}}}])}()});var Ic=se(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.MD5=Bg;function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},gs(e)}function ko(){"use strict";ko=function(){return i};var e,i={},r=Object.prototype,s=r.hasOwnProperty,l=Object.defineProperty||function(k,y,C){k[y]=C.value},t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",h=t.asyncIterator||"@@asyncIterator",g=t.toStringTag||"@@toStringTag";function o(k,y,C){return Object.defineProperty(k,y,{value:C,enumerable:!0,configurable:!0,writable:!0}),k[y]}try{o({},"")}catch{o=function(C,B,I){return C[B]=I}}function c(k,y,C,B){var I=y&&y.prototype instanceof p?y:p,R=Object.create(I.prototype),H=new N(B||[]);return l(R,"_invoke",{value:L(k,C,H)}),R}function f(k,y,C){try{return{type:"normal",arg:k.call(y,C)}}catch(B){return{type:"throw",arg:B}}}i.wrap=c;var v="suspendedStart",u="suspendedYield",a="executing",d="completed",_={};function p(){}function m(){}function w(){}var b={};o(b,n,function(){return this});var S=Object.getPrototypeOf,A=S&&S(S(X([])));A&&A!==r&&s.call(A,n)&&(b=A);var x=w.prototype=p.prototype=Object.create(b);function E(k){["next","throw","return"].forEach(function(y){o(k,y,function(C){return this._invoke(y,C)})})}function D(k,y){function C(I,R,H,$){var q=f(k[I],k,R);if(q.type!=="throw"){var P=q.arg,M=P.value;return M&&gs(M)=="object"&&s.call(M,"__await")?y.resolve(M.__await).then(function(U){C("next",U,H,$)},function(U){C("throw",U,H,$)}):y.resolve(M).then(function(U){P.value=U,H(P)},function(U){return C("throw",U,H,$)})}$(q.arg)}var B;l(this,"_invoke",{value:function(R,H){function $(){return new y(function(q,P){C(R,H,q,P)})}return B=B?B.then($,$):$()}})}function L(k,y,C){var B=v;return function(I,R){if(B===a)throw Error("Generator is already running");if(B===d){if(I==="throw")throw R;return{value:e,done:!0}}for(C.method=I,C.arg=R;;){var H=C.delegate;if(H){var $=T(H,C);if($){if($===_)continue;return $}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(B===v)throw B=d,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);B=a;var q=f(k,y,C);if(q.type==="normal"){if(B=C.done?d:u,q.arg===_)continue;return{value:q.arg,done:C.done}}q.type==="throw"&&(B=d,C.method="throw",C.arg=q.arg)}}}function T(k,y){var C=y.method,B=k.iterator[C];if(B===e)return y.delegate=null,C==="throw"&&k.iterator.return&&(y.method="return",y.arg=e,T(k,y),y.method==="throw")||C!=="return"&&(y.method="throw",y.arg=new TypeError("The iterator does not provide a '"+C+"' method")),_;var I=f(B,k.iterator,y.arg);if(I.type==="throw")return y.method="throw",y.arg=I.arg,y.delegate=null,_;var R=I.arg;return R?R.done?(y[k.resultName]=R.value,y.next=k.nextLoc,y.method!=="return"&&(y.method="next",y.arg=e),y.delegate=null,_):R:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,_)}function F(k){var y={tryLoc:k[0]};1 in k&&(y.catchLoc=k[1]),2 in k&&(y.finallyLoc=k[2],y.afterLoc=k[3]),this.tryEntries.push(y)}function K(k){var y=k.completion||{};y.type="normal",delete y.arg,k.completion=y}function N(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(F,this),this.reset(!0)}function X(k){if(k||k===""){var y=k[n];if(y)return y.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var C=-1,B=function I(){for(;++C<k.length;)if(s.call(k,C))return I.value=k[C],I.done=!1,I;return I.value=e,I.done=!0,I};return B.next=B}}throw new TypeError(gs(k)+" is not iterable")}return m.prototype=w,l(x,"constructor",{value:w,configurable:!0}),l(w,"constructor",{value:m,configurable:!0}),m.displayName=o(w,g,"GeneratorFunction"),i.isGeneratorFunction=function(k){var y=typeof k=="function"&&k.constructor;return!!y&&(y===m||(y.displayName||y.name)==="GeneratorFunction")},i.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,o(k,g,"GeneratorFunction")),k.prototype=Object.create(x),k},i.awrap=function(k){return{__await:k}},E(D.prototype),o(D.prototype,h,function(){return this}),i.AsyncIterator=D,i.async=function(k,y,C,B,I){I===void 0&&(I=Promise);var R=new D(c(k,y,C,B),I);return i.isGeneratorFunction(y)?R:R.next().then(function(H){return H.done?H.value:R.next()})},E(x),o(x,g,"Generator"),o(x,n,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),i.keys=function(k){var y=Object(k),C=[];for(var B in y)C.push(B);return C.reverse(),function I(){for(;C.length;){var R=C.pop();if(R in y)return I.value=R,I.done=!1,I}return I.done=!0,I}},i.values=X,N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!y)for(var C in this)C.charAt(0)==="t"&&s.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=e)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var C=this;function B(P,M){return H.type="throw",H.arg=y,C.next=P,M&&(C.method="next",C.arg=e),!!M}for(var I=this.tryEntries.length-1;I>=0;--I){var R=this.tryEntries[I],H=R.completion;if(R.tryLoc==="root")return B("end");if(R.tryLoc<=this.prev){var $=s.call(R,"catchLoc"),q=s.call(R,"finallyLoc");if($&&q){if(this.prev<R.catchLoc)return B(R.catchLoc,!0);if(this.prev<R.finallyLoc)return B(R.finallyLoc)}else if($){if(this.prev<R.catchLoc)return B(R.catchLoc,!0)}else{if(!q)throw Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return B(R.finallyLoc)}}}},abrupt:function(y,C){for(var B=this.tryEntries.length-1;B>=0;--B){var I=this.tryEntries[B];if(I.tryLoc<=this.prev&&s.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var R=I;break}}R&&(y==="break"||y==="continue")&&R.tryLoc<=C&&C<=R.finallyLoc&&(R=null);var H=R?R.completion:{};return H.type=y,H.arg=C,R?(this.method="next",this.next=R.finallyLoc,_):this.complete(H)},complete:function(y,C){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&C&&(this.next=C),_},finish:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.finallyLoc===y)return this.complete(B.completion,B.afterLoc),K(B),_}},catch:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.tryLoc===y){var I=B.completion;if(I.type==="throw"){var R=I.arg;K(B)}return R}}throw Error("illegal catch attempt")},delegateYield:function(y,C,B){return this.delegate={iterator:X(y),resultName:C,nextLoc:B},this.method==="next"&&(this.arg=e),_}},i}function Dc(e,i,r,s,l,t,n){try{var h=e[t](n),g=h.value}catch(o){return void r(o)}h.done?i(g):Promise.resolve(g).then(s,l)}function kg(e){return function(){var i=this,r=arguments;return new Promise(function(s,l){var t=e.apply(i,r);function n(g){Dc(t,s,l,n,h,"next",g)}function h(g){Dc(t,s,l,n,h,"throw",g)}n(void 0)})}}function Bg(e){return Bo.apply(this,arguments)}function Bo(){return Bo=kg(ko().mark(function e(i){var r,s;return ko().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(r="",s=0;s<i.length;s++)r+=String.fromCharCode(i[s]);return t.abrupt("return",Lg(Ig(Tg(Dg(r),8*r.length))));case 3:case"end":return t.stop()}},e)})),Bo.apply(this,arguments)}function Lg(e){for(var i=new Uint8Array(e.length),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}function Dg(e){for(var i=Array(e.length>>2),r=0;r<i.length;r++)i[r]=0;for(var s=0;s<8*e.length;s+=8)i[s>>5]|=(255&e.charCodeAt(s/8))<<s%32;return i}function Ig(e){for(var i="",r=0;r<32*e.length;r+=8)i+=String.fromCharCode(e[r>>5]>>>r%32&255);return i}function Tg(e,i){e[i>>5]|=128<<i%32,e[14+(i+64>>>9<<4)]=i;for(var r=1732584193,s=-271733879,l=-1732584194,t=271733878,n=0;n<e.length;n+=16){var h=r,g=s,o=l,c=t;s=$e(s=$e(s=$e(s=$e(s=Ue(s=Ue(s=Ue(s=Ue(s=Ne(s=Ne(s=Ne(s=Ne(s=Xe(s=Xe(s=Xe(s=Xe(s,l=Xe(l,t=Xe(t,r=Xe(r,s,l,t,e[n+0],7,-680876936),s,l,e[n+1],12,-389564586),r,s,e[n+2],17,606105819),t,r,e[n+3],22,-1044525330),l=Xe(l,t=Xe(t,r=Xe(r,s,l,t,e[n+4],7,-176418897),s,l,e[n+5],12,1200080426),r,s,e[n+6],17,-1473231341),t,r,e[n+7],22,-45705983),l=Xe(l,t=Xe(t,r=Xe(r,s,l,t,e[n+8],7,1770035416),s,l,e[n+9],12,-1958414417),r,s,e[n+10],17,-42063),t,r,e[n+11],22,-1990404162),l=Xe(l,t=Xe(t,r=Xe(r,s,l,t,e[n+12],7,1804603682),s,l,e[n+13],12,-40341101),r,s,e[n+14],17,-1502002290),t,r,e[n+15],22,1236535329),l=Ne(l,t=Ne(t,r=Ne(r,s,l,t,e[n+1],5,-165796510),s,l,e[n+6],9,-1069501632),r,s,e[n+11],14,643717713),t,r,e[n+0],20,-373897302),l=Ne(l,t=Ne(t,r=Ne(r,s,l,t,e[n+5],5,-701558691),s,l,e[n+10],9,38016083),r,s,e[n+15],14,-660478335),t,r,e[n+4],20,-405537848),l=Ne(l,t=Ne(t,r=Ne(r,s,l,t,e[n+9],5,568446438),s,l,e[n+14],9,-1019803690),r,s,e[n+3],14,-187363961),t,r,e[n+8],20,1163531501),l=Ne(l,t=Ne(t,r=Ne(r,s,l,t,e[n+13],5,-1444681467),s,l,e[n+2],9,-51403784),r,s,e[n+7],14,1735328473),t,r,e[n+12],20,-1926607734),l=Ue(l,t=Ue(t,r=Ue(r,s,l,t,e[n+5],4,-378558),s,l,e[n+8],11,-2022574463),r,s,e[n+11],16,1839030562),t,r,e[n+14],23,-35309556),l=Ue(l,t=Ue(t,r=Ue(r,s,l,t,e[n+1],4,-1530992060),s,l,e[n+4],11,1272893353),r,s,e[n+7],16,-155497632),t,r,e[n+10],23,-1094730640),l=Ue(l,t=Ue(t,r=Ue(r,s,l,t,e[n+13],4,681279174),s,l,e[n+0],11,-358537222),r,s,e[n+3],16,-722521979),t,r,e[n+6],23,76029189),l=Ue(l,t=Ue(t,r=Ue(r,s,l,t,e[n+9],4,-640364487),s,l,e[n+12],11,-421815835),r,s,e[n+15],16,530742520),t,r,e[n+2],23,-995338651),l=$e(l,t=$e(t,r=$e(r,s,l,t,e[n+0],6,-198630844),s,l,e[n+7],10,1126891415),r,s,e[n+14],15,-1416354905),t,r,e[n+5],21,-57434055),l=$e(l,t=$e(t,r=$e(r,s,l,t,e[n+12],6,1700485571),s,l,e[n+3],10,-1894986606),r,s,e[n+10],15,-1051523),t,r,e[n+1],21,-2054922799),l=$e(l,t=$e(t,r=$e(r,s,l,t,e[n+8],6,1873313359),s,l,e[n+15],10,-30611744),r,s,e[n+6],15,-1560198380),t,r,e[n+13],21,1309151649),l=$e(l,t=$e(t,r=$e(r,s,l,t,e[n+4],6,-145523070),s,l,e[n+11],10,-1120210379),r,s,e[n+2],15,718787259),t,r,e[n+9],21,-343485551),r=$t(r,h),s=$t(s,g),l=$t(l,o),t=$t(t,c)}return Array(r,s,l,t)}function ps(e,i,r,s,l,t){return $t(Rg($t($t(i,e),$t(s,t)),l),r)}function Xe(e,i,r,s,l,t,n){return ps(i&r|~i&s,e,i,l,t,n)}function Ne(e,i,r,s,l,t,n){return ps(i&s|r&~s,e,i,l,t,n)}function Ue(e,i,r,s,l,t,n){return ps(i^r^s,e,i,l,t,n)}function $e(e,i,r,s,l,t,n){return ps(r^(i|~s),e,i,l,t,n)}function $t(e,i){var r=(65535&e)+(65535&i);return(e>>16)+(i>>16)+(r>>16)<<16|65535&r}function Rg(e,i){return e<<i|e>>>32-i}});var Do=se(vs=>{"use strict";Object.defineProperty(vs,"__esModule",{value:!0});vs.default=void 0;var Tc=cc(),Rc=wc(),Mg=Sc(),Fg=Lc(),Pg=Ic();function fr(e){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},fr(e)}function Og(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Mc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Qg(s.key),s)}}function Hg(e,i,r){return i&&Mc(e.prototype,i),r&&Mc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qg(e){var i=Kg(e,"string");return fr(i)=="symbol"?i:i+""}function Kg(e,i){if(fr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(fr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Xg=function(){function e(){Og(this,e),this._algorithms={"AES-ECB":Tc.AESECBCipher,"AES-EAX":Tc.AESEAXCipher,"DES-ECB":Rc.DESECBCipher,"DES-CBC":Rc.DESCBCCipher,"RSA-PKCS1-v1_5":Mg.RSACipher,DH:Fg.DHCipher,MD5:Pg.MD5}}return Hg(e,[{key:"encrypt",value:function(r,s,l){if(s.algorithm.name!==r.name)throw new Error("algorithm does not match");if(typeof s.encrypt!="function")throw new Error("key does not support encryption");return s.encrypt(r,l)}},{key:"decrypt",value:function(r,s,l){if(s.algorithm.name!==r.name)throw new Error("algorithm does not match");if(typeof s.decrypt!="function")throw new Error("key does not support encryption");return s.decrypt(r,l)}},{key:"importKey",value:function(r,s,l,t,n){if(r!=="raw")throw new Error("key format is not supported");var h=this._algorithms[l.name];if(typeof h>"u"||typeof h.importKey!="function")throw new Error("algorithm is not supported");return h.importKey(s,l,t,n)}},{key:"generateKey",value:function(r,s,l){var t=this._algorithms[r.name];if(typeof t>"u"||typeof t.generateKey!="function")throw new Error("algorithm is not supported");return t.generateKey(r,s,l)}},{key:"exportKey",value:function(r,s){if(r!=="raw")throw new Error("key format is not supported");if(typeof s.exportKey!="function")throw new Error("key does not support exportKey");return s.exportKey()}},{key:"digest",value:function(r,s){var l=this._algorithms[r];if(typeof l!="function")throw new Error("algorithm is not supported");return l(s)}},{key:"deriveBits",value:function(r,s,l){if(s.algorithm.name!==r.name)throw new Error("algorithm does not match");if(typeof s.deriveBits!="function")throw new Error("key does not support deriveBits");return s.deriveBits(r,l)}}])}(),w1=vs.default=new Xg});var Uc=se(bs=>{"use strict";Object.defineProperty(bs,"__esModule",{value:!0});bs.default=void 0;var Fc=wn(),Ng=Qc(Dn()),Wt=Qc(Do());function Qc(e){return e&&e.__esModule?e:{default:e}}function Ug(e,i,r){return i=ys(i),$g(e,Kc()?Reflect.construct(i,r||[],ys(e).constructor):i.apply(e,r))}function $g(e,i){if(i&&(zt(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wg(e)}function Wg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Kc=function(){return!!e})()}function ys(e){return ys=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},ys(e)}function zg(e,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),i&&Io(e,i)}function Io(e,i){return Io=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Io(e,i)}function zt(e){"@babel/helpers - typeof";return zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},zt(e)}function Bt(){"use strict";Bt=function(){return i};var e,i={},r=Object.prototype,s=r.hasOwnProperty,l=Object.defineProperty||function(k,y,C){k[y]=C.value},t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",h=t.asyncIterator||"@@asyncIterator",g=t.toStringTag||"@@toStringTag";function o(k,y,C){return Object.defineProperty(k,y,{value:C,enumerable:!0,configurable:!0,writable:!0}),k[y]}try{o({},"")}catch{o=function(C,B,I){return C[B]=I}}function c(k,y,C,B){var I=y&&y.prototype instanceof p?y:p,R=Object.create(I.prototype),H=new N(B||[]);return l(R,"_invoke",{value:L(k,C,H)}),R}function f(k,y,C){try{return{type:"normal",arg:k.call(y,C)}}catch(B){return{type:"throw",arg:B}}}i.wrap=c;var v="suspendedStart",u="suspendedYield",a="executing",d="completed",_={};function p(){}function m(){}function w(){}var b={};o(b,n,function(){return this});var S=Object.getPrototypeOf,A=S&&S(S(X([])));A&&A!==r&&s.call(A,n)&&(b=A);var x=w.prototype=p.prototype=Object.create(b);function E(k){["next","throw","return"].forEach(function(y){o(k,y,function(C){return this._invoke(y,C)})})}function D(k,y){function C(I,R,H,$){var q=f(k[I],k,R);if(q.type!=="throw"){var P=q.arg,M=P.value;return M&&zt(M)=="object"&&s.call(M,"__await")?y.resolve(M.__await).then(function(U){C("next",U,H,$)},function(U){C("throw",U,H,$)}):y.resolve(M).then(function(U){P.value=U,H(P)},function(U){return C("throw",U,H,$)})}$(q.arg)}var B;l(this,"_invoke",{value:function(R,H){function $(){return new y(function(q,P){C(R,H,q,P)})}return B=B?B.then($,$):$()}})}function L(k,y,C){var B=v;return function(I,R){if(B===a)throw Error("Generator is already running");if(B===d){if(I==="throw")throw R;return{value:e,done:!0}}for(C.method=I,C.arg=R;;){var H=C.delegate;if(H){var $=T(H,C);if($){if($===_)continue;return $}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(B===v)throw B=d,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);B=a;var q=f(k,y,C);if(q.type==="normal"){if(B=C.done?d:u,q.arg===_)continue;return{value:q.arg,done:C.done}}q.type==="throw"&&(B=d,C.method="throw",C.arg=q.arg)}}}function T(k,y){var C=y.method,B=k.iterator[C];if(B===e)return y.delegate=null,C==="throw"&&k.iterator.return&&(y.method="return",y.arg=e,T(k,y),y.method==="throw")||C!=="return"&&(y.method="throw",y.arg=new TypeError("The iterator does not provide a '"+C+"' method")),_;var I=f(B,k.iterator,y.arg);if(I.type==="throw")return y.method="throw",y.arg=I.arg,y.delegate=null,_;var R=I.arg;return R?R.done?(y[k.resultName]=R.value,y.next=k.nextLoc,y.method!=="return"&&(y.method="next",y.arg=e),y.delegate=null,_):R:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,_)}function F(k){var y={tryLoc:k[0]};1 in k&&(y.catchLoc=k[1]),2 in k&&(y.finallyLoc=k[2],y.afterLoc=k[3]),this.tryEntries.push(y)}function K(k){var y=k.completion||{};y.type="normal",delete y.arg,k.completion=y}function N(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(F,this),this.reset(!0)}function X(k){if(k||k===""){var y=k[n];if(y)return y.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var C=-1,B=function I(){for(;++C<k.length;)if(s.call(k,C))return I.value=k[C],I.done=!1,I;return I.value=e,I.done=!0,I};return B.next=B}}throw new TypeError(zt(k)+" is not iterable")}return m.prototype=w,l(x,"constructor",{value:w,configurable:!0}),l(w,"constructor",{value:m,configurable:!0}),m.displayName=o(w,g,"GeneratorFunction"),i.isGeneratorFunction=function(k){var y=typeof k=="function"&&k.constructor;return!!y&&(y===m||(y.displayName||y.name)==="GeneratorFunction")},i.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,o(k,g,"GeneratorFunction")),k.prototype=Object.create(x),k},i.awrap=function(k){return{__await:k}},E(D.prototype),o(D.prototype,h,function(){return this}),i.AsyncIterator=D,i.async=function(k,y,C,B,I){I===void 0&&(I=Promise);var R=new D(c(k,y,C,B),I);return i.isGeneratorFunction(y)?R:R.next().then(function(H){return H.done?H.value:R.next()})},E(x),o(x,g,"Generator"),o(x,n,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),i.keys=function(k){var y=Object(k),C=[];for(var B in y)C.push(B);return C.reverse(),function I(){for(;C.length;){var R=C.pop();if(R in y)return I.value=R,I.done=!1,I}return I.done=!0,I}},i.values=X,N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!y)for(var C in this)C.charAt(0)==="t"&&s.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=e)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var C=this;function B(P,M){return H.type="throw",H.arg=y,C.next=P,M&&(C.method="next",C.arg=e),!!M}for(var I=this.tryEntries.length-1;I>=0;--I){var R=this.tryEntries[I],H=R.completion;if(R.tryLoc==="root")return B("end");if(R.tryLoc<=this.prev){var $=s.call(R,"catchLoc"),q=s.call(R,"finallyLoc");if($&&q){if(this.prev<R.catchLoc)return B(R.catchLoc,!0);if(this.prev<R.finallyLoc)return B(R.finallyLoc)}else if($){if(this.prev<R.catchLoc)return B(R.catchLoc,!0)}else{if(!q)throw Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return B(R.finallyLoc)}}}},abrupt:function(y,C){for(var B=this.tryEntries.length-1;B>=0;--B){var I=this.tryEntries[B];if(I.tryLoc<=this.prev&&s.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var R=I;break}}R&&(y==="break"||y==="continue")&&R.tryLoc<=C&&C<=R.finallyLoc&&(R=null);var H=R?R.completion:{};return H.type=y,H.arg=C,R?(this.method="next",this.next=R.finallyLoc,_):this.complete(H)},complete:function(y,C){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&C&&(this.next=C),_},finish:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.finallyLoc===y)return this.complete(B.completion,B.afterLoc),K(B),_}},catch:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.tryLoc===y){var I=B.completion;if(I.type==="throw"){var R=I.arg;K(B)}return R}}throw Error("illegal catch attempt")},delegateYield:function(y,C,B){return this.delegate={iterator:X(y),resultName:C,nextLoc:B},this.method==="next"&&(this.arg=e),_}},i}function Pc(e,i,r,s,l,t,n){try{var h=e[t](n),g=h.value}catch(o){return void r(o)}h.done?i(g):Promise.resolve(g).then(s,l)}function ms(e){return function(){var i=this,r=arguments;return new Promise(function(s,l){var t=e.apply(i,r);function n(g){Pc(t,s,l,n,h,"next",g)}function h(g){Pc(t,s,l,n,h,"throw",g)}n(void 0)})}}function Xc(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Oc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jg(s.key),s)}}function Nc(e,i,r){return i&&Oc(e.prototype,i),r&&Oc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function jg(e){var i=Gg(e,"string");return zt(i)=="symbol"?i:i+""}function Gg(e,i){if(zt(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(zt(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Hc=function(){function e(){Xc(this,e),this._cipher=null,this._counter=new Uint8Array(16)}return Nc(e,[{key:"setKey",value:function(){var i=ms(Bt().mark(function s(l){return Bt().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Wt.default.importKey("raw",l,{name:"AES-EAX"},!1,["encrypt, decrypt"]);case 2:this._cipher=n.sent;case 3:case"end":return n.stop()}},s,this)}));function r(s){return i.apply(this,arguments)}return r}()},{key:"makeMessage",value:function(){var i=ms(Bt().mark(function s(l){var t,n,h,g;return Bt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return t=new Uint8Array([(l.length&65280)>>>8,l.length&255]),c.next=3,Wt.default.encrypt({name:"AES-EAX",iv:this._counter,additionalData:t},this._cipher,l);case 3:for(n=c.sent,h=0;h<16&&this._counter[h]++===255;h++);return g=new Uint8Array(l.length+2+16),g.set(t),g.set(n,2),c.abrupt("return",g);case 9:case"end":return c.stop()}},s,this)}));function r(s){return i.apply(this,arguments)}return r}()},{key:"receiveMessage",value:function(){var i=ms(Bt().mark(function s(l,t){var n,h,g;return Bt().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=new Uint8Array([(l&65280)>>>8,l&255]),c.next=3,Wt.default.decrypt({name:"AES-EAX",iv:this._counter,additionalData:n},this._cipher,t);case 3:for(h=c.sent,g=0;g<16&&this._counter[g]++===255;g++);return c.abrupt("return",h);case 6:case"end":return c.stop()}},s,this)}));function r(s,l){return i.apply(this,arguments)}return r}()}])}(),x1=bs.default=function(e){function i(r,s){var l;return Xc(this,i),l=Ug(this,i),l._hasStarted=!1,l._checkSock=null,l._checkCredentials=null,l._approveServerResolve=null,l._sockReject=null,l._credentialsReject=null,l._approveServerReject=null,l._sock=r,l._getCredentials=s,l}return zg(i,e),Nc(i,[{key:"_waitSockAsync",value:function(s){var l=this;return new Promise(function(t,n){var h=function(){return!l._sock.rQwait("RA2",s)};h()?t():(l._checkSock=function(){h()&&(t(),l._checkSock=null,l._sockReject=null)},l._sockReject=n)})}},{key:"_waitApproveKeyAsync",value:function(){var s=this;return new Promise(function(l,t){s._approveServerResolve=l,s._approveServerReject=t})}},{key:"_waitCredentialsAsync",value:function(s){var l=this,t=function(){return s===1&&l._getCredentials().username!==void 0&&l._getCredentials().password!==void 0?!0:s===2&&l._getCredentials().password!==void 0};return new Promise(function(n,h){t()?n():(l._checkCredentials=function(){t()&&(n(),l._checkCredentials=null,l._credentialsReject=null)},l._credentialsReject=h)})}},{key:"checkInternalEvents",value:function(){this._checkSock!==null&&this._checkSock(),this._checkCredentials!==null&&this._checkCredentials()}},{key:"approveServer",value:function(){this._approveServerResolve!==null&&(this._approveServerResolve(),this._approveServerResolve=null)}},{key:"disconnect",value:function(){this._sockReject!==null&&(this._sockReject(new Error("disconnect normally")),this._sockReject=null),this._credentialsReject!==null&&(this._credentialsReject(new Error("disconnect normally")),this._credentialsReject=null),this._approveServerReject!==null&&(this._approveServerReject(new Error("disconnect normally")),this._approveServerReject=null)}},{key:"negotiateRA2neAuthAsync",value:function(){var r=ms(Bt().mark(function l(){var t,n,h,g,o,c,f,v,u,a,d,_,p,m,w,b,S,A,x,E,D,L,T,F,K,N,X,k,y,C,B,I,R,H,$;return Bt().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return this._hasStarted=!0,P.next=3,this._waitSockAsync(4);case 3:if(t=this._sock.rQpeekBytes(4),n=this._sock.rQshift32(),!(n<1024)){P.next=9;break}throw new Error("RA2: server public key is too short: "+n);case 9:if(!(n>8192)){P.next=11;break}throw new Error("RA2: server public key is too long: "+n);case 11:return h=Math.ceil(n/8),P.next=14,this._waitSockAsync(h*2);case 14:return g=this._sock.rQshiftBytes(h),o=this._sock.rQshiftBytes(h),P.next=18,Wt.default.importKey("raw",{n:g,e:o},{name:"RSA-PKCS1-v1_5"},!1,["encrypt"]);case 18:return c=P.sent,f=new Uint8Array(4+h*2),f.set(t),f.set(g,4),f.set(o,4+h),v=this._waitApproveKeyAsync(),this.dispatchEvent(new CustomEvent("serververification",{detail:{type:"RSA",publickey:f}})),P.next=27,v;case 27:return u=2048,a=Math.ceil(u/8),P.next=31,Wt.default.generateKey({name:"RSA-PKCS1-v1_5",modulusLength:u,publicExponent:new Uint8Array([1,0,1])},!0,["encrypt"]);case 31:return d=P.sent.privateKey,P.next=34,Wt.default.exportKey("raw",d);case 34:return _=P.sent,p=_.n,m=_.e,w=new Uint8Array(4+a*2),w[0]=(u&4278190080)>>>24,w[1]=(u&16711680)>>>16,w[2]=(u&65280)>>>8,w[3]=u&255,w.set(p,4),w.set(m,4+a),this._sock.sQpushBytes(w),this._sock.flush(),b=new Uint8Array(16),window.crypto.getRandomValues(b),P.next=50,Wt.default.encrypt({name:"RSA-PKCS1-v1_5"},c,b);case 50:return S=P.sent,A=new Uint8Array(2+h),A[0]=(h&65280)>>>8,A[1]=h&255,A.set(S,2),this._sock.sQpushBytes(A),this._sock.flush(),P.next=59,this._waitSockAsync(2);case 59:if(this._sock.rQshift16()===a){P.next=61;break}throw new Error("RA2: wrong encrypted message length");case 61:return x=this._sock.rQshiftBytes(a),P.next=64,Wt.default.decrypt({name:"RSA-PKCS1-v1_5"},d,x);case 64:if(E=P.sent,!(E===null||E.length!==16)){P.next=67;break}throw new Error("RA2: corrupted server encrypted random");case 67:return D=new Uint8Array(32),L=new Uint8Array(32),D.set(E),D.set(b,16),L.set(b),L.set(E,16),P.next=75,window.crypto.subtle.digest("SHA-1",D);case 75:return D=P.sent,D=new Uint8Array(D).slice(0,16),P.next=79,window.crypto.subtle.digest("SHA-1",L);case 79:return L=P.sent,L=new Uint8Array(L).slice(0,16),T=new Hc,P.next=84,T.setKey(D);case 84:return F=new Hc,P.next=87,F.setKey(L);case 87:return K=new Uint8Array(8+h*2+a*2),N=new Uint8Array(8+h*2+a*2),K.set(f),K.set(w,4+h*2),N.set(w),N.set(f,4+a*2),P.next=95,window.crypto.subtle.digest("SHA-1",K);case 95:return K=P.sent,P.next=98,window.crypto.subtle.digest("SHA-1",N);case 98:return N=P.sent,K=new Uint8Array(K),N=new Uint8Array(N),P.t0=this._sock,P.next=104,T.makeMessage(N);case 104:return P.t1=P.sent,P.t0.sQpushBytes.call(P.t0,P.t1),this._sock.flush(),P.next=109,this._waitSockAsync(38);case 109:if(this._sock.rQshift16()===20){P.next=111;break}throw new Error("RA2: wrong server hash");case 111:return P.next=113,F.receiveMessage(20,this._sock.rQshiftBytes(36));case 113:if(X=P.sent,X!==null){P.next=116;break}throw new Error("RA2: failed to authenticate the message");case 116:k=0;case 117:if(!(k<20)){P.next=123;break}if(X[k]===K[k]){P.next=120;break}throw new Error("RA2: wrong server hash");case 120:k++,P.next=117;break;case 123:return P.next=125,this._waitSockAsync(19);case 125:if(this._sock.rQshift16()===1){P.next=127;break}throw new Error("RA2: wrong subtype");case 127:return P.next=129,F.receiveMessage(1,this._sock.rQshiftBytes(17));case 129:if(y=P.sent,y!==null){P.next=132;break}throw new Error("RA2: failed to authenticate the message");case 132:if(y=y[0],C=this._waitCredentialsAsync(y),y!==1){P.next=138;break}(this._getCredentials().username===void 0||this._getCredentials().password===void 0)&&this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password"]}})),P.next=143;break;case 138:if(y!==2){P.next=142;break}this._getCredentials().password===void 0&&this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["password"]}})),P.next=143;break;case 142:throw new Error("RA2: wrong subtype");case 143:return P.next=145,C;case 145:for(y===1?B=(0,Fc.encodeUTF8)(this._getCredentials().username).slice(0,255):B="",I=(0,Fc.encodeUTF8)(this._getCredentials().password).slice(0,255),R=new Uint8Array(B.length+I.length+2),R[0]=B.length,R[B.length+1]=I.length,H=0;H<B.length;H++)R[H+1]=B.charCodeAt(H);for($=0;$<I.length;$++)R[B.length+2+$]=I.charCodeAt($);return P.t2=this._sock,P.next=155,T.makeMessage(R);case 155:P.t3=P.sent,P.t2.sQpushBytes.call(P.t2,P.t3),this._sock.flush();case 158:case"end":return P.stop()}},l,this)}));function s(){return r.apply(this,arguments)}return s}()},{key:"hasStarted",get:function(){return this._hasStarted},set:function(s){this._hasStarted=s}}])}(Ng.default)});var Wc=se(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});As.default=void 0;function _r(e){"@babel/helpers - typeof";return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},_r(e)}function qg(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function $c(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Yg(s.key),s)}}function Vg(e,i,r){return i&&$c(e.prototype,i),r&&$c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Yg(e){var i=Jg(e,"string");return _r(i)=="symbol"?i:i+""}function Jg(e,i){if(_r(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(_r(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var E1=As.default=function(){function e(){qg(this,e),this._lines=0}return Vg(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){if(l===0||t===0)return!0;this._lines===0&&(this._lines=t);for(var o=g==8?1:4,c=l*o;this._lines>0;){if(n.rQwait("RAW",c))return!1;var f=s+(t-this._lines),v=n.rQshiftBytes(c,!1);if(g==8){for(var u=new Uint8Array(l*4),a=0;a<l;a++)u[a*4+0]=(v[a]>>0&3)*255/3,u[a*4+1]=(v[a]>>2&3)*255/3,u[a*4+2]=(v[a]>>4&3)*255/3,u[a*4+3]=255;v=u}for(var d=0;d<l;d++)v[d*4+3]=255;h.blitImage(r,f,l,1,v,0),this._lines--}return!0}}])}()});var jc=se(ws=>{"use strict";Object.defineProperty(ws,"__esModule",{value:!0});ws.default=void 0;function gr(e){"@babel/helpers - typeof";return gr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},gr(e)}function Zg(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function zc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,tp(s.key),s)}}function ep(e,i,r){return i&&zc(e.prototype,i),r&&zc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tp(e){var i=ip(e,"string");return gr(i)=="symbol"?i:i+""}function ip(e,i){if(gr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(gr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var B1=ws.default=function(){function e(){Zg(this,e)}return ep(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){if(n.rQwait("COPYRECT",4))return!1;var o=n.rQshift16(),c=n.rQshift16();return l===0||t===0||h.copyImage(o,c,r,s,l,t),!0}}])}()});var qc=se(Cs=>{"use strict";Object.defineProperty(Cs,"__esModule",{value:!0});Cs.default=void 0;function pr(e){"@babel/helpers - typeof";return pr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},pr(e)}function rp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Gc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,np(s.key),s)}}function sp(e,i,r){return i&&Gc(e.prototype,i),r&&Gc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function np(e){var i=op(e,"string");return pr(i)=="symbol"?i:i+""}function op(e,i){if(pr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(pr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var D1=Cs.default=function(){function e(){rp(this,e),this._subrects=0}return sp(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){if(this._subrects===0){if(n.rQwait("RRE",8))return!1;this._subrects=n.rQshift32();var o=n.rQshiftBytes(4);h.fillRect(r,s,l,t,o)}for(;this._subrects>0;){if(n.rQwait("RRE",12))return!1;var c=n.rQshiftBytes(4),f=n.rQshift16(),v=n.rQshift16(),u=n.rQshift16(),a=n.rQshift16();h.fillRect(r+f,s+v,u,a,c),this._subrects--}return!0}}])}()});var Jc=se(xs=>{"use strict";Object.defineProperty(xs,"__esModule",{value:!0});xs.default=void 0;var ap=lp(xt());function Yc(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Yc=function(l){return l?r:i})(e)}function lp(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Bi(e)!="object"&&typeof e!="function")return{default:e};var r=Yc(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function Bi(e){"@babel/helpers - typeof";return Bi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Bi(e)}function hp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Vc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,up(s.key),s)}}function cp(e,i,r){return i&&Vc(e.prototype,i),r&&Vc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function up(e){var i=dp(e,"string");return Bi(i)=="symbol"?i:i+""}function dp(e,i){if(Bi(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Bi(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var T1=xs.default=function(){function e(){hp(this,e),this._tiles=0,this._lastsubencoding=0,this._tileBuffer=new Uint8Array(16*16*4)}return cp(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){for(this._tiles===0&&(this._tilesX=Math.ceil(l/16),this._tilesY=Math.ceil(t/16),this._totalTiles=this._tilesX*this._tilesY,this._tiles=this._totalTiles);this._tiles>0;){var o=1;if(n.rQwait("HEXTILE",o))return!1;var c=n.rQpeek8();if(c>30)throw new Error("Illegal hextile subencoding (subencoding: "+c+")");var f=this._totalTiles-this._tiles,v=f%this._tilesX,u=Math.floor(f/this._tilesX),a=r+v*16,d=s+u*16,_=Math.min(16,r+l-a),p=Math.min(16,s+t-d);if(c&1)o+=_*p*4;else if(c&2&&(o+=4),c&4&&(o+=4),c&8){if(o++,n.rQwait("HEXTILE",o))return!1;var m=n.rQpeekBytes(o).at(-1);c&16?o+=m*6:o+=m*2}if(n.rQwait("HEXTILE",o))return!1;if(n.rQshift8(),c===0)this._lastsubencoding&1?ap.Debug("     Ignoring blank after RAW"):h.fillRect(a,d,_,p,this._background);else if(c&1){for(var w=_*p,b=n.rQshiftBytes(w*4,!1),S=0;S<w;S++)b[S*4+3]=255;h.blitImage(a,d,_,p,b,0)}else{if(c&2&&(this._background=new Uint8Array(n.rQshiftBytes(4))),c&4&&(this._foreground=new Uint8Array(n.rQshiftBytes(4))),this._startTile(a,d,_,p,this._background),c&8)for(var A=n.rQshift8(),x=0;x<A;x++){var E=void 0;c&16?E=n.rQshiftBytes(4):E=this._foreground;var D=n.rQshift8(),L=D>>4,T=D&15,F=n.rQshift8(),K=(F>>4)+1,N=(F&15)+1;this._subTile(L,T,K,N,E)}this._finishTile(h)}this._lastsubencoding=c,this._tiles--}return!0}},{key:"_startTile",value:function(r,s,l,t,n){this._tileX=r,this._tileY=s,this._tileW=l,this._tileH=t;for(var h=n[0],g=n[1],o=n[2],c=this._tileBuffer,f=0;f<l*t*4;f+=4)c[f]=h,c[f+1]=g,c[f+2]=o,c[f+3]=255}},{key:"_subTile",value:function(r,s,l,t,n){for(var h=n[0],g=n[1],o=n[2],c=r+l,f=s+t,v=this._tileBuffer,u=this._tileW,a=s;a<f;a++)for(var d=r;d<c;d++){var _=(d+a*u)*4;v[_]=h,v[_+1]=g,v[_+2]=o,v[_+3]=255}}},{key:"_finishTile",value:function(r){r.blitImage(this._tileX,this._tileY,this._tileW,this._tileH,this._tileBuffer,0)}}])}()});var To=se(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});Ss.default=void 0;var fp=pp(xt()),_p=gp(Nr());function gp(e){return e&&e.__esModule?e:{default:e}}function eu(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(eu=function(l){return l?r:i})(e)}function pp(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Li(e)!="object"&&typeof e!="function")return{default:e};var r=eu(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function Li(e){"@babel/helpers - typeof";return Li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Li(e)}function vp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function Zc(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,yp(s.key),s)}}function mp(e,i,r){return i&&Zc(e.prototype,i),r&&Zc(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function yp(e){var i=bp(e,"string");return Li(i)=="symbol"?i:i+""}function bp(e,i){if(Li(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Li(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var M1=Ss.default=function(){function e(){vp(this,e),this._ctl=null,this._filter=null,this._numColors=0,this._palette=new Uint8Array(1024),this._len=0,this._zlibs=[];for(var i=0;i<4;i++)this._zlibs[i]=new _p.default}return mp(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){if(this._ctl===null){if(n.rQwait("TIGHT compression-control",1))return!1;this._ctl=n.rQshift8();for(var o=0;o<4;o++)this._ctl>>o&1&&(this._zlibs[o].reset(),fp.Info("Reset zlib stream "+o));this._ctl=this._ctl>>4}var c;if(this._ctl===8)c=this._fillRect(r,s,l,t,n,h,g);else if(this._ctl===9)c=this._jpegRect(r,s,l,t,n,h,g);else if(this._ctl===10)c=this._pngRect(r,s,l,t,n,h,g);else if((this._ctl&8)==0)c=this._basicRect(this._ctl,r,s,l,t,n,h,g);else throw new Error("Illegal tight compression received (ctl: "+this._ctl+")");return c&&(this._ctl=null),c}},{key:"_fillRect",value:function(r,s,l,t,n,h,g){if(n.rQwait("TIGHT",3))return!1;var o=n.rQshiftBytes(3);return h.fillRect(r,s,l,t,o,!1),!0}},{key:"_jpegRect",value:function(r,s,l,t,n,h,g){var o=this._readData(n);return o===null?!1:(h.imageRect(r,s,l,t,"image/jpeg",o),!0)}},{key:"_pngRect",value:function(r,s,l,t,n,h,g){throw new Error("PNG received in standard Tight rect")}},{key:"_basicRect",value:function(r,s,l,t,n,h,g,o){if(this._filter===null)if(r&4){if(h.rQwait("TIGHT",1))return!1;this._filter=h.rQshift8()}else this._filter=0;var c=r&3,f;switch(this._filter){case 0:f=this._copyFilter(c,s,l,t,n,h,g,o);break;case 1:f=this._paletteFilter(c,s,l,t,n,h,g,o);break;case 2:f=this._gradientFilter(c,s,l,t,n,h,g,o);break;default:throw new Error("Illegal tight filter received (ctl: "+this._filter+")")}return f&&(this._filter=null),f}},{key:"_copyFilter",value:function(r,s,l,t,n,h,g,o){var c=t*n*3,f;if(c===0)return!0;if(c<12){if(h.rQwait("TIGHT",c))return!1;f=h.rQshiftBytes(c)}else{if(f=this._readData(h),f===null)return!1;this._zlibs[r].setInput(f),f=this._zlibs[r].inflate(c),this._zlibs[r].setInput(null)}for(var v=new Uint8Array(t*n*4),u=0,a=0;u<t*n*4;u+=4,a+=3)v[u]=f[a],v[u+1]=f[a+1],v[u+2]=f[a+2],v[u+3]=255;return g.blitImage(s,l,t,n,v,0,!1),!0}},{key:"_paletteFilter",value:function(r,s,l,t,n,h,g,o){if(this._numColors===0){if(h.rQwait("TIGHT palette",1))return!1;var c=h.rQpeek8()+1,f=c*3;if(h.rQwait("TIGHT palette",1+f))return!1;this._numColors=c,h.rQskipBytes(1),h.rQshiftTo(this._palette,f)}var v=this._numColors<=2?1:8,u=Math.floor((t*v+7)/8),a=u*n,d;if(a===0)return!0;if(a<12){if(h.rQwait("TIGHT",a))return!1;d=h.rQshiftBytes(a)}else{if(d=this._readData(h),d===null)return!1;this._zlibs[r].setInput(d),d=this._zlibs[r].inflate(a),this._zlibs[r].setInput(null)}return this._numColors==2?this._monoRect(s,l,t,n,d,this._palette,g):this._paletteRect(s,l,t,n,d,this._palette,g),this._numColors=0,!0}},{key:"_monoRect",value:function(r,s,l,t,n,h,g){for(var o=this._getScratchBuffer(l*t*4),c=Math.floor((l+7)/8),f=Math.floor(l/8),v=0;v<t;v++){var u=void 0,a=void 0,d=void 0;for(d=0;d<f;d++)for(var _=7;_>=0;_--)u=(v*l+d*8+7-_)*4,a=(n[v*c+d]>>_&1)*3,o[u]=h[a],o[u+1]=h[a+1],o[u+2]=h[a+2],o[u+3]=255;for(var p=7;p>=8-l%8;p--)u=(v*l+d*8+7-p)*4,a=(n[v*c+d]>>p&1)*3,o[u]=h[a],o[u+1]=h[a+1],o[u+2]=h[a+2],o[u+3]=255}g.blitImage(r,s,l,t,o,0,!1)}},{key:"_paletteRect",value:function(r,s,l,t,n,h,g){for(var o=this._getScratchBuffer(l*t*4),c=l*t*4,f=0,v=0;f<c;f+=4,v++){var u=n[v]*3;o[f]=h[u],o[f+1]=h[u+1],o[f+2]=h[u+2],o[f+3]=255}g.blitImage(r,s,l,t,o,0,!1)}},{key:"_gradientFilter",value:function(r,s,l,t,n,h,g,o){var c=t*n*3,f;if(c===0)return!0;if(c<12){if(h.rQwait("TIGHT",c))return!1;f=h.rQshiftBytes(c)}else{if(f=this._readData(h),f===null)return!1;this._zlibs[r].setInput(f),f=this._zlibs[r].inflate(c),this._zlibs[r].setInput(null)}for(var v=new Uint8Array(4*t*n),u=0,a=0,d=new Uint8Array(3),_=0;_<t;_++){for(var p=0;p<3;p++){var m=d[p],w=f[a++]+m;v[u++]=w,d[p]=w}v[u++]=255}for(var b=0,S=new Uint8Array(3),A=new Uint8Array(3),x=1;x<n;x++){d.fill(0),A.fill(0);for(var E=0;E<t;E++){for(var D=0;D<3;D++){S[D]=v[b++];var L=d[D]+S[D]-A[D];L<0?L=0:L>255&&(L=255);var T=f[a++]+L;v[u++]=T,A[D]=S[D],d[D]=T}v[u++]=255,b++}}return g.blitImage(s,l,t,n,v,0,!1),!0}},{key:"_readData",value:function(r){if(this._len===0){if(r.rQwait("TIGHT",3))return null;var s;s=r.rQshift8(),this._len=s&127,s&128&&(s=r.rQshift8(),this._len|=(s&127)<<7,s&128&&(s=r.rQshift8(),this._len|=s<<14))}if(r.rQwait("TIGHT",this._len))return null;var l=r.rQshiftBytes(this._len,!1);return this._len=0,l}},{key:"_getScratchBuffer",value:function(r){return(!this._scratchBuffer||this._scratchBuffer.length<r)&&(this._scratchBuffer=new Uint8Array(r)),this._scratchBuffer}}])}()});var ru=se(ks=>{"use strict";function Di(e){"@babel/helpers - typeof";return Di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Di(e)}Object.defineProperty(ks,"__esModule",{value:!0});ks.default=void 0;var Ap=wp(To());function wp(e){return e&&e.__esModule?e:{default:e}}function Cp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function tu(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Sp(s.key),s)}}function xp(e,i,r){return i&&tu(e.prototype,i),r&&tu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Sp(e){var i=Ep(e,"string");return Di(i)=="symbol"?i:i+""}function Ep(e,i){if(Di(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Di(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}function kp(e,i,r){return i=Es(i),Bp(e,iu()?Reflect.construct(i,r||[],Es(e).constructor):i.apply(e,r))}function Bp(e,i){if(i&&(Di(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lp(e)}function Lp(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iu(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iu=function(){return!!e})()}function Es(e){return Es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Es(e)}function Dp(e,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),i&&Ro(e,i)}function Ro(e,i){return Ro=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Ro(e,i)}var P1=ks.default=function(e){function i(){return Cp(this,i),kp(this,i,arguments)}return Dp(i,e),xp(i,[{key:"_pngRect",value:function(s,l,t,n,h,g,o){var c=this._readData(h);return c===null?!1:(g.imageRect(s,l,t,n,"image/png",c),!0)}},{key:"_basicRect",value:function(s,l,t,n,h,g,o,c){throw new Error("BasicCompression received in TightPNG rect")}}])}(Ap.default)});var nu=se(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.default=void 0;var Ip=Tp(Nr());function Tp(e){return e&&e.__esModule?e:{default:e}}function vr(e){"@babel/helpers - typeof";return vr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},vr(e)}function Rp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function su(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Fp(s.key),s)}}function Mp(e,i,r){return i&&su(e.prototype,i),r&&su(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Fp(e){var i=Pp(e,"string");return vr(i)=="symbol"?i:i+""}function Pp(e,i){if(vr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(vr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var Bs=64,Ls=64,H1=Ds.default=function(){function e(){Rp(this,e),this._length=0,this._inflator=new Ip.default,this._pixelBuffer=new Uint8Array(Bs*Ls*4),this._tileBuffer=new Uint8Array(Bs*Ls*4)}return Mp(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){if(this._length===0){if(n.rQwait("ZLib data length",4))return!1;this._length=n.rQshift32()}if(n.rQwait("Zlib data",this._length))return!1;var o=n.rQshiftBytes(this._length,!1);this._inflator.setInput(o);for(var c=s;c<s+t;c+=Ls)for(var f=Math.min(Ls,s+t-c),v=r;v<r+l;v+=Bs){var u=Math.min(Bs,r+l-v),a=u*f,d=this._inflator.inflate(1)[0];if(d===0){var _=this._readPixels(a);h.blitImage(v,c,u,f,_,0,!1)}else if(d===1){var p=this._readPixels(1);h.fillRect(v,c,u,f,[p[0],p[1],p[2]])}else if(d>=2&&d<=16){var m=this._decodePaletteTile(d,a,u,f);h.blitImage(v,c,u,f,m,0,!1)}else if(d===128){var w=this._decodeRLETile(a);h.blitImage(v,c,u,f,w,0,!1)}else if(d>=130&&d<=255){var b=this._decodeRLEPaletteTile(d-128,a);h.blitImage(v,c,u,f,b,0,!1)}else throw new Error("Unknown subencoding: "+d)}return this._length=0,!0}},{key:"_getBitsPerPixelInPalette",value:function(r){if(r<=2)return 1;if(r<=4)return 2;if(r<=16)return 4}},{key:"_readPixels",value:function(r){for(var s=this._pixelBuffer,l=this._inflator.inflate(3*r),t=0,n=0;t<r*4;t+=4,n+=3)s[t]=l[n],s[t+1]=l[n+1],s[t+2]=l[n+2],s[t+3]=255;return s}},{key:"_decodePaletteTile",value:function(r,s,l,t){for(var n=this._tileBuffer,h=this._readPixels(r),g=this._getBitsPerPixelInPalette(r),o=(1<<g)-1,c=0,f=this._inflator.inflate(1)[0],v=0;v<t;v++){for(var u=8-g,a=0;a<l;a++){u<0&&(u=8-g,f=this._inflator.inflate(1)[0]);var d=f>>u&o;n[c]=h[d*4],n[c+1]=h[d*4+1],n[c+2]=h[d*4+2],n[c+3]=h[d*4+3],c+=4,u-=g}u<8-g&&v<t-1&&(f=this._inflator.inflate(1)[0])}return n}},{key:"_decodeRLETile",value:function(r){for(var s=this._tileBuffer,l=0;l<r;)for(var t=this._readPixels(1),n=this._readRLELength(),h=0;h<n;h++)s[l*4]=t[0],s[l*4+1]=t[1],s[l*4+2]=t[2],s[l*4+3]=t[3],l++;return s}},{key:"_decodeRLEPaletteTile",value:function(r,s){for(var l=this._tileBuffer,t=this._readPixels(r),n=0;n<s;){var h=this._inflator.inflate(1)[0],g=1;if(h>=128&&(h-=128,g=this._readRLELength()),h>r)throw new Error("Too big index in palette: "+h+", palette size: "+r);if(n+g>s)throw new Error("Too big rle length in palette mode: "+g+", allowed length is: "+(s-n));for(var o=0;o<g;o++)l[n*4]=t[h*4],l[n*4+1]=t[h*4+1],l[n*4+2]=t[h*4+2],l[n*4+3]=t[h*4+3],n++}return l}},{key:"_readRLELength",value:function(){var r=0,s=0;do s=this._inflator.inflate(1)[0],r+=s;while(s===255);return r+1}}])}()});var hu=se(Is=>{"use strict";Object.defineProperty(Is,"__esModule",{value:!0});Is.default=void 0;function mr(e){"@babel/helpers - typeof";return mr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},mr(e)}function ou(e){return Qp(e)||Hp(e)||lu(e)||Op()}function Op(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hp(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qp(e){if(Array.isArray(e))return Fo(e)}function Mo(e,i){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=lu(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var s=0,l=function(){};return{s:l,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(o){throw o},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var t,n=!0,h=!1;return{s:function(){r=r.call(e)},n:function(){var o=r.next();return n=o.done,o},e:function(o){h=!0,t=o},f:function(){try{n||r.return==null||r.return()}finally{if(h)throw t}}}}function lu(e,i){if(e){if(typeof e=="string")return Fo(e,i);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Fo(e,i):void 0}}function Fo(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,s=Array(i);r<i;r++)s[r]=e[r];return s}function Kp(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function au(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Np(s.key),s)}}function Xp(e,i,r){return i&&au(e.prototype,i),r&&au(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Np(e){var i=Up(e,"string");return mr(i)=="symbol"?i:i+""}function Up(e,i){if(mr(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(mr(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}var K1=Is.default=function(){function e(){Kp(this,e),this._cachedQuantTables=[],this._cachedHuffmanTables=[],this._segments=[]}return Xp(e,[{key:"decodeRect",value:function(r,s,l,t,n,h,g){for(;;){var o=this._readSegment(n);if(o===null)return!1;if(this._segments.push(o),o[1]===217)break}var c=[],f=[],v=Mo(this._segments),u;try{for(v.s();!(u=v.n()).done;){var a=u.value,d=a[1];d===196?c.push(a):d===219&&f.push(a)}}catch(T){v.e(T)}finally{v.f()}var _=this._segments.findIndex(function(T){return T[1]==192||T[1]==194});if(_==-1)throw new Error("Illegal JPEG image without SOF");if(f.length===0){var p;(p=this._segments).splice.apply(p,[_+1,0].concat(ou(this._cachedQuantTables)))}if(c.length===0){var m;(m=this._segments).splice.apply(m,[_+1,0].concat(ou(this._cachedHuffmanTables)))}var w=0,b=Mo(this._segments),S;try{for(b.s();!(S=b.n()).done;){var A=S.value;w+=A.length}}catch(T){b.e(T)}finally{b.f()}var x=new Uint8Array(w);w=0;var E=Mo(this._segments),D;try{for(E.s();!(D=E.n()).done;){var L=D.value;x.set(L,w),w+=L.length}}catch(T){E.e(T)}finally{E.f()}return h.imageRect(r,s,l,t,"image/jpeg",x),c.length!==0&&(this._cachedHuffmanTables=c),f.length!==0&&(this._cachedQuantTables=f),this._segments=[],!0}},{key:"_readSegment",value:function(r){if(r.rQwait("JPEG",2))return null;var s=r.rQshift8();if(s!=255)throw new Error("Illegal JPEG marker received (byte: "+s+")");var l=r.rQshift8();if(l>=208&&l<=217||l==1)return new Uint8Array([s,l]);if(r.rQwait("JPEG",2,2))return null;var t=r.rQshift16();if(t<2)throw new Error("Illegal JPEG length received (length: "+t+")");if(r.rQwait("JPEG",t-2,4))return null;var n=0;if(l===218)for(n+=2;;){if(r.rQwait("JPEG",t-2+n,4))return null;var h=r.rQpeekBytes(t-2+n,!1);if(h.at(-2)===255&&h.at(-1)!==0&&!(h.at(-1)>=208&&h.at(-1)<=215)){n-=2;break}n++}var g=new Uint8Array(2+t+n);return g[0]=s,g[1]=l,g[2]=t>>8,g[3]=t,g.set(r.rQshiftBytes(t-2+n,!1),4),g}}])}()});var Iu=se(Ps=>{"use strict";function Lt(e){"@babel/helpers - typeof";return Lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Lt(e)}Object.defineProperty(Ps,"__esModule",{value:!0});Ps.default=void 0;var ku=bn(),re=hv(xt()),yt=wn(),cu=Oi(),yr=za(),$p=Ln(),Wp=Fe(Dn()),zp=Fe(tl()),jp=Fe(Nr()),Gp=Fe(Ih()),qp=Fe(Wh()),Vp=Fe(qh()),Yp=Fe(Jh()),Jp=Fe(rc()),ot=Fe(wi()),Zp=Fe(sc()),he=nc(),ev=Fe(Uc()),Ve=Fe(Do()),tv=Fe(Wc()),iv=Fe(jc()),rv=Fe(qc()),sv=Fe(Jc()),nv=Fe(To()),ov=Fe(ru()),av=Fe(nu()),lv=Fe(hu());function Fe(e){return e&&e.__esModule?e:{default:e}}function Bu(e){if(typeof WeakMap!="function")return null;var i=new WeakMap,r=new WeakMap;return(Bu=function(l){return l?r:i})(e)}function hv(e,i){if(!i&&e&&e.__esModule)return e;if(e===null||Lt(e)!="object"&&typeof e!="function")return{default:e};var r=Bu(i);if(r&&r.has(e))return r.get(e);var s={__proto__:null},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in e)if(t!=="default"&&{}.hasOwnProperty.call(e,t)){var n=l?Object.getOwnPropertyDescriptor(e,t):null;n&&(n.get||n.set)?Object.defineProperty(s,t,n):s[t]=e[t]}return s.default=e,r&&r.set(e,s),s}function Ho(){"use strict";Ho=function(){return i};var e,i={},r=Object.prototype,s=r.hasOwnProperty,l=Object.defineProperty||function(k,y,C){k[y]=C.value},t=typeof Symbol=="function"?Symbol:{},n=t.iterator||"@@iterator",h=t.asyncIterator||"@@asyncIterator",g=t.toStringTag||"@@toStringTag";function o(k,y,C){return Object.defineProperty(k,y,{value:C,enumerable:!0,configurable:!0,writable:!0}),k[y]}try{o({},"")}catch{o=function(C,B,I){return C[B]=I}}function c(k,y,C,B){var I=y&&y.prototype instanceof p?y:p,R=Object.create(I.prototype),H=new N(B||[]);return l(R,"_invoke",{value:L(k,C,H)}),R}function f(k,y,C){try{return{type:"normal",arg:k.call(y,C)}}catch(B){return{type:"throw",arg:B}}}i.wrap=c;var v="suspendedStart",u="suspendedYield",a="executing",d="completed",_={};function p(){}function m(){}function w(){}var b={};o(b,n,function(){return this});var S=Object.getPrototypeOf,A=S&&S(S(X([])));A&&A!==r&&s.call(A,n)&&(b=A);var x=w.prototype=p.prototype=Object.create(b);function E(k){["next","throw","return"].forEach(function(y){o(k,y,function(C){return this._invoke(y,C)})})}function D(k,y){function C(I,R,H,$){var q=f(k[I],k,R);if(q.type!=="throw"){var P=q.arg,M=P.value;return M&&Lt(M)=="object"&&s.call(M,"__await")?y.resolve(M.__await).then(function(U){C("next",U,H,$)},function(U){C("throw",U,H,$)}):y.resolve(M).then(function(U){P.value=U,H(P)},function(U){return C("throw",U,H,$)})}$(q.arg)}var B;l(this,"_invoke",{value:function(R,H){function $(){return new y(function(q,P){C(R,H,q,P)})}return B=B?B.then($,$):$()}})}function L(k,y,C){var B=v;return function(I,R){if(B===a)throw Error("Generator is already running");if(B===d){if(I==="throw")throw R;return{value:e,done:!0}}for(C.method=I,C.arg=R;;){var H=C.delegate;if(H){var $=T(H,C);if($){if($===_)continue;return $}}if(C.method==="next")C.sent=C._sent=C.arg;else if(C.method==="throw"){if(B===v)throw B=d,C.arg;C.dispatchException(C.arg)}else C.method==="return"&&C.abrupt("return",C.arg);B=a;var q=f(k,y,C);if(q.type==="normal"){if(B=C.done?d:u,q.arg===_)continue;return{value:q.arg,done:C.done}}q.type==="throw"&&(B=d,C.method="throw",C.arg=q.arg)}}}function T(k,y){var C=y.method,B=k.iterator[C];if(B===e)return y.delegate=null,C==="throw"&&k.iterator.return&&(y.method="return",y.arg=e,T(k,y),y.method==="throw")||C!=="return"&&(y.method="throw",y.arg=new TypeError("The iterator does not provide a '"+C+"' method")),_;var I=f(B,k.iterator,y.arg);if(I.type==="throw")return y.method="throw",y.arg=I.arg,y.delegate=null,_;var R=I.arg;return R?R.done?(y[k.resultName]=R.value,y.next=k.nextLoc,y.method!=="return"&&(y.method="next",y.arg=e),y.delegate=null,_):R:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,_)}function F(k){var y={tryLoc:k[0]};1 in k&&(y.catchLoc=k[1]),2 in k&&(y.finallyLoc=k[2],y.afterLoc=k[3]),this.tryEntries.push(y)}function K(k){var y=k.completion||{};y.type="normal",delete y.arg,k.completion=y}function N(k){this.tryEntries=[{tryLoc:"root"}],k.forEach(F,this),this.reset(!0)}function X(k){if(k||k===""){var y=k[n];if(y)return y.call(k);if(typeof k.next=="function")return k;if(!isNaN(k.length)){var C=-1,B=function I(){for(;++C<k.length;)if(s.call(k,C))return I.value=k[C],I.done=!1,I;return I.value=e,I.done=!0,I};return B.next=B}}throw new TypeError(Lt(k)+" is not iterable")}return m.prototype=w,l(x,"constructor",{value:w,configurable:!0}),l(w,"constructor",{value:m,configurable:!0}),m.displayName=o(w,g,"GeneratorFunction"),i.isGeneratorFunction=function(k){var y=typeof k=="function"&&k.constructor;return!!y&&(y===m||(y.displayName||y.name)==="GeneratorFunction")},i.mark=function(k){return Object.setPrototypeOf?Object.setPrototypeOf(k,w):(k.__proto__=w,o(k,g,"GeneratorFunction")),k.prototype=Object.create(x),k},i.awrap=function(k){return{__await:k}},E(D.prototype),o(D.prototype,h,function(){return this}),i.AsyncIterator=D,i.async=function(k,y,C,B,I){I===void 0&&(I=Promise);var R=new D(c(k,y,C,B),I);return i.isGeneratorFunction(y)?R:R.next().then(function(H){return H.done?H.value:R.next()})},E(x),o(x,g,"Generator"),o(x,n,function(){return this}),o(x,"toString",function(){return"[object Generator]"}),i.keys=function(k){var y=Object(k),C=[];for(var B in y)C.push(B);return C.reverse(),function I(){for(;C.length;){var R=C.pop();if(R in y)return I.value=R,I.done=!1,I}return I.done=!0,I}},i.values=X,N.prototype={constructor:N,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(K),!y)for(var C in this)C.charAt(0)==="t"&&s.call(this,C)&&!isNaN(+C.slice(1))&&(this[C]=e)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var C=this;function B(P,M){return H.type="throw",H.arg=y,C.next=P,M&&(C.method="next",C.arg=e),!!M}for(var I=this.tryEntries.length-1;I>=0;--I){var R=this.tryEntries[I],H=R.completion;if(R.tryLoc==="root")return B("end");if(R.tryLoc<=this.prev){var $=s.call(R,"catchLoc"),q=s.call(R,"finallyLoc");if($&&q){if(this.prev<R.catchLoc)return B(R.catchLoc,!0);if(this.prev<R.finallyLoc)return B(R.finallyLoc)}else if($){if(this.prev<R.catchLoc)return B(R.catchLoc,!0)}else{if(!q)throw Error("try statement without catch or finally");if(this.prev<R.finallyLoc)return B(R.finallyLoc)}}}},abrupt:function(y,C){for(var B=this.tryEntries.length-1;B>=0;--B){var I=this.tryEntries[B];if(I.tryLoc<=this.prev&&s.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var R=I;break}}R&&(y==="break"||y==="continue")&&R.tryLoc<=C&&C<=R.finallyLoc&&(R=null);var H=R?R.completion:{};return H.type=y,H.arg=C,R?(this.method="next",this.next=R.finallyLoc,_):this.complete(H)},complete:function(y,C){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&C&&(this.next=C),_},finish:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.finallyLoc===y)return this.complete(B.completion,B.afterLoc),K(B),_}},catch:function(y){for(var C=this.tryEntries.length-1;C>=0;--C){var B=this.tryEntries[C];if(B.tryLoc===y){var I=B.completion;if(I.type==="throw"){var R=I.arg;K(B)}return R}}throw Error("illegal catch attempt")},delegateYield:function(y,C,B){return this.delegate={iterator:X(y),resultName:C,nextLoc:B},this.method==="next"&&(this.arg=e),_}},i}function uu(e,i,r,s,l,t,n){try{var h=e[t](n),g=h.value}catch(o){return void r(o)}h.done?i(g):Promise.resolve(g).then(s,l)}function cv(e){return function(){var i=this,r=arguments;return new Promise(function(s,l){var t=e.apply(i,r);function n(g){uu(t,s,l,n,h,"next",g)}function h(g){uu(t,s,l,n,h,"throw",g)}n(void 0)})}}function uv(e,i){return _v(e)||fv(e,i)||Lu(e,i)||dv()}function dv(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fv(e,i){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,l,t,n,h=[],g=!0,o=!1;try{if(t=(r=r.call(e)).next,i===0){if(Object(r)!==r)return;g=!1}else for(;!(g=(s=t.call(r)).done)&&(h.push(s.value),h.length!==i);g=!0);}catch(c){o=!0,l=c}finally{try{if(!g&&r.return!=null&&(n=r.return(),Object(n)!==n))return}finally{if(o)throw l}}return h}}function _v(e){if(Array.isArray(e))return e}function Po(e,i){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Lu(e))||i&&e&&typeof e.length=="number"){r&&(e=r);var s=0,l=function(){};return{s:l,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(o){throw o},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var t,n=!0,h=!1;return{s:function(){r=r.call(e)},n:function(){var o=r.next();return n=o.done,o},e:function(o){h=!0,t=o},f:function(){try{n||r.return==null||r.return()}finally{if(h)throw t}}}}function Lu(e,i){if(e){if(typeof e=="string")return du(e,i);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?du(e,i):void 0}}function du(e,i){(i==null||i>e.length)&&(i=e.length);for(var r=0,s=Array(i);r<i;r++)s[r]=e[r];return s}function gv(e,i){if(!(e instanceof i))throw new TypeError("Cannot call a class as a function")}function fu(e,i){for(var r=0;r<i.length;r++){var s=i[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,vv(s.key),s)}}function pv(e,i,r){return i&&fu(e.prototype,i),r&&fu(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function vv(e){var i=mv(e,"string");return Lt(i)=="symbol"?i:i+""}function mv(e,i){if(Lt(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,i||"default");if(Lt(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(e)}function yv(e,i,r){return i=Fs(i),bv(e,Du()?Reflect.construct(i,r||[],Fs(e).constructor):i.apply(e,r))}function bv(e,i){if(i&&(Lt(i)=="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Av(e)}function Av(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Du(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Du=function(){return!!e})()}function Fs(e){return Fs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},Fs(e)}function wv(e,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),i&&Qo(e,i)}function Qo(e,i){return Qo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Qo(e,i)}var Cv=3,xv="rgb(40, 40, 40)",_u=17,gu=50,pu=19,br=75,jt=50,Sv=1e3,Ev=50,vu=1,Ts=2,mu=6,yu=16,Oo=19,bu=22,Au=30,wu=113,Cu=129,xu=256,bt=1,Su=1<<24,Rs=1<<25,Eu=1<<26,Ar=1<<27,Ms=1<<28,At=Ps.default=function(e){function i(r,s,l){var t;if(gv(this,i),!r)throw new Error("Must specify target");if(!s)throw new Error("Must specify URL, WebSocket or RTCDataChannel");window.isSecureContext||re.Error("noVNC requires a secure context (TLS). Expect crashes!"),t=yv(this,i),t._target=r,typeof s=="string"?t._url=s:(t._url=null,t._rawChannel=s),l=l||{},t._rfbCredentials=l.credentials||{},t._shared="shared"in l?!!l.shared:!0,t._repeaterID=l.repeaterID||"",t._wsProtocols=l.wsProtocols||[],t._rfbConnectionState="",t._rfbInitState="",t._rfbAuthScheme=-1,t._rfbCleanDisconnect=!0,t._rfbRSAAESAuthenticationState=null,t._rfbVersion=0,t._rfbMaxVersion=3.8,t._rfbTightVNC=!1,t._rfbVeNCryptState=0,t._rfbXvpVer=0,t._fbWidth=0,t._fbHeight=0,t._fbName="",t._capabilities={power:!1},t._supportsFence=!1,t._supportsContinuousUpdates=!1,t._enabledContinuousUpdates=!1,t._supportsSetDesktopSize=!1,t._screenID=0,t._screenFlags=0,t._qemuExtKeyEventSupported=!1,t._clipboardText=null,t._clipboardServerCapabilitiesActions={},t._clipboardServerCapabilitiesFormats={},t._sock=null,t._display=null,t._flushing=!1,t._keyboard=null,t._gestures=null,t._resizeObserver=null,t._disconnTimer=null,t._resizeTimeout=null,t._mouseMoveTimer=null,t._decoders={},t._FBU={rects:0,x:0,y:0,width:0,height:0,encoding:null},t._mousePos={},t._mouseButtonMask=0,t._mouseLastMoveTime=0,t._viewportDragging=!1,t._viewportDragPos={},t._viewportHasMoved=!1,t._accumulatedWheelDeltaX=0,t._accumulatedWheelDeltaY=0,t._gestureLastTapTime=null,t._gestureFirstDoubleTapEv=null,t._gestureLastMagnitudeX=0,t._gestureLastMagnitudeY=0,t._eventHandlers={focusCanvas:t._focusCanvas.bind(t),handleResize:t._handleResize.bind(t),handleMouse:t._handleMouse.bind(t),handleWheel:t._handleWheel.bind(t),handleGesture:t._handleGesture.bind(t),handleRSAAESCredentialsRequired:t._handleRSAAESCredentialsRequired.bind(t),handleRSAAESServerVerification:t._handleRSAAESServerVerification.bind(t)},re.Debug(">> RFB.constructor"),t._screen=document.createElement("div"),t._screen.style.display="flex",t._screen.style.width="100%",t._screen.style.height="100%",t._screen.style.overflow="auto",t._screen.style.background=xv,t._canvas=document.createElement("canvas"),t._canvas.style.margin="auto",t._canvas.style.outline="none",t._canvas.width=0,t._canvas.height=0,t._canvas.tabIndex=-1,t._screen.appendChild(t._canvas),t._cursor=new Yp.default,t._cursorImage=i.cursors.none,t._decoders[he.encodings.encodingRaw]=new tv.default,t._decoders[he.encodings.encodingCopyRect]=new iv.default,t._decoders[he.encodings.encodingRRE]=new rv.default,t._decoders[he.encodings.encodingHextile]=new sv.default,t._decoders[he.encodings.encodingTight]=new nv.default,t._decoders[he.encodings.encodingTightPNG]=new ov.default,t._decoders[he.encodings.encodingZRLE]=new av.default,t._decoders[he.encodings.encodingJPEG]=new lv.default;try{t._display=new zp.default(t._canvas)}catch(n){throw re.Error("Display exception: "+n),n}return t._keyboard=new qp.default(t._canvas),t._keyboard.onkeyevent=t._handleKeyEvent.bind(t),t._remoteCapsLock=null,t._remoteNumLock=null,t._gestures=new Vp.default,t._sock=new Jp.default,t._sock.on("open",t._socketOpen.bind(t)),t._sock.on("close",t._socketClose.bind(t)),t._sock.on("message",t._handleMessage.bind(t)),t._sock.on("error",t._socketError.bind(t)),t._expectedClientWidth=null,t._expectedClientHeight=null,t._resizeObserver=new ResizeObserver(t._eventHandlers.handleResize),t._updateConnectionState("connecting"),re.Debug("<< RFB.constructor"),t.dragViewport=!1,t.focusOnClick=!0,t._viewOnly=!1,t._clipViewport=!1,t._clippingViewport=!1,t._scaleViewport=!1,t._resizeSession=!1,t._showDotCursor=!1,l.showDotCursor!==void 0&&(re.Warn("Specifying showDotCursor as a RFB constructor argument is deprecated"),t._showDotCursor=l.showDotCursor),t._qualityLevel=6,t._compressionLevel=2,t}return wv(i,e),pv(i,[{key:"viewOnly",get:function(){return this._viewOnly},set:function(s){this._viewOnly=s,(this._rfbConnectionState==="connecting"||this._rfbConnectionState==="connected")&&(s?this._keyboard.ungrab():this._keyboard.grab())}},{key:"capabilities",get:function(){return this._capabilities}},{key:"clippingViewport",get:function(){return this._clippingViewport}},{key:"_setClippingViewport",value:function(s){s!==this._clippingViewport&&(this._clippingViewport=s,this.dispatchEvent(new CustomEvent("clippingviewport",{detail:this._clippingViewport})))}},{key:"touchButton",get:function(){return 0},set:function(s){re.Warn("Using old API!")}},{key:"clipViewport",get:function(){return this._clipViewport},set:function(s){this._clipViewport=s,this._updateClip()}},{key:"scaleViewport",get:function(){return this._scaleViewport},set:function(s){this._scaleViewport=s,s&&this._clipViewport&&this._updateClip(),this._updateScale(),!s&&this._clipViewport&&this._updateClip()}},{key:"resizeSession",get:function(){return this._resizeSession},set:function(s){this._resizeSession=s,s&&this._requestRemoteResize()}},{key:"showDotCursor",get:function(){return this._showDotCursor},set:function(s){this._showDotCursor=s,this._refreshCursor()}},{key:"background",get:function(){return this._screen.style.background},set:function(s){this._screen.style.background=s}},{key:"qualityLevel",get:function(){return this._qualityLevel},set:function(s){if(!Number.isInteger(s)||s<0||s>9){re.Error("qualityLevel must be an integer between 0 and 9");return}this._qualityLevel!==s&&(this._qualityLevel=s,this._rfbConnectionState==="connected"&&this._sendEncodings())}},{key:"compressionLevel",get:function(){return this._compressionLevel},set:function(s){if(!Number.isInteger(s)||s<0||s>9){re.Error("compressionLevel must be an integer between 0 and 9");return}this._compressionLevel!==s&&(this._compressionLevel=s,this._rfbConnectionState==="connected"&&this._sendEncodings())}},{key:"disconnect",value:function(){this._updateConnectionState("disconnecting"),this._sock.off("error"),this._sock.off("message"),this._sock.off("open"),this._rfbRSAAESAuthenticationState!==null&&this._rfbRSAAESAuthenticationState.disconnect()}},{key:"approveServer",value:function(){this._rfbRSAAESAuthenticationState!==null&&this._rfbRSAAESAuthenticationState.approveServer()}},{key:"sendCredentials",value:function(s){this._rfbCredentials=s,this._resumeAuthentication()}},{key:"sendCtrlAltDel",value:function(){this._rfbConnectionState!=="connected"||this._viewOnly||(re.Info("Sending Ctrl-Alt-Del"),this.sendKey(ot.default.XK_Control_L,"ControlLeft",!0),this.sendKey(ot.default.XK_Alt_L,"AltLeft",!0),this.sendKey(ot.default.XK_Delete,"Delete",!0),this.sendKey(ot.default.XK_Delete,"Delete",!1),this.sendKey(ot.default.XK_Alt_L,"AltLeft",!1),this.sendKey(ot.default.XK_Control_L,"ControlLeft",!1))}},{key:"machineShutdown",value:function(){this._xvpOp(1,2)}},{key:"machineReboot",value:function(){this._xvpOp(1,3)}},{key:"machineReset",value:function(){this._xvpOp(1,4)}},{key:"sendKey",value:function(s,l,t){if(!(this._rfbConnectionState!=="connected"||this._viewOnly)){if(t===void 0){this.sendKey(s,l,!0),this.sendKey(s,l,!1);return}var n=Zp.default[l];if(this._qemuExtKeyEventSupported&&n)s=s||0,re.Info("Sending key ("+(t?"down":"up")+"): keysym "+s+", scancode "+n),i.messages.QEMUExtendedKeyEvent(this._sock,s,t,n);else{if(!s)return;re.Info("Sending keysym ("+(t?"down":"up")+"): "+s),i.messages.keyEvent(this._sock,s,t?1:0)}}}},{key:"focus",value:function(s){this._canvas.focus(s)}},{key:"blur",value:function(){this._canvas.blur()}},{key:"clipboardPasteFrom",value:function(s){if(!(this._rfbConnectionState!=="connected"||this._viewOnly))if(this._clipboardServerCapabilitiesFormats[bt]&&this._clipboardServerCapabilitiesActions[Ar])this._clipboardText=s,i.messages.extendedClipboardNotify(this._sock,[bt]);else{var l,t,n;l=0;var h=Po(s),g;try{for(h.s();!(g=h.n()).done;){var o=g.value;l++}}catch(a){h.e(a)}finally{h.f()}n=new Uint8Array(l),t=0;var c=Po(s),f;try{for(c.s();!(f=c.n()).done;){var v=f.value,u=v.codePointAt(0);u>255&&(u=63),n[t++]=u}}catch(a){c.e(a)}finally{c.f()}i.messages.clientCutText(this._sock,n)}}},{key:"getImageData",value:function(){return this._display.getImageData()}},{key:"toDataURL",value:function(s,l){return this._display.toDataURL(s,l)}},{key:"toBlob",value:function(s,l,t){return this._display.toBlob(s,l,t)}},{key:"_connect",value:function(){if(re.Debug(">> RFB.connect"),this._url)re.Info("connecting to ".concat(this._url)),this._sock.open(this._url,this._wsProtocols);else{if(re.Info("attaching ".concat(this._rawChannel," to Websock")),this._sock.attach(this._rawChannel),this._sock.readyState==="closed")throw Error("Cannot use already closed WebSocket/RTCDataChannel");this._sock.readyState==="open"&&this._socketOpen()}this._target.appendChild(this._screen),this._gestures.attach(this._canvas),this._cursor.attach(this._canvas),this._refreshCursor(),this._resizeObserver.observe(this._screen),this._canvas.addEventListener("mousedown",this._eventHandlers.focusCanvas),this._canvas.addEventListener("touchstart",this._eventHandlers.focusCanvas),this._canvas.addEventListener("mousedown",this._eventHandlers.handleMouse),this._canvas.addEventListener("mouseup",this._eventHandlers.handleMouse),this._canvas.addEventListener("mousemove",this._eventHandlers.handleMouse),this._canvas.addEventListener("click",this._eventHandlers.handleMouse),this._canvas.addEventListener("contextmenu",this._eventHandlers.handleMouse),this._canvas.addEventListener("wheel",this._eventHandlers.handleWheel),this._canvas.addEventListener("gesturestart",this._eventHandlers.handleGesture),this._canvas.addEventListener("gesturemove",this._eventHandlers.handleGesture),this._canvas.addEventListener("gestureend",this._eventHandlers.handleGesture),re.Debug("<< RFB.connect")}},{key:"_disconnect",value:function(){re.Debug(">> RFB.disconnect"),this._cursor.detach(),this._canvas.removeEventListener("gesturestart",this._eventHandlers.handleGesture),this._canvas.removeEventListener("gesturemove",this._eventHandlers.handleGesture),this._canvas.removeEventListener("gestureend",this._eventHandlers.handleGesture),this._canvas.removeEventListener("wheel",this._eventHandlers.handleWheel),this._canvas.removeEventListener("mousedown",this._eventHandlers.handleMouse),this._canvas.removeEventListener("mouseup",this._eventHandlers.handleMouse),this._canvas.removeEventListener("mousemove",this._eventHandlers.handleMouse),this._canvas.removeEventListener("click",this._eventHandlers.handleMouse),this._canvas.removeEventListener("contextmenu",this._eventHandlers.handleMouse),this._canvas.removeEventListener("mousedown",this._eventHandlers.focusCanvas),this._canvas.removeEventListener("touchstart",this._eventHandlers.focusCanvas),this._resizeObserver.disconnect(),this._keyboard.ungrab(),this._gestures.detach(),this._sock.close();try{this._target.removeChild(this._screen)}catch(s){if(s.name!=="NotFoundError")throw s}clearTimeout(this._resizeTimeout),clearTimeout(this._mouseMoveTimer),re.Debug("<< RFB.disconnect")}},{key:"_socketOpen",value:function(){this._rfbConnectionState==="connecting"&&this._rfbInitState===""?(this._rfbInitState="ProtocolVersion",re.Debug("Starting VNC handshake")):this._fail("Unexpected server connection while "+this._rfbConnectionState)}},{key:"_socketClose",value:function(s){re.Debug("WebSocket on-close event");var l="";switch(s.code&&(l="(code: "+s.code,s.reason&&(l+=", reason: "+s.reason),l+=")"),this._rfbConnectionState){case"connecting":this._fail("Connection closed "+l);break;case"connected":this._updateConnectionState("disconnecting"),this._updateConnectionState("disconnected");break;case"disconnecting":this._updateConnectionState("disconnected");break;case"disconnected":this._fail("Unexpected server disconnect when already disconnected "+l);break;default:this._fail("Unexpected server disconnect before connecting "+l);break}this._sock.off("close"),this._rawChannel=null}},{key:"_socketError",value:function(s){re.Warn("WebSocket on-error event")}},{key:"_focusCanvas",value:function(s){this.focusOnClick&&this.focus({preventScroll:!0})}},{key:"_setDesktopName",value:function(s){this._fbName=s,this.dispatchEvent(new CustomEvent("desktopname",{detail:{name:this._fbName}}))}},{key:"_saveExpectedClientSize",value:function(){this._expectedClientWidth=this._screen.clientWidth,this._expectedClientHeight=this._screen.clientHeight}},{key:"_currentClientSize",value:function(){return[this._screen.clientWidth,this._screen.clientHeight]}},{key:"_clientHasExpectedSize",value:function(){var s=this._currentClientSize(),l=uv(s,2),t=l[0],n=l[1];return t==this._expectedClientWidth&&n==this._expectedClientHeight}},{key:"_handleResize",value:function(){var s=this;this._clientHasExpectedSize()||(window.requestAnimationFrame(function(){s._updateClip(),s._updateScale()}),this._resizeSession&&(clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(this._requestRemoteResize.bind(this),500)))}},{key:"_updateClip",value:function(){var s=this._display.clipViewport,l=this._clipViewport;if(this._scaleViewport&&(l=!1),s!==l&&(this._display.clipViewport=l),l){var t=this._screenSize();this._display.viewportChangeSize(t.w,t.h),this._fixScrollbars(),this._setClippingViewport(t.w<this._display.width||t.h<this._display.height)}else this._setClippingViewport(!1);s!==l&&this._saveExpectedClientSize()}},{key:"_updateScale",value:function(){if(!this._scaleViewport)this._display.scale=1;else{var s=this._screenSize();this._display.autoscale(s.w,s.h)}this._fixScrollbars()}},{key:"_requestRemoteResize",value:function(){if(clearTimeout(this._resizeTimeout),this._resizeTimeout=null,!(!this._resizeSession||this._viewOnly||!this._supportsSetDesktopSize)){var s=this._screenSize();i.messages.setDesktopSize(this._sock,Math.floor(s.w),Math.floor(s.h),this._screenID,this._screenFlags),re.Debug("Requested new desktop size: "+s.w+"x"+s.h)}}},{key:"_screenSize",value:function(){var s=this._screen.getBoundingClientRect();return{w:s.width,h:s.height}}},{key:"_fixScrollbars",value:function(){var s=this._screen.style.overflow;this._screen.style.overflow="hidden",this._screen.getBoundingClientRect(),this._screen.style.overflow=s}},{key:"_updateConnectionState",value:function(s){var l=this,t=this._rfbConnectionState;if(s===t){re.Debug("Already in state '"+s+"', ignoring");return}if(t==="disconnected"){re.Error("Tried changing state of a disconnected RFB object");return}switch(s){case"connected":if(t!=="connecting"){re.Error("Bad transition to connected state, previous connection state: "+t);return}break;case"disconnected":if(t!=="disconnecting"){re.Error("Bad transition to disconnected state, previous connection state: "+t);return}break;case"connecting":if(t!==""){re.Error("Bad transition to connecting state, previous connection state: "+t);return}break;case"disconnecting":if(t!=="connected"&&t!=="connecting"){re.Error("Bad transition to disconnecting state, previous connection state: "+t);return}break;default:re.Error("Unknown connection state: "+s);return}switch(this._rfbConnectionState=s,re.Debug("New state '"+s+"', was '"+t+"'."),this._disconnTimer&&s!=="disconnecting"&&(re.Debug("Clearing disconnect timer"),clearTimeout(this._disconnTimer),this._disconnTimer=null,this._sock.off("close")),s){case"connecting":this._connect();break;case"connected":this.dispatchEvent(new CustomEvent("connect",{detail:{}}));break;case"disconnecting":this._disconnect(),this._disconnTimer=setTimeout(function(){re.Error("Disconnection timed out."),l._updateConnectionState("disconnected")},Cv*1e3);break;case"disconnected":this.dispatchEvent(new CustomEvent("disconnect",{detail:{clean:this._rfbCleanDisconnect}}));break}}},{key:"_fail",value:function(s){switch(this._rfbConnectionState){case"disconnecting":re.Error("Failed when disconnecting: "+s);break;case"connected":re.Error("Failed while connected: "+s);break;case"connecting":re.Error("Failed when connecting: "+s);break;default:re.Error("RFB failure: "+s);break}return this._rfbCleanDisconnect=!1,this._updateConnectionState("disconnecting"),this._updateConnectionState("disconnected"),!1}},{key:"_setCapability",value:function(s,l){this._capabilities[s]=l,this.dispatchEvent(new CustomEvent("capabilities",{detail:{capabilities:this._capabilities}}))}},{key:"_handleMessage",value:function(){if(this._sock.rQwait("message",1)){re.Warn("handleMessage called on an empty receive queue");return}switch(this._rfbConnectionState){case"disconnected":re.Error("Got data while disconnected");break;case"connected":for(;!(this._flushing||!this._normalMsg()||this._sock.rQwait("message",1)););break;case"connecting":for(;this._rfbConnectionState==="connecting"&&this._initMsg(););break;default:re.Error("Got data while in an invalid state");break}}},{key:"_handleKeyEvent",value:function(s,l,t,n,h){l=="CapsLock"&&t&&(this._remoteCapsLock=null),this._remoteCapsLock!==null&&h!==null&&this._remoteCapsLock!==h&&t&&(re.Debug("Fixing remote caps lock"),this.sendKey(ot.default.XK_Caps_Lock,"CapsLock",!0),this.sendKey(ot.default.XK_Caps_Lock,"CapsLock",!1),this._remoteCapsLock=null),l=="NumLock"&&t&&(this._remoteNumLock=null),this._remoteNumLock!==null&&n!==null&&this._remoteNumLock!==n&&t&&(re.Debug("Fixing remote num lock"),this.sendKey(ot.default.XK_Num_Lock,"NumLock",!0),this.sendKey(ot.default.XK_Num_Lock,"NumLock",!1),this._remoteNumLock=null),this.sendKey(s,l,t)}},{key:"_handleMouse",value:function(s){if(!(s.type==="click"&&s.target!==this._canvas)&&(s.stopPropagation(),s.preventDefault(),!(s.type==="click"||s.type==="contextmenu"))){var l=(0,yr.clientToElement)(s.clientX,s.clientY,this._canvas);switch(s.type){case"mousedown":(0,$p.setCapture)(this._canvas),this._handleMouseButton(l.x,l.y,!0,1<<s.button);break;case"mouseup":this._handleMouseButton(l.x,l.y,!1,1<<s.button);break;case"mousemove":this._handleMouseMove(l.x,l.y);break}}}},{key:"_handleMouseButton",value:function(s,l,t,n){if(this.dragViewport)if(t&&!this._viewportDragging){this._viewportDragging=!0,this._viewportDragPos={x:s,y:l},this._viewportHasMoved=!1;return}else{if(this._viewportDragging=!1,this._viewportHasMoved)return;this._sendMouse(s,l,n)}this._mouseMoveTimer!==null&&(clearTimeout(this._mouseMoveTimer),this._mouseMoveTimer=null,this._sendMouse(s,l,this._mouseButtonMask)),t?this._mouseButtonMask|=n:this._mouseButtonMask&=~n,this._sendMouse(s,l,this._mouseButtonMask)}},{key:"_handleMouseMove",value:function(s,l){var t=this;if(this._viewportDragging){var n=this._viewportDragPos.x-s,h=this._viewportDragPos.y-l;(this._viewportHasMoved||Math.abs(n)>cu.dragThreshold||Math.abs(h)>cu.dragThreshold)&&(this._viewportHasMoved=!0,this._viewportDragPos={x:s,y:l},this._display.viewportChangePos(n,h));return}if(this._mousePos={x:s,y:l},this._mouseMoveTimer==null){var g=Date.now()-this._mouseLastMoveTime;g>_u?(this._sendMouse(s,l,this._mouseButtonMask),this._mouseLastMoveTime=Date.now()):this._mouseMoveTimer=setTimeout(function(){t._handleDelayedMouseMove()},_u-g)}}},{key:"_handleDelayedMouseMove",value:function(){this._mouseMoveTimer=null,this._sendMouse(this._mousePos.x,this._mousePos.y,this._mouseButtonMask),this._mouseLastMoveTime=Date.now()}},{key:"_sendMouse",value:function(s,l,t){this._rfbConnectionState==="connected"&&(this._viewOnly||i.messages.pointerEvent(this._sock,this._display.absX(s),this._display.absY(l),t))}},{key:"_handleWheel",value:function(s){if(this._rfbConnectionState==="connected"&&!this._viewOnly){s.stopPropagation(),s.preventDefault();var l=(0,yr.clientToElement)(s.clientX,s.clientY,this._canvas),t=s.deltaX,n=s.deltaY;s.deltaMode!==0&&(t*=pu,n*=pu),this._accumulatedWheelDeltaX+=t,this._accumulatedWheelDeltaY+=n,Math.abs(this._accumulatedWheelDeltaX)>=gu&&(this._accumulatedWheelDeltaX<0?(this._handleMouseButton(l.x,l.y,!0,32),this._handleMouseButton(l.x,l.y,!1,32)):this._accumulatedWheelDeltaX>0&&(this._handleMouseButton(l.x,l.y,!0,64),this._handleMouseButton(l.x,l.y,!1,64)),this._accumulatedWheelDeltaX=0),Math.abs(this._accumulatedWheelDeltaY)>=gu&&(this._accumulatedWheelDeltaY<0?(this._handleMouseButton(l.x,l.y,!0,8),this._handleMouseButton(l.x,l.y,!1,8)):this._accumulatedWheelDeltaY>0&&(this._handleMouseButton(l.x,l.y,!0,16),this._handleMouseButton(l.x,l.y,!1,16)),this._accumulatedWheelDeltaY=0)}}},{key:"_fakeMouseMove",value:function(s,l,t){this._handleMouseMove(l,t),this._cursor.move(s.detail.clientX,s.detail.clientY)}},{key:"_handleTapEvent",value:function(s,l){var t=(0,yr.clientToElement)(s.detail.clientX,s.detail.clientY,this._canvas);if(this._gestureLastTapTime!==null&&Date.now()-this._gestureLastTapTime<Sv&&this._gestureFirstDoubleTapEv.detail.type===s.detail.type){var n=this._gestureFirstDoubleTapEv.detail.clientX-s.detail.clientX,h=this._gestureFirstDoubleTapEv.detail.clientY-s.detail.clientY,g=Math.hypot(n,h);g<Ev?t=(0,yr.clientToElement)(this._gestureFirstDoubleTapEv.detail.clientX,this._gestureFirstDoubleTapEv.detail.clientY,this._canvas):this._gestureFirstDoubleTapEv=s}else this._gestureFirstDoubleTapEv=s;this._gestureLastTapTime=Date.now(),this._fakeMouseMove(this._gestureFirstDoubleTapEv,t.x,t.y),this._handleMouseButton(t.x,t.y,!0,l),this._handleMouseButton(t.x,t.y,!1,l)}},{key:"_handleGesture",value:function(s){var l,t=(0,yr.clientToElement)(s.detail.clientX,s.detail.clientY,this._canvas);switch(s.type){case"gesturestart":switch(s.detail.type){case"onetap":this._handleTapEvent(s,1);break;case"twotap":this._handleTapEvent(s,4);break;case"threetap":this._handleTapEvent(s,2);break;case"drag":this._fakeMouseMove(s,t.x,t.y),this._handleMouseButton(t.x,t.y,!0,1);break;case"longpress":this._fakeMouseMove(s,t.x,t.y),this._handleMouseButton(t.x,t.y,!0,4);break;case"twodrag":this._gestureLastMagnitudeX=s.detail.magnitudeX,this._gestureLastMagnitudeY=s.detail.magnitudeY,this._fakeMouseMove(s,t.x,t.y);break;case"pinch":this._gestureLastMagnitudeX=Math.hypot(s.detail.magnitudeX,s.detail.magnitudeY),this._fakeMouseMove(s,t.x,t.y);break}break;case"gesturemove":switch(s.detail.type){case"onetap":case"twotap":case"threetap":break;case"drag":case"longpress":this._fakeMouseMove(s,t.x,t.y);break;case"twodrag":for(this._fakeMouseMove(s,t.x,t.y);s.detail.magnitudeY-this._gestureLastMagnitudeY>jt;)this._handleMouseButton(t.x,t.y,!0,8),this._handleMouseButton(t.x,t.y,!1,8),this._gestureLastMagnitudeY+=jt;for(;s.detail.magnitudeY-this._gestureLastMagnitudeY<-jt;)this._handleMouseButton(t.x,t.y,!0,16),this._handleMouseButton(t.x,t.y,!1,16),this._gestureLastMagnitudeY-=jt;for(;s.detail.magnitudeX-this._gestureLastMagnitudeX>jt;)this._handleMouseButton(t.x,t.y,!0,32),this._handleMouseButton(t.x,t.y,!1,32),this._gestureLastMagnitudeX+=jt;for(;s.detail.magnitudeX-this._gestureLastMagnitudeX<-jt;)this._handleMouseButton(t.x,t.y,!0,64),this._handleMouseButton(t.x,t.y,!1,64),this._gestureLastMagnitudeX-=jt;break;case"pinch":if(this._fakeMouseMove(s,t.x,t.y),l=Math.hypot(s.detail.magnitudeX,s.detail.magnitudeY),Math.abs(l-this._gestureLastMagnitudeX)>br){for(this._handleKeyEvent(ot.default.XK_Control_L,"ControlLeft",!0);l-this._gestureLastMagnitudeX>br;)this._handleMouseButton(t.x,t.y,!0,8),this._handleMouseButton(t.x,t.y,!1,8),this._gestureLastMagnitudeX+=br;for(;l-this._gestureLastMagnitudeX<-br;)this._handleMouseButton(t.x,t.y,!0,16),this._handleMouseButton(t.x,t.y,!1,16),this._gestureLastMagnitudeX-=br}this._handleKeyEvent(ot.default.XK_Control_L,"ControlLeft",!1);break}break;case"gestureend":switch(s.detail.type){case"onetap":case"twotap":case"threetap":case"pinch":case"twodrag":break;case"drag":this._fakeMouseMove(s,t.x,t.y),this._handleMouseButton(t.x,t.y,!1,1);break;case"longpress":this._fakeMouseMove(s,t.x,t.y),this._handleMouseButton(t.x,t.y,!1,4);break}break}}},{key:"_negotiateProtocolVersion",value:function(){if(this._sock.rQwait("version",12))return!1;var s=this._sock.rQshiftStr(12).substr(4,7);re.Info("Server ProtocolVersion: "+s);var l=0;switch(s){case"000.000":l=1;break;case"003.003":case"003.006":this._rfbVersion=3.3;break;case"003.007":this._rfbVersion=3.7;break;case"003.008":case"003.889":case"004.000":case"004.001":case"005.000":this._rfbVersion=3.8;break;default:return this._fail("Invalid server version "+s)}if(l){for(var t="ID:"+this._repeaterID;t.length<250;)t+="\0";return this._sock.sQpushString(t),this._sock.flush(),!0}this._rfbVersion>this._rfbMaxVersion&&(this._rfbVersion=this._rfbMaxVersion);var n="00"+parseInt(this._rfbVersion,10)+".00"+this._rfbVersion*10%10;this._sock.sQpushString("RFB "+n+`
`),this._sock.flush(),re.Debug("Sent ProtocolVersion: "+n),this._rfbInitState="Security"}},{key:"_isSupportedSecurityType",value:function(s){var l=[vu,Ts,mu,yu,Oo,bu,Au,wu,xu];return l.includes(s)}},{key:"_negotiateSecurity",value:function(){if(this._rfbVersion>=3.7){var s=this._sock.rQshift8();if(this._sock.rQwait("security type",s,1))return!1;if(s===0)return this._rfbInitState="SecurityReason",this._securityContext="no security types",this._securityStatus=1,!0;var l=this._sock.rQshiftBytes(s);re.Debug("Server security types: "+l),this._rfbAuthScheme=-1;var t=Po(l),n;try{for(t.s();!(n=t.n()).done;){var h=n.value;if(this._isSupportedSecurityType(h)){this._rfbAuthScheme=h;break}}}catch(g){t.e(g)}finally{t.f()}if(this._rfbAuthScheme===-1)return this._fail("Unsupported security types (types: "+l+")");this._sock.sQpush8(this._rfbAuthScheme),this._sock.flush()}else{if(this._sock.rQwait("security scheme",4))return!1;if(this._rfbAuthScheme=this._sock.rQshift32(),this._rfbAuthScheme==0)return this._rfbInitState="SecurityReason",this._securityContext="authentication scheme",this._securityStatus=1,!0}return this._rfbInitState="Authentication",re.Debug("Authenticating using scheme: "+this._rfbAuthScheme),!0}},{key:"_handleSecurityReason",value:function(){if(this._sock.rQwait("reason length",4))return!1;var s=this._sock.rQshift32(),l="";if(s>0){if(this._sock.rQwait("reason",s,4))return!1;l=this._sock.rQshiftStr(s)}return l!==""?(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:this._securityStatus,reason:l}})),this._fail("Security negotiation failed on "+this._securityContext+" (reason: "+l+")")):(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:this._securityStatus}})),this._fail("Security negotiation failed on "+this._securityContext))}},{key:"_negotiateXvpAuth",value:function(){return this._rfbCredentials.username===void 0||this._rfbCredentials.password===void 0||this._rfbCredentials.target===void 0?(this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password","target"]}})),!1):(this._sock.sQpush8(this._rfbCredentials.username.length),this._sock.sQpush8(this._rfbCredentials.target.length),this._sock.sQpushString(this._rfbCredentials.username),this._sock.sQpushString(this._rfbCredentials.target),this._sock.flush(),this._rfbAuthScheme=Ts,this._negotiateAuthentication())}},{key:"_negotiateVeNCryptAuth",value:function(){if(this._rfbVeNCryptState==0){if(this._sock.rQwait("vencrypt version",2))return!1;var s=this._sock.rQshift8(),l=this._sock.rQshift8();if(!(s==0&&l==2))return this._fail("Unsupported VeNCrypt version "+s+"."+l);this._sock.sQpush8(0),this._sock.sQpush8(2),this._sock.flush(),this._rfbVeNCryptState=1}if(this._rfbVeNCryptState==1){if(this._sock.rQwait("vencrypt ack",1))return!1;var t=this._sock.rQshift8();if(t!=0)return this._fail("VeNCrypt failure "+t);this._rfbVeNCryptState=2}if(this._rfbVeNCryptState==2){if(this._sock.rQwait("vencrypt subtypes length",1))return!1;var n=this._sock.rQshift8();if(n<1)return this._fail("VeNCrypt subtypes empty");this._rfbVeNCryptSubtypesLength=n,this._rfbVeNCryptState=3}if(this._rfbVeNCryptState==3){if(this._sock.rQwait("vencrypt subtypes",4*this._rfbVeNCryptSubtypesLength))return!1;for(var h=[],g=0;g<this._rfbVeNCryptSubtypesLength;g++)h.push(this._sock.rQshift32());this._rfbAuthScheme=-1;for(var o=0,c=h;o<c.length;o++){var f=c[o];if(f!==Oo&&this._isSupportedSecurityType(f)){this._rfbAuthScheme=f;break}}return this._rfbAuthScheme===-1?this._fail("Unsupported security types (types: "+h+")"):(this._sock.sQpush32(this._rfbAuthScheme),this._sock.flush(),this._rfbVeNCryptState=4,!0)}}},{key:"_negotiatePlainAuth",value:function(){if(this._rfbCredentials.username===void 0||this._rfbCredentials.password===void 0)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password"]}})),!1;var s=(0,yt.encodeUTF8)(this._rfbCredentials.username),l=(0,yt.encodeUTF8)(this._rfbCredentials.password);return this._sock.sQpush32(s.length),this._sock.sQpush32(l.length),this._sock.sQpushString(s),this._sock.sQpushString(l),this._sock.flush(),this._rfbInitState="SecurityResult",!0}},{key:"_negotiateStdVNCAuth",value:function(){if(this._sock.rQwait("auth challenge",16))return!1;if(this._rfbCredentials.password===void 0)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["password"]}})),!1;var s=Array.prototype.slice.call(this._sock.rQshiftBytes(16)),l=i.genDES(this._rfbCredentials.password,s);return this._sock.sQpushBytes(l),this._sock.flush(),this._rfbInitState="SecurityResult",!0}},{key:"_negotiateARDAuth",value:function(){if(this._rfbCredentials.username===void 0||this._rfbCredentials.password===void 0)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password"]}})),!1;if(this._rfbCredentials.ardPublicKey!=null&&this._rfbCredentials.ardCredentials!=null)return this._sock.sQpushBytes(this._rfbCredentials.ardCredentials),this._sock.sQpushBytes(this._rfbCredentials.ardPublicKey),this._sock.flush(),this._rfbCredentials.ardCredentials=null,this._rfbCredentials.ardPublicKey=null,this._rfbInitState="SecurityResult",!0;if(this._sock.rQwait("read ard",4))return!1;var s=this._sock.rQshiftBytes(2),l=this._sock.rQshift16();if(this._sock.rQwait("read ard keylength",l*2,4))return!1;var t=this._sock.rQshiftBytes(l),n=this._sock.rQshiftBytes(l),h=Ve.default.generateKey({name:"DH",g:s,p:t},!1,["deriveBits"]);return this._negotiateARDAuthAsync(l,n,h),!1}},{key:"_negotiateARDAuthAsync",value:function(){var r=cv(Ho().mark(function l(t,n,h){var g,o,c,f,v,u,a,d,_,p;return Ho().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:for(g=Ve.default.exportKey("raw",h.publicKey),o=Ve.default.deriveBits({name:"DH",public:n},h.privateKey,t*8),c=(0,yt.encodeUTF8)(this._rfbCredentials.username).substring(0,63),f=(0,yt.encodeUTF8)(this._rfbCredentials.password).substring(0,63),v=window.crypto.getRandomValues(new Uint8Array(128)),u=0;u<c.length;u++)v[u]=c.charCodeAt(u);for(v[c.length]=0,a=0;a<f.length;a++)v[64+a]=f.charCodeAt(a);return v[64+f.length]=0,w.next=11,Ve.default.digest("MD5",o);case 11:return d=w.sent,w.next=14,Ve.default.importKey("raw",d,{name:"AES-ECB"},!1,["encrypt"]);case 14:return _=w.sent,w.next=17,Ve.default.encrypt({name:"AES-ECB"},_,v);case 17:p=w.sent,this._rfbCredentials.ardCredentials=p,this._rfbCredentials.ardPublicKey=g,this._resumeAuthentication();case 21:case"end":return w.stop()}},l,this)}));function s(l,t,n){return r.apply(this,arguments)}return s}()},{key:"_negotiateTightUnixAuth",value:function(){return this._rfbCredentials.username===void 0||this._rfbCredentials.password===void 0?(this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password"]}})),!1):(this._sock.sQpush32(this._rfbCredentials.username.length),this._sock.sQpush32(this._rfbCredentials.password.length),this._sock.sQpushString(this._rfbCredentials.username),this._sock.sQpushString(this._rfbCredentials.password),this._sock.flush(),this._rfbInitState="SecurityResult",!0)}},{key:"_negotiateTightTunnels",value:function(s){for(var l={0:{vendor:"TGHT",signature:"NOTUNNEL"}},t={},n=0;n<s;n++){var h=this._sock.rQshift32(),g=this._sock.rQshiftStr(4),o=this._sock.rQshiftStr(8);t[h]={vendor:g,signature:o}}return re.Debug("Server Tight tunnel types: "+t),t[1]&&t[1].vendor==="SICR"&&t[1].signature==="SCHANNEL"&&(re.Debug("Detected Siemens server. Assuming NOTUNNEL support."),t[0]={vendor:"TGHT",signature:"NOTUNNEL"}),t[0]?t[0].vendor!=l[0].vendor||t[0].signature!=l[0].signature?this._fail("Client's tunnel type had the incorrect vendor or signature"):(re.Debug("Selected tunnel type: "+l[0]),this._sock.sQpush32(0),this._sock.flush(),!1):this._fail("Server wanted tunnels, but doesn't support the notunnel type")}},{key:"_negotiateTightAuth",value:function(){if(!this._rfbTightVNC){if(this._sock.rQwait("num tunnels",4))return!1;var s=this._sock.rQshift32();if(s>0&&this._sock.rQwait("tunnel capabilities",16*s,4))return!1;if(this._rfbTightVNC=!0,s>0)return this._negotiateTightTunnels(s),!1}if(this._sock.rQwait("sub auth count",4))return!1;var l=this._sock.rQshift32();if(l===0)return this._rfbInitState="SecurityResult",!0;if(this._sock.rQwait("sub auth capabilities",16*l,4))return!1;for(var t={STDVNOAUTH__:1,STDVVNCAUTH_:2,TGHTULGNAUTH:129},n=[],h=0;h<l;h++){this._sock.rQshift32();var g=this._sock.rQshiftStr(12);n.push(g)}re.Debug("Server Tight authentication types: "+n);for(var o in t)if(n.indexOf(o)!=-1)switch(this._sock.sQpush32(t[o]),this._sock.flush(),re.Debug("Selected authentication type: "+o),o){case"STDVNOAUTH__":return this._rfbInitState="SecurityResult",!0;case"STDVVNCAUTH_":return this._rfbAuthScheme=Ts,!0;case"TGHTULGNAUTH":return this._rfbAuthScheme=Cu,!0;default:return this._fail("Unsupported tiny auth scheme (scheme: "+o+")")}return this._fail("No supported sub-auth types!")}},{key:"_handleRSAAESCredentialsRequired",value:function(s){this.dispatchEvent(s)}},{key:"_handleRSAAESServerVerification",value:function(s){this.dispatchEvent(s)}},{key:"_negotiateRA2neAuth",value:function(){var s=this;return this._rfbRSAAESAuthenticationState===null&&(this._rfbRSAAESAuthenticationState=new ev.default(this._sock,function(){return s._rfbCredentials}),this._rfbRSAAESAuthenticationState.addEventListener("serververification",this._eventHandlers.handleRSAAESServerVerification),this._rfbRSAAESAuthenticationState.addEventListener("credentialsrequired",this._eventHandlers.handleRSAAESCredentialsRequired)),this._rfbRSAAESAuthenticationState.checkInternalEvents(),this._rfbRSAAESAuthenticationState.hasStarted||this._rfbRSAAESAuthenticationState.negotiateRA2neAuthAsync().catch(function(l){l.message!=="disconnect normally"&&s._fail(l.message)}).then(function(){return s._rfbInitState="SecurityResult",!0}).finally(function(){s._rfbRSAAESAuthenticationState.removeEventListener("serververification",s._eventHandlers.handleRSAAESServerVerification),s._rfbRSAAESAuthenticationState.removeEventListener("credentialsrequired",s._eventHandlers.handleRSAAESCredentialsRequired),s._rfbRSAAESAuthenticationState=null}),!1}},{key:"_negotiateMSLogonIIAuth",value:function(){if(this._sock.rQwait("mslogonii dh param",24))return!1;if(this._rfbCredentials.username===void 0||this._rfbCredentials.password===void 0)return this.dispatchEvent(new CustomEvent("credentialsrequired",{detail:{types:["username","password"]}})),!1;var s=this._sock.rQshiftBytes(8),l=this._sock.rQshiftBytes(8),t=this._sock.rQshiftBytes(8),n=Ve.default.generateKey({name:"DH",g:s,p:l},!0,["deriveBits"]),h=Ve.default.exportKey("raw",n.publicKey),g=Ve.default.deriveBits({name:"DH",public:t},n.privateKey,64),o=Ve.default.importKey("raw",g,{name:"DES-CBC"},!1,["encrypt"]),c=(0,yt.encodeUTF8)(this._rfbCredentials.username).substring(0,255),f=(0,yt.encodeUTF8)(this._rfbCredentials.password).substring(0,63),v=new Uint8Array(256),u=new Uint8Array(64);window.crypto.getRandomValues(v),window.crypto.getRandomValues(u);for(var a=0;a<c.length;a++)v[a]=c.charCodeAt(a);v[c.length]=0;for(var d=0;d<f.length;d++)u[d]=f.charCodeAt(d);return u[f.length]=0,v=Ve.default.encrypt({name:"DES-CBC",iv:g},o,v),u=Ve.default.encrypt({name:"DES-CBC",iv:g},o,u),this._sock.sQpushBytes(h),this._sock.sQpushBytes(v),this._sock.sQpushBytes(u),this._sock.flush(),this._rfbInitState="SecurityResult",!0}},{key:"_negotiateAuthentication",value:function(){switch(this._rfbAuthScheme){case vu:return this._rfbVersion>=3.8?this._rfbInitState="SecurityResult":this._rfbInitState="ClientInitialisation",!0;case bu:return this._negotiateXvpAuth();case Au:return this._negotiateARDAuth();case Ts:return this._negotiateStdVNCAuth();case yu:return this._negotiateTightAuth();case Oo:return this._negotiateVeNCryptAuth();case xu:return this._negotiatePlainAuth();case Cu:return this._negotiateTightUnixAuth();case mu:return this._negotiateRA2neAuth();case wu:return this._negotiateMSLogonIIAuth();default:return this._fail("Unsupported auth scheme (scheme: "+this._rfbAuthScheme+")")}}},{key:"_handleSecurityResult",value:function(){if(this._sock.rQwait("VNC auth response ",4))return!1;var s=this._sock.rQshift32();return s===0?(this._rfbInitState="ClientInitialisation",re.Debug("Authentication OK"),!0):this._rfbVersion>=3.8?(this._rfbInitState="SecurityReason",this._securityContext="security result",this._securityStatus=s,!0):(this.dispatchEvent(new CustomEvent("securityfailure",{detail:{status:s}})),this._fail("Security handshake failed"))}},{key:"_negotiateServerInit",value:function(){if(this._sock.rQwait("server initialization",24))return!1;var s=this._sock.rQshift16(),l=this._sock.rQshift16(),t=this._sock.rQshift8(),n=this._sock.rQshift8(),h=this._sock.rQshift8(),g=this._sock.rQshift8(),o=this._sock.rQshift16(),c=this._sock.rQshift16(),f=this._sock.rQshift16(),v=this._sock.rQshift8(),u=this._sock.rQshift8(),a=this._sock.rQshift8();this._sock.rQskipBytes(3);var d=this._sock.rQshift32();if(this._sock.rQwait("server init name",d,24))return!1;var _=this._sock.rQshiftStr(d);if(_=(0,yt.decodeUTF8)(_,!0),this._rfbTightVNC){if(this._sock.rQwait("TightVNC extended server init header",8,24+d))return!1;var p=this._sock.rQshift16(),m=this._sock.rQshift16(),w=this._sock.rQshift16();this._sock.rQskipBytes(2);var b=(p+m+w)*16;if(this._sock.rQwait("TightVNC extended server init header",b,32+d))return!1;this._sock.rQskipBytes(16*p),this._sock.rQskipBytes(16*m),this._sock.rQskipBytes(16*w)}return re.Info("Screen: "+s+"x"+l+", bpp: "+t+", depth: "+n+", bigEndian: "+h+", trueColor: "+g+", redMax: "+o+", greenMax: "+c+", blueMax: "+f+", redShift: "+v+", greenShift: "+u+", blueShift: "+a),this._setDesktopName(_),this._resize(s,l),this._viewOnly||this._keyboard.grab(),this._fbDepth=24,this._fbName==="Intel(r) AMT KVM"&&(re.Warn("Intel AMT KVM only supports 8/16 bit depths. Using low color mode."),this._fbDepth=8),i.messages.pixelFormat(this._sock,this._fbDepth,!0),this._sendEncodings(),i.messages.fbUpdateRequest(this._sock,!1,0,0,this._fbWidth,this._fbHeight),this._updateConnectionState("connected"),!0}},{key:"_sendEncodings",value:function(){var s=[];s.push(he.encodings.encodingCopyRect),this._fbDepth==24&&(s.push(he.encodings.encodingTight),s.push(he.encodings.encodingTightPNG),s.push(he.encodings.encodingZRLE),s.push(he.encodings.encodingJPEG),s.push(he.encodings.encodingHextile),s.push(he.encodings.encodingRRE)),s.push(he.encodings.encodingRaw),s.push(he.encodings.pseudoEncodingQualityLevel0+this._qualityLevel),s.push(he.encodings.pseudoEncodingCompressLevel0+this._compressionLevel),s.push(he.encodings.pseudoEncodingDesktopSize),s.push(he.encodings.pseudoEncodingLastRect),s.push(he.encodings.pseudoEncodingQEMUExtendedKeyEvent),s.push(he.encodings.pseudoEncodingQEMULedEvent),s.push(he.encodings.pseudoEncodingExtendedDesktopSize),s.push(he.encodings.pseudoEncodingXvp),s.push(he.encodings.pseudoEncodingFence),s.push(he.encodings.pseudoEncodingContinuousUpdates),s.push(he.encodings.pseudoEncodingDesktopName),s.push(he.encodings.pseudoEncodingExtendedClipboard),this._fbDepth==24&&(s.push(he.encodings.pseudoEncodingVMwareCursor),s.push(he.encodings.pseudoEncodingCursor)),i.messages.clientEncodings(this._sock,s)}},{key:"_initMsg",value:function(){switch(this._rfbInitState){case"ProtocolVersion":return this._negotiateProtocolVersion();case"Security":return this._negotiateSecurity();case"Authentication":return this._negotiateAuthentication();case"SecurityResult":return this._handleSecurityResult();case"SecurityReason":return this._handleSecurityReason();case"ClientInitialisation":return this._sock.sQpush8(this._shared?1:0),this._sock.flush(),this._rfbInitState="ServerInitialisation",!0;case"ServerInitialisation":return this._negotiateServerInit();default:return this._fail("Unknown init state (state: "+this._rfbInitState+")")}}},{key:"_resumeAuthentication",value:function(){setTimeout(this._initMsg.bind(this),0)}},{key:"_handleSetColourMapMsg",value:function(){return re.Debug("SetColorMapEntries"),this._fail("Unexpected SetColorMapEntries message")}},{key:"_handleServerCutText",value:function(){if(re.Debug("ServerCutText"),this._sock.rQwait("ServerCutText header",7,1))return!1;this._sock.rQskipBytes(3);var s=this._sock.rQshift32();if(s=(0,ku.toSigned32bit)(s),this._sock.rQwait("ServerCutText content",Math.abs(s),8))return!1;if(s>=0){var l=this._sock.rQshiftStr(s);if(this._viewOnly)return!0;this.dispatchEvent(new CustomEvent("clipboard",{detail:{text:l}}))}else{s=Math.abs(s);var t=this._sock.rQshift32(),n=t&65535,h=t&4278190080,g=!!(h&Su);if(g){this._clipboardServerCapabilitiesFormats={},this._clipboardServerCapabilitiesActions={};for(var o=0;o<=15;o++){var c=1<<o;n&c&&(this._clipboardServerCapabilitiesFormats[c]=!0,this._sock.rQshift32())}for(var f=24;f<=31;f++){var v=1<<f;this._clipboardServerCapabilitiesActions[v]=!!(h&v)}var u=[Su,Rs,Eu,Ar,Ms];i.messages.extendedClipboardCaps(this._sock,u,{extendedClipboardFormatText:0})}else if(h===Rs){if(this._viewOnly)return!0;this._clipboardText!=null&&this._clipboardServerCapabilitiesActions[Ms]&&n&bt&&i.messages.extendedClipboardProvide(this._sock,[bt],[this._clipboardText])}else if(h===Eu){if(this._viewOnly)return!0;this._clipboardServerCapabilitiesActions[Ar]&&(this._clipboardText!=null?i.messages.extendedClipboardNotify(this._sock,[bt]):i.messages.extendedClipboardNotify(this._sock,[]))}else if(h===Ar){if(this._viewOnly)return!0;this._clipboardServerCapabilitiesActions[Rs]&&n&bt&&i.messages.extendedClipboardRequest(this._sock,[bt])}else if(h===Ms){if(this._viewOnly||!(n&bt))return!0;this._clipboardText=null;var a=this._sock.rQshiftBytes(s-4),d=new jp.default,_=null;d.setInput(a);for(var p=0;p<=15;p++){var m=1<<p;if(n&m){var w=0,b=d.inflate(4);w|=b[0]<<24,w|=b[1]<<16,w|=b[2]<<8,w|=b[3];var S=d.inflate(w);m===bt&&(_=S)}}if(d.setInput(null),_!==null){for(var A="",x=0;x<_.length;x++)A+=String.fromCharCode(_[x]);_=A,_=(0,yt.decodeUTF8)(_),_.length>0&&_.charAt(_.length-1)==="\0"&&(_=_.slice(0,-1)),_=_.replaceAll(`\r
`,`
`),this.dispatchEvent(new CustomEvent("clipboard",{detail:{text:_}}))}}else return this._fail("Unexpected action in extended clipboard message: "+h)}return!0}},{key:"_handleServerFenceMsg",value:function(){if(this._sock.rQwait("ServerFence header",8,1))return!1;this._sock.rQskipBytes(3);var s=this._sock.rQshift32(),l=this._sock.rQshift8();if(this._sock.rQwait("ServerFence payload",l,9))return!1;l>64&&(re.Warn("Bad payload length ("+l+") in fence response"),l=64);var t=this._sock.rQshiftStr(l);return this._supportsFence=!0,s&1<<31?(s&=3,i.messages.clientFence(this._sock,s,t),!0):this._fail("Unexpected fence response")}},{key:"_handleXvpMsg",value:function(){if(this._sock.rQwait("XVP version and message",3,1))return!1;this._sock.rQskipBytes(1);var s=this._sock.rQshift8(),l=this._sock.rQshift8();switch(l){case 0:re.Error("XVP Operation Failed");break;case 1:this._rfbXvpVer=s,re.Info("XVP extensions enabled (version "+this._rfbXvpVer+")"),this._setCapability("power",!0);break;default:this._fail("Illegal server XVP message (msg: "+l+")");break}return!0}},{key:"_normalMsg",value:function(){var s;this._FBU.rects>0?s=0:s=this._sock.rQshift8();var l,t;switch(s){case 0:return t=this._framebufferUpdate(),t&&!this._enabledContinuousUpdates&&i.messages.fbUpdateRequest(this._sock,!0,0,0,this._fbWidth,this._fbHeight),t;case 1:return this._handleSetColourMapMsg();case 2:return re.Debug("Bell"),this.dispatchEvent(new CustomEvent("bell",{detail:{}})),!0;case 3:return this._handleServerCutText();case 150:return l=!this._supportsContinuousUpdates,this._supportsContinuousUpdates=!0,this._enabledContinuousUpdates=!1,l&&(this._enabledContinuousUpdates=!0,this._updateContinuousUpdates(),re.Info("Enabling continuous updates.")),!0;case 248:return this._handleServerFenceMsg();case 250:return this._handleXvpMsg();default:return this._fail("Unexpected server message (type "+s+")"),re.Debug("sock.rQpeekBytes(30): "+this._sock.rQpeekBytes(30)),!0}}},{key:"_framebufferUpdate",value:function(){var s=this;if(this._FBU.rects===0){if(this._sock.rQwait("FBU header",3,1))return!1;if(this._sock.rQskipBytes(1),this._FBU.rects=this._sock.rQshift16(),this._display.pending())return this._flushing=!0,this._display.flush().then(function(){s._flushing=!1,s._sock.rQwait("message",1)||s._handleMessage()}),!1}for(;this._FBU.rects>0;){if(this._FBU.encoding===null){if(this._sock.rQwait("rect header",12))return!1;this._FBU.x=this._sock.rQshift16(),this._FBU.y=this._sock.rQshift16(),this._FBU.width=this._sock.rQshift16(),this._FBU.height=this._sock.rQshift16(),this._FBU.encoding=this._sock.rQshift32(),this._FBU.encoding>>=0}if(!this._handleRect())return!1;this._FBU.rects--,this._FBU.encoding=null}return this._display.flip(),!0}},{key:"_handleRect",value:function(){switch(this._FBU.encoding){case he.encodings.pseudoEncodingLastRect:return this._FBU.rects=1,!0;case he.encodings.pseudoEncodingVMwareCursor:return this._handleVMwareCursor();case he.encodings.pseudoEncodingCursor:return this._handleCursor();case he.encodings.pseudoEncodingQEMUExtendedKeyEvent:return this._qemuExtKeyEventSupported=!0,!0;case he.encodings.pseudoEncodingDesktopName:return this._handleDesktopName();case he.encodings.pseudoEncodingDesktopSize:return this._resize(this._FBU.width,this._FBU.height),!0;case he.encodings.pseudoEncodingExtendedDesktopSize:return this._handleExtendedDesktopSize();case he.encodings.pseudoEncodingQEMULedEvent:return this._handleLedEvent();default:return this._handleDataRect()}}},{key:"_handleVMwareCursor",value:function(){var s=this._FBU.x,l=this._FBU.y,t=this._FBU.width,n=this._FBU.height;if(this._sock.rQwait("VMware cursor encoding",1))return!1;var h=this._sock.rQshift8();this._sock.rQshift8();var g,o=4;if(h==0){var c=-256;if(g=new Array(t*n*o),this._sock.rQwait("VMware cursor classic encoding",t*n*o*2,2))return!1;for(var f=new Array(t*n),v=0;v<t*n;v++)f[v]=this._sock.rQshift32();for(var u=new Array(t*n),a=0;a<t*n;a++)u[a]=this._sock.rQshift32();for(var d=0;d<t*n;d++)if(f[d]==0){var _=u[d],p=_>>8&255,m=_>>16&255,w=_>>24&255;g[d*o]=p,g[d*o+1]=m,g[d*o+2]=w,g[d*o+3]=255}else(f[d]&c)==c?u[d]==0?(g[d*o]=0,g[d*o+1]=0,g[d*o+2]=0,g[d*o+3]=0):((u[d]&c)==c,g[d*o]=0,g[d*o+1]=0,g[d*o+2]=0,g[d*o+3]=255):(g[d*o]=0,g[d*o+1]=0,g[d*o+2]=0,g[d*o+3]=255)}else if(h==1){if(this._sock.rQwait("VMware cursor alpha encoding",t*n*4,2))return!1;g=new Array(t*n*o);for(var b=0;b<t*n;b++){var S=this._sock.rQshift32();g[b*4]=S>>24&255,g[b*4+1]=S>>16&255,g[b*4+2]=S>>8&255,g[b*4+3]=S&255}}else return re.Warn("The given cursor type is not supported: "+h+" given."),!1;return this._updateCursor(g,s,l,t,n),!0}},{key:"_handleCursor",value:function(){var s=this._FBU.x,l=this._FBU.y,t=this._FBU.width,n=this._FBU.height,h=t*n*4,g=Math.ceil(t/8)*n,o=h+g;if(this._sock.rQwait("cursor encoding",o))return!1;for(var c=this._sock.rQshiftBytes(h),f=this._sock.rQshiftBytes(g),v=new Uint8Array(t*n*4),u=0,a=0;a<n;a++)for(var d=0;d<t;d++){var _=a*Math.ceil(t/8)+Math.floor(d/8),p=f[_]<<d%8&128?255:0;v[u]=c[u+2],v[u+1]=c[u+1],v[u+2]=c[u],v[u+3]=p,u+=4}return this._updateCursor(v,s,l,t,n),!0}},{key:"_handleDesktopName",value:function(){if(this._sock.rQwait("DesktopName",4))return!1;var s=this._sock.rQshift32();if(this._sock.rQwait("DesktopName",s,4))return!1;var l=this._sock.rQshiftStr(s);return l=(0,yt.decodeUTF8)(l,!0),this._setDesktopName(l),!0}},{key:"_handleLedEvent",value:function(){if(this._sock.rQwait("LED Status",1))return!1;var s=this._sock.rQshift8(),l=!!(s&2),t=!!(s&4);return this._remoteCapsLock=t,this._remoteNumLock=l,!0}},{key:"_handleExtendedDesktopSize",value:function(){if(this._sock.rQwait("ExtendedDesktopSize",4))return!1;var s=this._sock.rQpeek8(),l=4+s*16;if(this._sock.rQwait("ExtendedDesktopSize",l))return!1;var t=!this._supportsSetDesktopSize;this._supportsSetDesktopSize=!0,this._sock.rQskipBytes(1),this._sock.rQskipBytes(3);for(var n=0;n<s;n+=1)n===0?(this._screenID=this._sock.rQshift32(),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._sock.rQskipBytes(2),this._screenFlags=this._sock.rQshift32()):this._sock.rQskipBytes(16);if(this._FBU.x===1&&this._FBU.y!==0){var h="";switch(this._FBU.y){case 1:h="Resize is administratively prohibited";break;case 2:h="Out of resources";break;case 3:h="Invalid screen layout";break;default:h="Unknown reason";break}re.Warn("Server did not accept the resize request: "+h)}else this._resize(this._FBU.width,this._FBU.height);return t&&this._requestRemoteResize(),!0}},{key:"_handleDataRect",value:function(){var s=this._decoders[this._FBU.encoding];if(!s)return this._fail("Unsupported encoding (encoding: "+this._FBU.encoding+")"),!1;try{return s.decodeRect(this._FBU.x,this._FBU.y,this._FBU.width,this._FBU.height,this._sock,this._display,this._fbDepth)}catch(l){return this._fail("Error decoding rect: "+l),!1}}},{key:"_updateContinuousUpdates",value:function(){this._enabledContinuousUpdates&&i.messages.enableContinuousUpdates(this._sock,!0,0,0,this._fbWidth,this._fbHeight)}},{key:"_resize",value:function(s,l){this._fbWidth=s,this._fbHeight=l,this._display.resize(this._fbWidth,this._fbHeight),this._updateClip(),this._updateScale(),this._updateContinuousUpdates(),this._saveExpectedClientSize()}},{key:"_xvpOp",value:function(s,l){this._rfbXvpVer<s||(re.Info("Sending XVP operation "+l+" (version "+s+")"),i.messages.xvpOp(this._sock,s,l))}},{key:"_updateCursor",value:function(s,l,t,n,h){this._cursorImage={rgbaPixels:s,hotx:l,hoty:t,w:n,h},this._refreshCursor()}},{key:"_shouldShowDotCursor",value:function(){if(!this._showDotCursor)return!1;for(var s=3;s<this._cursorImage.rgbaPixels.length;s+=4)if(this._cursorImage.rgbaPixels[s])return!1;return!0}},{key:"_refreshCursor",value:function(){if(!(this._rfbConnectionState!=="connecting"&&this._rfbConnectionState!=="connected")){var s=this._shouldShowDotCursor()?i.cursors.dot:this._cursorImage;this._cursor.change(s.rgbaPixels,s.hotx,s.hoty,s.w,s.h)}}}],[{key:"genDES",value:function(s,l){var t=s.split("").map(function(h){return h.charCodeAt(0)}),n=Ve.default.importKey("raw",t,{name:"DES-ECB"},!1,["encrypt"]);return Ve.default.encrypt({name:"DES-ECB"},n,l)}}])}(Wp.default);At.messages={keyEvent:function(i,r,s){i.sQpush8(4),i.sQpush8(s),i.sQpush16(0),i.sQpush32(r),i.flush()},QEMUExtendedKeyEvent:function(i,r,s,l){function t(h){var g=l>>8,o=l&255;return g===224&&o<127?o|128:h}i.sQpush8(255),i.sQpush8(0),i.sQpush16(s),i.sQpush32(r);var n=t(l);i.sQpush32(n),i.flush()},pointerEvent:function(i,r,s,l){i.sQpush8(5),i.sQpush8(l),i.sQpush16(r),i.sQpush16(s),i.flush()},_buildExtendedClipboardFlags:function(i,r){for(var s=new Uint8Array(4),l=0,t=0,n=0;n<i.length;n++)t|=i[n];for(var h=0;h<r.length;h++)l|=r[h];return s[0]=t>>24,s[1]=0,s[2]=0,s[3]=l,s},extendedClipboardProvide:function(i,r,s){for(var l=new Gp.default,t=[],n=0;n<r.length;n++){if(r[n]!=bt)throw new Error("Unsupported extended clipboard format for Provide message.");s[n]=s[n].replace(/\r\n|\r|\n/gm,`\r
`);var h=(0,yt.encodeUTF8)(s[n]+"\0");t.push(h.length>>24&255,h.length>>16&255,h.length>>8&255,h.length&255);for(var g=0;g<h.length;g++)t.push(h.charCodeAt(g))}var o=l.deflate(new Uint8Array(t)),c=new Uint8Array(4+o.length);c.set(At.messages._buildExtendedClipboardFlags([Ms],r)),c.set(o,4),At.messages.clientCutText(i,c,!0)},extendedClipboardNotify:function(i,r){var s=At.messages._buildExtendedClipboardFlags([Ar],r);At.messages.clientCutText(i,s,!0)},extendedClipboardRequest:function(i,r){var s=At.messages._buildExtendedClipboardFlags([Rs],r);At.messages.clientCutText(i,s,!0)},extendedClipboardCaps:function(i,r,s){var l=Object.keys(s),t=new Uint8Array(4+4*l.length);l.map(function(g){return parseInt(g)}),l.sort(function(g,o){return g-o}),t.set(At.messages._buildExtendedClipboardFlags(r,[]));for(var n=4,h=0;h<l.length;h++)t[n]=s[l[h]]>>24,t[n+1]=s[l[h]]>>16,t[n+2]=s[l[h]]>>8,t[n+3]=s[l[h]]>>0,n+=4,t[3]|=1<<l[h];At.messages.clientCutText(i,t,!0)},clientCutText:function(i,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;i.sQpush8(6),i.sQpush8(0),i.sQpush8(0),i.sQpush8(0);var l;s?l=(0,ku.toUnsigned32bit)(-r.length):l=r.length,i.sQpush32(l),i.sQpushBytes(r),i.flush()},setDesktopSize:function(i,r,s,l,t){i.sQpush8(251),i.sQpush8(0),i.sQpush16(r),i.sQpush16(s),i.sQpush8(1),i.sQpush8(0),i.sQpush32(l),i.sQpush16(0),i.sQpush16(0),i.sQpush16(r),i.sQpush16(s),i.sQpush32(t),i.flush()},clientFence:function(i,r,s){i.sQpush8(248),i.sQpush8(0),i.sQpush8(0),i.sQpush8(0),i.sQpush32(r),i.sQpush8(s.length),i.sQpushString(s),i.flush()},enableContinuousUpdates:function(i,r,s,l,t,n){i.sQpush8(150),i.sQpush8(r),i.sQpush16(s),i.sQpush16(l),i.sQpush16(t),i.sQpush16(n),i.flush()},pixelFormat:function(i,r,s){var l;r>16?l=32:r>8?l=16:l=8;var t=Math.floor(r/3);i.sQpush8(0),i.sQpush8(0),i.sQpush8(0),i.sQpush8(0),i.sQpush8(l),i.sQpush8(r),i.sQpush8(0),i.sQpush8(s?1:0),i.sQpush16((1<<t)-1),i.sQpush16((1<<t)-1),i.sQpush16((1<<t)-1),i.sQpush8(t*0),i.sQpush8(t*1),i.sQpush8(t*2),i.sQpush8(0),i.sQpush8(0),i.sQpush8(0),i.flush()},clientEncodings:function(i,r){i.sQpush8(2),i.sQpush8(0),i.sQpush16(r.length);for(var s=0;s<r.length;s++)i.sQpush32(r[s]);i.flush()},fbUpdateRequest:function(i,r,s,l,t,n){typeof s>"u"&&(s=0),typeof l>"u"&&(l=0),i.sQpush8(3),i.sQpush8(r?1:0),i.sQpush16(s),i.sQpush16(l),i.sQpush16(t),i.sQpush16(n),i.flush()},xvpOp:function(i,r,s){i.sQpush8(250),i.sQpush8(0),i.sQpush8(r),i.sQpush8(s),i.flush()}};At.cursors={none:{rgbaPixels:new Uint8Array,w:0,h:0,hotx:0,hoty:0},dot:{rgbaPixels:new Uint8Array([255,255,255,255,0,0,0,255,255,255,255,255,0,0,0,255,0,0,0,0,0,0,0,255,255,255,255,255,0,0,0,255,255,255,255,255]),w:3,h:3,hotx:1,hoty:1}}});var ju=se((Ws,jo)=>{(function(e,i){if(typeof Ws=="object"&&typeof jo=="object")jo.exports=i();else if(typeof define=="function"&&define.amd)define([],i);else{var r=i();for(var s in r)(typeof Ws=="object"?Ws:e)[s]=r[s]}})(globalThis,()=>(()=>{"use strict";var e={4567:function(l,t,n){var h=this&&this.__decorate||function(_,p,m,w){var b,S=arguments.length,A=S<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,m):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(_,p,m,w);else for(var x=_.length-1;x>=0;x--)(b=_[x])&&(A=(S<3?b(A):S>3?b(p,m,A):b(p,m))||A);return S>3&&A&&Object.defineProperty(p,m,A),A},g=this&&this.__param||function(_,p){return function(m,w){p(m,w,_)}};Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;let o=n(9042),c=n(9924),f=n(844),v=n(4725),u=n(2585),a=n(3656),d=t.AccessibilityManager=class extends f.Disposable{constructor(_,p,m,w){super(),this._terminal=_,this._coreBrowserService=m,this._renderService=w,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let b=0;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);if(this._topBoundaryFocusListener=b=>this._handleBoundaryFocus(b,0),this._bottomBoundaryFocusListener=b=>this._handleBoundaryFocus(b,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new c.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(b=>this._handleResize(b.rows))),this.register(this._terminal.onRender(b=>this._refreshRows(b.start,b.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(b=>this._handleChar(b))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(b=>this._handleTab(b))),this.register(this._terminal.onKey(b=>this._handleKey(b.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,a.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,f.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(_){for(let p=0;p<_;p++)this._handleChar(" ")}_handleChar(_){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==_&&(this._charsToAnnounce+=_):this._charsToAnnounce+=_,_===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=o.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(_){this._clearLiveRegion(),/\p{Control}/u.test(_)||this._charsToConsume.push(_)}_refreshRows(_,p){this._liveRegionDebouncer.refresh(_,p,this._terminal.rows)}_renderRows(_,p){let m=this._terminal.buffer,w=m.lines.length.toString();for(let b=_;b<=p;b++){let S=m.lines.get(m.ydisp+b),A=[],x=S?.translateToString(!0,void 0,void 0,A)||"",E=(m.ydisp+b+1).toString(),D=this._rowElements[b];D&&(x.length===0?(D.innerText="\xA0",this._rowColumns.set(D,[0,1])):(D.textContent=x,this._rowColumns.set(D,A)),D.setAttribute("aria-posinset",E),D.setAttribute("aria-setsize",w))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(_,p){let m=_.target,w=this._rowElements[p===0?1:this._rowElements.length-2];if(m.getAttribute("aria-posinset")===(p===0?"1":`${this._terminal.buffer.lines.length}`)||_.relatedTarget!==w)return;let b,S;if(p===0?(b=m,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(b=this._rowElements.shift(),S=m,this._rowContainer.removeChild(b)),b.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),p===0){let A=this._createAccessibilityTreeNode();this._rowElements.unshift(A),this._rowContainer.insertAdjacentElement("afterbegin",A)}else{let A=this._createAccessibilityTreeNode();this._rowElements.push(A),this._rowContainer.appendChild(A)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(p===0?-1:1),this._rowElements[p===0?1:this._rowElements.length-2].focus(),_.preventDefault(),_.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let _=document.getSelection();if(!_)return;if(_.isCollapsed)return void(this._rowContainer.contains(_.anchorNode)&&this._terminal.clearSelection());if(!_.anchorNode||!_.focusNode)return void console.error("anchorNode and/or focusNode are null");let p={node:_.anchorNode,offset:_.anchorOffset},m={node:_.focusNode,offset:_.focusOffset};if((p.node.compareDocumentPosition(m.node)&Node.DOCUMENT_POSITION_PRECEDING||p.node===m.node&&p.offset>m.offset)&&([p,m]=[m,p]),p.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(p={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(p.node))return;let w=this._rowElements.slice(-1)[0];if(m.node.compareDocumentPosition(w)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(m={node:w,offset:w.textContent?.length??0}),!this._rowContainer.contains(m.node))return;let b=({node:x,offset:E})=>{let D=x instanceof Text?x.parentNode:x,L=parseInt(D?.getAttribute("aria-posinset"),10)-1;if(isNaN(L))return console.warn("row is invalid. Race condition?"),null;let T=this._rowColumns.get(D);if(!T)return console.warn("columns is null. Race condition?"),null;let F=E<T.length?T[E]:T.slice(-1)[0]+1;return F>=this._terminal.cols&&(++L,F=0),{row:L,column:F}},S=b(p),A=b(m);if(S&&A){if(S.row>A.row||S.row===A.row&&S.column>=A.column)throw new Error("invalid range");this._terminal.select(S.column,S.row,(A.row-S.row)*this._terminal.cols-S.column+A.column)}}_handleResize(_){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let p=this._rowContainer.children.length;p<this._terminal.rows;p++)this._rowElements[p]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[p]);for(;this._rowElements.length>_;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let _=this._coreBrowserService.mainDocument.createElement("div");return _.setAttribute("role","listitem"),_.tabIndex=-1,this._refreshRowDimensions(_),_}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let _=0;_<this._terminal.rows;_++)this._refreshRowDimensions(this._rowElements[_])}}_refreshRowDimensions(_){_.style.height=`${this._renderService.dimensions.css.cell.height}px`}};t.AccessibilityManager=d=h([g(1,u.IInstantiationService),g(2,v.ICoreBrowserService),g(3,v.IRenderService)],d)},3614:(l,t)=>{function n(c){return c.replace(/\r?\n/g,"\r")}function h(c,f){return f?"\x1B[200~"+c+"\x1B[201~":c}function g(c,f,v,u){c=h(c=n(c),v.decPrivateModes.bracketedPasteMode&&u.rawOptions.ignoreBracketedPasteMode!==!0),v.triggerDataEvent(c,!0),f.value=""}function o(c,f,v){let u=v.getBoundingClientRect(),a=c.clientX-u.left-10,d=c.clientY-u.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${a}px`,f.style.top=`${d}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=n,t.bracketTextForPaste=h,t.copyHandler=function(c,f){c.clipboardData&&c.clipboardData.setData("text/plain",f.selectionText),c.preventDefault()},t.handlePasteEvent=function(c,f,v,u){c.stopPropagation(),c.clipboardData&&g(c.clipboardData.getData("text/plain"),f,v,u)},t.paste=g,t.moveTextAreaUnderMouseCursor=o,t.rightClickHandler=function(c,f,v,u,a){o(c,f,v),a&&u.rightClickSelect(c),f.value=u.selectionText,f.select()}},7239:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;let h=n(1505);t.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(g,o,c){this._css.set(g,o,c)}getCss(g,o){return this._css.get(g,o)}setColor(g,o,c){this._color.set(g,o,c)}getColor(g,o){return this._color.get(g,o)}clear(){this._color.clear(),this._css.clear()}}},3656:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(n,h,g,o){n.addEventListener(h,g,o);let c=!1;return{dispose:()=>{c||(c=!0,n.removeEventListener(h,g,o))}}}},3551:function(l,t,n){var h=this&&this.__decorate||function(d,_,p,m){var w,b=arguments.length,S=b<3?_:m===null?m=Object.getOwnPropertyDescriptor(_,p):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(d,_,p,m);else for(var A=d.length-1;A>=0;A--)(w=d[A])&&(S=(b<3?w(S):b>3?w(_,p,S):w(_,p))||S);return b>3&&S&&Object.defineProperty(_,p,S),S},g=this&&this.__param||function(d,_){return function(p,m){_(p,m,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier=void 0;let o=n(3656),c=n(8460),f=n(844),v=n(2585),u=n(4725),a=t.Linkifier=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(d,_,p,m,w){super(),this._element=d,this._mouseService=_,this._renderService=p,this._bufferService=m,this._linkProviderService=w,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new c.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new c.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,o.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,o.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,o.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(d){this._lastMouseEvent=d;let _=this._positionFromMouseEvent(d,this._element,this._mouseService);if(!_)return;this._isMouseOut=!1;let p=d.composedPath();for(let m=0;m<p.length;m++){let w=p[m];if(w.classList.contains("xterm"))break;if(w.classList.contains("xterm-hover"))return}this._lastBufferCell&&_.x===this._lastBufferCell.x&&_.y===this._lastBufferCell.y||(this._handleHover(_),this._lastBufferCell=_)}_handleHover(d){if(this._activeLine!==d.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(d,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,d)||(this._clearCurrentLink(),this._askForLink(d,!0))}_askForLink(d,_){this._activeProviderReplies&&_||(this._activeProviderReplies?.forEach(m=>{m?.forEach(w=>{w.link.dispose&&w.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=d.y);let p=!1;for(let[m,w]of this._linkProviderService.linkProviders.entries())_?this._activeProviderReplies?.get(m)&&(p=this._checkLinkProviderResult(m,d,p)):w.provideLinks(d.y,b=>{if(this._isMouseOut)return;let S=b?.map(A=>({link:A}));this._activeProviderReplies?.set(m,S),p=this._checkLinkProviderResult(m,d,p),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(d.y,this._activeProviderReplies)})}_removeIntersectingLinks(d,_){let p=new Set;for(let m=0;m<_.size;m++){let w=_.get(m);if(w)for(let b=0;b<w.length;b++){let S=w[b],A=S.link.range.start.y<d?0:S.link.range.start.x,x=S.link.range.end.y>d?this._bufferService.cols:S.link.range.end.x;for(let E=A;E<=x;E++){if(p.has(E)){w.splice(b--,1);break}p.add(E)}}}}_checkLinkProviderResult(d,_,p){if(!this._activeProviderReplies)return p;let m=this._activeProviderReplies.get(d),w=!1;for(let b=0;b<d;b++)this._activeProviderReplies.has(b)&&!this._activeProviderReplies.get(b)||(w=!0);if(!w&&m){let b=m.find(S=>this._linkAtPosition(S.link,_));b&&(p=!0,this._handleNewLink(b))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!p)for(let b=0;b<this._activeProviderReplies.size;b++){let S=this._activeProviderReplies.get(b)?.find(A=>this._linkAtPosition(A.link,_));if(S){p=!0,this._handleNewLink(S);break}}return p}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(d){if(!this._currentLink)return;let _=this._positionFromMouseEvent(d,this._element,this._mouseService);_&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,_)&&this._currentLink.link.activate(d,this._currentLink.link.text)}_clearCurrentLink(d,_){this._currentLink&&this._lastMouseEvent&&(!d||!_||this._currentLink.link.range.start.y>=d&&this._currentLink.link.range.end.y<=_)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(d){if(!this._lastMouseEvent)return;let _=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);_&&this._linkAtPosition(d.link,_)&&(this._currentLink=d,this._currentLink.state={decorations:{underline:d.link.decorations===void 0||d.link.decorations.underline,pointerCursor:d.link.decorations===void 0||d.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,d.link,this._lastMouseEvent),d.link.decorations={},Object.defineProperties(d.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:p=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==p&&(this._currentLink.state.decorations.pointerCursor=p,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",p))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:p=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==p&&(this._currentLink.state.decorations.underline=p,this._currentLink.state.isHovered&&this._fireUnderlineEvent(d.link,p))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(p=>{if(!this._currentLink)return;let m=p.start===0?0:p.start+1+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.ydisp+1+p.end;if(this._currentLink.link.range.start.y>=m&&this._currentLink.link.range.end.y<=w&&(this._clearCurrentLink(m,w),this._lastMouseEvent)){let b=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);b&&this._askForLink(b,!1)}})))}_linkHover(d,_,p){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(_,!0),this._currentLink.state.decorations.pointerCursor&&d.classList.add("xterm-cursor-pointer")),_.hover&&_.hover(p,_.text)}_fireUnderlineEvent(d,_){let p=d.range,m=this._bufferService.buffer.ydisp,w=this._createLinkUnderlineEvent(p.start.x-1,p.start.y-m-1,p.end.x,p.end.y-m-1,void 0);(_?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(w)}_linkLeave(d,_,p){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(_,!1),this._currentLink.state.decorations.pointerCursor&&d.classList.remove("xterm-cursor-pointer")),_.leave&&_.leave(p,_.text)}_linkAtPosition(d,_){let p=d.range.start.y*this._bufferService.cols+d.range.start.x,m=d.range.end.y*this._bufferService.cols+d.range.end.x,w=_.y*this._bufferService.cols+_.x;return p<=w&&w<=m}_positionFromMouseEvent(d,_,p){let m=p.getCoords(d,_,this._bufferService.cols,this._bufferService.rows);if(m)return{x:m[0],y:m[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(d,_,p,m,w){return{x1:d,y1:_,x2:p,y2:m,cols:this._bufferService.cols,fg:w}}};t.Linkifier=a=h([g(1,u.IMouseService),g(2,u.IRenderService),g(3,v.IBufferService),g(4,u.ILinkProviderService)],a)},9042:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(l,t,n){var h=this&&this.__decorate||function(u,a,d,_){var p,m=arguments.length,w=m<3?a:_===null?_=Object.getOwnPropertyDescriptor(a,d):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,a,d,_);else for(var b=u.length-1;b>=0;b--)(p=u[b])&&(w=(m<3?p(w):m>3?p(a,d,w):p(a,d))||w);return m>3&&w&&Object.defineProperty(a,d,w),w},g=this&&this.__param||function(u,a){return function(d,_){a(d,_,u)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;let o=n(511),c=n(2585),f=t.OscLinkProvider=class{constructor(u,a,d){this._bufferService=u,this._optionsService=a,this._oscLinkService=d}provideLinks(u,a){let d=this._bufferService.buffer.lines.get(u-1);if(!d)return void a(void 0);let _=[],p=this._optionsService.rawOptions.linkHandler,m=new o.CellData,w=d.getTrimmedLength(),b=-1,S=-1,A=!1;for(let x=0;x<w;x++)if(S!==-1||d.hasContent(x)){if(d.loadCell(x,m),m.hasExtendedAttrs()&&m.extended.urlId){if(S===-1){S=x,b=m.extended.urlId;continue}A=m.extended.urlId!==b}else S!==-1&&(A=!0);if(A||S!==-1&&x===w-1){let E=this._oscLinkService.getLinkData(b)?.uri;if(E){let D={start:{x:S+1,y:u},end:{x:x+(A||x!==w-1?0:1),y:u}},L=!1;if(!p?.allowNonHttpProtocols)try{let T=new URL(E);["http:","https:"].includes(T.protocol)||(L=!0)}catch{L=!0}L||_.push({text:E,range:D,activate:(T,F)=>p?p.activate(T,F,D):v(0,F),hover:(T,F)=>p?.hover?.(T,F,D),leave:(T,F)=>p?.leave?.(T,F,D)})}A=!1,m.hasExtendedAttrs()&&m.extended.urlId?(S=x,b=m.extended.urlId):(S=-1,b=-1)}}a(_)}};function v(u,a){if(confirm(`Do you want to navigate to ${a}?

WARNING: This link could potentially be dangerous`)){let d=window.open();if(d){try{d.opener=null}catch{}d.location.href=a}else console.warn("Opening link blocked as opener could not be cleared")}}t.OscLinkProvider=f=h([g(0,c.IBufferService),g(1,c.IOptionsService),g(2,c.IOscLinkService)],f)},6193:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(n,h){this._renderCallback=n,this._coreBrowserService=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(n){return this._refreshCallbacks.push(n),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(n,h,g){this._rowCount=g,n=n!==void 0?n:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();let n=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let n of this._refreshCallbacks)n(0);this._refreshCallbacks=[]}}},3236:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;let h=n(3614),g=n(3656),o=n(3551),c=n(9042),f=n(3730),v=n(1680),u=n(3107),a=n(5744),d=n(2950),_=n(1296),p=n(428),m=n(4269),w=n(5114),b=n(8934),S=n(3230),A=n(9312),x=n(4725),E=n(6731),D=n(8055),L=n(8969),T=n(8460),F=n(844),K=n(6114),N=n(8437),X=n(2584),k=n(7399),y=n(5941),C=n(9074),B=n(2585),I=n(5435),R=n(4567),H=n(779);class $ extends L.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(P={}){super(P),this.browser=K,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new F.MutableDisposable),this._onCursorMove=this.register(new T.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new T.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new T.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new T.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new T.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new T.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new T.EventEmitter),this._onBlur=this.register(new T.EventEmitter),this._onA11yCharEmitter=this.register(new T.EventEmitter),this._onA11yTabEmitter=this.register(new T.EventEmitter),this._onWillOpen=this.register(new T.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(C.DecorationService),this._instantiationService.setService(B.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(H.LinkProviderService),this._instantiationService.setService(x.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((M,U)=>this.refresh(M,U))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(M=>this._reportWindowsOptions(M))),this.register(this._inputHandler.onColor(M=>this._handleColorEvent(M))),this.register((0,T.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,T.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,T.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(M=>this._afterResize(M.cols,M.rows))),this.register((0,F.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(P){if(this._themeService)for(let M of P){let U,Z="";switch(M.index){case 256:U="foreground",Z="10";break;case 257:U="background",Z="11";break;case 258:U="cursor",Z="12";break;default:U="ansi",Z="4;"+M.index}switch(M.type){case 0:let te=D.color.toColorRGB(U==="ansi"?this._themeService.colors.ansi[M.index]:this._themeService.colors[U]);this.coreService.triggerDataEvent(`${X.C0.ESC}]${Z};${(0,y.toRgbString)(te)}${X.C1_ESCAPED.ST}`);break;case 1:if(U==="ansi")this._themeService.modifyColors(ee=>ee.ansi[M.index]=D.channels.toColor(...M.color));else{let ee=U;this._themeService.modifyColors(le=>le[ee]=D.channels.toColor(...M.color))}break;case 2:this._themeService.restoreColor(M.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(P){P?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(R.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(P){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let P=this.buffer.ybase+this.buffer.y,M=this.buffer.lines.get(P);if(!M)return;let U=Math.min(this.buffer.x,this.cols-1),Z=this._renderService.dimensions.css.cell.height,te=M.getWidth(U),ee=this._renderService.dimensions.css.cell.width*te,le=this.buffer.y*this._renderService.dimensions.css.cell.height,ne=U*this._renderService.dimensions.css.cell.width;this.textarea.style.left=ne+"px",this.textarea.style.top=le+"px",this.textarea.style.width=ee+"px",this.textarea.style.height=Z+"px",this.textarea.style.lineHeight=Z+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,g.addDisposableDomListener)(this.element,"copy",M=>{this.hasSelection()&&(0,h.copyHandler)(M,this._selectionService)}));let P=M=>(0,h.handlePasteEvent)(M,this.textarea,this.coreService,this.optionsService);this.register((0,g.addDisposableDomListener)(this.textarea,"paste",P)),this.register((0,g.addDisposableDomListener)(this.element,"paste",P)),K.isFirefox?this.register((0,g.addDisposableDomListener)(this.element,"mousedown",M=>{M.button===2&&(0,h.rightClickHandler)(M,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,g.addDisposableDomListener)(this.element,"contextmenu",M=>{(0,h.rightClickHandler)(M,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),K.isLinux&&this.register((0,g.addDisposableDomListener)(this.element,"auxclick",M=>{M.button===1&&(0,h.moveTextAreaUnderMouseCursor)(M,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,g.addDisposableDomListener)(this.textarea,"keyup",P=>this._keyUp(P),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"keydown",P=>this._keyDown(P),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"keypress",P=>this._keyPress(P),!0)),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionupdate",P=>this._compositionHelper.compositionupdate(P))),this.register((0,g.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,g.addDisposableDomListener)(this.textarea,"input",P=>this._inputEvent(P),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(P){if(!P)throw new Error("Terminal requires a parent element.");if(P.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=P.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),P.appendChild(this.element);let M=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),M.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,g.addDisposableDomListener)(this.screenElement,"mousemove",U=>this.updateCursorStyle(U))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),M.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",c.promptLabel),K.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(w.CoreBrowserService,this.textarea,P.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(x.ICoreBrowserService,this._coreBrowserService),this.register((0,g.addDisposableDomListener)(this.textarea,"focus",U=>this._handleTextAreaFocus(U))),this.register((0,g.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(p.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(x.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(E.ThemeService),this._instantiationService.setService(x.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(m.CharacterJoinerService),this._instantiationService.setService(x.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(x.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(U=>this._onRender.fire(U))),this.onResize(U=>this._renderService.resize(U.cols,U.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(d.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(b.MouseService),this._instantiationService.setService(x.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(o.Linkifier,this.screenElement)),this.element.appendChild(M);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(v.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(A.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(x.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(U=>this.scrollLines(U.amount,U.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(U=>this._renderService.handleSelectionChanged(U.start,U.end,U.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(U=>{this.textarea.value=U,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(U=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,g.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(u.BufferDecorationRenderer,this.screenElement)),this.register((0,g.addDisposableDomListener)(this.element,"mousedown",U=>this._selectionService.handleMouseDown(U))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(R.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",U=>this._handleScreenReaderModeOptionChange(U))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(a.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",U=>{!this._overviewRulerRenderer&&U&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(a.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(_.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let P=this,M=this.element;function U(ee){let le=P._mouseService.getMouseReportCoords(ee,P.screenElement);if(!le)return!1;let ne,ye;switch(ee.overrideType||ee.type){case"mousemove":ye=32,ee.buttons===void 0?(ne=3,ee.button!==void 0&&(ne=ee.button<3?ee.button:3)):ne=1&ee.buttons?0:4&ee.buttons?1:2&ee.buttons?2:3;break;case"mouseup":ye=0,ne=ee.button<3?ee.button:3;break;case"mousedown":ye=1,ne=ee.button<3?ee.button:3;break;case"wheel":if(P._customWheelEventHandler&&P._customWheelEventHandler(ee)===!1||P.viewport.getLinesScrolled(ee)===0)return!1;ye=ee.deltaY<0?0:1,ne=4;break;default:return!1}return!(ye===void 0||ne===void 0||ne>4)&&P.coreMouseService.triggerMouseEvent({col:le.col,row:le.row,x:le.x,y:le.y,button:ne,action:ye,ctrl:ee.ctrlKey,alt:ee.altKey,shift:ee.shiftKey})}let Z={mouseup:null,wheel:null,mousedrag:null,mousemove:null},te={mouseup:ee=>(U(ee),ee.buttons||(this._document.removeEventListener("mouseup",Z.mouseup),Z.mousedrag&&this._document.removeEventListener("mousemove",Z.mousedrag)),this.cancel(ee)),wheel:ee=>(U(ee),this.cancel(ee,!0)),mousedrag:ee=>{ee.buttons&&U(ee)},mousemove:ee=>{ee.buttons||U(ee)}};this.register(this.coreMouseService.onProtocolChange(ee=>{ee?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ee)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ee?Z.mousemove||(M.addEventListener("mousemove",te.mousemove),Z.mousemove=te.mousemove):(M.removeEventListener("mousemove",Z.mousemove),Z.mousemove=null),16&ee?Z.wheel||(M.addEventListener("wheel",te.wheel,{passive:!1}),Z.wheel=te.wheel):(M.removeEventListener("wheel",Z.wheel),Z.wheel=null),2&ee?Z.mouseup||(Z.mouseup=te.mouseup):(this._document.removeEventListener("mouseup",Z.mouseup),Z.mouseup=null),4&ee?Z.mousedrag||(Z.mousedrag=te.mousedrag):(this._document.removeEventListener("mousemove",Z.mousedrag),Z.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,g.addDisposableDomListener)(M,"mousedown",ee=>{if(ee.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ee))return U(ee),Z.mouseup&&this._document.addEventListener("mouseup",Z.mouseup),Z.mousedrag&&this._document.addEventListener("mousemove",Z.mousedrag),this.cancel(ee)})),this.register((0,g.addDisposableDomListener)(M,"wheel",ee=>{if(!Z.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(ee)===!1)return!1;if(!this.buffer.hasScrollback){let le=this.viewport.getLinesScrolled(ee);if(le===0)return;let ne=X.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ee.deltaY<0?"A":"B"),ye="";for(let Te=0;Te<Math.abs(le);Te++)ye+=ne;return this.coreService.triggerDataEvent(ye,!0),this.cancel(ee,!0)}return this.viewport.handleWheel(ee)?this.cancel(ee):void 0}},{passive:!1})),this.register((0,g.addDisposableDomListener)(M,"touchstart",ee=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ee),this.cancel(ee)},{passive:!0})),this.register((0,g.addDisposableDomListener)(M,"touchmove",ee=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ee)?void 0:this.cancel(ee)},{passive:!1}))}refresh(P,M){this._renderService?.refreshRows(P,M)}updateCursorStyle(P){this._selectionService?.shouldColumnSelect(P)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(P,M,U=0){U===1?(super.scrollLines(P,M,U),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(P)}paste(P){(0,h.paste)(P,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(P){this._customKeyEventHandler=P}attachCustomWheelEventHandler(P){this._customWheelEventHandler=P}registerLinkProvider(P){return this._linkProviderService.registerLinkProvider(P)}registerCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let M=this._characterJoinerService.register(P);return this.refresh(0,this.rows-1),M}deregisterCharacterJoiner(P){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(P)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(P){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+P)}registerDecoration(P){return this._decorationService.registerDecoration(P)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(P,M,U){this._selectionService.setSelection(P,M,U)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(P,M){this._selectionService?.selectLines(P,M)}_keyDown(P){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;let M=this.browser.isMac&&this.options.macOptionIsMeta&&P.altKey;if(!M&&!this._compositionHelper.keydown(P))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;M||P.key!=="Dead"&&P.key!=="AltGraph"||(this._unprocessedDeadKey=!0);let U=(0,k.evaluateKeyboardEvent)(P,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(P),U.type===3||U.type===2){let Z=this.rows-1;return this.scrollLines(U.type===2?-Z:Z),this.cancel(P,!0)}return U.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,P)||(U.cancel&&this.cancel(P,!0),!U.key||!!(P.key&&!P.ctrlKey&&!P.altKey&&!P.metaKey&&P.key.length===1&&P.key.charCodeAt(0)>=65&&P.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(U.key!==X.C0.ETX&&U.key!==X.C0.CR||(this.textarea.value=""),this._onKey.fire({key:U.key,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(U.key,!0),!this.optionsService.rawOptions.screenReaderMode||P.altKey||P.ctrlKey?this.cancel(P,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(P,M){let U=P.isMac&&!this.options.macOptionIsMeta&&M.altKey&&!M.ctrlKey&&!M.metaKey||P.isWindows&&M.altKey&&M.ctrlKey&&!M.metaKey||P.isWindows&&M.getModifierState("AltGraph");return M.type==="keypress"?U:U&&(!M.keyCode||M.keyCode>47)}_keyUp(P){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1||(function(M){return M.keyCode===16||M.keyCode===17||M.keyCode===18}(P)||this.focus(),this.updateCursorStyle(P),this._keyPressHandled=!1)}_keyPress(P){let M;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(P)===!1)return!1;if(this.cancel(P),P.charCode)M=P.charCode;else if(P.which===null||P.which===void 0)M=P.keyCode;else{if(P.which===0||P.charCode===0)return!1;M=P.which}return!(!M||(P.altKey||P.ctrlKey||P.metaKey)&&!this._isThirdLevelShift(this.browser,P)||(M=String.fromCharCode(M),this._onKey.fire({key:M,domEvent:P}),this._showCursor(),this.coreService.triggerDataEvent(M,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(P){if(P.data&&P.inputType==="insertText"&&(!P.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let M=P.data;return this.coreService.triggerDataEvent(M,!0),this.cancel(P),!0}return!1}resize(P,M){P!==this.cols||M!==this.rows?super.resize(P,M):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(P,M){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let P=1;P<this.rows;P++)this.buffer.lines.push(this.buffer.getBlankLine(N.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let P=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=P,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(X.C0.ESC+"[I"):this.coreService.triggerDataEvent(X.C0.ESC+"[O")}_reportWindowsOptions(P){if(this._renderService)switch(P){case I.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:let M=this._renderService.dimensions.css.canvas.width.toFixed(0),U=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[4;${U};${M}t`);break;case I.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:let Z=this._renderService.dimensions.css.cell.width.toFixed(0),te=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[6;${te};${Z}t`)}}cancel(P,M){if(this.options.cancelEvents||M)return P.preventDefault(),P.stopPropagation(),!1}}t.Terminal=$},9924:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(n,h=1e3){this._renderCallback=n,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(n,h,g){this._rowCount=g,n=n!==void 0?n:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,n):n,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;let o=Date.now();if(o-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=o,this._innerRefresh();else if(!this._additionalRefreshRequested){let c=o-this._lastRefreshMs,f=this._debounceThresholdMS-c;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let n=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(n,h)}}},1680:function(l,t,n){var h=this&&this.__decorate||function(d,_,p,m){var w,b=arguments.length,S=b<3?_:m===null?m=Object.getOwnPropertyDescriptor(_,p):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(d,_,p,m);else for(var A=d.length-1;A>=0;A--)(w=d[A])&&(S=(b<3?w(S):b>3?w(_,p,S):w(_,p))||S);return b>3&&S&&Object.defineProperty(_,p,S),S},g=this&&this.__param||function(d,_){return function(p,m){_(p,m,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;let o=n(3656),c=n(4725),f=n(8460),v=n(844),u=n(2585),a=t.Viewport=class extends v.Disposable{constructor(d,_,p,m,w,b,S,A){super(),this._viewportElement=d,this._scrollArea=_,this._bufferService=p,this._optionsService=m,this._charSizeService=w,this._renderService=b,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,o.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(x=>this._activeBuffer=x.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(x=>this._renderDimensions=x)),this._handleThemeChange(A.colors),this.register(A.onChangeColors(x=>this._handleThemeChange(x))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(d){this._viewportElement.style.backgroundColor=d.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(d){if(d)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;let _=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==_&&(this._lastRecordedBufferHeight=_,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}let d=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==d&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=d),this._refreshAnimationFrame=null}syncScrollArea(d=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(d);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(d)}_handleScroll(d){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});let _=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:_,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;let d=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(d*(this._smoothScrollState.target-this._smoothScrollState.origin)),d<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(d,_){let p=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(_<0&&this._viewportElement.scrollTop!==0||_>0&&p<this._lastRecordedBufferHeight)||(d.cancelable&&d.preventDefault(),!1)}handleWheel(d){let _=this._getPixelsScrolled(d);return _!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+_:this._smoothScrollState.target+=_,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=_,this._bubbleScroll(d,_))}scrollLines(d){if(d!==0)if(this._optionsService.rawOptions.smoothScrollDuration){let _=d*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+_,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:d,suppressScrollEvent:!1})}_getPixelsScrolled(d){if(d.deltaY===0||d.shiftKey)return 0;let _=this._applyScrollModifier(d.deltaY,d);return d.deltaMode===WheelEvent.DOM_DELTA_LINE?_*=this._currentRowHeight:d.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(_*=this._currentRowHeight*this._bufferService.rows),_}getBufferElements(d,_){let p,m="",w=[],b=_??this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let A=d;A<b;A++){let x=S.get(A);if(!x)continue;let E=S.get(A+1)?.isWrapped;if(m+=x.translateToString(!E),!E||A===S.length-1){let D=document.createElement("div");D.textContent=m,w.push(D),m.length>0&&(p=D),m=""}}return{bufferElements:w,cursorElement:p}}getLinesScrolled(d){if(d.deltaY===0||d.shiftKey)return 0;let _=this._applyScrollModifier(d.deltaY,d);return d.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(_/=this._currentRowHeight+0,this._wheelPartialScroll+=_,_=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):d.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(_*=this._bufferService.rows),_}_applyScrollModifier(d,_){let p=this._optionsService.rawOptions.fastScrollModifier;return p==="alt"&&_.altKey||p==="ctrl"&&_.ctrlKey||p==="shift"&&_.shiftKey?d*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:d*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(d){this._lastTouchY=d.touches[0].pageY}handleTouchMove(d){let _=this._lastTouchY-d.touches[0].pageY;return this._lastTouchY=d.touches[0].pageY,_!==0&&(this._viewportElement.scrollTop+=_,this._bubbleScroll(d,_))}};t.Viewport=a=h([g(2,u.IBufferService),g(3,u.IOptionsService),g(4,c.ICharSizeService),g(5,c.IRenderService),g(6,c.ICoreBrowserService),g(7,c.IThemeService)],a)},3107:function(l,t,n){var h=this&&this.__decorate||function(u,a,d,_){var p,m=arguments.length,w=m<3?a:_===null?_=Object.getOwnPropertyDescriptor(a,d):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,a,d,_);else for(var b=u.length-1;b>=0;b--)(p=u[b])&&(w=(m<3?p(w):m>3?p(a,d,w):p(a,d))||w);return m>3&&w&&Object.defineProperty(a,d,w),w},g=this&&this.__param||function(u,a){return function(d,_){a(d,_,u)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;let o=n(4725),c=n(844),f=n(2585),v=t.BufferDecorationRenderer=class extends c.Disposable{constructor(u,a,d,_,p){super(),this._screenElement=u,this._bufferService=a,this._coreBrowserService=d,this._decorationService=_,this._renderService=p,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(m=>this._removeDecoration(m))),this.register((0,c.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let u of this._decorationService.decorations)this._renderDecoration(u);this._dimensionsChanged=!1}_renderDecoration(u){this._refreshStyle(u),this._dimensionsChanged&&this._refreshXPosition(u)}_createElement(u){let a=this._coreBrowserService.mainDocument.createElement("div");a.classList.add("xterm-decoration"),a.classList.toggle("xterm-decoration-top-layer",u?.options?.layer==="top"),a.style.width=`${Math.round((u.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,a.style.height=(u.options.height||1)*this._renderService.dimensions.css.cell.height+"px",a.style.top=(u.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",a.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let d=u.options.x??0;return d&&d>this._bufferService.cols&&(a.style.display="none"),this._refreshXPosition(u,a),a}_refreshStyle(u){let a=u.marker.line-this._bufferService.buffers.active.ydisp;if(a<0||a>=this._bufferService.rows)u.element&&(u.element.style.display="none",u.onRenderEmitter.fire(u.element));else{let d=this._decorationElements.get(u);d||(d=this._createElement(u),u.element=d,this._decorationElements.set(u,d),this._container.appendChild(d),u.onDispose(()=>{this._decorationElements.delete(u),d.remove()})),d.style.top=a*this._renderService.dimensions.css.cell.height+"px",d.style.display=this._altBufferIsActive?"none":"block",u.onRenderEmitter.fire(d)}}_refreshXPosition(u,a=u.element){if(!a)return;let d=u.options.x??0;(u.options.anchor||"left")==="right"?a.style.right=d?d*this._renderService.dimensions.css.cell.width+"px":"":a.style.left=d?d*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(u){this._decorationElements.get(u)?.remove(),this._decorationElements.delete(u),u.dispose()}};t.BufferDecorationRenderer=v=h([g(1,f.IBufferService),g(2,o.ICoreBrowserService),g(3,f.IDecorationService),g(4,o.IRenderService)],v)},5871:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(n){if(n.options.overviewRulerOptions){for(let h of this._zones)if(h.color===n.options.overviewRulerOptions.color&&h.position===n.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,n.marker.line))return;if(this._lineAdjacentToZone(h,n.marker.line,n.options.overviewRulerOptions.position))return void this._addLineToZone(h,n.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=n.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=n.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=n.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=n.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:n.options.overviewRulerOptions.color,position:n.options.overviewRulerOptions.position,startBufferLine:n.marker.line,endBufferLine:n.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(n){this._linePadding=n}_lineIntersectsZone(n,h){return h>=n.startBufferLine&&h<=n.endBufferLine}_lineAdjacentToZone(n,h,g){return h>=n.startBufferLine-this._linePadding[g||"full"]&&h<=n.endBufferLine+this._linePadding[g||"full"]}_addLineToZone(n,h){n.startBufferLine=Math.min(n.startBufferLine,h),n.endBufferLine=Math.max(n.endBufferLine,h)}}},5744:function(l,t,n){var h=this&&this.__decorate||function(p,m,w,b){var S,A=arguments.length,x=A<3?m:b===null?b=Object.getOwnPropertyDescriptor(m,w):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(p,m,w,b);else for(var E=p.length-1;E>=0;E--)(S=p[E])&&(x=(A<3?S(x):A>3?S(m,w,x):S(m,w))||x);return A>3&&x&&Object.defineProperty(m,w,x),x},g=this&&this.__param||function(p,m){return function(w,b){m(w,b,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;let o=n(5871),c=n(4725),f=n(844),v=n(2585),u={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0},d={full:0,left:0,center:0,right:0},_=t.OverviewRulerRenderer=class extends f.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(p,m,w,b,S,A,x){super(),this._viewportElement=p,this._screenElement=m,this._bufferService=w,this._decorationService=b,this._renderService=S,this._optionsService=A,this._coreBrowserService=x,this._colorZoneStore=new o.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);let E=this._canvas.getContext("2d");if(!E)throw new Error("Ctx cannot be null");this._ctx=E,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,f.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){let p=Math.floor(this._canvas.width/3),m=Math.ceil(this._canvas.width/3);a.full=this._canvas.width,a.left=p,a.center=m,a.right=p,this._refreshDrawHeightConstants(),d.full=0,d.left=0,d.center=a.left,d.right=a.left+a.center}_refreshDrawHeightConstants(){u.full=Math.round(2*this._coreBrowserService.dpr);let p=this._canvas.height/this._bufferService.buffer.lines.length,m=Math.round(Math.max(Math.min(p,12),6)*this._coreBrowserService.dpr);u.left=m,u.center=m,u.right=m}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*u.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let m of this._decorationService.decorations)this._colorZoneStore.addDecoration(m);this._ctx.lineWidth=1;let p=this._colorZoneStore.zones;for(let m of p)m.position!=="full"&&this._renderColorZone(m);for(let m of p)m.position==="full"&&this._renderColorZone(m);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(p){this._ctx.fillStyle=p.color,this._ctx.fillRect(d[p.position||"full"],Math.round((this._canvas.height-1)*(p.startBufferLine/this._bufferService.buffers.active.lines.length)-u[p.position||"full"]/2),a[p.position||"full"],Math.round((this._canvas.height-1)*((p.endBufferLine-p.startBufferLine)/this._bufferService.buffers.active.lines.length)+u[p.position||"full"]))}_queueRefresh(p,m){this._shouldUpdateDimensions=p||this._shouldUpdateDimensions,this._shouldUpdateAnchor=m||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};t.OverviewRulerRenderer=_=h([g(2,v.IBufferService),g(3,v.IDecorationService),g(4,c.IRenderService),g(5,v.IOptionsService),g(6,c.ICoreBrowserService)],_)},2950:function(l,t,n){var h=this&&this.__decorate||function(u,a,d,_){var p,m=arguments.length,w=m<3?a:_===null?_=Object.getOwnPropertyDescriptor(a,d):_;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,a,d,_);else for(var b=u.length-1;b>=0;b--)(p=u[b])&&(w=(m<3?p(w):m>3?p(a,d,w):p(a,d))||w);return m>3&&w&&Object.defineProperty(a,d,w),w},g=this&&this.__param||function(u,a){return function(d,_){a(d,_,u)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;let o=n(4725),c=n(2585),f=n(2584),v=t.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(u,a,d,_,p,m){this._textarea=u,this._compositionView=a,this._bufferService=d,this._optionsService=_,this._coreService=p,this._renderService=m,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(u){this._compositionView.textContent=u.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(u){if(this._isComposing||this._isSendingComposition){if(u.keyCode===229||u.keyCode===16||u.keyCode===17||u.keyCode===18)return!1;this._finalizeComposition(!1)}return u.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(u){if(this._compositionView.classList.remove("active"),this._isComposing=!1,u){let a={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let d;this._isSendingComposition=!1,a.start+=this._dataAlreadySent.length,d=this._isComposing?this._textarea.value.substring(a.start,a.end):this._textarea.value.substring(a.start),d.length>0&&this._coreService.triggerDataEvent(d,!0)}},0)}else{this._isSendingComposition=!1;let a=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(a,!0)}}_handleAnyTextareaChanges(){let u=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let a=this._textarea.value,d=a.replace(u,"");this._dataAlreadySent=d,a.length>u.length?this._coreService.triggerDataEvent(d,!0):a.length<u.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):a.length===u.length&&a!==u&&this._coreService.triggerDataEvent(a,!0)}},0)}updateCompositionElements(u){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let a=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),d=this._renderService.dimensions.css.cell.height,_=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,p=a*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=p+"px",this._compositionView.style.top=_+"px",this._compositionView.style.height=d+"px",this._compositionView.style.lineHeight=d+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let m=this._compositionView.getBoundingClientRect();this._textarea.style.left=p+"px",this._textarea.style.top=_+"px",this._textarea.style.width=Math.max(m.width,1)+"px",this._textarea.style.height=Math.max(m.height,1)+"px",this._textarea.style.lineHeight=m.height+"px"}u||setTimeout(()=>this.updateCompositionElements(!0),0)}}};t.CompositionHelper=v=h([g(2,c.IBufferService),g(3,c.IOptionsService),g(4,c.ICoreService),g(5,o.IRenderService)],v)},9806:(l,t)=>{function n(h,g,o){let c=o.getBoundingClientRect(),f=h.getComputedStyle(o),v=parseInt(f.getPropertyValue("padding-left")),u=parseInt(f.getPropertyValue("padding-top"));return[g.clientX-c.left-v,g.clientY-c.top-u]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=n,t.getCoords=function(h,g,o,c,f,v,u,a,d){if(!v)return;let _=n(h,g,o);return _?(_[0]=Math.ceil((_[0]+(d?u/2:0))/u),_[1]=Math.ceil(_[1]/a),_[0]=Math.min(Math.max(_[0],1),c+(d?1:0)),_[1]=Math.min(Math.max(_[1],1),f),_):void 0}},9504:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;let h=n(2584);function g(a,d,_,p){let m=a-o(a,_),w=d-o(d,_),b=Math.abs(m-w)-function(S,A,x){let E=0,D=S-o(S,x),L=A-o(A,x);for(let T=0;T<Math.abs(D-L);T++){let F=c(S,A)==="A"?-1:1;x.buffer.lines.get(D+F*T)?.isWrapped&&E++}return E}(a,d,_);return u(b,v(c(a,d),p))}function o(a,d){let _=0,p=d.buffer.lines.get(a),m=p?.isWrapped;for(;m&&a>=0&&a<d.rows;)_++,p=d.buffer.lines.get(--a),m=p?.isWrapped;return _}function c(a,d){return a>d?"A":"B"}function f(a,d,_,p,m,w){let b=a,S=d,A="";for(;b!==_||S!==p;)b+=m?1:-1,m&&b>w.cols-1?(A+=w.buffer.translateBufferLineToString(S,!1,a,b),b=0,a=0,S++):!m&&b<0&&(A+=w.buffer.translateBufferLineToString(S,!1,0,a+1),b=w.cols-1,a=b,S--);return A+w.buffer.translateBufferLineToString(S,!1,a,b)}function v(a,d){let _=d?"O":"[";return h.C0.ESC+_+a}function u(a,d){a=Math.floor(a);let _="";for(let p=0;p<a;p++)_+=d;return _}t.moveToCellSequence=function(a,d,_,p){let m=_.buffer.x,w=_.buffer.y;if(!_.buffer.hasScrollback)return function(A,x,E,D,L,T){return g(x,D,L,T).length===0?"":u(f(A,x,A,x-o(x,L),!1,L).length,v("D",T))}(m,w,0,d,_,p)+g(w,d,_,p)+function(A,x,E,D,L,T){let F;F=g(x,D,L,T).length>0?D-o(D,L):x;let K=D,N=function(X,k,y,C,B,I){let R;return R=g(y,C,B,I).length>0?C-o(C,B):k,X<y&&R<=C||X>=y&&R<C?"C":"D"}(A,x,E,D,L,T);return u(f(A,F,E,K,N==="C",L).length,v(N,T))}(m,w,a,d,_,p);let b;if(w===d)return b=m>a?"D":"C",u(Math.abs(m-a),v(b,p));b=w>d?"D":"C";let S=Math.abs(w-d);return u(function(A,x){return x.cols-A}(w>d?a:m,_)+(S-1)*_.cols+1+((w>d?m:a)-1),v(b,p))}},1296:function(l,t,n){var h=this&&this.__decorate||function(T,F,K,N){var X,k=arguments.length,y=k<3?F:N===null?N=Object.getOwnPropertyDescriptor(F,K):N;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(T,F,K,N);else for(var C=T.length-1;C>=0;C--)(X=T[C])&&(y=(k<3?X(y):k>3?X(F,K,y):X(F,K))||y);return k>3&&y&&Object.defineProperty(F,K,y),y},g=this&&this.__param||function(T,F){return function(K,N){F(K,N,T)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;let o=n(3787),c=n(2550),f=n(2223),v=n(6171),u=n(6052),a=n(4725),d=n(8055),_=n(8460),p=n(844),m=n(2585),w="xterm-dom-renderer-owner-",b="xterm-rows",S="xterm-fg-",A="xterm-bg-",x="xterm-focus",E="xterm-selection",D=1,L=t.DomRenderer=class extends p.Disposable{constructor(T,F,K,N,X,k,y,C,B,I,R,H,$){super(),this._terminal=T,this._document=F,this._element=K,this._screenElement=N,this._viewportElement=X,this._helperContainer=k,this._linkifier2=y,this._charSizeService=B,this._optionsService=I,this._bufferService=R,this._coreBrowserService=H,this._themeService=$,this._terminalClass=D++,this._rowElements=[],this._selectionRenderModel=(0,u.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new _.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(b),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(E),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,v.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(q=>this._injectCss(q))),this._injectCss(this._themeService.colors),this._rowFactory=C.createInstance(o.DomRendererRowFactory,document),this._element.classList.add(w+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(q=>this._handleLinkHover(q))),this.register(this._linkifier2.onHideLinkUnderline(q=>this._handleLinkLeave(q))),this.register((0,p.toDisposable)(()=>{this._element.classList.remove(w+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new c.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let T=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*T,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*T),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/T),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/T),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let K of this._rowElements)K.style.width=`${this.dimensions.css.canvas.width}px`,K.style.height=`${this.dimensions.css.cell.height}px`,K.style.lineHeight=`${this.dimensions.css.cell.height}px`,K.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let F=`${this._terminalSelector} .${b} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=F,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(T){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let F=`${this._terminalSelector} .${b} { color: ${T.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;F+=`${this._terminalSelector} .${b} .xterm-dim { color: ${d.color.multiplyOpacity(T.foreground,.5).css};}`,F+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let K=`blink_underline_${this._terminalClass}`,N=`blink_bar_${this._terminalClass}`,X=`blink_block_${this._terminalClass}`;F+=`@keyframes ${K} { 50% {  border-bottom-style: hidden; }}`,F+=`@keyframes ${N} { 50% {  box-shadow: none; }}`,F+=`@keyframes ${X} { 0% {  background-color: ${T.cursor.css};  color: ${T.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${T.cursor.css}; }}`,F+=`${this._terminalSelector} .${b}.${x} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${K} 1s step-end infinite;}${this._terminalSelector} .${b}.${x} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${N} 1s step-end infinite;}${this._terminalSelector} .${b}.${x} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block { background-color: ${T.cursor.css}; color: ${T.cursorAccent.css};}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${T.cursor.css} !important; color: ${T.cursorAccent.css} !important;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${T.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${T.cursor.css} inset;}${this._terminalSelector} .${b} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${T.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,F+=`${this._terminalSelector} .${E} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${E} div { position: absolute; background-color: ${T.selectionBackgroundOpaque.css};}${this._terminalSelector} .${E} div { position: absolute; background-color: ${T.selectionInactiveBackgroundOpaque.css};}`;for(let[k,y]of T.ansi.entries())F+=`${this._terminalSelector} .${S}${k} { color: ${y.css}; }${this._terminalSelector} .${S}${k}.xterm-dim { color: ${d.color.multiplyOpacity(y,.5).css}; }${this._terminalSelector} .${A}${k} { background-color: ${y.css}; }`;F+=`${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR} { color: ${d.color.opaque(T.background).css}; }${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${d.color.multiplyOpacity(d.color.opaque(T.background),.5).css}; }${this._terminalSelector} .${A}${f.INVERTED_DEFAULT_COLOR} { background-color: ${T.foreground.css}; }`,this._themeStyleElement.textContent=F}_setDefaultSpacing(){let T=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${T}px`,this._rowFactory.defaultSpacing=T}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(T,F){for(let K=this._rowElements.length;K<=F;K++){let N=this._document.createElement("div");this._rowContainer.appendChild(N),this._rowElements.push(N)}for(;this._rowElements.length>F;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(T,F){this._refreshRowElements(T,F),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(x),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(x),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(T,F,K){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(T,F,K),this.renderRows(0,this._bufferService.rows-1),!T||!F)return;this._selectionRenderModel.update(this._terminal,T,F,K);let N=this._selectionRenderModel.viewportStartRow,X=this._selectionRenderModel.viewportEndRow,k=this._selectionRenderModel.viewportCappedStartRow,y=this._selectionRenderModel.viewportCappedEndRow;if(k>=this._bufferService.rows||y<0)return;let C=this._document.createDocumentFragment();if(K){let B=T[0]>F[0];C.appendChild(this._createSelectionElement(k,B?F[0]:T[0],B?T[0]:F[0],y-k+1))}else{let B=N===k?T[0]:0,I=k===X?F[0]:this._bufferService.cols;C.appendChild(this._createSelectionElement(k,B,I));let R=y-k-1;if(C.appendChild(this._createSelectionElement(k+1,0,this._bufferService.cols,R)),k!==y){let H=X===y?F[0]:this._bufferService.cols;C.appendChild(this._createSelectionElement(y,0,H))}}this._selectionContainer.appendChild(C)}_createSelectionElement(T,F,K,N=1){let X=this._document.createElement("div"),k=F*this.dimensions.css.cell.width,y=this.dimensions.css.cell.width*(K-F);return k+y>this.dimensions.css.canvas.width&&(y=this.dimensions.css.canvas.width-k),X.style.height=N*this.dimensions.css.cell.height+"px",X.style.top=T*this.dimensions.css.cell.height+"px",X.style.left=`${k}px`,X.style.width=`${y}px`,X}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let T of this._rowElements)T.replaceChildren()}renderRows(T,F){let K=this._bufferService.buffer,N=K.ybase+K.y,X=Math.min(K.x,this._bufferService.cols-1),k=this._optionsService.rawOptions.cursorBlink,y=this._optionsService.rawOptions.cursorStyle,C=this._optionsService.rawOptions.cursorInactiveStyle;for(let B=T;B<=F;B++){let I=B+K.ydisp,R=this._rowElements[B],H=K.lines.get(I);if(!R||!H)break;R.replaceChildren(...this._rowFactory.createRow(H,I,I===N,y,C,X,k,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${w}${this._terminalClass}`}_handleLinkHover(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!0)}_handleLinkLeave(T){this._setCellUnderline(T.x1,T.x2,T.y1,T.y2,T.cols,!1)}_setCellUnderline(T,F,K,N,X,k){K<0&&(T=0),N<0&&(F=0);let y=this._bufferService.rows-1;K=Math.max(Math.min(K,y),0),N=Math.max(Math.min(N,y),0),X=Math.min(X,this._bufferService.cols);let C=this._bufferService.buffer,B=C.ybase+C.y,I=Math.min(C.x,X-1),R=this._optionsService.rawOptions.cursorBlink,H=this._optionsService.rawOptions.cursorStyle,$=this._optionsService.rawOptions.cursorInactiveStyle;for(let q=K;q<=N;++q){let P=q+C.ydisp,M=this._rowElements[q],U=C.lines.get(P);if(!M||!U)break;M.replaceChildren(...this._rowFactory.createRow(U,P,P===B,H,$,I,R,this.dimensions.css.cell.width,this._widthCache,k?q===K?T:0:-1,k?(q===N?F:X)-1:-1))}}};t.DomRenderer=L=h([g(7,m.IInstantiationService),g(8,a.ICharSizeService),g(9,m.IOptionsService),g(10,m.IBufferService),g(11,a.ICoreBrowserService),g(12,a.IThemeService)],L)},3787:function(l,t,n){var h=this&&this.__decorate||function(b,S,A,x){var E,D=arguments.length,L=D<3?S:x===null?x=Object.getOwnPropertyDescriptor(S,A):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(b,S,A,x);else for(var T=b.length-1;T>=0;T--)(E=b[T])&&(L=(D<3?E(L):D>3?E(S,A,L):E(S,A))||L);return D>3&&L&&Object.defineProperty(S,A,L),L},g=this&&this.__param||function(b,S){return function(A,x){S(A,x,b)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=void 0;let o=n(2223),c=n(643),f=n(511),v=n(2585),u=n(8055),a=n(4725),d=n(4269),_=n(6171),p=n(3734),m=t.DomRendererRowFactory=class{constructor(b,S,A,x,E,D,L){this._document=b,this._characterJoinerService=S,this._optionsService=A,this._coreBrowserService=x,this._coreService=E,this._decorationService=D,this._themeService=L,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(b,S,A){this._selectionStart=b,this._selectionEnd=S,this._columnSelectMode=A}createRow(b,S,A,x,E,D,L,T,F,K,N){let X=[],k=this._characterJoinerService.getJoinedCharacters(S),y=this._themeService.colors,C,B=b.getNoBgTrimmedLength();A&&B<D+1&&(B=D+1);let I=0,R="",H=0,$=0,q=0,P=!1,M=0,U=!1,Z=0,te=[],ee=K!==-1&&N!==-1;for(let le=0;le<B;le++){b.loadCell(le,this._workCell);let ne=this._workCell.getWidth();if(ne===0)continue;let ye=!1,Te=le,oe=this._workCell;if(k.length>0&&le===k[0][0]){ye=!0;let ce=k.shift();oe=new d.JoinedCellData(this._workCell,b.translateToString(!0,ce[0],ce[1]),ce[1]-ce[0]),Te=ce[1]-1,ne=oe.getWidth()}let dt=this._isCellInSelection(le,S),hi=A&&le===D,ve=ee&&le>=K&&le<=N,ue=!1;this._decorationService.forEachDecorationAtCell(le,S,void 0,ce=>{ue=!0});let de=oe.getChars()||c.WHITESPACE_CELL_CHAR;if(de===" "&&(oe.isUnderline()||oe.isOverline())&&(de="\xA0"),Z=ne*T-F.get(de,oe.isBold(),oe.isItalic()),C){if(I&&(dt&&U||!dt&&!U&&oe.bg===H)&&(dt&&U&&y.selectionForeground||oe.fg===$)&&oe.extended.ext===q&&ve===P&&Z===M&&!hi&&!ye&&!ue){oe.isInvisible()?R+=c.WHITESPACE_CELL_CHAR:R+=de,I++;continue}I&&(C.textContent=R),C=this._document.createElement("span"),I=0,R=""}else C=this._document.createElement("span");if(H=oe.bg,$=oe.fg,q=oe.extended.ext,P=ve,M=Z,U=dt,ye&&D>=le&&D<=Te&&(D=le),!this._coreService.isCursorHidden&&hi&&this._coreService.isCursorInitialized){if(te.push("xterm-cursor"),this._coreBrowserService.isFocused)L&&te.push("xterm-cursor-blink"),te.push(x==="bar"?"xterm-cursor-bar":x==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(E)switch(E){case"outline":te.push("xterm-cursor-outline");break;case"block":te.push("xterm-cursor-block");break;case"bar":te.push("xterm-cursor-bar");break;case"underline":te.push("xterm-cursor-underline")}}if(oe.isBold()&&te.push("xterm-bold"),oe.isItalic()&&te.push("xterm-italic"),oe.isDim()&&te.push("xterm-dim"),R=oe.isInvisible()?c.WHITESPACE_CELL_CHAR:oe.getChars()||c.WHITESPACE_CELL_CHAR,oe.isUnderline()&&(te.push(`xterm-underline-${oe.extended.underlineStyle}`),R===" "&&(R="\xA0"),!oe.isUnderlineColorDefault()))if(oe.isUnderlineColorRGB())C.style.textDecorationColor=`rgb(${p.AttributeData.toColorRGB(oe.getUnderlineColor()).join(",")})`;else{let ce=oe.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&oe.isBold()&&ce<8&&(ce+=8),C.style.textDecorationColor=y.ansi[ce].css}oe.isOverline()&&(te.push("xterm-overline"),R===" "&&(R="\xA0")),oe.isStrikethrough()&&te.push("xterm-strikethrough"),ve&&(C.style.textDecoration="underline");let ie=oe.getFgColor(),pe=oe.getFgColorMode(),De=oe.getBgColor(),Ce=oe.getBgColorMode(),wt=!!oe.isInverse();if(wt){let ce=ie;ie=De,De=ce;let Fi=pe;pe=Ce,Ce=Fi}let Ge,tt,Re,Ae=!1;switch(this._decorationService.forEachDecorationAtCell(le,S,void 0,ce=>{ce.options.layer!=="top"&&Ae||(ce.backgroundColorRGB&&(Ce=50331648,De=ce.backgroundColorRGB.rgba>>8&16777215,Ge=ce.backgroundColorRGB),ce.foregroundColorRGB&&(pe=50331648,ie=ce.foregroundColorRGB.rgba>>8&16777215,tt=ce.foregroundColorRGB),Ae=ce.options.layer==="top")}),!Ae&&dt&&(Ge=this._coreBrowserService.isFocused?y.selectionBackgroundOpaque:y.selectionInactiveBackgroundOpaque,De=Ge.rgba>>8&16777215,Ce=50331648,Ae=!0,y.selectionForeground&&(pe=50331648,ie=y.selectionForeground.rgba>>8&16777215,tt=y.selectionForeground)),Ae&&te.push("xterm-decoration-top"),Ce){case 16777216:case 33554432:Re=y.ansi[De],te.push(`xterm-bg-${De}`);break;case 50331648:Re=u.channels.toColor(De>>16,De>>8&255,255&De),this._addStyle(C,`background-color:#${w((De>>>0).toString(16),"0",6)}`);break;default:wt?(Re=y.foreground,te.push(`xterm-bg-${o.INVERTED_DEFAULT_COLOR}`)):Re=y.background}switch(Ge||oe.isDim()&&(Ge=u.color.multiplyOpacity(Re,.5)),pe){case 16777216:case 33554432:oe.isBold()&&ie<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(ie+=8),this._applyMinimumContrast(C,Re,y.ansi[ie],oe,Ge,void 0)||te.push(`xterm-fg-${ie}`);break;case 50331648:let ce=u.channels.toColor(ie>>16&255,ie>>8&255,255&ie);this._applyMinimumContrast(C,Re,ce,oe,Ge,tt)||this._addStyle(C,`color:#${w(ie.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(C,Re,y.foreground,oe,Ge,tt)||wt&&te.push(`xterm-fg-${o.INVERTED_DEFAULT_COLOR}`)}te.length&&(C.className=te.join(" "),te.length=0),hi||ye||ue?C.textContent=R:I++,Z!==this.defaultSpacing&&(C.style.letterSpacing=`${Z}px`),X.push(C),le=Te}return C&&I&&(C.textContent=R),X}_applyMinimumContrast(b,S,A,x,E,D){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,_.treatGlyphAsBackgroundColor)(x.getCode()))return!1;let L=this._getContrastCache(x),T;if(E||D||(T=L.getColor(S.rgba,A.rgba)),T===void 0){let F=this._optionsService.rawOptions.minimumContrastRatio/(x.isDim()?2:1);T=u.color.ensureContrastRatio(E||S,D||A,F),L.setColor((E||S).rgba,(D||A).rgba,T??null)}return!!T&&(this._addStyle(b,`color:${T.css}`),!0)}_getContrastCache(b){return b.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(b,S){b.setAttribute("style",`${b.getAttribute("style")||""}${S};`)}_isCellInSelection(b,S){let A=this._selectionStart,x=this._selectionEnd;return!(!A||!x)&&(this._columnSelectMode?A[0]<=x[0]?b>=A[0]&&S>=A[1]&&b<x[0]&&S<=x[1]:b<A[0]&&S>=A[1]&&b>=x[0]&&S<=x[1]:S>A[1]&&S<x[1]||A[1]===x[1]&&S===A[1]&&b>=A[0]&&b<x[0]||A[1]<x[1]&&S===x[1]&&b<x[0]||A[1]<x[1]&&S===A[1]&&b>=A[0])}};function w(b,S,A){for(;b.length<A;)b=S+b;return b}t.DomRendererRowFactory=m=h([g(1,a.ICharacterJoinerService),g(2,v.IOptionsService),g(3,a.ICoreBrowserService),g(4,v.ICoreService),g(5,v.IDecorationService),g(6,a.IThemeService)],m)},2550:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WidthCache=void 0,t.WidthCache=class{constructor(n,h){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=n.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let g=n.createElement("span");g.classList.add("xterm-char-measure-element");let o=n.createElement("span");o.classList.add("xterm-char-measure-element"),o.style.fontWeight="bold";let c=n.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontStyle="italic";let f=n.createElement("span");f.classList.add("xterm-char-measure-element"),f.style.fontWeight="bold",f.style.fontStyle="italic",this._measureElements=[g,o,c,f],this._container.appendChild(g),this._container.appendChild(o),this._container.appendChild(c),this._container.appendChild(f),h.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(n,h,g,o){n===this._font&&h===this._fontSize&&g===this._weight&&o===this._weightBold||(this._font=n,this._fontSize=h,this._weight=g,this._weightBold=o,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${g}`,this._measureElements[1].style.fontWeight=`${o}`,this._measureElements[2].style.fontWeight=`${g}`,this._measureElements[3].style.fontWeight=`${o}`,this.clear())}get(n,h,g){let o=0;if(!h&&!g&&n.length===1&&(o=n.charCodeAt(0))<256){if(this._flat[o]!==-9999)return this._flat[o];let v=this._measure(n,0);return v>0&&(this._flat[o]=v),v}let c=n;h&&(c+="B"),g&&(c+="I");let f=this._holey.get(c);if(f===void 0){let v=0;h&&(v|=1),g&&(v|=2),f=this._measure(n,v),f>0&&this._holey.set(c,f)}return f}_measure(n,h){let g=this._measureElements[h];return g.textContent=n.repeat(32),g.offsetWidth/32}}},2223:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;let h=n(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(l,t)=>{function n(g){return 57508<=g&&g<=57558}function h(g){return g>=128512&&g<=128591||g>=127744&&g<=128511||g>=128640&&g<=128767||g>=9728&&g<=9983||g>=9984&&g<=10175||g>=65024&&g<=65039||g>=129280&&g<=129535||g>=127462&&g<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(g){if(!g)throw new Error("value must not be falsy");return g},t.isPowerlineGlyph=n,t.isRestrictedPowerlineGlyph=function(g){return 57520<=g&&g<=57527},t.isEmoji=h,t.allowRescaling=function(g,o,c,f){return o===1&&c>Math.ceil(1.5*f)&&g!==void 0&&g>255&&!h(g)&&!n(g)&&!function(v){return 57344<=v&&v<=63743}(g)},t.treatGlyphAsBackgroundColor=function(g){return n(g)||function(o){return 9472<=o&&o<=9631}(g)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(g,o,c=0){return(g-(2*Math.round(o)-c))%(2*Math.round(o))}},6052:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class n{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(g,o,c,f=!1){if(this.selectionStart=o,this.selectionEnd=c,!o||!c||o[0]===c[0]&&o[1]===c[1])return void this.clear();let v=g.buffers.active.ydisp,u=o[1]-v,a=c[1]-v,d=Math.max(u,0),_=Math.min(a,g.rows-1);d>=g.rows||_<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=f,this.viewportStartRow=u,this.viewportEndRow=a,this.viewportCappedStartRow=d,this.viewportCappedEndRow=_,this.startCol=o[0],this.endCol=c[0])}isCellSelected(g,o,c){return!!this.hasSelection&&(c-=g.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?o>=this.startCol&&c>=this.viewportCappedStartRow&&o<this.endCol&&c<=this.viewportCappedEndRow:o<this.startCol&&c>=this.viewportCappedStartRow&&o>=this.endCol&&c<=this.viewportCappedEndRow:c>this.viewportStartRow&&c<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&c===this.viewportStartRow&&o>=this.startCol&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&c===this.viewportEndRow&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&c===this.viewportStartRow&&o>=this.startCol)}}t.createSelectionRenderModel=function(){return new n}},456:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(n){this._bufferService=n,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?n%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)-1]:[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[n,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let n=this.selectionStart[0]+this.selectionStartLength;return n>this._bufferService.cols?[n%this._bufferService.cols,this.selectionStart[1]+Math.floor(n/this._bufferService.cols)]:[Math.max(n,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let n=this.selectionStart,h=this.selectionEnd;return!(!n||!h)&&(n[1]>h[1]||n[1]===h[1]&&n[0]>h[0])}handleTrim(n){return this.selectionStart&&(this.selectionStart[1]-=n),this.selectionEnd&&(this.selectionEnd[1]-=n),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(l,t,n){var h=this&&this.__decorate||function(_,p,m,w){var b,S=arguments.length,A=S<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,m):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(_,p,m,w);else for(var x=_.length-1;x>=0;x--)(b=_[x])&&(A=(S<3?b(A):S>3?b(p,m,A):b(p,m))||A);return S>3&&A&&Object.defineProperty(p,m,A),A},g=this&&this.__param||function(_,p){return function(m,w){p(m,w,_)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;let o=n(2585),c=n(8460),f=n(844),v=t.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(_,p,m){super(),this._optionsService=m,this.width=0,this.height=0,this._onCharSizeChange=this.register(new c.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new d(this._optionsService))}catch{this._measureStrategy=this.register(new a(_,p,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){let _=this._measureStrategy.measure();_.width===this.width&&_.height===this.height||(this.width=_.width,this.height=_.height,this._onCharSizeChange.fire())}};t.CharSizeService=v=h([g(2,o.IOptionsService)],v);class u extends f.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(p,m){p!==void 0&&p>0&&m!==void 0&&m>0&&(this._result.width=p,this._result.height=m)}}class a extends u{constructor(p,m,w){super(),this._document=p,this._parentElement=m,this._optionsService=w,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class d extends u{constructor(p){super(),this._optionsService=p,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let m=this._ctx.measureText("W");if(!("width"in m&&"fontBoundingBoxAscent"in m&&"fontBoundingBoxDescent"in m))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let p=this._ctx.measureText("W");return this._validateAndSet(p.width,p.fontBoundingBoxAscent+p.fontBoundingBoxDescent),this._result}}},4269:function(l,t,n){var h=this&&this.__decorate||function(d,_,p,m){var w,b=arguments.length,S=b<3?_:m===null?m=Object.getOwnPropertyDescriptor(_,p):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(d,_,p,m);else for(var A=d.length-1;A>=0;A--)(w=d[A])&&(S=(b<3?w(S):b>3?w(_,p,S):w(_,p))||S);return b>3&&S&&Object.defineProperty(_,p,S),S},g=this&&this.__param||function(d,_){return function(p,m){_(p,m,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;let o=n(3734),c=n(643),f=n(511),v=n(2585);class u extends o.AttributeData{constructor(_,p,m){super(),this.content=0,this.combinedData="",this.fg=_.fg,this.bg=_.bg,this.combinedData=p,this._width=m}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(_){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=u;let a=t.CharacterJoinerService=class zu{constructor(_){this._bufferService=_,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(_){let p={id:this._nextCharacterJoinerId++,handler:_};return this._characterJoiners.push(p),p.id}deregister(_){for(let p=0;p<this._characterJoiners.length;p++)if(this._characterJoiners[p].id===_)return this._characterJoiners.splice(p,1),!0;return!1}getJoinedCharacters(_){if(this._characterJoiners.length===0)return[];let p=this._bufferService.buffer.lines.get(_);if(!p||p.length===0)return[];let m=[],w=p.translateToString(!0),b=0,S=0,A=0,x=p.getFg(0),E=p.getBg(0);for(let D=0;D<p.getTrimmedLength();D++)if(p.loadCell(D,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==x||this._workCell.bg!==E){if(D-b>1){let L=this._getJoinedRanges(w,A,S,p,b);for(let T=0;T<L.length;T++)m.push(L[T])}b=D,A=S,x=this._workCell.fg,E=this._workCell.bg}S+=this._workCell.getChars().length||c.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-b>1){let D=this._getJoinedRanges(w,A,S,p,b);for(let L=0;L<D.length;L++)m.push(D[L])}return m}_getJoinedRanges(_,p,m,w,b){let S=_.substring(p,m),A=[];try{A=this._characterJoiners[0].handler(S)}catch(x){console.error(x)}for(let x=1;x<this._characterJoiners.length;x++)try{let E=this._characterJoiners[x].handler(S);for(let D=0;D<E.length;D++)zu._mergeRanges(A,E[D])}catch(E){console.error(E)}return this._stringRangesToCellRanges(A,w,b),A}_stringRangesToCellRanges(_,p,m){let w=0,b=!1,S=0,A=_[w];if(A){for(let x=m;x<this._bufferService.cols;x++){let E=p.getWidth(x),D=p.getString(x).length||c.WHITESPACE_CELL_CHAR.length;if(E!==0){if(!b&&A[0]<=S&&(A[0]=x,b=!0),A[1]<=S){if(A[1]=x,A=_[++w],!A)break;A[0]<=S?(A[0]=x,b=!0):b=!1}S+=D}}A&&(A[1]=this._bufferService.cols)}}static _mergeRanges(_,p){let m=!1;for(let w=0;w<_.length;w++){let b=_[w];if(m){if(p[1]<=b[0])return _[w-1][1]=p[1],_;if(p[1]<=b[1])return _[w-1][1]=Math.max(p[1],b[1]),_.splice(w,1),_;_.splice(w,1),w--}else{if(p[1]<=b[0])return _.splice(w,0,p),_;if(p[1]<=b[1])return b[0]=Math.min(p[0],b[0]),_;p[0]<b[1]&&(b[0]=Math.min(p[0],b[0]),m=!0)}}return m?_[_.length-1][1]=p[1]:_.push(p),_}};t.CharacterJoinerService=a=h([g(0,v.IBufferService)],a)},5114:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0;let h=n(844),g=n(8460),o=n(3656);class c extends h.Disposable{constructor(u,a,d){super(),this._textarea=u,this._window=a,this.mainDocument=d,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new f(this._window),this._onDprChange=this.register(new g.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new g.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(_=>this._screenDprMonitor.setWindow(_))),this.register((0,g.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(u){this._window!==u&&(this._window=u,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}t.CoreBrowserService=c;class f extends h.Disposable{constructor(u){super(),this._parentWindow=u,this._windowResizeListener=this.register(new h.MutableDisposable),this._onDprChange=this.register(new g.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,h.toDisposable)(()=>this.clearListener()))}setWindow(u){this._parentWindow=u,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,o.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkProviderService=void 0;let h=n(844);class g extends h.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,h.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(c){return this.linkProviders.push(c),{dispose:()=>{let f=this.linkProviders.indexOf(c);f!==-1&&this.linkProviders.splice(f,1)}}}}t.LinkProviderService=g},8934:function(l,t,n){var h=this&&this.__decorate||function(v,u,a,d){var _,p=arguments.length,m=p<3?u:d===null?d=Object.getOwnPropertyDescriptor(u,a):d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(v,u,a,d);else for(var w=v.length-1;w>=0;w--)(_=v[w])&&(m=(p<3?_(m):p>3?_(u,a,m):_(u,a))||m);return p>3&&m&&Object.defineProperty(u,a,m),m},g=this&&this.__param||function(v,u){return function(a,d){u(a,d,v)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;let o=n(4725),c=n(9806),f=t.MouseService=class{constructor(v,u){this._renderService=v,this._charSizeService=u}getCoords(v,u,a,d,_){return(0,c.getCoords)(window,v,u,a,d,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,_)}getMouseReportCoords(v,u){let a=(0,c.getCoordsRelativeToElement)(window,v,u);if(this._charSizeService.hasValidSize)return a[0]=Math.min(Math.max(a[0],0),this._renderService.dimensions.css.canvas.width-1),a[1]=Math.min(Math.max(a[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(a[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(a[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(a[0]),y:Math.floor(a[1])}}};t.MouseService=f=h([g(0,o.IRenderService),g(1,o.ICharSizeService)],f)},3230:function(l,t,n){var h=this&&this.__decorate||function(_,p,m,w){var b,S=arguments.length,A=S<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,m):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(_,p,m,w);else for(var x=_.length-1;x>=0;x--)(b=_[x])&&(A=(S<3?b(A):S>3?b(p,m,A):b(p,m))||A);return S>3&&A&&Object.defineProperty(p,m,A),A},g=this&&this.__param||function(_,p){return function(m,w){p(m,w,_)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;let o=n(6193),c=n(4725),f=n(8460),v=n(844),u=n(7226),a=n(2585),d=t.RenderService=class extends v.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(_,p,m,w,b,S,A,x){super(),this._rowCount=_,this._charSizeService=w,this._renderer=this.register(new v.MutableDisposable),this._pausedResizeTask=new u.DebouncedIdleTask,this._observerDisposable=this.register(new v.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new f.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new f.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new f.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new o.RenderDebouncer((E,D)=>this._renderRows(E,D),A),this.register(this._renderDebouncer),this.register(A.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(S.onResize(()=>this._fullRefresh())),this.register(S.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(m.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(b.onDecorationRegistered(()=>this._fullRefresh())),this.register(b.onDecorationRemoved(()=>this._fullRefresh())),this.register(m.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(S.cols,S.rows),this._fullRefresh()})),this.register(m.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(S.buffer.y,S.buffer.y,!0))),this.register(x.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(A.window,p),this.register(A.onWindowChange(E=>this._registerIntersectionObserver(E,p)))}_registerIntersectionObserver(_,p){if("IntersectionObserver"in _){let m=new _.IntersectionObserver(w=>this._handleIntersectionChange(w[w.length-1]),{threshold:0});m.observe(p),this._observerDisposable.value=(0,v.toDisposable)(()=>m.disconnect())}}_handleIntersectionChange(_){this._isPaused=_.isIntersecting===void 0?_.intersectionRatio===0:!_.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(_,p,m=!1){this._isPaused?this._needsFullRefresh=!0:(m||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(_,p,this._rowCount))}_renderRows(_,p){this._renderer.value&&(_=Math.min(_,this._rowCount-1),p=Math.min(p,this._rowCount-1),this._renderer.value.renderRows(_,p),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:_,end:p}),this._onRender.fire({start:_,end:p}),this._isNextRenderRedrawOnly=!0)}resize(_,p){this._rowCount=p,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(_){this._renderer.value=_,this._renderer.value&&(this._renderer.value.onRequestRedraw(p=>this.refreshRows(p.start,p.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(_){return this._renderDebouncer.addRefreshCallback(_)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(_,p){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(_,p)):this._renderer.value.handleResize(_,p),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(_,p,m){this._selectionState.start=_,this._selectionState.end=p,this._selectionState.columnSelectMode=m,this._renderer.value?.handleSelectionChanged(_,p,m)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};t.RenderService=d=h([g(2,a.IOptionsService),g(3,c.ICharSizeService),g(4,a.IDecorationService),g(5,a.IBufferService),g(6,c.ICoreBrowserService),g(7,c.IThemeService)],d)},9312:function(l,t,n){var h=this&&this.__decorate||function(A,x,E,D){var L,T=arguments.length,F=T<3?x:D===null?D=Object.getOwnPropertyDescriptor(x,E):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(A,x,E,D);else for(var K=A.length-1;K>=0;K--)(L=A[K])&&(F=(T<3?L(F):T>3?L(x,E,F):L(x,E))||F);return T>3&&F&&Object.defineProperty(x,E,F),F},g=this&&this.__param||function(A,x){return function(E,D){x(E,D,A)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;let o=n(9806),c=n(9504),f=n(456),v=n(4725),u=n(8460),a=n(844),d=n(6114),_=n(4841),p=n(511),m=n(2585),w="\xA0",b=new RegExp(w,"g"),S=t.SelectionService=class extends a.Disposable{constructor(A,x,E,D,L,T,F,K,N){super(),this._element=A,this._screenElement=x,this._linkifier=E,this._bufferService=D,this._coreService=L,this._mouseService=T,this._optionsService=F,this._renderService=K,this._coreBrowserService=N,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new p.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new u.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new u.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new u.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=X=>this._handleMouseMove(X),this._mouseUpListener=X=>this._handleMouseUp(X),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(X=>this._handleTrim(X)),this.register(this._bufferService.buffers.onBufferActivate(X=>this._handleBufferActivate(X))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,a.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let A=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;return!(!A||!x||A[0]===x[0]&&A[1]===x[1])}get selectionText(){let A=this._model.finalSelectionStart,x=this._model.finalSelectionEnd;if(!A||!x)return"";let E=this._bufferService.buffer,D=[];if(this._activeSelectionMode===3){if(A[0]===x[0])return"";let L=A[0]<x[0]?A[0]:x[0],T=A[0]<x[0]?x[0]:A[0];for(let F=A[1];F<=x[1];F++){let K=E.translateBufferLineToString(F,!0,L,T);D.push(K)}}else{let L=A[1]===x[1]?x[0]:void 0;D.push(E.translateBufferLineToString(A[1],!0,A[0],L));for(let T=A[1]+1;T<=x[1]-1;T++){let F=E.lines.get(T),K=E.translateBufferLineToString(T,!0);F?.isWrapped?D[D.length-1]+=K:D.push(K)}if(A[1]!==x[1]){let T=E.lines.get(x[1]),F=E.translateBufferLineToString(x[1],!0,0,x[0]);T&&T.isWrapped?D[D.length-1]+=F:D.push(F)}}return D.map(L=>L.replace(b," ")).join(d.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(A){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),d.isLinux&&A&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(A){let x=this._getMouseBufferCoords(A),E=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!!(E&&D&&x)&&this._areCoordsInSelection(x,E,D)}isCellInSelection(A,x){let E=this._model.finalSelectionStart,D=this._model.finalSelectionEnd;return!(!E||!D)&&this._areCoordsInSelection([A,x],E,D)}_areCoordsInSelection(A,x,E){return A[1]>x[1]&&A[1]<E[1]||x[1]===E[1]&&A[1]===x[1]&&A[0]>=x[0]&&A[0]<E[0]||x[1]<E[1]&&A[1]===E[1]&&A[0]<E[0]||x[1]<E[1]&&A[1]===x[1]&&A[0]>=x[0]}_selectWordAtCursor(A,x){let E=this._linkifier.currentLink?.link?.range;if(E)return this._model.selectionStart=[E.start.x-1,E.start.y-1],this._model.selectionStartLength=(0,_.getRangeLength)(E,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let D=this._getMouseBufferCoords(A);return!!D&&(this._selectWordAt(D,x),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(A,x){this._model.clearSelection(),A=Math.max(A,0),x=Math.min(x,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,A],this._model.selectionEnd=[this._bufferService.cols,x],this.refresh(),this._onSelectionChange.fire()}_handleTrim(A){this._model.handleTrim(A)&&this.refresh()}_getMouseBufferCoords(A){let x=this._mouseService.getCoords(A,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(x)return x[0]--,x[1]--,x[1]+=this._bufferService.buffer.ydisp,x}_getMouseEventScrollAmount(A){let x=(0,o.getCoordsRelativeToElement)(this._coreBrowserService.window,A,this._screenElement)[1],E=this._renderService.dimensions.css.canvas.height;return x>=0&&x<=E?0:(x>E&&(x-=E),x=Math.min(Math.max(x,-50),50),x/=50,x/Math.abs(x)+Math.round(14*x))}shouldForceSelection(A){return d.isMac?A.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:A.shiftKey}handleMouseDown(A){if(this._mouseDownTimeStamp=A.timeStamp,(A.button!==2||!this.hasSelection)&&A.button===0){if(!this._enabled){if(!this.shouldForceSelection(A))return;A.stopPropagation()}A.preventDefault(),this._dragScrollAmount=0,this._enabled&&A.shiftKey?this._handleIncrementalClick(A):A.detail===1?this._handleSingleClick(A):A.detail===2?this._handleDoubleClick(A):A.detail===3&&this._handleTripleClick(A),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(A){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(A))}_handleSingleClick(A){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(A)?3:0,this._model.selectionStart=this._getMouseBufferCoords(A),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let x=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);x&&x.length!==this._model.selectionStart[0]&&x.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(A){this._selectWordAtCursor(A,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(A){let x=this._getMouseBufferCoords(A);x&&(this._activeSelectionMode=2,this._selectLineAt(x[1]))}shouldColumnSelect(A){return A.altKey&&!(d.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(A){if(A.stopImmediatePropagation(),!this._model.selectionStart)return;let x=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(A),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(A),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let E=this._bufferService.buffer;if(this._model.selectionEnd[1]<E.lines.length){let D=E.lines.get(this._model.selectionEnd[1]);D&&D.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}x&&x[0]===this._model.selectionEnd[0]&&x[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let A=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(A.ydisp+this._bufferService.rows,A.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=A.ydisp),this.refresh()}}_handleMouseUp(A){let x=A.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&x<500&&A.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let E=this._mouseService.getCoords(A,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(E&&E[0]!==void 0&&E[1]!==void 0){let D=(0,c.moveToCellSequence)(E[0]-1,E[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(D,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let A=this._model.finalSelectionStart,x=this._model.finalSelectionEnd,E=!(!A||!x||A[0]===x[0]&&A[1]===x[1]);E?A&&x&&(this._oldSelectionStart&&this._oldSelectionEnd&&A[0]===this._oldSelectionStart[0]&&A[1]===this._oldSelectionStart[1]&&x[0]===this._oldSelectionEnd[0]&&x[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(A,x,E)):this._oldHasSelection&&this._fireOnSelectionChange(A,x,E)}_fireOnSelectionChange(A,x,E){this._oldSelectionStart=A,this._oldSelectionEnd=x,this._oldHasSelection=E,this._onSelectionChange.fire()}_handleBufferActivate(A){this.clearSelection(),this._trimListener.dispose(),this._trimListener=A.activeBuffer.lines.onTrim(x=>this._handleTrim(x))}_convertViewportColToCharacterIndex(A,x){let E=x;for(let D=0;x>=D;D++){let L=A.loadCell(D,this._workCell).getChars().length;this._workCell.getWidth()===0?E--:L>1&&x!==D&&(E+=L-1)}return E}setSelection(A,x,E){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[A,x],this._model.selectionStartLength=E,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(A){this._isClickInSelection(A)||(this._selectWordAtCursor(A,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(A,x,E=!0,D=!0){if(A[0]>=this._bufferService.cols)return;let L=this._bufferService.buffer,T=L.lines.get(A[1]);if(!T)return;let F=L.translateBufferLineToString(A[1],!1),K=this._convertViewportColToCharacterIndex(T,A[0]),N=K,X=A[0]-K,k=0,y=0,C=0,B=0;if(F.charAt(K)===" "){for(;K>0&&F.charAt(K-1)===" ";)K--;for(;N<F.length&&F.charAt(N+1)===" ";)N++}else{let H=A[0],$=A[0];T.getWidth(H)===0&&(k++,H--),T.getWidth($)===2&&(y++,$++);let q=T.getString($).length;for(q>1&&(B+=q-1,N+=q-1);H>0&&K>0&&!this._isCharWordSeparator(T.loadCell(H-1,this._workCell));){T.loadCell(H-1,this._workCell);let P=this._workCell.getChars().length;this._workCell.getWidth()===0?(k++,H--):P>1&&(C+=P-1,K-=P-1),K--,H--}for(;$<T.length&&N+1<F.length&&!this._isCharWordSeparator(T.loadCell($+1,this._workCell));){T.loadCell($+1,this._workCell);let P=this._workCell.getChars().length;this._workCell.getWidth()===2?(y++,$++):P>1&&(B+=P-1,N+=P-1),N++,$++}}N++;let I=K+X-k+C,R=Math.min(this._bufferService.cols,N-K+k+y-C-B);if(x||F.slice(K,N).trim()!==""){if(E&&I===0&&T.getCodePoint(0)!==32){let H=L.lines.get(A[1]-1);if(H&&T.isWrapped&&H.getCodePoint(this._bufferService.cols-1)!==32){let $=this._getWordAt([this._bufferService.cols-1,A[1]-1],!1,!0,!1);if($){let q=this._bufferService.cols-$.start;I-=q,R+=q}}}if(D&&I+R===this._bufferService.cols&&T.getCodePoint(this._bufferService.cols-1)!==32){let H=L.lines.get(A[1]+1);if(H?.isWrapped&&H.getCodePoint(0)!==32){let $=this._getWordAt([0,A[1]+1],!1,!1,!0);$&&(R+=$.length)}}return{start:I,length:R}}}_selectWordAt(A,x){let E=this._getWordAt(A,x);if(E){for(;E.start<0;)E.start+=this._bufferService.cols,A[1]--;this._model.selectionStart=[E.start,A[1]],this._model.selectionStartLength=E.length}}_selectToWordAt(A){let x=this._getWordAt(A,!0);if(x){let E=A[1];for(;x.start<0;)x.start+=this._bufferService.cols,E--;if(!this._model.areSelectionValuesReversed())for(;x.start+x.length>this._bufferService.cols;)x.length-=this._bufferService.cols,E++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?x.start:x.start+x.length,E]}}_isCharWordSeparator(A){return A.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(A.getChars())>=0}_selectLineAt(A){let x=this._bufferService.buffer.getWrappedRangeForLine(A),E={start:{x:0,y:x.first},end:{x:this._bufferService.cols-1,y:x.last}};this._model.selectionStart=[0,x.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,_.getRangeLength)(E,this._bufferService.cols)}};t.SelectionService=S=h([g(3,m.IBufferService),g(4,m.ICoreService),g(5,v.IMouseService),g(6,m.IOptionsService),g(7,v.IRenderService),g(8,v.ICoreBrowserService)],S)},4725:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ILinkProviderService=t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;let h=n(8343);t.ICharSizeService=(0,h.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),t.IMouseService=(0,h.createDecorator)("MouseService"),t.IRenderService=(0,h.createDecorator)("RenderService"),t.ISelectionService=(0,h.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,h.createDecorator)("ThemeService"),t.ILinkProviderService=(0,h.createDecorator)("LinkProviderService")},6731:function(l,t,n){var h=this&&this.__decorate||function(S,A,x,E){var D,L=arguments.length,T=L<3?A:E===null?E=Object.getOwnPropertyDescriptor(A,x):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(S,A,x,E);else for(var F=S.length-1;F>=0;F--)(D=S[F])&&(T=(L<3?D(T):L>3?D(A,x,T):D(A,x))||T);return L>3&&T&&Object.defineProperty(A,x,T),T},g=this&&this.__param||function(S,A){return function(x,E){A(x,E,S)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;let o=n(7239),c=n(8055),f=n(8460),v=n(844),u=n(2585),a=c.css.toColor("#ffffff"),d=c.css.toColor("#000000"),_=c.css.toColor("#ffffff"),p=c.css.toColor("#000000"),m={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{let S=[c.css.toColor("#2e3436"),c.css.toColor("#cc0000"),c.css.toColor("#4e9a06"),c.css.toColor("#c4a000"),c.css.toColor("#3465a4"),c.css.toColor("#75507b"),c.css.toColor("#06989a"),c.css.toColor("#d3d7cf"),c.css.toColor("#555753"),c.css.toColor("#ef2929"),c.css.toColor("#8ae234"),c.css.toColor("#fce94f"),c.css.toColor("#729fcf"),c.css.toColor("#ad7fa8"),c.css.toColor("#34e2e2"),c.css.toColor("#eeeeec")],A=[0,95,135,175,215,255];for(let x=0;x<216;x++){let E=A[x/36%6|0],D=A[x/6%6|0],L=A[x%6];S.push({css:c.channels.toCss(E,D,L),rgba:c.channels.toRgba(E,D,L)})}for(let x=0;x<24;x++){let E=8+10*x;S.push({css:c.channels.toCss(E,E,E),rgba:c.channels.toRgba(E,E,E)})}return S})());let w=t.ThemeService=class extends v.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new o.ColorContrastCache,this._halfContrastCache=new o.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:a,background:d,cursor:_,cursorAccent:p,selectionForeground:void 0,selectionBackgroundTransparent:m,selectionBackgroundOpaque:c.color.blend(d,m),selectionInactiveBackgroundTransparent:m,selectionInactiveBackgroundOpaque:c.color.blend(d,m),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){let A=this._colors;if(A.foreground=b(S.foreground,a),A.background=b(S.background,d),A.cursor=b(S.cursor,_),A.cursorAccent=b(S.cursorAccent,p),A.selectionBackgroundTransparent=b(S.selectionBackground,m),A.selectionBackgroundOpaque=c.color.blend(A.background,A.selectionBackgroundTransparent),A.selectionInactiveBackgroundTransparent=b(S.selectionInactiveBackground,A.selectionBackgroundTransparent),A.selectionInactiveBackgroundOpaque=c.color.blend(A.background,A.selectionInactiveBackgroundTransparent),A.selectionForeground=S.selectionForeground?b(S.selectionForeground,c.NULL_COLOR):void 0,A.selectionForeground===c.NULL_COLOR&&(A.selectionForeground=void 0),c.color.isOpaque(A.selectionBackgroundTransparent)&&(A.selectionBackgroundTransparent=c.color.opacity(A.selectionBackgroundTransparent,.3)),c.color.isOpaque(A.selectionInactiveBackgroundTransparent)&&(A.selectionInactiveBackgroundTransparent=c.color.opacity(A.selectionInactiveBackgroundTransparent,.3)),A.ansi=t.DEFAULT_ANSI_COLORS.slice(),A.ansi[0]=b(S.black,t.DEFAULT_ANSI_COLORS[0]),A.ansi[1]=b(S.red,t.DEFAULT_ANSI_COLORS[1]),A.ansi[2]=b(S.green,t.DEFAULT_ANSI_COLORS[2]),A.ansi[3]=b(S.yellow,t.DEFAULT_ANSI_COLORS[3]),A.ansi[4]=b(S.blue,t.DEFAULT_ANSI_COLORS[4]),A.ansi[5]=b(S.magenta,t.DEFAULT_ANSI_COLORS[5]),A.ansi[6]=b(S.cyan,t.DEFAULT_ANSI_COLORS[6]),A.ansi[7]=b(S.white,t.DEFAULT_ANSI_COLORS[7]),A.ansi[8]=b(S.brightBlack,t.DEFAULT_ANSI_COLORS[8]),A.ansi[9]=b(S.brightRed,t.DEFAULT_ANSI_COLORS[9]),A.ansi[10]=b(S.brightGreen,t.DEFAULT_ANSI_COLORS[10]),A.ansi[11]=b(S.brightYellow,t.DEFAULT_ANSI_COLORS[11]),A.ansi[12]=b(S.brightBlue,t.DEFAULT_ANSI_COLORS[12]),A.ansi[13]=b(S.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),A.ansi[14]=b(S.brightCyan,t.DEFAULT_ANSI_COLORS[14]),A.ansi[15]=b(S.brightWhite,t.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){let x=Math.min(A.ansi.length-16,S.extendedAnsi.length);for(let E=0;E<x;E++)A.ansi[E+16]=b(S.extendedAnsi[E],t.DEFAULT_ANSI_COLORS[E+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let A=0;A<this._restoreColors.ansi.length;++A)this._colors.ansi[A]=this._restoreColors.ansi[A]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function b(S,A){if(S!==void 0)try{return c.css.toColor(S)}catch{}return A}t.ThemeService=w=h([g(0,u.IOptionsService)],w)},6349:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;let h=n(8460),g=n(844);class o extends g.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;let v=new Array(f);for(let u=0;u<Math.min(f,this.length);u++)v[u]=this._array[this._getCyclicIndex(u)];this._array=v,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let v=this._length;v<f;v++)this._array[v]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,v){this._array[this._getCyclicIndex(f)]=v}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,v,...u){if(v){for(let a=f;a<this._length-v;a++)this._array[this._getCyclicIndex(a)]=this._array[this._getCyclicIndex(a+v)];this._length-=v,this.onDeleteEmitter.fire({index:f,amount:v})}for(let a=this._length-1;a>=f;a--)this._array[this._getCyclicIndex(a+u.length)]=this._array[this._getCyclicIndex(a)];for(let a=0;a<u.length;a++)this._array[this._getCyclicIndex(f+a)]=u[a];if(u.length&&this.onInsertEmitter.fire({index:f,amount:u.length}),this._length+u.length>this._maxLength){let a=this._length+u.length-this._maxLength;this._startIndex+=a,this._length=this._maxLength,this.onTrimEmitter.fire(a)}else this._length+=u.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,v,u){if(!(v<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+u<0)throw new Error("Cannot shift elements in list beyond index 0");if(u>0){for(let d=v-1;d>=0;d--)this.set(f+d+u,this.get(f+d));let a=f+v+u-this._length;if(a>0)for(this._length+=a;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let a=0;a<v;a++)this.set(f+a+u,this.get(f+a))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}t.CircularList=o},1439:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function n(h,g=5){if(typeof h!="object")return h;let o=Array.isArray(h)?[]:{};for(let c in h)o[c]=g<=1?h[c]:h[c]&&n(h[c],g-1);return o}},8055:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let n=0,h=0,g=0,o=0;var c,f,v,u,a;function d(p){let m=p.toString(16);return m.length<2?"0"+m:m}function _(p,m){return p<m?(m+.05)/(p+.05):(p+.05)/(m+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(p){p.toCss=function(m,w,b,S){return S!==void 0?`#${d(m)}${d(w)}${d(b)}${d(S)}`:`#${d(m)}${d(w)}${d(b)}`},p.toRgba=function(m,w,b,S=255){return(m<<24|w<<16|b<<8|S)>>>0},p.toColor=function(m,w,b,S){return{css:p.toCss(m,w,b,S),rgba:p.toRgba(m,w,b,S)}}}(c||(t.channels=c={})),function(p){function m(w,b){return o=Math.round(255*b),[n,h,g]=a.toChannels(w.rgba),{css:c.toCss(n,h,g,o),rgba:c.toRgba(n,h,g,o)}}p.blend=function(w,b){if(o=(255&b.rgba)/255,o===1)return{css:b.css,rgba:b.rgba};let S=b.rgba>>24&255,A=b.rgba>>16&255,x=b.rgba>>8&255,E=w.rgba>>24&255,D=w.rgba>>16&255,L=w.rgba>>8&255;return n=E+Math.round((S-E)*o),h=D+Math.round((A-D)*o),g=L+Math.round((x-L)*o),{css:c.toCss(n,h,g),rgba:c.toRgba(n,h,g)}},p.isOpaque=function(w){return(255&w.rgba)==255},p.ensureContrastRatio=function(w,b,S){let A=a.ensureContrastRatio(w.rgba,b.rgba,S);if(A)return c.toColor(A>>24&255,A>>16&255,A>>8&255)},p.opaque=function(w){let b=(255|w.rgba)>>>0;return[n,h,g]=a.toChannels(b),{css:c.toCss(n,h,g),rgba:b}},p.opacity=m,p.multiplyOpacity=function(w,b){return o=255&w.rgba,m(w,o*b/255)},p.toColorRGB=function(w){return[w.rgba>>24&255,w.rgba>>16&255,w.rgba>>8&255]}}(f||(t.color=f={})),function(p){let m,w;try{let b=document.createElement("canvas");b.width=1,b.height=1;let S=b.getContext("2d",{willReadFrequently:!0});S&&(m=S,m.globalCompositeOperation="copy",w=m.createLinearGradient(0,0,1,1))}catch{}p.toColor=function(b){if(b.match(/#[\da-f]{3,8}/i))switch(b.length){case 4:return n=parseInt(b.slice(1,2).repeat(2),16),h=parseInt(b.slice(2,3).repeat(2),16),g=parseInt(b.slice(3,4).repeat(2),16),c.toColor(n,h,g);case 5:return n=parseInt(b.slice(1,2).repeat(2),16),h=parseInt(b.slice(2,3).repeat(2),16),g=parseInt(b.slice(3,4).repeat(2),16),o=parseInt(b.slice(4,5).repeat(2),16),c.toColor(n,h,g,o);case 7:return{css:b,rgba:(parseInt(b.slice(1),16)<<8|255)>>>0};case 9:return{css:b,rgba:parseInt(b.slice(1),16)>>>0}}let S=b.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return n=parseInt(S[1]),h=parseInt(S[2]),g=parseInt(S[3]),o=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),c.toColor(n,h,g,o);if(!m||!w)throw new Error("css.toColor: Unsupported css format");if(m.fillStyle=w,m.fillStyle=b,typeof m.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(m.fillRect(0,0,1,1),[n,h,g,o]=m.getImageData(0,0,1,1).data,o!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:c.toRgba(n,h,g,o),css:b}}}(v||(t.css=v={})),function(p){function m(w,b,S){let A=w/255,x=b/255,E=S/255;return .2126*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))+.7152*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}p.relativeLuminance=function(w){return m(w>>16&255,w>>8&255,255&w)},p.relativeLuminance2=m}(u||(t.rgb=u={})),function(p){function m(b,S,A){let x=b>>24&255,E=b>>16&255,D=b>>8&255,L=S>>24&255,T=S>>16&255,F=S>>8&255,K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));for(;K<A&&(L>0||T>0||F>0);)L-=Math.max(0,Math.ceil(.1*L)),T-=Math.max(0,Math.ceil(.1*T)),F-=Math.max(0,Math.ceil(.1*F)),K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));return(L<<24|T<<16|F<<8|255)>>>0}function w(b,S,A){let x=b>>24&255,E=b>>16&255,D=b>>8&255,L=S>>24&255,T=S>>16&255,F=S>>8&255,K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));for(;K<A&&(L<255||T<255||F<255);)L=Math.min(255,L+Math.ceil(.1*(255-L))),T=Math.min(255,T+Math.ceil(.1*(255-T))),F=Math.min(255,F+Math.ceil(.1*(255-F))),K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));return(L<<24|T<<16|F<<8|255)>>>0}p.blend=function(b,S){if(o=(255&S)/255,o===1)return S;let A=S>>24&255,x=S>>16&255,E=S>>8&255,D=b>>24&255,L=b>>16&255,T=b>>8&255;return n=D+Math.round((A-D)*o),h=L+Math.round((x-L)*o),g=T+Math.round((E-T)*o),c.toRgba(n,h,g)},p.ensureContrastRatio=function(b,S,A){let x=u.relativeLuminance(b>>8),E=u.relativeLuminance(S>>8);if(_(x,E)<A){if(E<x){let T=m(b,S,A),F=_(x,u.relativeLuminance(T>>8));if(F<A){let K=w(b,S,A);return F>_(x,u.relativeLuminance(K>>8))?T:K}return T}let D=w(b,S,A),L=_(x,u.relativeLuminance(D>>8));if(L<A){let T=m(b,S,A);return L>_(x,u.relativeLuminance(T>>8))?D:T}return D}},p.reduceLuminance=m,p.increaseLuminance=w,p.toChannels=function(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]}}(a||(t.rgba=a={})),t.toPaddedHex=d,t.contrastRatio=_},8969:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;let h=n(844),g=n(2585),o=n(4348),c=n(7866),f=n(744),v=n(7302),u=n(6975),a=n(8460),d=n(1753),_=n(1480),p=n(7994),m=n(9282),w=n(5435),b=n(5981),S=n(2660),A=!1;class x extends h.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new a.EventEmitter),this._onScroll.event(D=>{this._onScrollApi?.fire(D.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(D){for(let L in D)this.optionsService.options[L]=D[L]}constructor(D){super(),this._windowsWrappingHeuristics=this.register(new h.MutableDisposable),this._onBinary=this.register(new a.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new a.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new a.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new a.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new a.EventEmitter),this._instantiationService=new o.InstantiationService,this.optionsService=this.register(new v.OptionsService(D)),this._instantiationService.setService(g.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(g.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(c.LogService)),this._instantiationService.setService(g.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(u.CoreService)),this._instantiationService.setService(g.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(d.CoreMouseService)),this._instantiationService.setService(g.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(_.UnicodeService)),this._instantiationService.setService(g.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(p.CharsetService),this._instantiationService.setService(g.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(g.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new w.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,a.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,a.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,a.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,a.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(L=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(L=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new b.WriteBuffer((L,T)=>this._inputHandler.parse(L,T))),this.register((0,a.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(D,L){this._writeBuffer.write(D,L)}writeSync(D,L){this._logService.logLevel<=g.LogLevelEnum.WARN&&!A&&(this._logService.warn("writeSync is unreliable and will be removed soon."),A=!0),this._writeBuffer.writeSync(D,L)}input(D,L=!0){this.coreService.triggerDataEvent(D,L)}resize(D,L){isNaN(D)||isNaN(L)||(D=Math.max(D,f.MINIMUM_COLS),L=Math.max(L,f.MINIMUM_ROWS),this._bufferService.resize(D,L))}scroll(D,L=!1){this._bufferService.scroll(D,L)}scrollLines(D,L,T){this._bufferService.scrollLines(D,L,T)}scrollPages(D){this.scrollLines(D*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(D){let L=D-this._bufferService.buffer.ydisp;L!==0&&this.scrollLines(L)}registerEscHandler(D,L){return this._inputHandler.registerEscHandler(D,L)}registerDcsHandler(D,L){return this._inputHandler.registerDcsHandler(D,L)}registerCsiHandler(D,L){return this._inputHandler.registerCsiHandler(D,L)}registerOscHandler(D,L){return this._inputHandler.registerOscHandler(D,L)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let D=!1,L=this.optionsService.rawOptions.windowsPty;L&&L.buildNumber!==void 0&&L.buildNumber!==void 0?D=L.backend==="conpty"&&L.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(D=!0),D?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let D=[];D.push(this.onLineFeed(m.updateWindowsModeWrappedState.bind(null,this._bufferService))),D.push(this.registerCsiHandler({final:"H"},()=>((0,m.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,h.toDisposable)(()=>{for(let L of D)L.dispose()})}}}t.CoreTerminal=x},8460:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===n)return void this._listeners.splice(h,1)}}})),this._event}fire(n,h){let g=[];for(let o=0;o<this._listeners.length;o++)g.push(this._listeners[o]);for(let o=0;o<g.length;o++)g[o].call(void 0,n,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(n,h){return n(g=>h.fire(g))},t.runAndSubscribe=function(n,h){return h(void 0),n(g=>h(g))}},5435:function(l,t,n){var h=this&&this.__decorate||function(k,y,C,B){var I,R=arguments.length,H=R<3?y:B===null?B=Object.getOwnPropertyDescriptor(y,C):B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(k,y,C,B);else for(var $=k.length-1;$>=0;$--)(I=k[$])&&(H=(R<3?I(H):R>3?I(y,C,H):I(y,C))||H);return R>3&&H&&Object.defineProperty(y,C,H),H},g=this&&this.__param||function(k,y){return function(C,B){y(C,B,k)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;let o=n(2584),c=n(7116),f=n(2015),v=n(844),u=n(482),a=n(8437),d=n(8460),_=n(643),p=n(511),m=n(3734),w=n(2585),b=n(1480),S=n(6242),A=n(6351),x=n(5941),E={"(":0,")":1,"*":2,"+":3,"-":1,".":2},D=131072;function L(k,y){if(k>24)return y.setWinLines||!1;switch(k){case 1:return!!y.restoreWin;case 2:return!!y.minimizeWin;case 3:return!!y.setWinPosition;case 4:return!!y.setWinSizePixels;case 5:return!!y.raiseWin;case 6:return!!y.lowerWin;case 7:return!!y.refreshWin;case 8:return!!y.setWinSizeChars;case 9:return!!y.maximizeWin;case 10:return!!y.fullscreenWin;case 11:return!!y.getWinState;case 13:return!!y.getWinPosition;case 14:return!!y.getWinSizePixels;case 15:return!!y.getScreenSizePixels;case 16:return!!y.getCellSizePixels;case 18:return!!y.getWinSizeChars;case 19:return!!y.getScreenSizeChars;case 20:return!!y.getIconTitle;case 21:return!!y.getWinTitle;case 22:return!!y.pushTitle;case 23:return!!y.popTitle;case 24:return!!y.setWinLines}return!1}var T;(function(k){k[k.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",k[k.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(T||(t.WindowsOptionsReportType=T={}));let F=0;class K extends v.Disposable{getAttrData(){return this._curAttrData}constructor(y,C,B,I,R,H,$,q,P=new f.EscapeSequenceParser){super(),this._bufferService=y,this._charsetService=C,this._coreService=B,this._logService=I,this._optionsService=R,this._oscLinkService=H,this._coreMouseService=$,this._unicodeService=q,this._parser=P,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new u.StringToUtf32,this._utf8Decoder=new u.Utf8ToUtf32,this._workCell=new p.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new d.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new d.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new d.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new d.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new d.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new d.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new d.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new d.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new d.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new d.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new d.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new d.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new d.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new N(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(M=>this._activeBuffer=M.activeBuffer)),this._parser.setCsiHandlerFallback((M,U)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(M),params:U.toArray()})}),this._parser.setEscHandlerFallback(M=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(M)})}),this._parser.setExecuteHandlerFallback(M=>{this._logService.debug("Unknown EXECUTE code: ",{code:M})}),this._parser.setOscHandlerFallback((M,U,Z)=>{this._logService.debug("Unknown OSC code: ",{identifier:M,action:U,data:Z})}),this._parser.setDcsHandlerFallback((M,U,Z)=>{U==="HOOK"&&(Z=Z.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(M),action:U,payload:Z})}),this._parser.setPrintHandler((M,U,Z)=>this.print(M,U,Z)),this._parser.registerCsiHandler({final:"@"},M=>this.insertChars(M)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},M=>this.scrollLeft(M)),this._parser.registerCsiHandler({final:"A"},M=>this.cursorUp(M)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},M=>this.scrollRight(M)),this._parser.registerCsiHandler({final:"B"},M=>this.cursorDown(M)),this._parser.registerCsiHandler({final:"C"},M=>this.cursorForward(M)),this._parser.registerCsiHandler({final:"D"},M=>this.cursorBackward(M)),this._parser.registerCsiHandler({final:"E"},M=>this.cursorNextLine(M)),this._parser.registerCsiHandler({final:"F"},M=>this.cursorPrecedingLine(M)),this._parser.registerCsiHandler({final:"G"},M=>this.cursorCharAbsolute(M)),this._parser.registerCsiHandler({final:"H"},M=>this.cursorPosition(M)),this._parser.registerCsiHandler({final:"I"},M=>this.cursorForwardTab(M)),this._parser.registerCsiHandler({final:"J"},M=>this.eraseInDisplay(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},M=>this.eraseInDisplay(M,!0)),this._parser.registerCsiHandler({final:"K"},M=>this.eraseInLine(M,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},M=>this.eraseInLine(M,!0)),this._parser.registerCsiHandler({final:"L"},M=>this.insertLines(M)),this._parser.registerCsiHandler({final:"M"},M=>this.deleteLines(M)),this._parser.registerCsiHandler({final:"P"},M=>this.deleteChars(M)),this._parser.registerCsiHandler({final:"S"},M=>this.scrollUp(M)),this._parser.registerCsiHandler({final:"T"},M=>this.scrollDown(M)),this._parser.registerCsiHandler({final:"X"},M=>this.eraseChars(M)),this._parser.registerCsiHandler({final:"Z"},M=>this.cursorBackwardTab(M)),this._parser.registerCsiHandler({final:"`"},M=>this.charPosAbsolute(M)),this._parser.registerCsiHandler({final:"a"},M=>this.hPositionRelative(M)),this._parser.registerCsiHandler({final:"b"},M=>this.repeatPrecedingCharacter(M)),this._parser.registerCsiHandler({final:"c"},M=>this.sendDeviceAttributesPrimary(M)),this._parser.registerCsiHandler({prefix:">",final:"c"},M=>this.sendDeviceAttributesSecondary(M)),this._parser.registerCsiHandler({final:"d"},M=>this.linePosAbsolute(M)),this._parser.registerCsiHandler({final:"e"},M=>this.vPositionRelative(M)),this._parser.registerCsiHandler({final:"f"},M=>this.hVPosition(M)),this._parser.registerCsiHandler({final:"g"},M=>this.tabClear(M)),this._parser.registerCsiHandler({final:"h"},M=>this.setMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"h"},M=>this.setModePrivate(M)),this._parser.registerCsiHandler({final:"l"},M=>this.resetMode(M)),this._parser.registerCsiHandler({prefix:"?",final:"l"},M=>this.resetModePrivate(M)),this._parser.registerCsiHandler({final:"m"},M=>this.charAttributes(M)),this._parser.registerCsiHandler({final:"n"},M=>this.deviceStatus(M)),this._parser.registerCsiHandler({prefix:"?",final:"n"},M=>this.deviceStatusPrivate(M)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},M=>this.softReset(M)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},M=>this.setCursorStyle(M)),this._parser.registerCsiHandler({final:"r"},M=>this.setScrollRegion(M)),this._parser.registerCsiHandler({final:"s"},M=>this.saveCursor(M)),this._parser.registerCsiHandler({final:"t"},M=>this.windowOptions(M)),this._parser.registerCsiHandler({final:"u"},M=>this.restoreCursor(M)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},M=>this.insertColumns(M)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},M=>this.deleteColumns(M)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},M=>this.selectProtected(M)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},M=>this.requestMode(M,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},M=>this.requestMode(M,!1)),this._parser.setExecuteHandler(o.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(o.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(o.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(o.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(o.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(o.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(o.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(o.C1.IND,()=>this.index()),this._parser.setExecuteHandler(o.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(o.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new S.OscHandler(M=>(this.setTitle(M),this.setIconName(M),!0))),this._parser.registerOscHandler(1,new S.OscHandler(M=>this.setIconName(M))),this._parser.registerOscHandler(2,new S.OscHandler(M=>this.setTitle(M))),this._parser.registerOscHandler(4,new S.OscHandler(M=>this.setOrReportIndexedColor(M))),this._parser.registerOscHandler(8,new S.OscHandler(M=>this.setHyperlink(M))),this._parser.registerOscHandler(10,new S.OscHandler(M=>this.setOrReportFgColor(M))),this._parser.registerOscHandler(11,new S.OscHandler(M=>this.setOrReportBgColor(M))),this._parser.registerOscHandler(12,new S.OscHandler(M=>this.setOrReportCursorColor(M))),this._parser.registerOscHandler(104,new S.OscHandler(M=>this.restoreIndexedColor(M))),this._parser.registerOscHandler(110,new S.OscHandler(M=>this.restoreFgColor(M))),this._parser.registerOscHandler(111,new S.OscHandler(M=>this.restoreBgColor(M))),this._parser.registerOscHandler(112,new S.OscHandler(M=>this.restoreCursorColor(M))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let M in c.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:M},()=>this.selectCharset("("+M)),this._parser.registerEscHandler({intermediates:")",final:M},()=>this.selectCharset(")"+M)),this._parser.registerEscHandler({intermediates:"*",final:M},()=>this.selectCharset("*"+M)),this._parser.registerEscHandler({intermediates:"+",final:M},()=>this.selectCharset("+"+M)),this._parser.registerEscHandler({intermediates:"-",final:M},()=>this.selectCharset("-"+M)),this._parser.registerEscHandler({intermediates:".",final:M},()=>this.selectCharset("."+M)),this._parser.registerEscHandler({intermediates:"/",final:M},()=>this.selectCharset("/"+M));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(M=>(this._logService.error("Parsing error: ",M),M)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new A.DcsHandler((M,U)=>this.requestStatusString(M,U)))}_preserveStack(y,C,B,I){this._parseStack.paused=!0,this._parseStack.cursorStartX=y,this._parseStack.cursorStartY=C,this._parseStack.decodedLength=B,this._parseStack.position=I}_logSlowResolvingAsync(y){this._logService.logLevel<=w.LogLevelEnum.WARN&&Promise.race([y,new Promise((C,B)=>setTimeout(()=>B("#SLOW_TIMEOUT"),5e3))]).catch(C=>{if(C!=="#SLOW_TIMEOUT")throw C;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(y,C){let B,I=this._activeBuffer.x,R=this._activeBuffer.y,H=0,$=this._parseStack.paused;if($){if(B=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,C))return this._logSlowResolvingAsync(B),B;I=this._parseStack.cursorStartX,R=this._parseStack.cursorStartY,this._parseStack.paused=!1,y.length>D&&(H=this._parseStack.position+D)}if(this._logService.logLevel<=w.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof y=="string"?` "${y}"`:` "${Array.prototype.map.call(y,M=>String.fromCharCode(M)).join("")}"`),typeof y=="string"?y.split("").map(M=>M.charCodeAt(0)):y),this._parseBuffer.length<y.length&&this._parseBuffer.length<D&&(this._parseBuffer=new Uint32Array(Math.min(y.length,D))),$||this._dirtyRowTracker.clearRange(),y.length>D)for(let M=H;M<y.length;M+=D){let U=M+D<y.length?M+D:y.length,Z=typeof y=="string"?this._stringDecoder.decode(y.substring(M,U),this._parseBuffer):this._utf8Decoder.decode(y.subarray(M,U),this._parseBuffer);if(B=this._parser.parse(this._parseBuffer,Z))return this._preserveStack(I,R,Z,M),this._logSlowResolvingAsync(B),B}else if(!$){let M=typeof y=="string"?this._stringDecoder.decode(y,this._parseBuffer):this._utf8Decoder.decode(y,this._parseBuffer);if(B=this._parser.parse(this._parseBuffer,M))return this._preserveStack(I,R,M,0),this._logSlowResolvingAsync(B),B}this._activeBuffer.x===I&&this._activeBuffer.y===R||this._onCursorMove.fire();let q=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),P=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);P<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(P,this._bufferService.rows-1),Math.min(q,this._bufferService.rows-1))}print(y,C,B){let I,R,H=this._charsetService.charset,$=this._optionsService.rawOptions.screenReaderMode,q=this._bufferService.cols,P=this._coreService.decPrivateModes.wraparound,M=this._coreService.modes.insertMode,U=this._curAttrData,Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&B-C>0&&Z.getWidth(this._activeBuffer.x-1)===2&&Z.setCellFromCodepoint(this._activeBuffer.x-1,0,1,U);let te=this._parser.precedingJoinState;for(let ee=C;ee<B;++ee){if(I=y[ee],I<127&&H){let Te=H[String.fromCharCode(I)];Te&&(I=Te.charCodeAt(0))}let le=this._unicodeService.charProperties(I,te);R=b.UnicodeService.extractWidth(le);let ne=b.UnicodeService.extractShouldJoin(le),ye=ne?b.UnicodeService.extractWidth(te):0;if(te=le,$&&this._onA11yChar.fire((0,u.stringFromCodePoint)(I)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+R-ye>q){if(P){let Te=Z,oe=this._activeBuffer.x-ye;for(this._activeBuffer.x=ye,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),Z=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ye>0&&Z instanceof a.BufferLine&&Z.copyCellsFrom(Te,oe,0,ye,!1);oe<q;)Te.setCellFromCodepoint(oe++,0,1,U)}else if(this._activeBuffer.x=q-1,R===2)continue}if(ne&&this._activeBuffer.x){let Te=Z.getWidth(this._activeBuffer.x-1)?1:2;Z.addCodepointToCell(this._activeBuffer.x-Te,I,R);for(let oe=R-ye;--oe>=0;)Z.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}else if(M&&(Z.insertCells(this._activeBuffer.x,R-ye,this._activeBuffer.getNullCell(U)),Z.getWidth(q-1)===2&&Z.setCellFromCodepoint(q-1,_.NULL_CELL_CODE,_.NULL_CELL_WIDTH,U)),Z.setCellFromCodepoint(this._activeBuffer.x++,I,R,U),R>0)for(;--R;)Z.setCellFromCodepoint(this._activeBuffer.x++,0,0,U)}this._parser.precedingJoinState=te,this._activeBuffer.x<q&&B-C>0&&Z.getWidth(this._activeBuffer.x)===0&&!Z.hasContent(this._activeBuffer.x)&&Z.setCellFromCodepoint(this._activeBuffer.x,0,1,U),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(y,C){return y.final!=="t"||y.prefix||y.intermediates?this._parser.registerCsiHandler(y,C):this._parser.registerCsiHandler(y,B=>!L(B.params[0],this._optionsService.rawOptions.windowOptions)||C(B))}registerDcsHandler(y,C){return this._parser.registerDcsHandler(y,new A.DcsHandler(C))}registerEscHandler(y,C){return this._parser.registerEscHandler(y,C)}registerOscHandler(y,C){return this._parser.registerOscHandler(y,new S.OscHandler(C))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let y=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);y.hasWidth(this._activeBuffer.x)&&!y.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let y=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-y),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(y=this._bufferService.cols-1){this._activeBuffer.x=Math.min(y,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(y,C){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=y,this._activeBuffer.y=this._activeBuffer.scrollTop+C):(this._activeBuffer.x=y,this._activeBuffer.y=C),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(y,C){this._restrictCursor(),this._setCursor(this._activeBuffer.x+y,this._activeBuffer.y+C)}cursorUp(y){let C=this._activeBuffer.y-this._activeBuffer.scrollTop;return C>=0?this._moveCursor(0,-Math.min(C,y.params[0]||1)):this._moveCursor(0,-(y.params[0]||1)),!0}cursorDown(y){let C=this._activeBuffer.scrollBottom-this._activeBuffer.y;return C>=0?this._moveCursor(0,Math.min(C,y.params[0]||1)):this._moveCursor(0,y.params[0]||1),!0}cursorForward(y){return this._moveCursor(y.params[0]||1,0),!0}cursorBackward(y){return this._moveCursor(-(y.params[0]||1),0),!0}cursorNextLine(y){return this.cursorDown(y),this._activeBuffer.x=0,!0}cursorPrecedingLine(y){return this.cursorUp(y),this._activeBuffer.x=0,!0}cursorCharAbsolute(y){return this._setCursor((y.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(y){return this._setCursor(y.length>=2?(y.params[1]||1)-1:0,(y.params[0]||1)-1),!0}charPosAbsolute(y){return this._setCursor((y.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(y){return this._moveCursor(y.params[0]||1,0),!0}linePosAbsolute(y){return this._setCursor(this._activeBuffer.x,(y.params[0]||1)-1),!0}vPositionRelative(y){return this._moveCursor(0,y.params[0]||1),!0}hVPosition(y){return this.cursorPosition(y),!0}tabClear(y){let C=y.params[0];return C===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:C===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(y){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let C=y.params[0]||1;for(;C--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(y){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let C=y.params[0]||1;for(;C--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(y){let C=y.params[0];return C===1&&(this._curAttrData.bg|=536870912),C!==2&&C!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(y,C,B,I=!1,R=!1){let H=this._activeBuffer.lines.get(this._activeBuffer.ybase+y);H.replaceCells(C,B,this._activeBuffer.getNullCell(this._eraseAttrData()),R),I&&(H.isWrapped=!1)}_resetBufferLine(y,C=!1){let B=this._activeBuffer.lines.get(this._activeBuffer.ybase+y);B&&(B.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),C),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+y),B.isWrapped=!1)}eraseInDisplay(y,C=!1){let B;switch(this._restrictCursor(this._bufferService.cols),y.params[0]){case 0:for(B=this._activeBuffer.y,this._dirtyRowTracker.markDirty(B),this._eraseInBufferLine(B++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,C);B<this._bufferService.rows;B++)this._resetBufferLine(B,C);this._dirtyRowTracker.markDirty(B);break;case 1:for(B=this._activeBuffer.y,this._dirtyRowTracker.markDirty(B),this._eraseInBufferLine(B,0,this._activeBuffer.x+1,!0,C),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(B+1).isWrapped=!1);B--;)this._resetBufferLine(B,C);this._dirtyRowTracker.markDirty(0);break;case 2:for(B=this._bufferService.rows,this._dirtyRowTracker.markDirty(B-1);B--;)this._resetBufferLine(B,C);this._dirtyRowTracker.markDirty(0);break;case 3:let I=this._activeBuffer.lines.length-this._bufferService.rows;I>0&&(this._activeBuffer.lines.trimStart(I),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-I,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-I,0),this._onScroll.fire(0))}return!0}eraseInLine(y,C=!1){switch(this._restrictCursor(this._bufferService.cols),y.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,C);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,C);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,C)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(y){this._restrictCursor();let C=y.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let B=this._activeBuffer.ybase+this._activeBuffer.y,I=this._bufferService.rows-1-this._activeBuffer.scrollBottom,R=this._bufferService.rows-1+this._activeBuffer.ybase-I+1;for(;C--;)this._activeBuffer.lines.splice(R-1,1),this._activeBuffer.lines.splice(B,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(y){this._restrictCursor();let C=y.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let B=this._activeBuffer.ybase+this._activeBuffer.y,I;for(I=this._bufferService.rows-1-this._activeBuffer.scrollBottom,I=this._bufferService.rows-1+this._activeBuffer.ybase-I;C--;)this._activeBuffer.lines.splice(B,1),this._activeBuffer.lines.splice(I,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(y){this._restrictCursor();let C=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return C&&(C.insertCells(this._activeBuffer.x,y.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(y){this._restrictCursor();let C=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return C&&(C.deleteCells(this._activeBuffer.x,y.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(y){let C=y.params[0]||1;for(;C--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(y){let C=y.params[0]||1;for(;C--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(a.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let C=y.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){let I=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);I.deleteCells(0,C,this._activeBuffer.getNullCell(this._eraseAttrData())),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let C=y.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){let I=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);I.insertCells(0,C,this._activeBuffer.getNullCell(this._eraseAttrData())),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let C=y.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){let I=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);I.insertCells(this._activeBuffer.x,C,this._activeBuffer.getNullCell(this._eraseAttrData())),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(y){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let C=y.params[0]||1;for(let B=this._activeBuffer.scrollTop;B<=this._activeBuffer.scrollBottom;++B){let I=this._activeBuffer.lines.get(this._activeBuffer.ybase+B);I.deleteCells(this._activeBuffer.x,C,this._activeBuffer.getNullCell(this._eraseAttrData())),I.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(y){this._restrictCursor();let C=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return C&&(C.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(y.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(y){let C=this._parser.precedingJoinState;if(!C)return!0;let B=y.params[0]||1,I=b.UnicodeService.extractWidth(C),R=this._activeBuffer.x-I,H=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(R),$=new Uint32Array(H.length*B),q=0;for(let M=0;M<H.length;){let U=H.codePointAt(M)||0;$[q++]=U,M+=U>65535?2:1}let P=q;for(let M=1;M<B;++M)$.copyWithin(P,0,q),P+=q;return this.print($,0,P),!0}sendDeviceAttributesPrimary(y){return y.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(o.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(o.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(y){return y.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(o.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(o.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(y.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(o.C0.ESC+"[>83;40003;0c")),!0}_is(y){return(this._optionsService.rawOptions.termName+"").indexOf(y)===0}setMode(y){for(let C=0;C<y.length;C++)switch(y.params[C]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(y){for(let C=0;C<y.length;C++)switch(y.params[C]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,c.DEFAULT_CHARSET),this._charsetService.setgCharset(1,c.DEFAULT_CHARSET),this._charsetService.setgCharset(2,c.DEFAULT_CHARSET),this._charsetService.setgCharset(3,c.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(y){for(let C=0;C<y.length;C++)switch(y.params[C]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(y){for(let C=0;C<y.length;C++)switch(y.params[C]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),y.params[C]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(y,C){let B=this._coreService.decPrivateModes,{activeProtocol:I,activeEncoding:R}=this._coreMouseService,H=this._coreService,{buffers:$,cols:q}=this._bufferService,{active:P,alt:M}=$,U=this._optionsService.rawOptions,Z=ne=>ne?1:2,te=y.params[0];return ee=te,le=C?te===2?4:te===4?Z(H.modes.insertMode):te===12?3:te===20?Z(U.convertEol):0:te===1?Z(B.applicationCursorKeys):te===3?U.windowOptions.setWinLines?q===80?2:q===132?1:0:0:te===6?Z(B.origin):te===7?Z(B.wraparound):te===8?3:te===9?Z(I==="X10"):te===12?Z(U.cursorBlink):te===25?Z(!H.isCursorHidden):te===45?Z(B.reverseWraparound):te===66?Z(B.applicationKeypad):te===67?4:te===1e3?Z(I==="VT200"):te===1002?Z(I==="DRAG"):te===1003?Z(I==="ANY"):te===1004?Z(B.sendFocus):te===1005?4:te===1006?Z(R==="SGR"):te===1015?4:te===1016?Z(R==="SGR_PIXELS"):te===1048?1:te===47||te===1047||te===1049?Z(P===M):te===2004?Z(B.bracketedPasteMode):0,H.triggerDataEvent(`${o.C0.ESC}[${C?"":"?"}${ee};${le}$y`),!0;var ee,le}_updateAttrColor(y,C,B,I,R){return C===2?(y|=50331648,y&=-16777216,y|=m.AttributeData.fromColorRGB([B,I,R])):C===5&&(y&=-50331904,y|=33554432|255&B),y}_extractColor(y,C,B){let I=[0,0,-1,0,0,0],R=0,H=0;do{if(I[H+R]=y.params[C+H],y.hasSubParams(C+H)){let $=y.getSubParams(C+H),q=0;do I[1]===5&&(R=1),I[H+q+1+R]=$[q];while(++q<$.length&&q+H+1+R<I.length);break}if(I[1]===5&&H+R>=2||I[1]===2&&H+R>=5)break;I[1]&&(R=1)}while(++H+C<y.length&&H+R<I.length);for(let $=2;$<I.length;++$)I[$]===-1&&(I[$]=0);switch(I[0]){case 38:B.fg=this._updateAttrColor(B.fg,I[1],I[3],I[4],I[5]);break;case 48:B.bg=this._updateAttrColor(B.bg,I[1],I[3],I[4],I[5]);break;case 58:B.extended=B.extended.clone(),B.extended.underlineColor=this._updateAttrColor(B.extended.underlineColor,I[1],I[3],I[4],I[5])}return H}_processUnderline(y,C){C.extended=C.extended.clone(),(!~y||y>5)&&(y=1),C.extended.underlineStyle=y,C.fg|=268435456,y===0&&(C.fg&=-268435457),C.updateExtended()}_processSGR0(y){y.fg=a.DEFAULT_ATTR_DATA.fg,y.bg=a.DEFAULT_ATTR_DATA.bg,y.extended=y.extended.clone(),y.extended.underlineStyle=0,y.extended.underlineColor&=-67108864,y.updateExtended()}charAttributes(y){if(y.length===1&&y.params[0]===0)return this._processSGR0(this._curAttrData),!0;let C=y.length,B,I=this._curAttrData;for(let R=0;R<C;R++)B=y.params[R],B>=30&&B<=37?(I.fg&=-50331904,I.fg|=16777216|B-30):B>=40&&B<=47?(I.bg&=-50331904,I.bg|=16777216|B-40):B>=90&&B<=97?(I.fg&=-50331904,I.fg|=16777224|B-90):B>=100&&B<=107?(I.bg&=-50331904,I.bg|=16777224|B-100):B===0?this._processSGR0(I):B===1?I.fg|=134217728:B===3?I.bg|=67108864:B===4?(I.fg|=268435456,this._processUnderline(y.hasSubParams(R)?y.getSubParams(R)[0]:1,I)):B===5?I.fg|=536870912:B===7?I.fg|=67108864:B===8?I.fg|=1073741824:B===9?I.fg|=2147483648:B===2?I.bg|=134217728:B===21?this._processUnderline(2,I):B===22?(I.fg&=-134217729,I.bg&=-134217729):B===23?I.bg&=-67108865:B===24?(I.fg&=-268435457,this._processUnderline(0,I)):B===25?I.fg&=-536870913:B===27?I.fg&=-67108865:B===28?I.fg&=-1073741825:B===29?I.fg&=2147483647:B===39?(I.fg&=-67108864,I.fg|=16777215&a.DEFAULT_ATTR_DATA.fg):B===49?(I.bg&=-67108864,I.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):B===38||B===48||B===58?R+=this._extractColor(y,R,I):B===53?I.bg|=1073741824:B===55?I.bg&=-1073741825:B===59?(I.extended=I.extended.clone(),I.extended.underlineColor=-1,I.updateExtended()):B===100?(I.fg&=-67108864,I.fg|=16777215&a.DEFAULT_ATTR_DATA.fg,I.bg&=-67108864,I.bg|=16777215&a.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",B);return!0}deviceStatus(y){switch(y.params[0]){case 5:this._coreService.triggerDataEvent(`${o.C0.ESC}[0n`);break;case 6:let C=this._activeBuffer.y+1,B=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${o.C0.ESC}[${C};${B}R`)}return!0}deviceStatusPrivate(y){if(y.params[0]===6){let C=this._activeBuffer.y+1,B=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${o.C0.ESC}[?${C};${B}R`)}return!0}softReset(y){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(y){let C=y.params[0]||1;switch(C){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}let B=C%2==1;return this._optionsService.options.cursorBlink=B,!0}setScrollRegion(y){let C=y.params[0]||1,B;return(y.length<2||(B=y.params[1])>this._bufferService.rows||B===0)&&(B=this._bufferService.rows),B>C&&(this._activeBuffer.scrollTop=C-1,this._activeBuffer.scrollBottom=B-1,this._setCursor(0,0)),!0}windowOptions(y){if(!L(y.params[0],this._optionsService.rawOptions.windowOptions))return!0;let C=y.length>1?y.params[1]:0;switch(y.params[0]){case 14:C!==2&&this._onRequestWindowsOptionsReport.fire(T.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(T.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${o.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:C!==0&&C!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),C!==0&&C!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:C!==0&&C!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),C!==0&&C!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(y){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(y){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(y){return this._windowTitle=y,this._onTitleChange.fire(y),!0}setIconName(y){return this._iconName=y,!0}setOrReportIndexedColor(y){let C=[],B=y.split(";");for(;B.length>1;){let I=B.shift(),R=B.shift();if(/^\d+$/.exec(I)){let H=parseInt(I);if(X(H))if(R==="?")C.push({type:0,index:H});else{let $=(0,x.parseColor)(R);$&&C.push({type:1,index:H,color:$})}}}return C.length&&this._onColor.fire(C),!0}setHyperlink(y){let C=y.split(";");return!(C.length<2)&&(C[1]?this._createHyperlink(C[0],C[1]):!C[0]&&this._finishHyperlink())}_createHyperlink(y,C){this._getCurrentLinkId()&&this._finishHyperlink();let B=y.split(":"),I,R=B.findIndex(H=>H.startsWith("id="));return R!==-1&&(I=B[R].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:I,uri:C}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(y,C){let B=y.split(";");for(let I=0;I<B.length&&!(C>=this._specialColors.length);++I,++C)if(B[I]==="?")this._onColor.fire([{type:0,index:this._specialColors[C]}]);else{let R=(0,x.parseColor)(B[I]);R&&this._onColor.fire([{type:1,index:this._specialColors[C],color:R}])}return!0}setOrReportFgColor(y){return this._setOrReportSpecialColor(y,0)}setOrReportBgColor(y){return this._setOrReportSpecialColor(y,1)}setOrReportCursorColor(y){return this._setOrReportSpecialColor(y,2)}restoreIndexedColor(y){if(!y)return this._onColor.fire([{type:2}]),!0;let C=[],B=y.split(";");for(let I=0;I<B.length;++I)if(/^\d+$/.exec(B[I])){let R=parseInt(B[I]);X(R)&&C.push({type:2,index:R})}return C.length&&this._onColor.fire(C),!0}restoreFgColor(y){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(y){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(y){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,c.DEFAULT_CHARSET),!0}selectCharset(y){return y.length!==2?(this.selectDefaultCharset(),!0):(y[0]==="/"||this._charsetService.setgCharset(E[y[0]],c.CHARSETS[y[1]]||c.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let y=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,y,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=a.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=a.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(y){return this._charsetService.setgLevel(y),!0}screenAlignmentPattern(){let y=new p.CellData;y.content=4194373,y.fg=this._curAttrData.fg,y.bg=this._curAttrData.bg,this._setCursor(0,0);for(let C=0;C<this._bufferService.rows;++C){let B=this._activeBuffer.ybase+this._activeBuffer.y+C,I=this._activeBuffer.lines.get(B);I&&(I.fill(y),I.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(y,C){let B=this._bufferService.buffer,I=this._optionsService.rawOptions;return(R=>(this._coreService.triggerDataEvent(`${o.C0.ESC}${R}${o.C0.ESC}\\`),!0))(y==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:y==='"p'?'P1$r61;1"p':y==="r"?`P1$r${B.scrollTop+1};${B.scrollBottom+1}r`:y==="m"?"P1$r0m":y===" q"?`P1$r${{block:2,underline:4,bar:6}[I.cursorStyle]-(I.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(y,C){this._dirtyRowTracker.markRangeDirty(y,C)}}t.InputHandler=K;let N=class{constructor(k){this._bufferService=k,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(k){k<this.start?this.start=k:k>this.end&&(this.end=k)}markRangeDirty(k,y){k>y&&(F=k,k=y,y=F),k<this.start&&(this.start=k),y>this.end&&(this.end=y)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function X(k){return 0<=k&&k<256}N=h([g(0,w.IBufferService)],N)},844:(l,t)=>{function n(h){for(let g of h)g.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let g=this._disposables.indexOf(h);g!==-1&&this._disposables.splice(g,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){this._isDisposed||h===this._value||(this._value?.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=n,t.getDisposeArrayDisposable=function(h){return{dispose:()=>n(h)}}},1505:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(g,o,c){this._data[g]||(this._data[g]={}),this._data[g][o]=c}get(g,o){return this._data[g]?this._data[g][o]:void 0}clear(){this._data={}}}t.TwoKeyMap=n,t.FourKeyMap=class{constructor(){this._data=new n}set(h,g,o,c,f){this._data.get(h,g)||this._data.set(h,g,new n),this._data.get(h,g).set(o,c,f)}get(h,g,o,c){return this._data.get(h,g)?.get(o,c)}clear(){this._data.clear()}}},6114:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof process<"u"&&"title"in process;let n=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=n.includes("Firefox"),t.isLegacyEdge=n.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(n),t.getSafariVersion=function(){if(!t.isSafari)return 0;let g=n.match(/Version\/(\d+)/);return g===null||g.length<2?0:parseInt(g[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(n)},6106:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let n=0;t.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(n=this._search(this._getKey(h)),this._array.splice(n,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;let g=this._getKey(h);if(g===void 0||(n=this._search(g),n===-1)||this._getKey(this._array[n])!==g)return!1;do if(this._array[n]===h)return this._array.splice(n,1),!0;while(++n<this._array.length&&this._getKey(this._array[n])===g);return!1}*getKeyIterator(h){if(this._array.length!==0&&(n=this._search(h),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===h))do yield this._array[n];while(++n<this._array.length&&this._getKey(this._array[n])===h)}forEachByKey(h,g){if(this._array.length!==0&&(n=this._search(h),!(n<0||n>=this._array.length)&&this._getKey(this._array[n])===h))do g(this._array[n]);while(++n<this._array.length&&this._getKey(this._array[n])===h)}values(){return[...this._array].values()}_search(h){let g=0,o=this._array.length-1;for(;o>=g;){let c=g+o>>1,f=this._getKey(this._array[c]);if(f>h)o=c-1;else{if(!(f<h)){for(;c>0&&this._getKey(this._array[c-1])===h;)c--;return c}g=c+1}}return g}}},7226:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;let h=n(6114);class g{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let v=0,u=0,a=f.timeRemaining(),d=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),u=Math.max(v,u),d=f.timeRemaining(),1.5*u>d)return a-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(a-v))}ms`),void this._start();a=d}this.clear()}}class o extends g{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){let v=Date.now()+f;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}t.PriorityTaskQueue=o,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends g{_requestCallback(c){return requestIdleCallback(c)}_cancelCallback(c){cancelIdleCallback(c)}}:o,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(c){this._queue.clear(),this._queue.enqueue(c)}flush(){this._queue.flush()}}},9282:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;let h=n(643);t.updateWindowsModeWrappedState=function(g){let o=g.buffer.lines.get(g.buffer.ybase+g.buffer.y-1),c=o?.get(g.cols-1),f=g.buffer.lines.get(g.buffer.ybase+g.buffer.y);f&&c&&(f.isWrapped=c[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&c[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(o){return[o>>>16&255,o>>>8&255,255&o]}static fromColorRGB(o){return(255&o[0])<<16|(255&o[1])<<8|255&o[2]}clone(){let o=new n;return o.fg=this.fg,o.bg=this.bg,o.extended=this.extended.clone(),o}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=n;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(o){this._ext=o}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(o){this._ext&=-469762049,this._ext|=o<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(o){this._ext&=-67108864,this._ext|=67108863&o}get urlId(){return this._urlId}set urlId(o){this._urlId=o}get underlineVariantOffset(){let o=(3758096384&this._ext)>>29;return o<0?4294967288^o:o}set underlineVariantOffset(o){this._ext&=536870911,this._ext|=o<<29&3758096384}constructor(o=0,c=0){this._ext=0,this._urlId=0,this._ext=o,this._urlId=c}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},9092:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=t.MAX_BUFFER_SIZE=void 0;let h=n(6349),g=n(7226),o=n(3734),c=n(8437),f=n(4634),v=n(511),u=n(643),a=n(4863),d=n(7116);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(_,p,m){this._hasScrollback=_,this._optionsService=p,this._bufferService=m,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=c.DEFAULT_ATTR_DATA.clone(),this.savedCharset=d.DEFAULT_CHARSET,this.markers=[],this._nullCell=v.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]),this._whitespaceCell=v.CellData.fromCharData([0,u.WHITESPACE_CELL_CHAR,u.WHITESPACE_CELL_WIDTH,u.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new g.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(_){return _?(this._nullCell.fg=_.fg,this._nullCell.bg=_.bg,this._nullCell.extended=_.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new o.ExtendedAttrs),this._nullCell}getWhitespaceCell(_){return _?(this._whitespaceCell.fg=_.fg,this._whitespaceCell.bg=_.bg,this._whitespaceCell.extended=_.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new o.ExtendedAttrs),this._whitespaceCell}getBlankLine(_,p){return new c.BufferLine(this._bufferService.cols,this.getNullCell(_),p)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let _=this.ybase+this.y-this.ydisp;return _>=0&&_<this._rows}_getCorrectBufferLength(_){if(!this._hasScrollback)return _;let p=_+this._optionsService.rawOptions.scrollback;return p>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:p}fillViewportRows(_){if(this.lines.length===0){_===void 0&&(_=c.DEFAULT_ATTR_DATA);let p=this._rows;for(;p--;)this.lines.push(this.getBlankLine(_))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(_,p){let m=this.getNullCell(c.DEFAULT_ATTR_DATA),w=0,b=this._getCorrectBufferLength(p);if(b>this.lines.maxLength&&(this.lines.maxLength=b),this.lines.length>0){if(this._cols<_)for(let A=0;A<this.lines.length;A++)w+=+this.lines.get(A).resize(_,m);let S=0;if(this._rows<p)for(let A=this._rows;A<p;A++)this.lines.length<p+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new c.BufferLine(_,m)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new c.BufferLine(_,m)));else for(let A=this._rows;A>p;A--)this.lines.length>p+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(b<this.lines.maxLength){let A=this.lines.length-b;A>0&&(this.lines.trimStart(A),this.ybase=Math.max(this.ybase-A,0),this.ydisp=Math.max(this.ydisp-A,0),this.savedY=Math.max(this.savedY-A,0)),this.lines.maxLength=b}this.x=Math.min(this.x,_-1),this.y=Math.min(this.y,p-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,_-1),this.scrollTop=0}if(this.scrollBottom=p-1,this._isReflowEnabled&&(this._reflow(_,p),this._cols>_))for(let S=0;S<this.lines.length;S++)w+=+this.lines.get(S).resize(_,m);this._cols=_,this._rows=p,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let _=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,_=!1);let p=0;for(;this._memoryCleanupPosition<this.lines.length;)if(p+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),p>100)return!0;return _}get _isReflowEnabled(){let _=this._optionsService.rawOptions.windowsPty;return _&&_.buildNumber?this._hasScrollback&&_.backend==="conpty"&&_.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(_,p){this._cols!==_&&(_>this._cols?this._reflowLarger(_,p):this._reflowSmaller(_,p))}_reflowLarger(_,p){let m=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,_,this.ybase+this.y,this.getNullCell(c.DEFAULT_ATTR_DATA));if(m.length>0){let w=(0,f.reflowLargerCreateNewLayout)(this.lines,m);(0,f.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(_,p,w.countRemoved)}}_reflowLargerAdjustViewport(_,p,m){let w=this.getNullCell(c.DEFAULT_ATTR_DATA),b=m;for(;b-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<p&&this.lines.push(new c.BufferLine(_,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-m,0)}_reflowSmaller(_,p){let m=this.getNullCell(c.DEFAULT_ATTR_DATA),w=[],b=0;for(let S=this.lines.length-1;S>=0;S--){let A=this.lines.get(S);if(!A||!A.isWrapped&&A.getTrimmedLength()<=_)continue;let x=[A];for(;A.isWrapped&&S>0;)A=this.lines.get(--S),x.unshift(A);let E=this.ybase+this.y;if(E>=S&&E<S+x.length)continue;let D=x[x.length-1].getTrimmedLength(),L=(0,f.reflowSmallerGetNewLineLengths)(x,this._cols,_),T=L.length-x.length,F;F=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+T):Math.max(0,this.lines.length-this.lines.maxLength+T);let K=[];for(let B=0;B<T;B++){let I=this.getBlankLine(c.DEFAULT_ATTR_DATA,!0);K.push(I)}K.length>0&&(w.push({start:S+x.length+b,newLines:K}),b+=K.length),x.push(...K);let N=L.length-1,X=L[N];X===0&&(N--,X=L[N]);let k=x.length-T-1,y=D;for(;k>=0;){let B=Math.min(y,X);if(x[N]===void 0)break;if(x[N].copyCellsFrom(x[k],y-B,X-B,B,!0),X-=B,X===0&&(N--,X=L[N]),y-=B,y===0){k--;let I=Math.max(k,0);y=(0,f.getWrappedLineTrimmedLength)(x,I,this._cols)}}for(let B=0;B<x.length;B++)L[B]<_&&x[B].setCell(L[B],m);let C=T-F;for(;C-- >0;)this.ybase===0?this.y<p-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+b)-p&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+T,this.ybase+p-1)}if(w.length>0){let S=[],A=[];for(let N=0;N<this.lines.length;N++)A.push(this.lines.get(N));let x=this.lines.length,E=x-1,D=0,L=w[D];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+b);let T=0;for(let N=Math.min(this.lines.maxLength-1,x+b-1);N>=0;N--)if(L&&L.start>E+T){for(let X=L.newLines.length-1;X>=0;X--)this.lines.set(N--,L.newLines[X]);N++,S.push({index:E+1,amount:L.newLines.length}),T+=L.newLines.length,L=w[++D]}else this.lines.set(N,A[E--]);let F=0;for(let N=S.length-1;N>=0;N--)S[N].index+=F,this.lines.onInsertEmitter.fire(S[N]),F+=S[N].amount;let K=Math.max(0,x+b-this.lines.maxLength);K>0&&this.lines.onTrimEmitter.fire(K)}}translateBufferLineToString(_,p,m=0,w){let b=this.lines.get(_);return b?b.translateToString(p,m,w):""}getWrappedRangeForLine(_){let p=_,m=_;for(;p>0&&this.lines.get(p).isWrapped;)p--;for(;m+1<this.lines.length&&this.lines.get(m+1).isWrapped;)m++;return{first:p,last:m}}setupTabStops(_){for(_!=null?this.tabs[_]||(_=this.prevStop(_)):(this.tabs={},_=0);_<this._cols;_+=this._optionsService.rawOptions.tabStopWidth)this.tabs[_]=!0}prevStop(_){for(_==null&&(_=this.x);!this.tabs[--_]&&_>0;);return _>=this._cols?this._cols-1:_<0?0:_}nextStop(_){for(_==null&&(_=this.x);!this.tabs[++_]&&_<this._cols;);return _>=this._cols?this._cols-1:_<0?0:_}clearMarkers(_){this._isClearing=!0;for(let p=0;p<this.markers.length;p++)this.markers[p].line===_&&(this.markers[p].dispose(),this.markers.splice(p--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let _=0;_<this.markers.length;_++)this.markers[_].dispose(),this.markers.splice(_--,1);this._isClearing=!1}addMarker(_){let p=new a.Marker(_);return this.markers.push(p),p.register(this.lines.onTrim(m=>{p.line-=m,p.line<0&&p.dispose()})),p.register(this.lines.onInsert(m=>{p.line>=m.index&&(p.line+=m.amount)})),p.register(this.lines.onDelete(m=>{p.line>=m.index&&p.line<m.index+m.amount&&p.dispose(),p.line>m.index&&(p.line-=m.amount)})),p.register(p.onDispose(()=>this._removeMarker(p))),p}_removeMarker(_){this._isClearing||this.markers.splice(this.markers.indexOf(_),1)}}},8437:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;let h=n(3734),g=n(511),o=n(643),c=n(482);t.DEFAULT_ATTR_DATA=Object.freeze(new h.AttributeData);let f=0;class v{constructor(a,d,_=!1){this.isWrapped=_,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*a);let p=d||g.CellData.fromCharData([0,o.NULL_CELL_CHAR,o.NULL_CELL_WIDTH,o.NULL_CELL_CODE]);for(let m=0;m<a;++m)this.setCell(m,p);this.length=a}get(a){let d=this._data[3*a+0],_=2097151&d;return[this._data[3*a+1],2097152&d?this._combined[a]:_?(0,c.stringFromCodePoint)(_):"",d>>22,2097152&d?this._combined[a].charCodeAt(this._combined[a].length-1):_]}set(a,d){this._data[3*a+1]=d[o.CHAR_DATA_ATTR_INDEX],d[o.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[a]=d[1],this._data[3*a+0]=2097152|a|d[o.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*a+0]=d[o.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|d[o.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(a){return this._data[3*a+0]>>22}hasWidth(a){return 12582912&this._data[3*a+0]}getFg(a){return this._data[3*a+1]}getBg(a){return this._data[3*a+2]}hasContent(a){return 4194303&this._data[3*a+0]}getCodePoint(a){let d=this._data[3*a+0];return 2097152&d?this._combined[a].charCodeAt(this._combined[a].length-1):2097151&d}isCombined(a){return 2097152&this._data[3*a+0]}getString(a){let d=this._data[3*a+0];return 2097152&d?this._combined[a]:2097151&d?(0,c.stringFromCodePoint)(2097151&d):""}isProtected(a){return 536870912&this._data[3*a+2]}loadCell(a,d){return f=3*a,d.content=this._data[f+0],d.fg=this._data[f+1],d.bg=this._data[f+2],2097152&d.content&&(d.combinedData=this._combined[a]),268435456&d.bg&&(d.extended=this._extendedAttrs[a]),d}setCell(a,d){2097152&d.content&&(this._combined[a]=d.combinedData),268435456&d.bg&&(this._extendedAttrs[a]=d.extended),this._data[3*a+0]=d.content,this._data[3*a+1]=d.fg,this._data[3*a+2]=d.bg}setCellFromCodepoint(a,d,_,p){268435456&p.bg&&(this._extendedAttrs[a]=p.extended),this._data[3*a+0]=d|_<<22,this._data[3*a+1]=p.fg,this._data[3*a+2]=p.bg}addCodepointToCell(a,d,_){let p=this._data[3*a+0];2097152&p?this._combined[a]+=(0,c.stringFromCodePoint)(d):2097151&p?(this._combined[a]=(0,c.stringFromCodePoint)(2097151&p)+(0,c.stringFromCodePoint)(d),p&=-2097152,p|=2097152):p=d|4194304,_&&(p&=-12582913,p|=_<<22),this._data[3*a+0]=p}insertCells(a,d,_){if((a%=this.length)&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,_),d<this.length-a){let p=new g.CellData;for(let m=this.length-a-d-1;m>=0;--m)this.setCell(a+d+m,this.loadCell(a+m,p));for(let m=0;m<d;++m)this.setCell(a+m,_)}else for(let p=a;p<this.length;++p)this.setCell(p,_);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,_)}deleteCells(a,d,_){if(a%=this.length,d<this.length-a){let p=new g.CellData;for(let m=0;m<this.length-a-d;++m)this.setCell(a+m,this.loadCell(a+d+m,p));for(let m=this.length-d;m<this.length;++m)this.setCell(m,_)}else for(let p=a;p<this.length;++p)this.setCell(p,_);a&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,_),this.getWidth(a)!==0||this.hasContent(a)||this.setCellFromCodepoint(a,0,1,_)}replaceCells(a,d,_,p=!1){if(p)for(a&&this.getWidth(a-1)===2&&!this.isProtected(a-1)&&this.setCellFromCodepoint(a-1,0,1,_),d<this.length&&this.getWidth(d-1)===2&&!this.isProtected(d)&&this.setCellFromCodepoint(d,0,1,_);a<d&&a<this.length;)this.isProtected(a)||this.setCell(a,_),a++;else for(a&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a-1,0,1,_),d<this.length&&this.getWidth(d-1)===2&&this.setCellFromCodepoint(d,0,1,_);a<d&&a<this.length;)this.setCell(a++,_)}resize(a,d){if(a===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;let _=3*a;if(a>this.length){if(this._data.buffer.byteLength>=4*_)this._data=new Uint32Array(this._data.buffer,0,_);else{let p=new Uint32Array(_);p.set(this._data),this._data=p}for(let p=this.length;p<a;++p)this.setCell(p,d)}else{this._data=this._data.subarray(0,_);let p=Object.keys(this._combined);for(let w=0;w<p.length;w++){let b=parseInt(p[w],10);b>=a&&delete this._combined[b]}let m=Object.keys(this._extendedAttrs);for(let w=0;w<m.length;w++){let b=parseInt(m[w],10);b>=a&&delete this._extendedAttrs[b]}}return this.length=a,4*_*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){let a=new Uint32Array(this._data.length);return a.set(this._data),this._data=a,1}return 0}fill(a,d=!1){if(d)for(let _=0;_<this.length;++_)this.isProtected(_)||this.setCell(_,a);else{this._combined={},this._extendedAttrs={};for(let _=0;_<this.length;++_)this.setCell(_,a)}}copyFrom(a){this.length!==a.length?this._data=new Uint32Array(a._data):this._data.set(a._data),this.length=a.length,this._combined={};for(let d in a._combined)this._combined[d]=a._combined[d];this._extendedAttrs={};for(let d in a._extendedAttrs)this._extendedAttrs[d]=a._extendedAttrs[d];this.isWrapped=a.isWrapped}clone(){let a=new v(0);a._data=new Uint32Array(this._data),a.length=this.length;for(let d in this._combined)a._combined[d]=this._combined[d];for(let d in this._extendedAttrs)a._extendedAttrs[d]=this._extendedAttrs[d];return a.isWrapped=this.isWrapped,a}getTrimmedLength(){for(let a=this.length-1;a>=0;--a)if(4194303&this._data[3*a+0])return a+(this._data[3*a+0]>>22);return 0}getNoBgTrimmedLength(){for(let a=this.length-1;a>=0;--a)if(4194303&this._data[3*a+0]||50331648&this._data[3*a+2])return a+(this._data[3*a+0]>>22);return 0}copyCellsFrom(a,d,_,p,m){let w=a._data;if(m)for(let S=p-1;S>=0;S--){for(let A=0;A<3;A++)this._data[3*(_+S)+A]=w[3*(d+S)+A];268435456&w[3*(d+S)+2]&&(this._extendedAttrs[_+S]=a._extendedAttrs[d+S])}else for(let S=0;S<p;S++){for(let A=0;A<3;A++)this._data[3*(_+S)+A]=w[3*(d+S)+A];268435456&w[3*(d+S)+2]&&(this._extendedAttrs[_+S]=a._extendedAttrs[d+S])}let b=Object.keys(a._combined);for(let S=0;S<b.length;S++){let A=parseInt(b[S],10);A>=d&&(this._combined[A-d+_]=a._combined[A])}}translateToString(a,d,_,p){d=d??0,_=_??this.length,a&&(_=Math.min(_,this.getTrimmedLength())),p&&(p.length=0);let m="";for(;d<_;){let w=this._data[3*d+0],b=2097151&w,S=2097152&w?this._combined[d]:b?(0,c.stringFromCodePoint)(b):o.WHITESPACE_CELL_CHAR;if(m+=S,p)for(let A=0;A<S.length;++A)p.push(d);d+=w>>22||1}return p&&p.push(d),m}}t.BufferLine=v},4841:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(n,h){if(n.start.y>n.end.y)throw new Error(`Buffer range end (${n.end.x}, ${n.end.y}) cannot be before start (${n.start.x}, ${n.start.y})`);return h*(n.end.y-n.start.y)+(n.end.x-n.start.x+1)}},4634:(l,t)=>{function n(h,g,o){if(g===h.length-1)return h[g].getTrimmedLength();let c=!h[g].hasContent(o-1)&&h[g].getWidth(o-1)===1,f=h[g+1].getWidth(0)===2;return c&&f?o-1:o}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(h,g,o,c,f){let v=[];for(let u=0;u<h.length-1;u++){let a=u,d=h.get(++a);if(!d.isWrapped)continue;let _=[h.get(u)];for(;a<h.length&&d.isWrapped;)_.push(d),d=h.get(++a);if(c>=u&&c<a){u+=_.length-1;continue}let p=0,m=n(_,p,g),w=1,b=0;for(;w<_.length;){let A=n(_,w,g),x=A-b,E=o-m,D=Math.min(x,E);_[p].copyCellsFrom(_[w],b,m,D,!1),m+=D,m===o&&(p++,m=0),b+=D,b===A&&(w++,b=0),m===0&&p!==0&&_[p-1].getWidth(o-1)===2&&(_[p].copyCellsFrom(_[p-1],o-1,m++,1,!1),_[p-1].setCell(o-1,f))}_[p].replaceCells(m,o,f);let S=0;for(let A=_.length-1;A>0&&(A>p||_[A].getTrimmedLength()===0);A--)S++;S>0&&(v.push(u+_.length-S),v.push(S)),u+=_.length-1}return v},t.reflowLargerCreateNewLayout=function(h,g){let o=[],c=0,f=g[c],v=0;for(let u=0;u<h.length;u++)if(f===u){let a=g[++c];h.onDeleteEmitter.fire({index:u-v,amount:a}),u+=a-1,v+=a,f=g[++c]}else o.push(u);return{layout:o,countRemoved:v}},t.reflowLargerApplyNewLayout=function(h,g){let o=[];for(let c=0;c<g.length;c++)o.push(h.get(g[c]));for(let c=0;c<o.length;c++)h.set(c,o[c]);h.length=g.length},t.reflowSmallerGetNewLineLengths=function(h,g,o){let c=[],f=h.map((d,_)=>n(h,_,g)).reduce((d,_)=>d+_),v=0,u=0,a=0;for(;a<f;){if(f-a<o){c.push(f-a);break}v+=o;let d=n(h,u,g);v>d&&(v-=d,u++);let _=h[u].getWidth(v-1)===2;_&&v--;let p=_?o-1:o;c.push(p),a+=p}return c},t.getWrappedLineTrimmedLength=n},5295:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;let h=n(8460),g=n(844),o=n(9092);class c extends g.Disposable{constructor(v,u){super(),this._optionsService=v,this._bufferService=u,this._onBufferActivate=this.register(new h.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new o.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new o.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,u){this._normal.resize(v,u),this._alt.resize(v,u),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}t.BufferSet=c},511:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;let h=n(482),g=n(643),o=n(3734);class c extends o.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new o.ExtendedAttrs,this.combinedData=""}static fromCharData(v){let u=new c;return u.setFromCharData(v),u}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[g.CHAR_DATA_ATTR_INDEX],this.bg=0;let u=!1;if(v[g.CHAR_DATA_CHAR_INDEX].length>2)u=!0;else if(v[g.CHAR_DATA_CHAR_INDEX].length===2){let a=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=a&&a<=56319){let d=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=d&&d<=57343?this.content=1024*(a-55296)+d-56320+65536|v[g.CHAR_DATA_WIDTH_INDEX]<<22:u=!0}else u=!0}else this.content=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[g.CHAR_DATA_WIDTH_INDEX]<<22;u&&(this.combinedData=v[g.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[g.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=c},643:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;let h=n(8460),g=n(844);class o{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=o._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,g.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}t.Marker=o,o._nextId=1},7116:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"\u25C6",a:"\u2592",b:"\u2409",c:"\u240C",d:"\u240D",e:"\u240A",f:"\xB0",g:"\xB1",h:"\u2424",i:"\u240B",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},t.CHARSETS.A={"#":"\xA3"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"\xA3","@":"\xBE","[":"ij","\\":"\xBD","]":"|","{":"\xA8","|":"f","}":"\xBC","~":"\xB4"},t.CHARSETS.C=t.CHARSETS[5]={"[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS.R={"#":"\xA3","@":"\xE0","[":"\xB0","\\":"\xE7","]":"\xA7","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xA8"},t.CHARSETS.Q={"@":"\xE0","[":"\xE2","\\":"\xE7","]":"\xEA","^":"\xEE","`":"\xF4","{":"\xE9","|":"\xF9","}":"\xE8","~":"\xFB"},t.CHARSETS.K={"@":"\xA7","[":"\xC4","\\":"\xD6","]":"\xDC","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xDF"},t.CHARSETS.Y={"#":"\xA3","@":"\xA7","[":"\xB0","\\":"\xE7","]":"\xE9","`":"\xF9","{":"\xE0","|":"\xF2","}":"\xE8","~":"\xEC"},t.CHARSETS.E=t.CHARSETS[6]={"@":"\xC4","[":"\xC6","\\":"\xD8","]":"\xC5","^":"\xDC","`":"\xE4","{":"\xE6","|":"\xF8","}":"\xE5","~":"\xFC"},t.CHARSETS.Z={"#":"\xA3","@":"\xA7","[":"\xA1","\\":"\xD1","]":"\xBF","{":"\xB0","|":"\xF1","}":"\xE7"},t.CHARSETS.H=t.CHARSETS[7]={"@":"\xC9","[":"\xC4","\\":"\xD6","]":"\xC5","^":"\xDC","`":"\xE9","{":"\xE4","|":"\xF6","}":"\xE5","~":"\xFC"},t.CHARSETS["="]={"#":"\xF9","@":"\xE0","[":"\xE9","\\":"\xE7","]":"\xEA","^":"\xEE",_:"\xE8","`":"\xF4","{":"\xE4","|":"\xF6","}":"\xFC","~":"\xFB"}},2584:(l,t)=>{var n,h,g;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(o){o.NUL="\0",o.SOH="",o.STX="",o.ETX="",o.EOT="",o.ENQ="",o.ACK="",o.BEL="\x07",o.BS="\b",o.HT="	",o.LF=`
`,o.VT="\v",o.FF="\f",o.CR="\r",o.SO="",o.SI="",o.DLE="",o.DC1="",o.DC2="",o.DC3="",o.DC4="",o.NAK="",o.SYN="",o.ETB="",o.CAN="",o.EM="",o.SUB="",o.ESC="\x1B",o.FS="",o.GS="",o.RS="",o.US="",o.SP=" ",o.DEL="\x7F"}(n||(t.C0=n={})),function(o){o.PAD="\x80",o.HOP="\x81",o.BPH="\x82",o.NBH="\x83",o.IND="\x84",o.NEL="\x85",o.SSA="\x86",o.ESA="\x87",o.HTS="\x88",o.HTJ="\x89",o.VTS="\x8A",o.PLD="\x8B",o.PLU="\x8C",o.RI="\x8D",o.SS2="\x8E",o.SS3="\x8F",o.DCS="\x90",o.PU1="\x91",o.PU2="\x92",o.STS="\x93",o.CCH="\x94",o.MW="\x95",o.SPA="\x96",o.EPA="\x97",o.SOS="\x98",o.SGCI="\x99",o.SCI="\x9A",o.CSI="\x9B",o.ST="\x9C",o.OSC="\x9D",o.PM="\x9E",o.APC="\x9F"}(h||(t.C1=h={})),function(o){o.ST=`${n.ESC}\\`}(g||(t.C1_ESCAPED=g={}))},7399:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;let h=n(2584),g={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(o,c,f,v){let u={type:0,cancel:!1,key:void 0},a=(o.shiftKey?1:0)|(o.altKey?2:0)|(o.ctrlKey?4:0)|(o.metaKey?8:0);switch(o.keyCode){case 0:o.key==="UIKeyInputUpArrow"?u.key=c?h.C0.ESC+"OA":h.C0.ESC+"[A":o.key==="UIKeyInputLeftArrow"?u.key=c?h.C0.ESC+"OD":h.C0.ESC+"[D":o.key==="UIKeyInputRightArrow"?u.key=c?h.C0.ESC+"OC":h.C0.ESC+"[C":o.key==="UIKeyInputDownArrow"&&(u.key=c?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:u.key=o.ctrlKey?"\b":h.C0.DEL,o.altKey&&(u.key=h.C0.ESC+u.key);break;case 9:if(o.shiftKey){u.key=h.C0.ESC+"[Z";break}u.key=h.C0.HT,u.cancel=!0;break;case 13:u.key=o.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,u.cancel=!0;break;case 27:u.key=h.C0.ESC,o.altKey&&(u.key=h.C0.ESC+h.C0.ESC),u.cancel=!0;break;case 37:if(o.metaKey)break;a?(u.key=h.C0.ESC+"[1;"+(a+1)+"D",u.key===h.C0.ESC+"[1;3D"&&(u.key=h.C0.ESC+(f?"b":"[1;5D"))):u.key=c?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(o.metaKey)break;a?(u.key=h.C0.ESC+"[1;"+(a+1)+"C",u.key===h.C0.ESC+"[1;3C"&&(u.key=h.C0.ESC+(f?"f":"[1;5C"))):u.key=c?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(o.metaKey)break;a?(u.key=h.C0.ESC+"[1;"+(a+1)+"A",f||u.key!==h.C0.ESC+"[1;3A"||(u.key=h.C0.ESC+"[1;5A")):u.key=c?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(o.metaKey)break;a?(u.key=h.C0.ESC+"[1;"+(a+1)+"B",f||u.key!==h.C0.ESC+"[1;3B"||(u.key=h.C0.ESC+"[1;5B")):u.key=c?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:o.shiftKey||o.ctrlKey||(u.key=h.C0.ESC+"[2~");break;case 46:u.key=a?h.C0.ESC+"[3;"+(a+1)+"~":h.C0.ESC+"[3~";break;case 36:u.key=a?h.C0.ESC+"[1;"+(a+1)+"H":c?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:u.key=a?h.C0.ESC+"[1;"+(a+1)+"F":c?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:o.shiftKey?u.type=2:o.ctrlKey?u.key=h.C0.ESC+"[5;"+(a+1)+"~":u.key=h.C0.ESC+"[5~";break;case 34:o.shiftKey?u.type=3:o.ctrlKey?u.key=h.C0.ESC+"[6;"+(a+1)+"~":u.key=h.C0.ESC+"[6~";break;case 112:u.key=a?h.C0.ESC+"[1;"+(a+1)+"P":h.C0.ESC+"OP";break;case 113:u.key=a?h.C0.ESC+"[1;"+(a+1)+"Q":h.C0.ESC+"OQ";break;case 114:u.key=a?h.C0.ESC+"[1;"+(a+1)+"R":h.C0.ESC+"OR";break;case 115:u.key=a?h.C0.ESC+"[1;"+(a+1)+"S":h.C0.ESC+"OS";break;case 116:u.key=a?h.C0.ESC+"[15;"+(a+1)+"~":h.C0.ESC+"[15~";break;case 117:u.key=a?h.C0.ESC+"[17;"+(a+1)+"~":h.C0.ESC+"[17~";break;case 118:u.key=a?h.C0.ESC+"[18;"+(a+1)+"~":h.C0.ESC+"[18~";break;case 119:u.key=a?h.C0.ESC+"[19;"+(a+1)+"~":h.C0.ESC+"[19~";break;case 120:u.key=a?h.C0.ESC+"[20;"+(a+1)+"~":h.C0.ESC+"[20~";break;case 121:u.key=a?h.C0.ESC+"[21;"+(a+1)+"~":h.C0.ESC+"[21~";break;case 122:u.key=a?h.C0.ESC+"[23;"+(a+1)+"~":h.C0.ESC+"[23~";break;case 123:u.key=a?h.C0.ESC+"[24;"+(a+1)+"~":h.C0.ESC+"[24~";break;default:if(!o.ctrlKey||o.shiftKey||o.altKey||o.metaKey)if(f&&!v||!o.altKey||o.metaKey)!f||o.altKey||o.ctrlKey||o.shiftKey||!o.metaKey?o.key&&!o.ctrlKey&&!o.altKey&&!o.metaKey&&o.keyCode>=48&&o.key.length===1?u.key=o.key:o.key&&o.ctrlKey&&(o.key==="_"&&(u.key=h.C0.US),o.key==="@"&&(u.key=h.C0.NUL)):o.keyCode===65&&(u.type=1);else{let d=g[o.keyCode],_=d?.[o.shiftKey?1:0];if(_)u.key=h.C0.ESC+_;else if(o.keyCode>=65&&o.keyCode<=90){let p=o.ctrlKey?o.keyCode-64:o.keyCode+32,m=String.fromCharCode(p);o.shiftKey&&(m=m.toUpperCase()),u.key=h.C0.ESC+m}else if(o.keyCode===32)u.key=h.C0.ESC+(o.ctrlKey?h.C0.NUL:" ");else if(o.key==="Dead"&&o.code.startsWith("Key")){let p=o.code.slice(3,4);o.shiftKey||(p=p.toLowerCase()),u.key=h.C0.ESC+p,u.cancel=!0}}else o.keyCode>=65&&o.keyCode<=90?u.key=String.fromCharCode(o.keyCode-64):o.keyCode===32?u.key=h.C0.NUL:o.keyCode>=51&&o.keyCode<=55?u.key=String.fromCharCode(o.keyCode-51+27):o.keyCode===56?u.key=h.C0.DEL:o.keyCode===219?u.key=h.C0.ESC:o.keyCode===220?u.key=h.C0.FS:o.keyCode===221&&(u.key=h.C0.GS)}return u}},482:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},t.utf32ToString=function(n,h=0,g=n.length){let o="";for(let c=h;c<g;++c){let f=n[c];f>65535?(f-=65536,o+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):o+=String.fromCharCode(f)}return o},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,h){let g=n.length;if(!g)return 0;let o=0,c=0;if(this._interim){let f=n.charCodeAt(c++);56320<=f&&f<=57343?h[o++]=1024*(this._interim-55296)+f-56320+65536:(h[o++]=this._interim,h[o++]=f),this._interim=0}for(let f=c;f<g;++f){let v=n.charCodeAt(f);if(55296<=v&&v<=56319){if(++f>=g)return this._interim=v,o;let u=n.charCodeAt(f);56320<=u&&u<=57343?h[o++]=1024*(v-55296)+u-56320+65536:(h[o++]=v,h[o++]=u)}else v!==65279&&(h[o++]=v)}return o}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,h){let g=n.length;if(!g)return 0;let o,c,f,v,u=0,a=0,d=0;if(this.interim[0]){let m=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)w<<=6,w|=b;let A=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,x=A-S;for(;d<x;){if(d>=g)return 0;if(b=n[d++],(192&b)!=128){d--,m=!0;break}this.interim[S++]=b,w<<=6,w|=63&b}m||(A===2?w<128?d--:h[u++]=w:A===3?w<2048||w>=55296&&w<=57343||w===65279||(h[u++]=w):w<65536||w>1114111||(h[u++]=w)),this.interim.fill(0)}let _=g-4,p=d;for(;p<g;){for(;!(!(p<_)||128&(o=n[p])||128&(c=n[p+1])||128&(f=n[p+2])||128&(v=n[p+3]));)h[u++]=o,h[u++]=c,h[u++]=f,h[u++]=v,p+=4;if(o=n[p++],o<128)h[u++]=o;else if((224&o)==192){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(a=(31&o)<<6|63&c,a<128){p--;continue}h[u++]=a}else if((240&o)==224){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,u;if(f=n[p++],(192&f)!=128){p--;continue}if(a=(15&o)<<12|(63&c)<<6|63&f,a<2048||a>=55296&&a<=57343||a===65279)continue;h[u++]=a}else if((248&o)==240){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,u;if(f=n[p++],(192&f)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,this.interim[2]=f,u;if(v=n[p++],(192&v)!=128){p--;continue}if(a=(7&o)<<18|(63&c)<<12|(63&f)<<6|63&v,a<65536||a>1114111)continue;h[u++]=a}}return u}}},225:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;let h=n(1480),g=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],c;t.UnicodeV6=class{constructor(){if(this.version="6",!c){c=new Uint8Array(65536),c.fill(1),c[0]=0,c.fill(0,1,32),c.fill(0,127,160),c.fill(2,4352,4448),c[9001]=2,c[9002]=2,c.fill(2,11904,42192),c[12351]=1,c.fill(2,44032,55204),c.fill(2,63744,64256),c.fill(2,65040,65050),c.fill(2,65072,65136),c.fill(2,65280,65377),c.fill(2,65504,65511);for(let f=0;f<g.length;++f)c.fill(0,g[f][0],g[f][1]+1)}}wcwidth(f){return f<32?0:f<127?1:f<65536?c[f]:function(v,u){let a,d=0,_=u.length-1;if(v<u[0][0]||v>u[_][1])return!1;for(;_>=d;)if(a=d+_>>1,v>u[a][1])d=a+1;else{if(!(v<u[a][0]))return!0;_=a-1}return!1}(f,o)?0:f>=131072&&f<=196605||f>=196608&&f<=262141?2:1}charProperties(f,v){let u=this.wcwidth(f),a=u===0&&v!==0;if(a){let d=h.UnicodeService.extractWidth(v);d===0?a=!1:d>u&&(u=d)}return h.UnicodeService.createPropertyValue(0,u,a)}}},5981:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;let h=n(8460),g=n(844);class o extends g.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let u;for(this._isSyncWriting=!0;u=this._writeBuffer.shift();){this._action(u);let a=this._callbacks.shift();a&&a()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(v)}_innerWrite(f=0,v=!0){let u=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){let a=this._writeBuffer[this._bufferOffset],d=this._action(a,v);if(d){let p=m=>Date.now()-u>=12?setTimeout(()=>this._innerWrite(0,m)):this._innerWrite(u,m);return void d.catch(m=>(queueMicrotask(()=>{throw m}),Promise.resolve(!1))).then(p)}let _=this._callbacks[this._bufferOffset];if(_&&_(),this._bufferOffset++,this._pendingData-=a.length,Date.now()-u>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=o},5941:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;let n=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function g(o,c){let f=o.toString(16),v=f.length<2?"0"+f:f;switch(c){case 4:return f[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}t.parseColor=function(o){if(!o)return;let c=o.toLowerCase();if(c.indexOf("rgb:")===0){c=c.slice(4);let f=n.exec(c);if(f){let v=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/v*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/v*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/v*255)]}}else if(c.indexOf("#")===0&&(c=c.slice(1),h.exec(c)&&[3,6,9,12].includes(c.length))){let f=c.length/3,v=[0,0,0];for(let u=0;u<3;++u){let a=parseInt(c.slice(f*u,f*u+f),16);v[u]=f===1?a<<4:f===2?a:f===3?a>>4:a>>8}return v}},t.toRgbString=function(o,c=16){let[f,v,u]=o;return`rgb:${g(f,c)}/${g(v,c)}/${g(u,c)}`}},5770:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;let h=n(482),g=n(8742),o=n(5770),c=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=c,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=c}registerHandler(v,u){this._handlers[v]===void 0&&(this._handlers[v]=[]);let a=this._handlers[v];return a.push(u),{dispose:()=>{let d=a.indexOf(u);d!==-1&&a.splice(d,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=c,this._ident=0}hook(v,u){if(this.reset(),this._ident=v,this._active=this._handlers[v]||c,this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].hook(u);else this._handlerFb(this._ident,"HOOK",u)}put(v,u,a){if(this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].put(v,u,a);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(v,u,a))}unhook(v,u=!0){if(this._active.length){let a=!1,d=this._active.length-1,_=!1;if(this._stack.paused&&(d=this._stack.loopPosition-1,a=u,_=this._stack.fallThrough,this._stack.paused=!1),!_&&a===!1){for(;d>=0&&(a=this._active[d].unhook(v),a!==!0);d--)if(a instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!1,a;d--}for(;d>=0;d--)if(a=this._active[d].unhook(!1),a instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!0,a}else this._handlerFb(this._ident,"UNHOOK",v);this._active=c,this._ident=0}};let f=new g.Params;f.addParam(0),t.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=f,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():f,this._data="",this._hitLimit=!1}put(v,u,a){this._hitLimit||(this._data+=(0,h.utf32ToString)(v,u,a),this._data.length>o.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let u=!1;if(this._hitLimit)u=!1;else if(v&&(u=this._handler(this._data,this._params),u instanceof Promise))return u.then(a=>(this._params=f,this._data="",this._hitLimit=!1,a));return this._params=f,this._data="",this._hitLimit=!1,u}}},2015:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;let h=n(844),g=n(8742),o=n(6242),c=n(6351);class f{constructor(d){this.table=new Uint8Array(d)}setDefault(d,_){this.table.fill(d<<4|_)}add(d,_,p,m){this.table[_<<8|d]=p<<4|m}addMany(d,_,p,m){for(let w=0;w<d.length;w++)this.table[_<<8|d[w]]=p<<4|m}}t.TransitionTable=f;let v=160;t.VT500_TRANSITION_TABLE=function(){let a=new f(4095),d=Array.apply(null,Array(256)).map((S,A)=>A),_=(S,A)=>d.slice(S,A),p=_(32,127),m=_(0,24);m.push(25),m.push.apply(m,_(28,32));let w=_(0,14),b;for(b in a.setDefault(1,0),a.addMany(p,0,2,0),w)a.addMany([24,26,153,154],b,3,0),a.addMany(_(128,144),b,3,0),a.addMany(_(144,152),b,3,0),a.add(156,b,0,0),a.add(27,b,11,1),a.add(157,b,4,8),a.addMany([152,158,159],b,0,7),a.add(155,b,11,3),a.add(144,b,11,9);return a.addMany(m,0,3,0),a.addMany(m,1,3,1),a.add(127,1,0,1),a.addMany(m,8,0,8),a.addMany(m,3,3,3),a.add(127,3,0,3),a.addMany(m,4,3,4),a.add(127,4,0,4),a.addMany(m,6,3,6),a.addMany(m,5,3,5),a.add(127,5,0,5),a.addMany(m,2,3,2),a.add(127,2,0,2),a.add(93,1,4,8),a.addMany(p,8,5,8),a.add(127,8,5,8),a.addMany([156,27,24,26,7],8,6,0),a.addMany(_(28,32),8,0,8),a.addMany([88,94,95],1,0,7),a.addMany(p,7,0,7),a.addMany(m,7,0,7),a.add(156,7,0,0),a.add(127,7,0,7),a.add(91,1,11,3),a.addMany(_(64,127),3,7,0),a.addMany(_(48,60),3,8,4),a.addMany([60,61,62,63],3,9,4),a.addMany(_(48,60),4,8,4),a.addMany(_(64,127),4,7,0),a.addMany([60,61,62,63],4,0,6),a.addMany(_(32,64),6,0,6),a.add(127,6,0,6),a.addMany(_(64,127),6,0,0),a.addMany(_(32,48),3,9,5),a.addMany(_(32,48),5,9,5),a.addMany(_(48,64),5,0,6),a.addMany(_(64,127),5,7,0),a.addMany(_(32,48),4,9,5),a.addMany(_(32,48),1,9,2),a.addMany(_(32,48),2,9,2),a.addMany(_(48,127),2,10,0),a.addMany(_(48,80),1,10,0),a.addMany(_(81,88),1,10,0),a.addMany([89,90,92],1,10,0),a.addMany(_(96,127),1,10,0),a.add(80,1,11,9),a.addMany(m,9,0,9),a.add(127,9,0,9),a.addMany(_(28,32),9,0,9),a.addMany(_(32,48),9,9,12),a.addMany(_(48,60),9,8,10),a.addMany([60,61,62,63],9,9,10),a.addMany(m,11,0,11),a.addMany(_(32,128),11,0,11),a.addMany(_(28,32),11,0,11),a.addMany(m,10,0,10),a.add(127,10,0,10),a.addMany(_(28,32),10,0,10),a.addMany(_(48,60),10,8,10),a.addMany([60,61,62,63],10,0,11),a.addMany(_(32,48),10,9,12),a.addMany(m,12,0,12),a.add(127,12,0,12),a.addMany(_(28,32),12,0,12),a.addMany(_(32,48),12,9,12),a.addMany(_(48,64),12,0,11),a.addMany(_(64,127),12,12,13),a.addMany(_(64,127),10,12,13),a.addMany(_(64,127),9,12,13),a.addMany(m,13,13,13),a.addMany(p,13,13,13),a.add(127,13,0,13),a.addMany([27,156,24,26],13,14,0),a.add(v,0,2,0),a.add(v,8,5,8),a.add(v,6,0,6),a.add(v,11,0,11),a.add(v,13,13,13),a}();class u extends h.Disposable{constructor(d=t.VT500_TRANSITION_TABLE){super(),this._transitions=d,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new g.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(_,p,m)=>{},this._executeHandlerFb=_=>{},this._csiHandlerFb=(_,p)=>{},this._escHandlerFb=_=>{},this._errorHandlerFb=_=>_,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new o.OscParser),this._dcsParser=this.register(new c.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(d,_=[64,126]){let p=0;if(d.prefix){if(d.prefix.length>1)throw new Error("only one byte as prefix supported");if(p=d.prefix.charCodeAt(0),p&&60>p||p>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(d.intermediates){if(d.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let w=0;w<d.intermediates.length;++w){let b=d.intermediates.charCodeAt(w);if(32>b||b>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");p<<=8,p|=b}}if(d.final.length!==1)throw new Error("final must be a single byte");let m=d.final.charCodeAt(0);if(_[0]>m||m>_[1])throw new Error(`final must be in range ${_[0]} .. ${_[1]}`);return p<<=8,p|=m,p}identToString(d){let _=[];for(;d;)_.push(String.fromCharCode(255&d)),d>>=8;return _.reverse().join("")}setPrintHandler(d){this._printHandler=d}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(d,_){let p=this._identifier(d,[48,126]);this._escHandlers[p]===void 0&&(this._escHandlers[p]=[]);let m=this._escHandlers[p];return m.push(_),{dispose:()=>{let w=m.indexOf(_);w!==-1&&m.splice(w,1)}}}clearEscHandler(d){this._escHandlers[this._identifier(d,[48,126])]&&delete this._escHandlers[this._identifier(d,[48,126])]}setEscHandlerFallback(d){this._escHandlerFb=d}setExecuteHandler(d,_){this._executeHandlers[d.charCodeAt(0)]=_}clearExecuteHandler(d){this._executeHandlers[d.charCodeAt(0)]&&delete this._executeHandlers[d.charCodeAt(0)]}setExecuteHandlerFallback(d){this._executeHandlerFb=d}registerCsiHandler(d,_){let p=this._identifier(d);this._csiHandlers[p]===void 0&&(this._csiHandlers[p]=[]);let m=this._csiHandlers[p];return m.push(_),{dispose:()=>{let w=m.indexOf(_);w!==-1&&m.splice(w,1)}}}clearCsiHandler(d){this._csiHandlers[this._identifier(d)]&&delete this._csiHandlers[this._identifier(d)]}setCsiHandlerFallback(d){this._csiHandlerFb=d}registerDcsHandler(d,_){return this._dcsParser.registerHandler(this._identifier(d),_)}clearDcsHandler(d){this._dcsParser.clearHandler(this._identifier(d))}setDcsHandlerFallback(d){this._dcsParser.setHandlerFallback(d)}registerOscHandler(d,_){return this._oscParser.registerHandler(d,_)}clearOscHandler(d){this._oscParser.clearHandler(d)}setOscHandlerFallback(d){this._oscParser.setHandlerFallback(d)}setErrorHandler(d){this._errorHandler=d}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(d,_,p,m,w){this._parseStack.state=d,this._parseStack.handlers=_,this._parseStack.handlerPos=p,this._parseStack.transition=m,this._parseStack.chunkPos=w}parse(d,_,p){let m,w=0,b=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(p===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let A=this._parseStack.handlers,x=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(p===!1&&x>-1){for(;x>=0&&(m=A[x](this._params),m!==!0);x--)if(m instanceof Promise)return this._parseStack.handlerPos=x,m}this._parseStack.handlers=[];break;case 4:if(p===!1&&x>-1){for(;x>=0&&(m=A[x](),m!==!0);x--)if(m instanceof Promise)return this._parseStack.handlerPos=x,m}this._parseStack.handlers=[];break;case 6:if(w=d[this._parseStack.chunkPos],m=this._dcsParser.unhook(w!==24&&w!==26,p),m)return m;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(w=d[this._parseStack.chunkPos],m=this._oscParser.end(w!==24&&w!==26,p),m)return m;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let A=S;A<_;++A){switch(w=d[A],b=this._transitions.table[this.currentState<<8|(w<160?w:v)],b>>4){case 2:for(let T=A+1;;++T){if(T>=_||(w=d[T])<32||w>126&&w<v){this._printHandler(d,A,T),A=T-1;break}if(++T>=_||(w=d[T])<32||w>126&&w<v){this._printHandler(d,A,T),A=T-1;break}if(++T>=_||(w=d[T])<32||w>126&&w<v){this._printHandler(d,A,T),A=T-1;break}if(++T>=_||(w=d[T])<32||w>126&&w<v){this._printHandler(d,A,T),A=T-1;break}}break;case 3:this._executeHandlers[w]?this._executeHandlers[w]():this._executeHandlerFb(w),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:A,code:w,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let x=this._csiHandlers[this._collect<<8|w],E=x?x.length-1:-1;for(;E>=0&&(m=x[E](this._params),m!==!0);E--)if(m instanceof Promise)return this._preserveStack(3,x,E,b,A),m;E<0&&this._csiHandlerFb(this._collect<<8|w,this._params),this.precedingJoinState=0;break;case 8:do switch(w){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(w-48)}while(++A<_&&(w=d[A])>47&&w<60);A--;break;case 9:this._collect<<=8,this._collect|=w;break;case 10:let D=this._escHandlers[this._collect<<8|w],L=D?D.length-1:-1;for(;L>=0&&(m=D[L](),m!==!0);L--)if(m instanceof Promise)return this._preserveStack(4,D,L,b,A),m;L<0&&this._escHandlerFb(this._collect<<8|w),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|w,this._params);break;case 13:for(let T=A+1;;++T)if(T>=_||(w=d[T])===24||w===26||w===27||w>127&&w<v){this._dcsParser.put(d,A,T),A=T-1;break}break;case 14:if(m=this._dcsParser.unhook(w!==24&&w!==26),m)return this._preserveStack(6,[],0,b,A),m;w===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let T=A+1;;T++)if(T>=_||(w=d[T])<32||w>127&&w<v){this._oscParser.put(d,A,T),A=T-1;break}break;case 6:if(m=this._oscParser.end(w!==24&&w!==26),m)return this._preserveStack(5,[],0,b,A),m;w===27&&(b|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&b}}}t.EscapeSequenceParser=u},6242:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;let h=n(5770),g=n(482),o=[];t.OscParser=class{constructor(){this._state=0,this._active=o,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(c,f){this._handlers[c]===void 0&&(this._handlers[c]=[]);let v=this._handlers[c];return v.push(f),{dispose:()=>{let u=v.indexOf(f);u!==-1&&v.splice(u,1)}}}clearHandler(c){this._handlers[c]&&delete this._handlers[c]}setHandlerFallback(c){this._handlerFb=c}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=o}reset(){if(this._state===2)for(let c=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;c>=0;--c)this._active[c].end(!1);this._stack.paused=!1,this._active=o,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||o,this._active.length)for(let c=this._active.length-1;c>=0;c--)this._active[c].start();else this._handlerFb(this._id,"START")}_put(c,f,v){if(this._active.length)for(let u=this._active.length-1;u>=0;u--)this._active[u].put(c,f,v);else this._handlerFb(this._id,"PUT",(0,g.utf32ToString)(c,f,v))}start(){this.reset(),this._state=1}put(c,f,v){if(this._state!==3){if(this._state===1)for(;f<v;){let u=c[f++];if(u===59){this._state=2,this._start();break}if(u<48||57<u)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+u-48}this._state===2&&v-f>0&&this._put(c,f,v)}}end(c,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,u=this._active.length-1,a=!1;if(this._stack.paused&&(u=this._stack.loopPosition-1,v=f,a=this._stack.fallThrough,this._stack.paused=!1),!a&&v===!1){for(;u>=0&&(v=this._active[u].end(c),v!==!0);u--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!1,v;u--}for(;u>=0;u--)if(v=this._active[u].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=u,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",c);this._active=o,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(c){this._handler=c,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(c,f,v){this._hitLimit||(this._data+=(0,g.utf32ToString)(c,f,v),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(c){let f=!1;if(this._hitLimit)f=!1;else if(c&&(f=this._handler(this._data),f instanceof Promise))return f.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,f}}},8742:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;let n=2147483647;class h{static fromArray(o){let c=new h;if(!o.length)return c;for(let f=Array.isArray(o[0])?1:0;f<o.length;++f){let v=o[f];if(Array.isArray(v))for(let u=0;u<v.length;++u)c.addSubParam(v[u]);else c.addParam(v)}return c}constructor(o=32,c=32){if(this.maxLength=o,this.maxSubParamsLength=c,c>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(o),this.length=0,this._subParams=new Int32Array(c),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(o),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){let o=new h(this.maxLength,this.maxSubParamsLength);return o.params.set(this.params),o.length=this.length,o._subParams.set(this._subParams),o._subParamsLength=this._subParamsLength,o._subParamsIdx.set(this._subParamsIdx),o._rejectDigits=this._rejectDigits,o._rejectSubDigits=this._rejectSubDigits,o._digitIsSub=this._digitIsSub,o}toArray(){let o=[];for(let c=0;c<this.length;++c){o.push(this.params[c]);let f=this._subParamsIdx[c]>>8,v=255&this._subParamsIdx[c];v-f>0&&o.push(Array.prototype.slice.call(this._subParams,f,v))}return o}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(o){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=o>n?n:o}}addSubParam(o){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(o<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=o>n?n:o,this._subParamsIdx[this.length-1]++}}hasSubParams(o){return(255&this._subParamsIdx[o])-(this._subParamsIdx[o]>>8)>0}getSubParams(o){let c=this._subParamsIdx[o]>>8,f=255&this._subParamsIdx[o];return f-c>0?this._subParams.subarray(c,f):null}getSubParamsAll(){let o={};for(let c=0;c<this.length;++c){let f=this._subParamsIdx[c]>>8,v=255&this._subParamsIdx[c];v-f>0&&(o[c]=this._subParams.slice(f,v))}return o}addDigit(o){let c;if(this._rejectDigits||!(c=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let f=this._digitIsSub?this._subParams:this.params,v=f[c-1];f[c-1]=~v?Math.min(10*v+o,n):o}}t.Params=h},5741:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let n=this._addons.length-1;n>=0;n--)this._addons[n].instance.dispose()}loadAddon(n,h){let g={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(g),h.dispose=()=>this._wrappedAddonDispose(g),h.activate(n)}_wrappedAddonDispose(n){if(n.isDisposed)return;let h=-1;for(let g=0;g<this._addons.length;g++)if(this._addons[g]===n){h=g;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");n.isDisposed=!0,n.dispose.apply(n.instance),this._addons.splice(h,1)}}},8771:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;let h=n(3785),g=n(511);t.BufferApiView=class{constructor(o,c){this._buffer=o,this.type=c}init(o){return this._buffer=o,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(o){let c=this._buffer.lines.get(o);if(c)return new h.BufferLineApiView(c)}getNullCell(){return new g.CellData}}},3785:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;let h=n(511);t.BufferLineApiView=class{constructor(g){this._line=g}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(g,o){if(!(g<0||g>=this._line.length))return o?(this._line.loadCell(g,o),o):this._line.loadCell(g,new h.CellData)}translateToString(g,o,c){return this._line.translateToString(g,o,c)}}},8285:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;let h=n(8771),g=n(8460),o=n(844);class c extends o.Disposable{constructor(v){super(),this._core=v,this._onBufferChange=this.register(new g.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}t.BufferNamespaceApi=c},7975:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(n){this._core=n}registerCsiHandler(n,h){return this._core.registerCsiHandler(n,g=>h(g.toArray()))}addCsiHandler(n,h){return this.registerCsiHandler(n,h)}registerDcsHandler(n,h){return this._core.registerDcsHandler(n,(g,o)=>h(g,o.toArray()))}addDcsHandler(n,h){return this.registerDcsHandler(n,h)}registerEscHandler(n,h){return this._core.registerEscHandler(n,h)}addEscHandler(n,h){return this.registerEscHandler(n,h)}registerOscHandler(n,h){return this._core.registerOscHandler(n,h)}addOscHandler(n,h){return this.registerOscHandler(n,h)}}},7090:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(n){this._core=n}register(n){this._core.unicodeService.register(n)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(n){this._core.unicodeService.activeVersion=n}}},744:function(l,t,n){var h=this&&this.__decorate||function(a,d,_,p){var m,w=arguments.length,b=w<3?d:p===null?p=Object.getOwnPropertyDescriptor(d,_):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(a,d,_,p);else for(var S=a.length-1;S>=0;S--)(m=a[S])&&(b=(w<3?m(b):w>3?m(d,_,b):m(d,_))||b);return w>3&&b&&Object.defineProperty(d,_,b),b},g=this&&this.__param||function(a,d){return function(_,p){d(_,p,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;let o=n(8460),c=n(844),f=n(5295),v=n(2585);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let u=t.BufferService=class extends c.Disposable{get buffer(){return this.buffers.active}constructor(a){super(),this.isUserScrolling=!1,this._onResize=this.register(new o.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new o.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(a.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(a.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(a,this))}resize(a,d){this.cols=a,this.rows=d,this.buffers.resize(a,d),this._onResize.fire({cols:a,rows:d})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(a,d=!1){let _=this.buffer,p;p=this._cachedBlankLine,p&&p.length===this.cols&&p.getFg(0)===a.fg&&p.getBg(0)===a.bg||(p=_.getBlankLine(a,d),this._cachedBlankLine=p),p.isWrapped=d;let m=_.ybase+_.scrollTop,w=_.ybase+_.scrollBottom;if(_.scrollTop===0){let b=_.lines.isFull;w===_.lines.length-1?b?_.lines.recycle().copyFrom(p):_.lines.push(p.clone()):_.lines.splice(w+1,0,p.clone()),b?this.isUserScrolling&&(_.ydisp=Math.max(_.ydisp-1,0)):(_.ybase++,this.isUserScrolling||_.ydisp++)}else{let b=w-m+1;_.lines.shiftElements(m+1,b-1,-1),_.lines.set(w,p.clone())}this.isUserScrolling||(_.ydisp=_.ybase),this._onScroll.fire(_.ydisp)}scrollLines(a,d,_){let p=this.buffer;if(a<0){if(p.ydisp===0)return;this.isUserScrolling=!0}else a+p.ydisp>=p.ybase&&(this.isUserScrolling=!1);let m=p.ydisp;p.ydisp=Math.max(Math.min(p.ydisp+a,p.ybase),0),m!==p.ydisp&&(d||this._onScroll.fire(p.ydisp))}};t.BufferService=u=h([g(0,v.IOptionsService)],u)},7994:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(n){this.glevel=n,this.charset=this._charsets[n]}setgCharset(n,h){this._charsets[n]=h,this.glevel===n&&(this.charset=h)}}},1753:function(l,t,n){var h=this&&this.__decorate||function(p,m,w,b){var S,A=arguments.length,x=A<3?m:b===null?b=Object.getOwnPropertyDescriptor(m,w):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(p,m,w,b);else for(var E=p.length-1;E>=0;E--)(S=p[E])&&(x=(A<3?S(x):A>3?S(m,w,x):S(m,w))||x);return A>3&&x&&Object.defineProperty(m,w,x),x},g=this&&this.__param||function(p,m){return function(w,b){m(w,b,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;let o=n(2585),c=n(8460),f=n(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:p=>p.button!==4&&p.action===1&&(p.ctrl=!1,p.alt=!1,p.shift=!1,!0)},VT200:{events:19,restrict:p=>p.action!==32},DRAG:{events:23,restrict:p=>p.action!==32||p.button!==3},ANY:{events:31,restrict:p=>!0}};function u(p,m){let w=(p.ctrl?16:0)|(p.shift?4:0)|(p.alt?8:0);return p.button===4?(w|=64,w|=p.action):(w|=3&p.button,4&p.button&&(w|=64),8&p.button&&(w|=128),p.action===32?w|=32:p.action!==0||m||(w|=3)),w}let a=String.fromCharCode,d={DEFAULT:p=>{let m=[u(p,!1)+32,p.col+32,p.row+32];return m[0]>255||m[1]>255||m[2]>255?"":`\x1B[M${a(m[0])}${a(m[1])}${a(m[2])}`},SGR:p=>{let m=p.action===0&&p.button!==4?"m":"M";return`\x1B[<${u(p,!0)};${p.col};${p.row}${m}`},SGR_PIXELS:p=>{let m=p.action===0&&p.button!==4?"m":"M";return`\x1B[<${u(p,!0)};${p.x};${p.y}${m}`}},_=t.CoreMouseService=class extends f.Disposable{constructor(p,m){super(),this._bufferService=p,this._coreService=m,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new c.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(let w of Object.keys(v))this.addProtocol(w,v[w]);for(let w of Object.keys(d))this.addEncoding(w,d[w]);this.reset()}addProtocol(p,m){this._protocols[p]=m}addEncoding(p,m){this._encodings[p]=m}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(p){if(!this._protocols[p])throw new Error(`unknown protocol "${p}"`);this._activeProtocol=p,this._onProtocolChange.fire(this._protocols[p].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(p){if(!this._encodings[p])throw new Error(`unknown encoding "${p}"`);this._activeEncoding=p}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(p){if(p.col<0||p.col>=this._bufferService.cols||p.row<0||p.row>=this._bufferService.rows||p.button===4&&p.action===32||p.button===3&&p.action!==32||p.button!==4&&(p.action===2||p.action===3)||(p.col++,p.row++,p.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,p,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(p))return!1;let m=this._encodings[this._activeEncoding](p);return m&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(m):this._coreService.triggerDataEvent(m,!0)),this._lastEvent=p,!0}explainEvents(p){return{down:!!(1&p),up:!!(2&p),drag:!!(4&p),move:!!(8&p),wheel:!!(16&p)}}_equalEvents(p,m,w){if(w){if(p.x!==m.x||p.y!==m.y)return!1}else if(p.col!==m.col||p.row!==m.row)return!1;return p.button===m.button&&p.action===m.action&&p.ctrl===m.ctrl&&p.alt===m.alt&&p.shift===m.shift}};t.CoreMouseService=_=h([g(0,o.IBufferService),g(1,o.ICoreService)],_)},6975:function(l,t,n){var h=this&&this.__decorate||function(_,p,m,w){var b,S=arguments.length,A=S<3?p:w===null?w=Object.getOwnPropertyDescriptor(p,m):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(_,p,m,w);else for(var x=_.length-1;x>=0;x--)(b=_[x])&&(A=(S<3?b(A):S>3?b(p,m,A):b(p,m))||A);return S>3&&A&&Object.defineProperty(p,m,A),A},g=this&&this.__param||function(_,p){return function(m,w){p(m,w,_)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;let o=n(1439),c=n(8460),f=n(844),v=n(2585),u=Object.freeze({insertMode:!1}),a=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0}),d=t.CoreService=class extends f.Disposable{constructor(_,p,m){super(),this._bufferService=_,this._logService=p,this._optionsService=m,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new c.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new c.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new c.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new c.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,o.clone)(u),this.decPrivateModes=(0,o.clone)(a)}reset(){this.modes=(0,o.clone)(u),this.decPrivateModes=(0,o.clone)(a)}triggerDataEvent(_,p=!1){if(this._optionsService.rawOptions.disableStdin)return;let m=this._bufferService.buffer;p&&this._optionsService.rawOptions.scrollOnUserInput&&m.ybase!==m.ydisp&&this._onRequestScrollToBottom.fire(),p&&this._onUserInput.fire(),this._logService.debug(`sending data "${_}"`,()=>_.split("").map(w=>w.charCodeAt(0))),this._onData.fire(_)}triggerBinaryEvent(_){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${_}"`,()=>_.split("").map(p=>p.charCodeAt(0))),this._onBinary.fire(_))}};t.CoreService=d=h([g(0,v.IBufferService),g(1,v.ILogService),g(2,v.IOptionsService)],d)},9074:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;let h=n(8055),g=n(8460),o=n(844),c=n(6106),f=0,v=0;class u extends o.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new c.SortedList(_=>_?.marker.line),this._onDecorationRegistered=this.register(new g.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new g.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,o.toDisposable)(()=>this.reset()))}registerDecoration(_){if(_.marker.isDisposed)return;let p=new a(_);if(p){let m=p.marker.onDispose(()=>p.dispose());p.onDispose(()=>{p&&(this._decorations.delete(p)&&this._onDecorationRemoved.fire(p),m.dispose())}),this._decorations.insert(p),this._onDecorationRegistered.fire(p)}return p}reset(){for(let _ of this._decorations.values())_.dispose();this._decorations.clear()}*getDecorationsAtCell(_,p,m){let w=0,b=0;for(let S of this._decorations.getKeyIterator(p))w=S.options.x??0,b=w+(S.options.width??1),_>=w&&_<b&&(!m||(S.options.layer??"bottom")===m)&&(yield S)}forEachDecorationAtCell(_,p,m,w){this._decorations.forEachByKey(p,b=>{f=b.options.x??0,v=f+(b.options.width??1),_>=f&&_<v&&(!m||(b.options.layer??"bottom")===m)&&w(b)})}}t.DecorationService=u;class a extends o.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(_){super(),this.options=_,this.onRenderEmitter=this.register(new g.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new g.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=_.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;let h=n(2585),g=n(8343);class o{constructor(...f){this._entries=new Map;for(let[v,u]of f)this.set(v,u)}set(f,v){let u=this._entries.get(f);return this._entries.set(f,v),u}forEach(f){for(let[v,u]of this._entries.entries())f(v,u)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}t.ServiceCollection=o,t.InstantiationService=class{constructor(){this._services=new o,this._services.set(h.IInstantiationService,this)}setService(c,f){this._services.set(c,f)}getService(c){return this._services.get(c)}createInstance(c,...f){let v=(0,g.getServiceDependencies)(c).sort((d,_)=>d.index-_.index),u=[];for(let d of v){let _=this._services.get(d.id);if(!_)throw new Error(`[createInstance] ${c.name} depends on UNKNOWN service ${d.id}.`);u.push(_)}let a=v.length>0?v[0].index:f.length;if(f.length!==a)throw new Error(`[createInstance] First service dependency of ${c.name} at position ${a+1} conflicts with ${f.length} static arguments`);return new c(...f,...u)}}},7866:function(l,t,n){var h=this&&this.__decorate||function(a,d,_,p){var m,w=arguments.length,b=w<3?d:p===null?p=Object.getOwnPropertyDescriptor(d,_):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(a,d,_,p);else for(var S=a.length-1;S>=0;S--)(m=a[S])&&(b=(w<3?m(b):w>3?m(d,_,b):m(d,_))||b);return w>3&&b&&Object.defineProperty(d,_,b),b},g=this&&this.__param||function(a,d){return function(_,p){d(_,p,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;let o=n(844),c=n(2585),f={trace:c.LogLevelEnum.TRACE,debug:c.LogLevelEnum.DEBUG,info:c.LogLevelEnum.INFO,warn:c.LogLevelEnum.WARN,error:c.LogLevelEnum.ERROR,off:c.LogLevelEnum.OFF},v,u=t.LogService=class extends o.Disposable{get logLevel(){return this._logLevel}constructor(a){super(),this._optionsService=a,this._logLevel=c.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),v=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(a){for(let d=0;d<a.length;d++)typeof a[d]=="function"&&(a[d]=a[d]())}_log(a,d,_){this._evalLazyOptionalParams(_),a.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+d,..._)}trace(a,...d){this._logLevel<=c.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,a,d)}debug(a,...d){this._logLevel<=c.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,a,d)}info(a,...d){this._logLevel<=c.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,a,d)}warn(a,...d){this._logLevel<=c.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,a,d)}error(a,...d){this._logLevel<=c.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,a,d)}};t.LogService=u=h([g(0,c.IOptionsService)],u),t.setTraceLogger=function(a){v=a},t.traceCall=function(a,d,_){if(typeof _.value!="function")throw new Error("not supported");let p=_.value;_.value=function(...m){if(v.logLevel!==c.LogLevelEnum.TRACE)return p.apply(this,m);v.trace(`GlyphRenderer#${p.name}(${m.map(b=>JSON.stringify(b)).join(", ")})`);let w=p.apply(this,m);return v.trace(`GlyphRenderer#${p.name} return`,w),w}}},7302:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;let h=n(8460),g=n(844),o=n(6114);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:o.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};let c=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends g.Disposable{constructor(u){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;let a={...t.DEFAULT_OPTIONS};for(let d in u)if(d in a)try{let _=u[d];a[d]=this._sanitizeAndValidateOption(d,_)}catch(_){console.error(_)}this.rawOptions=a,this.options={...a},this._setupOptions(),this.register((0,g.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(u,a){return this.onOptionChange(d=>{d===u&&a(this.rawOptions[u])})}onMultipleOptionChange(u,a){return this.onOptionChange(d=>{u.indexOf(d)!==-1&&a()})}_setupOptions(){let u=d=>{if(!(d in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${d}"`);return this.rawOptions[d]},a=(d,_)=>{if(!(d in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${d}"`);_=this._sanitizeAndValidateOption(d,_),this.rawOptions[d]!==_&&(this.rawOptions[d]=_,this._onOptionChange.fire(d))};for(let d in this.rawOptions){let _={get:u.bind(this,d),set:a.bind(this,d)};Object.defineProperty(this.options,d,_)}}_sanitizeAndValidateOption(u,a){switch(u){case"cursorStyle":if(a||(a=t.DEFAULT_OPTIONS[u]),!function(d){return d==="block"||d==="underline"||d==="bar"}(a))throw new Error(`"${a}" is not a valid value for ${u}`);break;case"wordSeparator":a||(a=t.DEFAULT_OPTIONS[u]);break;case"fontWeight":case"fontWeightBold":if(typeof a=="number"&&1<=a&&a<=1e3)break;a=c.includes(a)?a:t.DEFAULT_OPTIONS[u];break;case"cursorWidth":a=Math.floor(a);case"lineHeight":case"tabStopWidth":if(a<1)throw new Error(`${u} cannot be less than 1, value: ${a}`);break;case"minimumContrastRatio":a=Math.max(1,Math.min(21,Math.round(10*a)/10));break;case"scrollback":if((a=Math.min(a,4294967295))<0)throw new Error(`${u} cannot be less than 0, value: ${a}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(a<=0)throw new Error(`${u} cannot be less than or equal to 0, value: ${a}`);break;case"rows":case"cols":if(!a&&a!==0)throw new Error(`${u} must be numeric, value: ${a}`);break;case"windowsPty":a=a??{}}return a}}t.OptionsService=f},2660:function(l,t,n){var h=this&&this.__decorate||function(f,v,u,a){var d,_=arguments.length,p=_<3?v:a===null?a=Object.getOwnPropertyDescriptor(v,u):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(f,v,u,a);else for(var m=f.length-1;m>=0;m--)(d=f[m])&&(p=(_<3?d(p):_>3?d(v,u,p):d(v,u))||p);return _>3&&p&&Object.defineProperty(v,u,p),p},g=this&&this.__param||function(f,v){return function(u,a){v(u,a,f)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;let o=n(2585),c=t.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){let v=this._bufferService.buffer;if(f.id===void 0){let m=v.addMarker(v.ybase+v.y),w={data:f,id:this._nextId++,lines:[m]};return m.onDispose(()=>this._removeMarkerFromLink(w,m)),this._dataByLinkId.set(w.id,w),w.id}let u=f,a=this._getEntryIdKey(u),d=this._entriesWithId.get(a);if(d)return this.addLineToLink(d.id,v.ybase+v.y),d.id;let _=v.addMarker(v.ybase+v.y),p={id:this._nextId++,key:this._getEntryIdKey(u),data:u,lines:[_]};return _.onDispose(()=>this._removeMarkerFromLink(p,_)),this._entriesWithId.set(p.key,p),this._dataByLinkId.set(p.id,p),p.id}addLineToLink(f,v){let u=this._dataByLinkId.get(f);if(u&&u.lines.every(a=>a.line!==v)){let a=this._bufferService.buffer.addMarker(v);u.lines.push(a),a.onDispose(()=>this._removeMarkerFromLink(u,a))}}getLinkData(f){return this._dataByLinkId.get(f)?.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,v){let u=f.lines.indexOf(v);u!==-1&&(f.lines.splice(u,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};t.OscLinkService=c=h([g(0,o.IBufferService)],c)},8343:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;let n="di$target",h="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(g){return g[h]||[]},t.createDecorator=function(g){if(t.serviceRegistry.has(g))return t.serviceRegistry.get(g);let o=function(c,f,v){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(u,a,d){a[n]===a?a[h].push({id:u,index:d}):(a[h]=[{id:u,index:d}],a[n]=a)})(o,c,v)};return o.toString=()=>g,t.serviceRegistry.set(g,o),o}},2585:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;let h=n(8343);var g;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(o){o[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF"}(g||(t.LogLevelEnum=g={})),t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;let h=n(8460),g=n(225);class o{static extractShouldJoin(f){return(1&f)!=0}static extractWidth(f){return f>>1&3}static extractCharKind(f){return f>>3}static createPropertyValue(f,v,u=!1){return(16777215&f)<<3|(3&v)<<1|(u?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;let f=new g.UnicodeV6;this.register(f),this._active=f.version,this._activeProvider=f}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(f){if(!this._providers[f])throw new Error(`unknown Unicode version "${f}"`);this._active=f,this._activeProvider=this._providers[f],this._onChange.fire(f)}register(f){this._providers[f.version]=f}wcwidth(f){return this._activeProvider.wcwidth(f)}getStringCellWidth(f){let v=0,u=0,a=f.length;for(let d=0;d<a;++d){let _=f.charCodeAt(d);if(55296<=_&&_<=56319){if(++d>=a)return v+this.wcwidth(_);let w=f.charCodeAt(d);56320<=w&&w<=57343?_=1024*(_-55296)+w-56320+65536:v+=this.wcwidth(w)}let p=this.charProperties(_,u),m=o.extractWidth(p);o.extractShouldJoin(p)&&(m-=o.extractWidth(u)),v+=m,u=p}return v}charProperties(f,v){return this._activeProvider.charProperties(f,v)}}t.UnicodeService=o}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l].call(n.exports,n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.Terminal=void 0;let t=r(9042),n=r(3236),h=r(844),g=r(5741),o=r(8285),c=r(7975),f=r(7090),v=["cols","rows"];class u extends h.Disposable{constructor(d){super(),this._core=this.register(new n.Terminal(d)),this._addonManager=this.register(new g.AddonManager),this._publicOptions={...this._core.options};let _=m=>this._core.options[m],p=(m,w)=>{this._checkReadonlyOptions(m),this._core.options[m]=w};for(let m in this._core.options){let w={get:_.bind(this,m),set:p.bind(this,m)};Object.defineProperty(this._publicOptions,m,w)}}_checkReadonlyOptions(d){if(v.includes(d))throw new Error(`Option "${d}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new c.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new o.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let d=this._core.coreService.decPrivateModes,_="none";switch(this._core.coreMouseService.activeProtocol){case"X10":_="x10";break;case"VT200":_="vt200";break;case"DRAG":_="drag";break;case"ANY":_="any"}return{applicationCursorKeysMode:d.applicationCursorKeys,applicationKeypadMode:d.applicationKeypad,bracketedPasteMode:d.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:_,originMode:d.origin,reverseWraparoundMode:d.reverseWraparound,sendFocusMode:d.sendFocus,wraparoundMode:d.wraparound}}get options(){return this._publicOptions}set options(d){for(let _ in d)this._publicOptions[_]=d[_]}blur(){this._core.blur()}focus(){this._core.focus()}input(d,_=!0){this._core.input(d,_)}resize(d,_){this._verifyIntegers(d,_),this._core.resize(d,_)}open(d){this._core.open(d)}attachCustomKeyEventHandler(d){this._core.attachCustomKeyEventHandler(d)}attachCustomWheelEventHandler(d){this._core.attachCustomWheelEventHandler(d)}registerLinkProvider(d){return this._core.registerLinkProvider(d)}registerCharacterJoiner(d){return this._checkProposedApi(),this._core.registerCharacterJoiner(d)}deregisterCharacterJoiner(d){this._checkProposedApi(),this._core.deregisterCharacterJoiner(d)}registerMarker(d=0){return this._verifyIntegers(d),this._core.registerMarker(d)}registerDecoration(d){return this._checkProposedApi(),this._verifyPositiveIntegers(d.x??0,d.width??0,d.height??0),this._core.registerDecoration(d)}hasSelection(){return this._core.hasSelection()}select(d,_,p){this._verifyIntegers(d,_,p),this._core.select(d,_,p)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(d,_){this._verifyIntegers(d,_),this._core.selectLines(d,_)}dispose(){super.dispose()}scrollLines(d){this._verifyIntegers(d),this._core.scrollLines(d)}scrollPages(d){this._verifyIntegers(d),this._core.scrollPages(d)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(d){this._verifyIntegers(d),this._core.scrollToLine(d)}clear(){this._core.clear()}write(d,_){this._core.write(d,_)}writeln(d,_){this._core.write(d),this._core.write(`\r
`,_)}paste(d){this._core.paste(d)}refresh(d,_){this._verifyIntegers(d,_),this._core.refresh(d,_)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(d){this._addonManager.loadAddon(this,d)}static get strings(){return t}_verifyIntegers(...d){for(let _ of d)if(_===1/0||isNaN(_)||_%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...d){for(let _ of d)if(_&&(_===1/0||isNaN(_)||_%1!=0||_<0))throw new Error("This API only accepts positive integers")}}l.Terminal=u})(),s})())});var Gu=se((zs,Go)=>{(function(e,i){typeof zs=="object"&&typeof Go=="object"?Go.exports=i():typeof define=="function"&&define.amd?define([],i):typeof zs=="object"?zs.FitAddon=i():e.FitAddon=i()})(self,()=>(()=>{"use strict";var e={};return(()=>{var i=e;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{activate(r){this._terminal=r}dispose(){}fit(){let r=this.proposeDimensions();if(!r||!this._terminal||isNaN(r.cols)||isNaN(r.rows))return;let s=this._terminal._core;this._terminal.rows===r.rows&&this._terminal.cols===r.cols||(s._renderService.clear(),this._terminal.resize(r.cols,r.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let r=this._terminal._core,s=r._renderService.dimensions;if(s.css.cell.width===0||s.css.cell.height===0)return;let l=this._terminal.options.scrollback===0?0:r.viewport.scrollBarWidth,t=window.getComputedStyle(this._terminal.element.parentElement),n=parseInt(t.getPropertyValue("height")),h=Math.max(0,parseInt(t.getPropertyValue("width"))),g=window.getComputedStyle(this._terminal.element),o=n-(parseInt(g.getPropertyValue("padding-top"))+parseInt(g.getPropertyValue("padding-bottom"))),c=h-(parseInt(g.getPropertyValue("padding-right"))+parseInt(g.getPropertyValue("padding-left")))-l;return{cols:Math.max(2,Math.floor(c/s.css.cell.width)),rows:Math.max(1,Math.floor(o/s.css.cell.height))}}}})(),e})())});var qu=se((js,qo)=>{(function(e,i){typeof js=="object"&&typeof qo=="object"?qo.exports=i():typeof define=="function"&&define.amd?define([],i):typeof js=="object"?js.WebglAddon=i():e.WebglAddon=i()})(self,()=>(()=>{"use strict";var e={965:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlyphRenderer=void 0;let h=n(374),g=n(509),o=n(855),c=n(859),f=n(381),v=11,u=v*Float32Array.BYTES_PER_ELEMENT,a,d=0,_=0,p=0;class m extends c.Disposable{constructor(b,S,A,x){super(),this._terminal=b,this._gl=S,this._dimensions=A,this._optionsService=x,this._activeBuffer=0,this._vertices={count:0,attributes:new Float32Array(0),attributesBuffers:[new Float32Array(0),new Float32Array(0)]};let E=this._gl;g.TextureAtlas.maxAtlasPages===void 0&&(g.TextureAtlas.maxAtlasPages=Math.min(32,(0,h.throwIfFalsy)(E.getParameter(E.MAX_TEXTURE_IMAGE_UNITS))),g.TextureAtlas.maxTextureSize=(0,h.throwIfFalsy)(E.getParameter(E.MAX_TEXTURE_SIZE))),this._program=(0,h.throwIfFalsy)((0,f.createProgram)(E,`#version 300 es
layout (location = 0) in vec2 a_unitquad;
layout (location = 1) in vec2 a_cellpos;
layout (location = 2) in vec2 a_offset;
layout (location = 3) in vec2 a_size;
layout (location = 4) in float a_texpage;
layout (location = 5) in vec2 a_texcoord;
layout (location = 6) in vec2 a_texsize;

uniform mat4 u_projection;
uniform vec2 u_resolution;

out vec2 v_texcoord;
flat out int v_texpage;

void main() {
  vec2 zeroToOne = (a_offset / u_resolution) + a_cellpos + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_texpage = int(a_texpage);
  v_texcoord = a_texcoord + a_unitquad * a_texsize;
}`,function(N){let X="";for(let k=1;k<N;k++)X+=` else if (v_texpage == ${k}) { outColor = texture(u_texture[${k}], v_texcoord); }`;return`#version 300 es
precision lowp float;

in vec2 v_texcoord;
flat in int v_texpage;

uniform sampler2D u_texture[${N}];

out vec4 outColor;

void main() {
  if (v_texpage == 0) {
    outColor = texture(u_texture[0], v_texcoord);
  } ${X}
}`}(g.TextureAtlas.maxAtlasPages))),this.register((0,c.toDisposable)(()=>E.deleteProgram(this._program))),this._projectionLocation=(0,h.throwIfFalsy)(E.getUniformLocation(this._program,"u_projection")),this._resolutionLocation=(0,h.throwIfFalsy)(E.getUniformLocation(this._program,"u_resolution")),this._textureLocation=(0,h.throwIfFalsy)(E.getUniformLocation(this._program,"u_texture")),this._vertexArrayObject=E.createVertexArray(),E.bindVertexArray(this._vertexArrayObject);let D=new Float32Array([0,0,1,0,0,1,1,1]),L=E.createBuffer();this.register((0,c.toDisposable)(()=>E.deleteBuffer(L))),E.bindBuffer(E.ARRAY_BUFFER,L),E.bufferData(E.ARRAY_BUFFER,D,E.STATIC_DRAW),E.enableVertexAttribArray(0),E.vertexAttribPointer(0,2,this._gl.FLOAT,!1,0,0);let T=new Uint8Array([0,1,2,3]),F=E.createBuffer();this.register((0,c.toDisposable)(()=>E.deleteBuffer(F))),E.bindBuffer(E.ELEMENT_ARRAY_BUFFER,F),E.bufferData(E.ELEMENT_ARRAY_BUFFER,T,E.STATIC_DRAW),this._attributesBuffer=(0,h.throwIfFalsy)(E.createBuffer()),this.register((0,c.toDisposable)(()=>E.deleteBuffer(this._attributesBuffer))),E.bindBuffer(E.ARRAY_BUFFER,this._attributesBuffer),E.enableVertexAttribArray(2),E.vertexAttribPointer(2,2,E.FLOAT,!1,u,0),E.vertexAttribDivisor(2,1),E.enableVertexAttribArray(3),E.vertexAttribPointer(3,2,E.FLOAT,!1,u,2*Float32Array.BYTES_PER_ELEMENT),E.vertexAttribDivisor(3,1),E.enableVertexAttribArray(4),E.vertexAttribPointer(4,1,E.FLOAT,!1,u,4*Float32Array.BYTES_PER_ELEMENT),E.vertexAttribDivisor(4,1),E.enableVertexAttribArray(5),E.vertexAttribPointer(5,2,E.FLOAT,!1,u,5*Float32Array.BYTES_PER_ELEMENT),E.vertexAttribDivisor(5,1),E.enableVertexAttribArray(6),E.vertexAttribPointer(6,2,E.FLOAT,!1,u,7*Float32Array.BYTES_PER_ELEMENT),E.vertexAttribDivisor(6,1),E.enableVertexAttribArray(1),E.vertexAttribPointer(1,2,E.FLOAT,!1,u,9*Float32Array.BYTES_PER_ELEMENT),E.vertexAttribDivisor(1,1),E.useProgram(this._program);let K=new Int32Array(g.TextureAtlas.maxAtlasPages);for(let N=0;N<g.TextureAtlas.maxAtlasPages;N++)K[N]=N;E.uniform1iv(this._textureLocation,K),E.uniformMatrix4fv(this._projectionLocation,!1,f.PROJECTION_MATRIX),this._atlasTextures=[];for(let N=0;N<g.TextureAtlas.maxAtlasPages;N++){let X=new f.GLTexture((0,h.throwIfFalsy)(E.createTexture()));this.register((0,c.toDisposable)(()=>E.deleteTexture(X.texture))),E.activeTexture(E.TEXTURE0+N),E.bindTexture(E.TEXTURE_2D,X.texture),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE),E.texImage2D(E.TEXTURE_2D,0,E.RGBA,1,1,0,E.RGBA,E.UNSIGNED_BYTE,new Uint8Array([255,0,0,255])),this._atlasTextures[N]=X}E.enable(E.BLEND),E.blendFunc(E.SRC_ALPHA,E.ONE_MINUS_SRC_ALPHA),this.handleResize()}beginFrame(){return!this._atlas||this._atlas.beginFrame()}updateCell(b,S,A,x,E,D,L,T,F){this._updateCell(this._vertices.attributes,b,S,A,x,E,D,L,T,F)}_updateCell(b,S,A,x,E,D,L,T,F,K){d=(A*this._terminal.cols+S)*v,x!==o.NULL_CELL_CODE&&x!==void 0?this._atlas&&(a=T&&T.length>1?this._atlas.getRasterizedGlyphCombinedChar(T,E,D,L,!1):this._atlas.getRasterizedGlyph(x,E,D,L,!1),_=Math.floor((this._dimensions.device.cell.width-this._dimensions.device.char.width)/2),E!==K&&a.offset.x>_?(p=a.offset.x-_,b[d]=-(a.offset.x-p)+this._dimensions.device.char.left,b[d+1]=-a.offset.y+this._dimensions.device.char.top,b[d+2]=(a.size.x-p)/this._dimensions.device.canvas.width,b[d+3]=a.size.y/this._dimensions.device.canvas.height,b[d+4]=a.texturePage,b[d+5]=a.texturePositionClipSpace.x+p/this._atlas.pages[a.texturePage].canvas.width,b[d+6]=a.texturePositionClipSpace.y,b[d+7]=a.sizeClipSpace.x-p/this._atlas.pages[a.texturePage].canvas.width,b[d+8]=a.sizeClipSpace.y):(b[d]=-a.offset.x+this._dimensions.device.char.left,b[d+1]=-a.offset.y+this._dimensions.device.char.top,b[d+2]=a.size.x/this._dimensions.device.canvas.width,b[d+3]=a.size.y/this._dimensions.device.canvas.height,b[d+4]=a.texturePage,b[d+5]=a.texturePositionClipSpace.x,b[d+6]=a.texturePositionClipSpace.y,b[d+7]=a.sizeClipSpace.x,b[d+8]=a.sizeClipSpace.y),this._optionsService.rawOptions.rescaleOverlappingGlyphs&&(0,h.allowRescaling)(x,F,a.size.x,this._dimensions.device.cell.width)&&(b[d+2]=(this._dimensions.device.cell.width-1)/this._dimensions.device.canvas.width)):b.fill(0,d,d+v-1-2)}clear(){let b=this._terminal,S=b.cols*b.rows*v;this._vertices.count!==S?this._vertices.attributes=new Float32Array(S):this._vertices.attributes.fill(0);let A=0;for(;A<this._vertices.attributesBuffers.length;A++)this._vertices.count!==S?this._vertices.attributesBuffers[A]=new Float32Array(S):this._vertices.attributesBuffers[A].fill(0);this._vertices.count=S,A=0;for(let x=0;x<b.rows;x++)for(let E=0;E<b.cols;E++)this._vertices.attributes[A+9]=E/b.cols,this._vertices.attributes[A+10]=x/b.rows,A+=v}handleResize(){let b=this._gl;b.useProgram(this._program),b.viewport(0,0,b.canvas.width,b.canvas.height),b.uniform2f(this._resolutionLocation,b.canvas.width,b.canvas.height),this.clear()}render(b){if(!this._atlas)return;let S=this._gl;S.useProgram(this._program),S.bindVertexArray(this._vertexArrayObject),this._activeBuffer=(this._activeBuffer+1)%2;let A=this._vertices.attributesBuffers[this._activeBuffer],x=0;for(let E=0;E<b.lineLengths.length;E++){let D=E*this._terminal.cols*v,L=this._vertices.attributes.subarray(D,D+b.lineLengths[E]*v);A.set(L,x),x+=L.length}S.bindBuffer(S.ARRAY_BUFFER,this._attributesBuffer),S.bufferData(S.ARRAY_BUFFER,A.subarray(0,x),S.STREAM_DRAW);for(let E=0;E<this._atlas.pages.length;E++)this._atlas.pages[E].version!==this._atlasTextures[E].version&&this._bindAtlasPageTexture(S,this._atlas,E);S.drawElementsInstanced(S.TRIANGLE_STRIP,4,S.UNSIGNED_BYTE,0,x/v)}setAtlas(b){this._atlas=b;for(let S of this._atlasTextures)S.version=-1}_bindAtlasPageTexture(b,S,A){b.activeTexture(b.TEXTURE0+A),b.bindTexture(b.TEXTURE_2D,this._atlasTextures[A].texture),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,S.pages[A].canvas),b.generateMipmap(b.TEXTURE_2D),this._atlasTextures[A].version=S.pages[A].version}setDimensions(b){this._dimensions=b}}t.GlyphRenderer=m},742:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleRenderer=void 0;let h=n(374),g=n(859),o=n(310),c=n(381),f=8*Float32Array.BYTES_PER_ELEMENT;class v{constructor(){this.attributes=new Float32Array(160),this.count=0}}let u=0,a=0,d=0,_=0,p=0,m=0,w=0;class b extends g.Disposable{constructor(A,x,E,D){super(),this._terminal=A,this._gl=x,this._dimensions=E,this._themeService=D,this._vertices=new v,this._verticesCursor=new v;let L=this._gl;this._program=(0,h.throwIfFalsy)((0,c.createProgram)(L,`#version 300 es
layout (location = 0) in vec2 a_position;
layout (location = 1) in vec2 a_size;
layout (location = 2) in vec4 a_color;
layout (location = 3) in vec2 a_unitquad;

uniform mat4 u_projection;

out vec4 v_color;

void main() {
  vec2 zeroToOne = a_position + (a_unitquad * a_size);
  gl_Position = u_projection * vec4(zeroToOne, 0.0, 1.0);
  v_color = a_color;
}`,`#version 300 es
precision lowp float;

in vec4 v_color;

out vec4 outColor;

void main() {
  outColor = v_color;
}`)),this.register((0,g.toDisposable)(()=>L.deleteProgram(this._program))),this._projectionLocation=(0,h.throwIfFalsy)(L.getUniformLocation(this._program,"u_projection")),this._vertexArrayObject=L.createVertexArray(),L.bindVertexArray(this._vertexArrayObject);let T=new Float32Array([0,0,1,0,0,1,1,1]),F=L.createBuffer();this.register((0,g.toDisposable)(()=>L.deleteBuffer(F))),L.bindBuffer(L.ARRAY_BUFFER,F),L.bufferData(L.ARRAY_BUFFER,T,L.STATIC_DRAW),L.enableVertexAttribArray(3),L.vertexAttribPointer(3,2,this._gl.FLOAT,!1,0,0);let K=new Uint8Array([0,1,2,3]),N=L.createBuffer();this.register((0,g.toDisposable)(()=>L.deleteBuffer(N))),L.bindBuffer(L.ELEMENT_ARRAY_BUFFER,N),L.bufferData(L.ELEMENT_ARRAY_BUFFER,K,L.STATIC_DRAW),this._attributesBuffer=(0,h.throwIfFalsy)(L.createBuffer()),this.register((0,g.toDisposable)(()=>L.deleteBuffer(this._attributesBuffer))),L.bindBuffer(L.ARRAY_BUFFER,this._attributesBuffer),L.enableVertexAttribArray(0),L.vertexAttribPointer(0,2,L.FLOAT,!1,f,0),L.vertexAttribDivisor(0,1),L.enableVertexAttribArray(1),L.vertexAttribPointer(1,2,L.FLOAT,!1,f,2*Float32Array.BYTES_PER_ELEMENT),L.vertexAttribDivisor(1,1),L.enableVertexAttribArray(2),L.vertexAttribPointer(2,4,L.FLOAT,!1,f,4*Float32Array.BYTES_PER_ELEMENT),L.vertexAttribDivisor(2,1),this._updateCachedColors(D.colors),this.register(this._themeService.onChangeColors(X=>{this._updateCachedColors(X),this._updateViewportRectangle()}))}renderBackgrounds(){this._renderVertices(this._vertices)}renderCursor(){this._renderVertices(this._verticesCursor)}_renderVertices(A){let x=this._gl;x.useProgram(this._program),x.bindVertexArray(this._vertexArrayObject),x.uniformMatrix4fv(this._projectionLocation,!1,c.PROJECTION_MATRIX),x.bindBuffer(x.ARRAY_BUFFER,this._attributesBuffer),x.bufferData(x.ARRAY_BUFFER,A.attributes,x.DYNAMIC_DRAW),x.drawElementsInstanced(this._gl.TRIANGLE_STRIP,4,x.UNSIGNED_BYTE,0,A.count)}handleResize(){this._updateViewportRectangle()}setDimensions(A){this._dimensions=A}_updateCachedColors(A){this._bgFloat=this._colorToFloat32Array(A.background),this._cursorFloat=this._colorToFloat32Array(A.cursor)}_updateViewportRectangle(){this._addRectangleFloat(this._vertices.attributes,0,0,0,this._terminal.cols*this._dimensions.device.cell.width,this._terminal.rows*this._dimensions.device.cell.height,this._bgFloat)}updateBackgrounds(A){let x=this._terminal,E=this._vertices,D,L,T,F,K,N,X,k,y,C,B,I=1;for(D=0;D<x.rows;D++){for(T=-1,F=0,K=0,N=!1,L=0;L<x.cols;L++)X=(D*x.cols+L)*o.RENDER_MODEL_INDICIES_PER_CELL,k=A.cells[X+o.RENDER_MODEL_BG_OFFSET],y=A.cells[X+o.RENDER_MODEL_FG_OFFSET],C=!!(67108864&y),(k!==F||y!==K&&(N||C))&&((F!==0||N&&K!==0)&&(B=8*I++,this._updateRectangle(E,B,K,F,T,L,D)),T=L,F=k,K=y,N=C);(F!==0||N&&K!==0)&&(B=8*I++,this._updateRectangle(E,B,K,F,T,x.cols,D))}E.count=I}updateCursor(A){let x=this._verticesCursor,E=A.cursor;if(!E||E.style==="block")return void(x.count=0);let D,L=0;E.style!=="bar"&&E.style!=="outline"||(D=8*L++,this._addRectangleFloat(x.attributes,D,E.x*this._dimensions.device.cell.width,E.y*this._dimensions.device.cell.height,E.style==="bar"?E.dpr*E.cursorWidth:E.dpr,this._dimensions.device.cell.height,this._cursorFloat)),E.style!=="underline"&&E.style!=="outline"||(D=8*L++,this._addRectangleFloat(x.attributes,D,E.x*this._dimensions.device.cell.width,(E.y+1)*this._dimensions.device.cell.height-E.dpr,E.width*this._dimensions.device.cell.width,E.dpr,this._cursorFloat)),E.style==="outline"&&(D=8*L++,this._addRectangleFloat(x.attributes,D,E.x*this._dimensions.device.cell.width,E.y*this._dimensions.device.cell.height,E.width*this._dimensions.device.cell.width,E.dpr,this._cursorFloat),D=8*L++,this._addRectangleFloat(x.attributes,D,(E.x+E.width)*this._dimensions.device.cell.width-E.dpr,E.y*this._dimensions.device.cell.height,E.dpr,this._dimensions.device.cell.height,this._cursorFloat)),x.count=L}_updateRectangle(A,x,E,D,L,T,F){if(67108864&E)switch(50331648&E){case 16777216:case 33554432:u=this._themeService.colors.ansi[255&E].rgba;break;case 50331648:u=(16777215&E)<<8;break;default:u=this._themeService.colors.foreground.rgba}else switch(50331648&D){case 16777216:case 33554432:u=this._themeService.colors.ansi[255&D].rgba;break;case 50331648:u=(16777215&D)<<8;break;default:u=this._themeService.colors.background.rgba}A.attributes.length<x+4&&(A.attributes=(0,c.expandFloat32Array)(A.attributes,this._terminal.rows*this._terminal.cols*8)),a=L*this._dimensions.device.cell.width,d=F*this._dimensions.device.cell.height,_=(u>>24&255)/255,p=(u>>16&255)/255,m=(u>>8&255)/255,w=1,this._addRectangle(A.attributes,x,a,d,(T-L)*this._dimensions.device.cell.width,this._dimensions.device.cell.height,_,p,m,w)}_addRectangle(A,x,E,D,L,T,F,K,N,X){A[x]=E/this._dimensions.device.canvas.width,A[x+1]=D/this._dimensions.device.canvas.height,A[x+2]=L/this._dimensions.device.canvas.width,A[x+3]=T/this._dimensions.device.canvas.height,A[x+4]=F,A[x+5]=K,A[x+6]=N,A[x+7]=X}_addRectangleFloat(A,x,E,D,L,T,F){A[x]=E/this._dimensions.device.canvas.width,A[x+1]=D/this._dimensions.device.canvas.height,A[x+2]=L/this._dimensions.device.canvas.width,A[x+3]=T/this._dimensions.device.canvas.height,A[x+4]=F[0],A[x+5]=F[1],A[x+6]=F[2],A[x+7]=F[3]}_colorToFloat32Array(A){return new Float32Array([(A.rgba>>24&255)/255,(A.rgba>>16&255)/255,(A.rgba>>8&255)/255,(255&A.rgba)/255])}}t.RectangleRenderer=b},310:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderModel=t.COMBINED_CHAR_BIT_MASK=t.RENDER_MODEL_EXT_OFFSET=t.RENDER_MODEL_FG_OFFSET=t.RENDER_MODEL_BG_OFFSET=t.RENDER_MODEL_INDICIES_PER_CELL=void 0;let h=n(296);t.RENDER_MODEL_INDICIES_PER_CELL=4,t.RENDER_MODEL_BG_OFFSET=1,t.RENDER_MODEL_FG_OFFSET=2,t.RENDER_MODEL_EXT_OFFSET=3,t.COMBINED_CHAR_BIT_MASK=2147483648,t.RenderModel=class{constructor(){this.cells=new Uint32Array(0),this.lineLengths=new Uint32Array(0),this.selection=(0,h.createSelectionRenderModel)()}resize(g,o){let c=g*o*t.RENDER_MODEL_INDICIES_PER_CELL;c!==this.cells.length&&(this.cells=new Uint32Array(c),this.lineLengths=new Uint32Array(o))}clear(){this.cells.fill(0,0),this.lineLengths.fill(0,0)}}},666:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.JoinedCellData=t.WebglRenderer=void 0;let h=n(820),g=n(274),o=n(627),c=n(457),f=n(56),v=n(374),u=n(345),a=n(859),d=n(147),_=n(782),p=n(855),m=n(965),w=n(742),b=n(310),S=n(733);class A extends a.Disposable{constructor(L,T,F,K,N,X,k,y,C){super(),this._terminal=L,this._characterJoinerService=T,this._charSizeService=F,this._coreBrowserService=K,this._coreService=N,this._decorationService=X,this._optionsService=k,this._themeService=y,this._cursorBlinkStateManager=new a.MutableDisposable,this._charAtlasDisposable=this.register(new a.MutableDisposable),this._observerDisposable=this.register(new a.MutableDisposable),this._model=new b.RenderModel,this._workCell=new _.CellData,this._workCell2=new _.CellData,this._rectangleRenderer=this.register(new a.MutableDisposable),this._glyphRenderer=this.register(new a.MutableDisposable),this._onChangeTextureAtlas=this.register(new u.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new u.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new u.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onRequestRedraw=this.register(new u.EventEmitter),this.onRequestRedraw=this._onRequestRedraw.event,this._onContextLoss=this.register(new u.EventEmitter),this.onContextLoss=this._onContextLoss.event,this.register(this._themeService.onChangeColors(()=>this._handleColorChange())),this._cellColorResolver=new g.CellColorResolver(this._terminal,this._optionsService,this._model.selection,this._decorationService,this._coreBrowserService,this._themeService),this._core=this._terminal._core,this._renderLayers=[new S.LinkRenderLayer(this._core.screenElement,2,this._terminal,this._core.linkifier,this._coreBrowserService,k,this._themeService)],this.dimensions=(0,v.createRenderDimensions)(),this._devicePixelRatio=this._coreBrowserService.dpr,this._updateDimensions(),this._updateCursorBlink(),this.register(k.onOptionChange(()=>this._handleOptionsChanged())),this._canvas=this._coreBrowserService.mainDocument.createElement("canvas");let B={antialias:!1,depth:!1,preserveDrawingBuffer:C};if(this._gl=this._canvas.getContext("webgl2",B),!this._gl)throw new Error("WebGL2 not supported "+this._gl);this.register((0,h.addDisposableDomListener)(this._canvas,"webglcontextlost",I=>{console.log("webglcontextlost event received"),I.preventDefault(),this._contextRestorationTimeout=setTimeout(()=>{this._contextRestorationTimeout=void 0,console.warn("webgl context not restored; firing onContextLoss"),this._onContextLoss.fire(I)},3e3)})),this.register((0,h.addDisposableDomListener)(this._canvas,"webglcontextrestored",I=>{console.warn("webglcontextrestored event received"),clearTimeout(this._contextRestorationTimeout),this._contextRestorationTimeout=void 0,(0,o.removeTerminalFromCache)(this._terminal),this._initializeWebGLState(),this._requestRedrawViewport()})),this._observerDisposable.value=(0,f.observeDevicePixelDimensions)(this._canvas,this._coreBrowserService.window,(I,R)=>this._setCanvasDevicePixelDimensions(I,R)),this.register(this._coreBrowserService.onWindowChange(I=>{this._observerDisposable.value=(0,f.observeDevicePixelDimensions)(this._canvas,I,(R,H)=>this._setCanvasDevicePixelDimensions(R,H))})),this._core.screenElement.appendChild(this._canvas),[this._rectangleRenderer.value,this._glyphRenderer.value]=this._initializeWebGLState(),this._isAttached=this._coreBrowserService.window.document.body.contains(this._core.screenElement),this.register((0,a.toDisposable)(()=>{for(let I of this._renderLayers)I.dispose();this._canvas.parentElement?.removeChild(this._canvas),(0,o.removeTerminalFromCache)(this._terminal)}))}get textureAtlas(){return this._charAtlas?.pages[0].canvas}_handleColorChange(){this._refreshCharAtlas(),this._clearModel(!0)}handleDevicePixelRatioChange(){this._devicePixelRatio!==this._coreBrowserService.dpr&&(this._devicePixelRatio=this._coreBrowserService.dpr,this.handleResize(this._terminal.cols,this._terminal.rows))}handleResize(L,T){this._updateDimensions(),this._model.resize(this._terminal.cols,this._terminal.rows);for(let F of this._renderLayers)F.resize(this._terminal,this.dimensions);this._canvas.width=this.dimensions.device.canvas.width,this._canvas.height=this.dimensions.device.canvas.height,this._canvas.style.width=`${this.dimensions.css.canvas.width}px`,this._canvas.style.height=`${this.dimensions.css.canvas.height}px`,this._core.screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._core.screenElement.style.height=`${this.dimensions.css.canvas.height}px`,this._rectangleRenderer.value?.setDimensions(this.dimensions),this._rectangleRenderer.value?.handleResize(),this._glyphRenderer.value?.setDimensions(this.dimensions),this._glyphRenderer.value?.handleResize(),this._refreshCharAtlas(),this._clearModel(!1)}handleCharSizeChanged(){this.handleResize(this._terminal.cols,this._terminal.rows)}handleBlur(){for(let L of this._renderLayers)L.handleBlur(this._terminal);this._cursorBlinkStateManager.value?.pause(),this._requestRedrawViewport()}handleFocus(){for(let L of this._renderLayers)L.handleFocus(this._terminal);this._cursorBlinkStateManager.value?.resume(),this._requestRedrawViewport()}handleSelectionChanged(L,T,F){for(let K of this._renderLayers)K.handleSelectionChanged(this._terminal,L,T,F);this._model.selection.update(this._core,L,T,F),this._requestRedrawViewport()}handleCursorMove(){for(let L of this._renderLayers)L.handleCursorMove(this._terminal);this._cursorBlinkStateManager.value?.restartBlinkAnimation()}_handleOptionsChanged(){this._updateDimensions(),this._refreshCharAtlas(),this._updateCursorBlink()}_initializeWebGLState(){return this._rectangleRenderer.value=new w.RectangleRenderer(this._terminal,this._gl,this.dimensions,this._themeService),this._glyphRenderer.value=new m.GlyphRenderer(this._terminal,this._gl,this.dimensions,this._optionsService),this.handleCharSizeChanged(),[this._rectangleRenderer.value,this._glyphRenderer.value]}_refreshCharAtlas(){if(this.dimensions.device.char.width<=0&&this.dimensions.device.char.height<=0)return void(this._isAttached=!1);let L=(0,o.acquireTextureAtlas)(this._terminal,this._optionsService.rawOptions,this._themeService.colors,this.dimensions.device.cell.width,this.dimensions.device.cell.height,this.dimensions.device.char.width,this.dimensions.device.char.height,this._coreBrowserService.dpr);this._charAtlas!==L&&(this._onChangeTextureAtlas.fire(L.pages[0].canvas),this._charAtlasDisposable.value=(0,a.getDisposeArrayDisposable)([(0,u.forwardEvent)(L.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas),(0,u.forwardEvent)(L.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)])),this._charAtlas=L,this._charAtlas.warmUp(),this._glyphRenderer.value?.setAtlas(this._charAtlas)}_clearModel(L){this._model.clear(),L&&this._glyphRenderer.value?.clear()}clearTextureAtlas(){this._charAtlas?.clearTexture(),this._clearModel(!0),this._requestRedrawViewport()}clear(){this._clearModel(!0);for(let L of this._renderLayers)L.reset(this._terminal);this._cursorBlinkStateManager.value?.restartBlinkAnimation(),this._updateCursorBlink()}registerCharacterJoiner(L){return-1}deregisterCharacterJoiner(L){return!1}renderRows(L,T){if(!this._isAttached){if(!(this._coreBrowserService.window.document.body.contains(this._core.screenElement)&&this._charSizeService.width&&this._charSizeService.height))return;this._updateDimensions(),this._refreshCharAtlas(),this._isAttached=!0}for(let F of this._renderLayers)F.handleGridChanged(this._terminal,L,T);this._glyphRenderer.value&&this._rectangleRenderer.value&&(this._glyphRenderer.value.beginFrame()?(this._clearModel(!0),this._updateModel(0,this._terminal.rows-1)):this._updateModel(L,T),this._rectangleRenderer.value.renderBackgrounds(),this._glyphRenderer.value.render(this._model),this._cursorBlinkStateManager.value&&!this._cursorBlinkStateManager.value.isCursorVisible||this._rectangleRenderer.value.renderCursor())}_updateCursorBlink(){this._terminal.options.cursorBlink?this._cursorBlinkStateManager.value=new c.CursorBlinkStateManager(()=>{this._requestRedrawCursor()},this._coreBrowserService):this._cursorBlinkStateManager.clear(),this._requestRedrawCursor()}_updateModel(L,T){let F=this._core,K,N,X,k,y,C,B,I,R,H,$,q,P,M,U=this._workCell;L=E(L,F.rows-1,0),T=E(T,F.rows-1,0);let Z=this._terminal.buffer.active.baseY+this._terminal.buffer.active.cursorY,te=Z-F.buffer.ydisp,ee=Math.min(this._terminal.buffer.active.cursorX,F.cols-1),le=-1,ne=this._coreService.isCursorInitialized&&!this._coreService.isCursorHidden&&(!this._cursorBlinkStateManager.value||this._cursorBlinkStateManager.value.isCursorVisible);this._model.cursor=void 0;let ye=!1;for(N=L;N<=T;N++)for(X=N+F.buffer.ydisp,k=F.buffer.lines.get(X),this._model.lineLengths[N]=0,y=this._characterJoinerService.getJoinedCharacters(X),P=0;P<F.cols;P++)if(K=this._cellColorResolver.result.bg,k.loadCell(P,U),P===0&&(K=this._cellColorResolver.result.bg),C=!1,B=P,y.length>0&&P===y[0][0]&&(C=!0,I=y.shift(),U=new x(U,k.translateToString(!0,I[0],I[1]),I[1]-I[0]),B=I[1]-1),R=U.getChars(),H=U.getCode(),q=(N*F.cols+P)*b.RENDER_MODEL_INDICIES_PER_CELL,this._cellColorResolver.resolve(U,P,X,this.dimensions.device.cell.width),ne&&X===Z&&(P===ee&&(this._model.cursor={x:ee,y:te,width:U.getWidth(),style:this._coreBrowserService.isFocused?F.options.cursorStyle||"block":F.options.cursorInactiveStyle,cursorWidth:F.options.cursorWidth,dpr:this._devicePixelRatio},le=ee+U.getWidth()-1),P>=ee&&P<=le&&(this._coreBrowserService.isFocused&&(F.options.cursorStyle||"block")==="block"||this._coreBrowserService.isFocused===!1&&F.options.cursorInactiveStyle==="block")&&(this._cellColorResolver.result.fg=50331648|this._themeService.colors.cursorAccent.rgba>>8&16777215,this._cellColorResolver.result.bg=50331648|this._themeService.colors.cursor.rgba>>8&16777215)),H!==p.NULL_CELL_CODE&&(this._model.lineLengths[N]=P+1),(this._model.cells[q]!==H||this._model.cells[q+b.RENDER_MODEL_BG_OFFSET]!==this._cellColorResolver.result.bg||this._model.cells[q+b.RENDER_MODEL_FG_OFFSET]!==this._cellColorResolver.result.fg||this._model.cells[q+b.RENDER_MODEL_EXT_OFFSET]!==this._cellColorResolver.result.ext)&&(ye=!0,R.length>1&&(H|=b.COMBINED_CHAR_BIT_MASK),this._model.cells[q]=H,this._model.cells[q+b.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[q+b.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[q+b.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext,$=U.getWidth(),this._glyphRenderer.value.updateCell(P,N,H,this._cellColorResolver.result.bg,this._cellColorResolver.result.fg,this._cellColorResolver.result.ext,R,$,K),C))for(U=this._workCell,P++;P<B;P++)M=(N*F.cols+P)*b.RENDER_MODEL_INDICIES_PER_CELL,this._glyphRenderer.value.updateCell(P,N,p.NULL_CELL_CODE,0,0,0,p.NULL_CELL_CHAR,0,0),this._model.cells[M]=p.NULL_CELL_CODE,this._model.cells[M+b.RENDER_MODEL_BG_OFFSET]=this._cellColorResolver.result.bg,this._model.cells[M+b.RENDER_MODEL_FG_OFFSET]=this._cellColorResolver.result.fg,this._model.cells[M+b.RENDER_MODEL_EXT_OFFSET]=this._cellColorResolver.result.ext;ye&&this._rectangleRenderer.value.updateBackgrounds(this._model),this._rectangleRenderer.value.updateCursor(this._model)}_updateDimensions(){this._charSizeService.width&&this._charSizeService.height&&(this.dimensions.device.char.width=Math.floor(this._charSizeService.width*this._devicePixelRatio),this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*this._devicePixelRatio),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.top=this._optionsService.rawOptions.lineHeight===1?0:Math.round((this.dimensions.device.cell.height-this.dimensions.device.char.height)/2),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.char.left=Math.floor(this._optionsService.rawOptions.letterSpacing/2),this.dimensions.device.canvas.height=this._terminal.rows*this.dimensions.device.cell.height,this.dimensions.device.canvas.width=this._terminal.cols*this.dimensions.device.cell.width,this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/this._devicePixelRatio),this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/this._devicePixelRatio),this.dimensions.css.cell.height=this.dimensions.device.cell.height/this._devicePixelRatio,this.dimensions.css.cell.width=this.dimensions.device.cell.width/this._devicePixelRatio)}_setCanvasDevicePixelDimensions(L,T){this._canvas.width===L&&this._canvas.height===T||(this._canvas.width=L,this._canvas.height=T,this._requestRedrawViewport())}_requestRedrawViewport(){this._onRequestRedraw.fire({start:0,end:this._terminal.rows-1})}_requestRedrawCursor(){let L=this._terminal.buffer.active.cursorY;this._onRequestRedraw.fire({start:L,end:L})}}t.WebglRenderer=A;class x extends d.AttributeData{constructor(L,T,F){super(),this.content=0,this.combinedData="",this.fg=L.fg,this.bg=L.bg,this.combinedData=T,this._width=F}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(L){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}function E(D,L,T=0){return Math.max(Math.min(D,L),T)}t.JoinedCellData=x},381:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GLTexture=t.expandFloat32Array=t.createShader=t.createProgram=t.PROJECTION_MATRIX=void 0;let h=n(374);function g(o,c,f){let v=(0,h.throwIfFalsy)(o.createShader(c));if(o.shaderSource(v,f),o.compileShader(v),o.getShaderParameter(v,o.COMPILE_STATUS))return v;console.error(o.getShaderInfoLog(v)),o.deleteShader(v)}t.PROJECTION_MATRIX=new Float32Array([2,0,0,0,0,-2,0,0,0,0,1,0,-1,1,0,1]),t.createProgram=function(o,c,f){let v=(0,h.throwIfFalsy)(o.createProgram());if(o.attachShader(v,(0,h.throwIfFalsy)(g(o,o.VERTEX_SHADER,c))),o.attachShader(v,(0,h.throwIfFalsy)(g(o,o.FRAGMENT_SHADER,f))),o.linkProgram(v),o.getProgramParameter(v,o.LINK_STATUS))return v;console.error(o.getProgramInfoLog(v)),o.deleteProgram(v)},t.createShader=g,t.expandFloat32Array=function(o,c){let f=Math.min(2*o.length,c),v=new Float32Array(f);for(let u=0;u<o.length;u++)v[u]=o[u];return v},t.GLTexture=class{constructor(o){this.texture=o,this.version=-1}}},592:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRenderLayer=void 0;let h=n(627),g=n(237),o=n(374),c=n(859);class f extends c.Disposable{constructor(u,a,d,_,p,m,w,b){super(),this._container=a,this._alpha=p,this._coreBrowserService=m,this._optionsService=w,this._themeService=b,this._deviceCharWidth=0,this._deviceCharHeight=0,this._deviceCellWidth=0,this._deviceCellHeight=0,this._deviceCharLeft=0,this._deviceCharTop=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add(`xterm-${d}-layer`),this._canvas.style.zIndex=_.toString(),this._initCanvas(),this._container.appendChild(this._canvas),this.register(this._themeService.onChangeColors(S=>{this._refreshCharAtlas(u,S),this.reset(u)})),this.register((0,c.toDisposable)(()=>{this._canvas.remove()}))}_initCanvas(){this._ctx=(0,o.throwIfFalsy)(this._canvas.getContext("2d",{alpha:this._alpha})),this._alpha||this._clearAll()}handleBlur(u){}handleFocus(u){}handleCursorMove(u){}handleGridChanged(u,a,d){}handleSelectionChanged(u,a,d,_=!1){}_setTransparency(u,a){if(a===this._alpha)return;let d=this._canvas;this._alpha=a,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,d),this._refreshCharAtlas(u,this._themeService.colors),this.handleGridChanged(u,0,u.rows-1)}_refreshCharAtlas(u,a){this._deviceCharWidth<=0&&this._deviceCharHeight<=0||(this._charAtlas=(0,h.acquireTextureAtlas)(u,this._optionsService.rawOptions,a,this._deviceCellWidth,this._deviceCellHeight,this._deviceCharWidth,this._deviceCharHeight,this._coreBrowserService.dpr),this._charAtlas.warmUp())}resize(u,a){this._deviceCellWidth=a.device.cell.width,this._deviceCellHeight=a.device.cell.height,this._deviceCharWidth=a.device.char.width,this._deviceCharHeight=a.device.char.height,this._deviceCharLeft=a.device.char.left,this._deviceCharTop=a.device.char.top,this._canvas.width=a.device.canvas.width,this._canvas.height=a.device.canvas.height,this._canvas.style.width=`${a.css.canvas.width}px`,this._canvas.style.height=`${a.css.canvas.height}px`,this._alpha||this._clearAll(),this._refreshCharAtlas(u,this._themeService.colors)}_fillBottomLineAtCells(u,a,d=1){this._ctx.fillRect(u*this._deviceCellWidth,(a+1)*this._deviceCellHeight-this._coreBrowserService.dpr-1,d*this._deviceCellWidth,this._coreBrowserService.dpr)}_clearAll(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))}_clearCells(u,a,d,_){this._alpha?this._ctx.clearRect(u*this._deviceCellWidth,a*this._deviceCellHeight,d*this._deviceCellWidth,_*this._deviceCellHeight):(this._ctx.fillStyle=this._themeService.colors.background.css,this._ctx.fillRect(u*this._deviceCellWidth,a*this._deviceCellHeight,d*this._deviceCellWidth,_*this._deviceCellHeight))}_fillCharTrueColor(u,a,d,_){this._ctx.font=this._getFont(u,!1,!1),this._ctx.textBaseline=g.TEXT_BASELINE,this._clipCell(d,_,a.getWidth()),this._ctx.fillText(a.getChars(),d*this._deviceCellWidth+this._deviceCharLeft,_*this._deviceCellHeight+this._deviceCharTop+this._deviceCharHeight)}_clipCell(u,a,d){this._ctx.beginPath(),this._ctx.rect(u*this._deviceCellWidth,a*this._deviceCellHeight,d*this._deviceCellWidth,this._deviceCellHeight),this._ctx.clip()}_getFont(u,a,d){return`${d?"italic":""} ${a?u.options.fontWeightBold:u.options.fontWeight} ${u.options.fontSize*this._coreBrowserService.dpr}px ${u.options.fontFamily}`}}t.BaseRenderLayer=f},733:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LinkRenderLayer=void 0;let h=n(197),g=n(237),o=n(592);class c extends o.BaseRenderLayer{constructor(v,u,a,d,_,p,m){super(a,v,"link",u,!0,_,p,m),this.register(d.onShowLinkUnderline(w=>this._handleShowLinkUnderline(w))),this.register(d.onHideLinkUnderline(w=>this._handleHideLinkUnderline(w)))}resize(v,u){super.resize(v,u),this._state=void 0}reset(v){this._clearCurrentLink()}_clearCurrentLink(){if(this._state){this._clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);let v=this._state.y2-this._state.y1-1;v>0&&this._clearCells(0,this._state.y1+1,this._state.cols,v),this._clearCells(0,this._state.y2,this._state.x2,1),this._state=void 0}}_handleShowLinkUnderline(v){if(v.fg===g.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._themeService.colors.background.css:v.fg!==void 0&&(0,h.is256Color)(v.fg)?this._ctx.fillStyle=this._themeService.colors.ansi[v.fg].css:this._ctx.fillStyle=this._themeService.colors.foreground.css,v.y1===v.y2)this._fillBottomLineAtCells(v.x1,v.y1,v.x2-v.x1);else{this._fillBottomLineAtCells(v.x1,v.y1,v.cols-v.x1);for(let u=v.y1+1;u<v.y2;u++)this._fillBottomLineAtCells(0,u,v.cols);this._fillBottomLineAtCells(0,v.y2,v.x2)}this._state=v}_handleHideLinkUnderline(v){this._clearCurrentLink()}}t.LinkRenderLayer=c},820:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(n,h,g,o){n.addEventListener(h,g,o);let c=!1;return{dispose:()=>{c||(c=!0,n.removeEventListener(h,g,o))}}}},274:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellColorResolver=void 0;let h=n(855),g=n(160),o=n(374),c,f=0,v=0,u=!1,a=!1,d=!1,_=0;t.CellColorResolver=class{constructor(p,m,w,b,S,A){this._terminal=p,this._optionService=m,this._selectionRenderModel=w,this._decorationService=b,this._coreBrowserService=S,this._themeService=A,this.result={fg:0,bg:0,ext:0}}resolve(p,m,w,b){if(this.result.bg=p.bg,this.result.fg=p.fg,this.result.ext=268435456&p.bg?p.extended.ext:0,v=0,f=0,a=!1,u=!1,d=!1,c=this._themeService.colors,_=0,p.getCode()!==h.NULL_CELL_CODE&&p.extended.underlineStyle===4){let S=Math.max(1,Math.floor(this._optionService.rawOptions.fontSize*this._coreBrowserService.dpr/15));_=m*b%(2*Math.round(S))}if(this._decorationService.forEachDecorationAtCell(m,w,"bottom",S=>{S.backgroundColorRGB&&(v=S.backgroundColorRGB.rgba>>8&16777215,a=!0),S.foregroundColorRGB&&(f=S.foregroundColorRGB.rgba>>8&16777215,u=!0)}),d=this._selectionRenderModel.isCellSelected(this._terminal,m,w),d){if(67108864&this.result.fg||(50331648&this.result.bg)!=0){if(67108864&this.result.fg)switch(50331648&this.result.fg){case 16777216:case 33554432:v=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:v=(16777215&this.result.fg)<<8|255;break;default:v=this._themeService.colors.foreground.rgba}else switch(50331648&this.result.bg){case 16777216:case 33554432:v=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:v=(16777215&this.result.bg)<<8|255}v=g.rgba.blend(v,4294967040&(this._coreBrowserService.isFocused?c.selectionBackgroundOpaque:c.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}else v=(this._coreBrowserService.isFocused?c.selectionBackgroundOpaque:c.selectionInactiveBackgroundOpaque).rgba>>8&16777215;if(a=!0,c.selectionForeground&&(f=c.selectionForeground.rgba>>8&16777215,u=!0),(0,o.treatGlyphAsBackgroundColor)(p.getCode())){if(67108864&this.result.fg&&(50331648&this.result.bg)==0)f=(this._coreBrowserService.isFocused?c.selectionBackgroundOpaque:c.selectionInactiveBackgroundOpaque).rgba>>8&16777215;else{if(67108864&this.result.fg)switch(50331648&this.result.bg){case 16777216:case 33554432:f=this._themeService.colors.ansi[255&this.result.bg].rgba;break;case 50331648:f=(16777215&this.result.bg)<<8|255}else switch(50331648&this.result.fg){case 16777216:case 33554432:f=this._themeService.colors.ansi[255&this.result.fg].rgba;break;case 50331648:f=(16777215&this.result.fg)<<8|255;break;default:f=this._themeService.colors.foreground.rgba}f=g.rgba.blend(f,4294967040&(this._coreBrowserService.isFocused?c.selectionBackgroundOpaque:c.selectionInactiveBackgroundOpaque).rgba|128)>>8&16777215}u=!0}}this._decorationService.forEachDecorationAtCell(m,w,"top",S=>{S.backgroundColorRGB&&(v=S.backgroundColorRGB.rgba>>8&16777215,a=!0),S.foregroundColorRGB&&(f=S.foregroundColorRGB.rgba>>8&16777215,u=!0)}),a&&(v=d?-16777216&p.bg&-134217729|v|50331648:-16777216&p.bg|v|50331648),u&&(f=-16777216&p.fg&-67108865|f|50331648),67108864&this.result.fg&&(a&&!u&&(f=(50331648&this.result.bg)==0?-134217728&this.result.fg|16777215&c.background.rgba>>8|50331648:-134217728&this.result.fg|67108863&this.result.bg,u=!0),!a&&u&&(v=(50331648&this.result.fg)==0?-67108864&this.result.bg|16777215&c.foreground.rgba>>8|50331648:-67108864&this.result.bg|67108863&this.result.fg,a=!0)),c=void 0,this.result.bg=a?v:this.result.bg,this.result.fg=u?f:this.result.fg,this.result.ext&=536870911,this.result.ext|=_<<29&3758096384}}},627:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeTerminalFromCache=t.acquireTextureAtlas=void 0;let h=n(509),g=n(197),o=[];t.acquireTextureAtlas=function(c,f,v,u,a,d,_,p){let m=(0,g.generateConfig)(u,a,d,_,f,v,p);for(let S=0;S<o.length;S++){let A=o[S],x=A.ownedBy.indexOf(c);if(x>=0){if((0,g.configEquals)(A.config,m))return A.atlas;A.ownedBy.length===1?(A.atlas.dispose(),o.splice(S,1)):A.ownedBy.splice(x,1);break}}for(let S=0;S<o.length;S++){let A=o[S];if((0,g.configEquals)(A.config,m))return A.ownedBy.push(c),A.atlas}let w=c._core,b={atlas:new h.TextureAtlas(document,m,w.unicodeService),config:m,ownedBy:[c]};return o.push(b),b.atlas},t.removeTerminalFromCache=function(c){for(let f=0;f<o.length;f++){let v=o[f].ownedBy.indexOf(c);if(v!==-1){o[f].ownedBy.length===1?(o[f].atlas.dispose(),o.splice(f,1)):o[f].ownedBy.splice(v,1);break}}}},197:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.is256Color=t.configEquals=t.generateConfig=void 0;let h=n(160);t.generateConfig=function(g,o,c,f,v,u,a){let d={foreground:u.foreground,background:u.background,cursor:h.NULL_COLOR,cursorAccent:h.NULL_COLOR,selectionForeground:h.NULL_COLOR,selectionBackgroundTransparent:h.NULL_COLOR,selectionBackgroundOpaque:h.NULL_COLOR,selectionInactiveBackgroundTransparent:h.NULL_COLOR,selectionInactiveBackgroundOpaque:h.NULL_COLOR,ansi:u.ansi.slice(),contrastCache:u.contrastCache,halfContrastCache:u.halfContrastCache};return{customGlyphs:v.customGlyphs,devicePixelRatio:a,letterSpacing:v.letterSpacing,lineHeight:v.lineHeight,deviceCellWidth:g,deviceCellHeight:o,deviceCharWidth:c,deviceCharHeight:f,fontFamily:v.fontFamily,fontSize:v.fontSize,fontWeight:v.fontWeight,fontWeightBold:v.fontWeightBold,allowTransparency:v.allowTransparency,drawBoldTextInBrightColors:v.drawBoldTextInBrightColors,minimumContrastRatio:v.minimumContrastRatio,colors:d}},t.configEquals=function(g,o){for(let c=0;c<g.colors.ansi.length;c++)if(g.colors.ansi[c].rgba!==o.colors.ansi[c].rgba)return!1;return g.devicePixelRatio===o.devicePixelRatio&&g.customGlyphs===o.customGlyphs&&g.lineHeight===o.lineHeight&&g.letterSpacing===o.letterSpacing&&g.fontFamily===o.fontFamily&&g.fontSize===o.fontSize&&g.fontWeight===o.fontWeight&&g.fontWeightBold===o.fontWeightBold&&g.allowTransparency===o.allowTransparency&&g.deviceCharWidth===o.deviceCharWidth&&g.deviceCharHeight===o.deviceCharHeight&&g.drawBoldTextInBrightColors===o.drawBoldTextInBrightColors&&g.minimumContrastRatio===o.minimumContrastRatio&&g.colors.foreground.rgba===o.colors.foreground.rgba&&g.colors.background.rgba===o.colors.background.rgba},t.is256Color=function(g){return(50331648&g)==16777216||(50331648&g)==33554432}},237:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;let h=n(399);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},457:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CursorBlinkStateManager=void 0,t.CursorBlinkStateManager=class{constructor(n,h){this._renderCallback=n,this._coreBrowserService=h,this.isCursorVisible=!0,this._coreBrowserService.isFocused&&this._restartInterval()}get isPaused(){return!(this._blinkStartTimeout||this._blinkInterval)}dispose(){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}restartBlinkAnimation(){this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})))}_restartInterval(n=600){this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout=this._coreBrowserService.window.setTimeout(()=>{if(this._animationTimeRestarted){let h=600-(Date.now()-this._animationTimeRestarted);if(this._animationTimeRestarted=void 0,h>0)return void this._restartInterval(h)}this.isCursorVisible=!1,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0}),this._blinkInterval=this._coreBrowserService.window.setInterval(()=>{if(this._animationTimeRestarted){let h=600-(Date.now()-this._animationTimeRestarted);return this._animationTimeRestarted=void 0,void this._restartInterval(h)}this.isCursorVisible=!this.isCursorVisible,this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._renderCallback(),this._animationFrame=void 0})},600)},n)}pause(){this.isCursorVisible=!0,this._blinkInterval&&(this._coreBrowserService.window.clearInterval(this._blinkInterval),this._blinkInterval=void 0),this._blinkStartTimeout&&(this._coreBrowserService.window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=void 0),this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}resume(){this.pause(),this._animationTimeRestarted=void 0,this._restartInterval(),this.restartBlinkAnimation()}}},860:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tryDrawCustomChar=t.powerlineDefinitions=t.boxDrawingDefinitions=t.blockElementDefinitions=void 0;let h=n(374);t.blockElementDefinitions={"\u2580":[{x:0,y:0,w:8,h:4}],"\u2581":[{x:0,y:7,w:8,h:1}],"\u2582":[{x:0,y:6,w:8,h:2}],"\u2583":[{x:0,y:5,w:8,h:3}],"\u2584":[{x:0,y:4,w:8,h:4}],"\u2585":[{x:0,y:3,w:8,h:5}],"\u2586":[{x:0,y:2,w:8,h:6}],"\u2587":[{x:0,y:1,w:8,h:7}],"\u2588":[{x:0,y:0,w:8,h:8}],"\u2589":[{x:0,y:0,w:7,h:8}],"\u258A":[{x:0,y:0,w:6,h:8}],"\u258B":[{x:0,y:0,w:5,h:8}],"\u258C":[{x:0,y:0,w:4,h:8}],"\u258D":[{x:0,y:0,w:3,h:8}],"\u258E":[{x:0,y:0,w:2,h:8}],"\u258F":[{x:0,y:0,w:1,h:8}],"\u2590":[{x:4,y:0,w:4,h:8}],"\u2594":[{x:0,y:0,w:8,h:1}],"\u2595":[{x:7,y:0,w:1,h:8}],"\u2596":[{x:0,y:4,w:4,h:4}],"\u2597":[{x:4,y:4,w:4,h:4}],"\u2598":[{x:0,y:0,w:4,h:4}],"\u2599":[{x:0,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u259A":[{x:0,y:0,w:4,h:4},{x:4,y:4,w:4,h:4}],"\u259B":[{x:0,y:0,w:4,h:8},{x:4,y:0,w:4,h:4}],"\u259C":[{x:0,y:0,w:8,h:4},{x:4,y:0,w:4,h:8}],"\u259D":[{x:4,y:0,w:4,h:4}],"\u259E":[{x:4,y:0,w:4,h:4},{x:0,y:4,w:4,h:4}],"\u259F":[{x:4,y:0,w:4,h:8},{x:0,y:4,w:8,h:4}],"\u{1FB70}":[{x:1,y:0,w:1,h:8}],"\u{1FB71}":[{x:2,y:0,w:1,h:8}],"\u{1FB72}":[{x:3,y:0,w:1,h:8}],"\u{1FB73}":[{x:4,y:0,w:1,h:8}],"\u{1FB74}":[{x:5,y:0,w:1,h:8}],"\u{1FB75}":[{x:6,y:0,w:1,h:8}],"\u{1FB76}":[{x:0,y:1,w:8,h:1}],"\u{1FB77}":[{x:0,y:2,w:8,h:1}],"\u{1FB78}":[{x:0,y:3,w:8,h:1}],"\u{1FB79}":[{x:0,y:4,w:8,h:1}],"\u{1FB7A}":[{x:0,y:5,w:8,h:1}],"\u{1FB7B}":[{x:0,y:6,w:8,h:1}],"\u{1FB7C}":[{x:0,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB7D}":[{x:0,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7E}":[{x:7,y:0,w:1,h:8},{x:0,y:0,w:8,h:1}],"\u{1FB7F}":[{x:7,y:0,w:1,h:8},{x:0,y:7,w:8,h:1}],"\u{1FB80}":[{x:0,y:0,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB81}":[{x:0,y:0,w:8,h:1},{x:0,y:2,w:8,h:1},{x:0,y:4,w:8,h:1},{x:0,y:7,w:8,h:1}],"\u{1FB82}":[{x:0,y:0,w:8,h:2}],"\u{1FB83}":[{x:0,y:0,w:8,h:3}],"\u{1FB84}":[{x:0,y:0,w:8,h:5}],"\u{1FB85}":[{x:0,y:0,w:8,h:6}],"\u{1FB86}":[{x:0,y:0,w:8,h:7}],"\u{1FB87}":[{x:6,y:0,w:2,h:8}],"\u{1FB88}":[{x:5,y:0,w:3,h:8}],"\u{1FB89}":[{x:3,y:0,w:5,h:8}],"\u{1FB8A}":[{x:2,y:0,w:6,h:8}],"\u{1FB8B}":[{x:1,y:0,w:7,h:8}],"\u{1FB95}":[{x:0,y:0,w:2,h:2},{x:4,y:0,w:2,h:2},{x:2,y:2,w:2,h:2},{x:6,y:2,w:2,h:2},{x:0,y:4,w:2,h:2},{x:4,y:4,w:2,h:2},{x:2,y:6,w:2,h:2},{x:6,y:6,w:2,h:2}],"\u{1FB96}":[{x:2,y:0,w:2,h:2},{x:6,y:0,w:2,h:2},{x:0,y:2,w:2,h:2},{x:4,y:2,w:2,h:2},{x:2,y:4,w:2,h:2},{x:6,y:4,w:2,h:2},{x:0,y:6,w:2,h:2},{x:4,y:6,w:2,h:2}],"\u{1FB97}":[{x:0,y:2,w:8,h:2},{x:0,y:6,w:8,h:2}]};let g={"\u2591":[[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]],"\u2592":[[1,0],[0,0],[0,1],[0,0]],"\u2593":[[0,1],[1,1],[1,0],[1,1]]};t.boxDrawingDefinitions={"\u2500":{1:"M0,.5 L1,.5"},"\u2501":{3:"M0,.5 L1,.5"},"\u2502":{1:"M.5,0 L.5,1"},"\u2503":{3:"M.5,0 L.5,1"},"\u250C":{1:"M0.5,1 L.5,.5 L1,.5"},"\u250F":{3:"M0.5,1 L.5,.5 L1,.5"},"\u2510":{1:"M0,.5 L.5,.5 L.5,1"},"\u2513":{3:"M0,.5 L.5,.5 L.5,1"},"\u2514":{1:"M.5,0 L.5,.5 L1,.5"},"\u2517":{3:"M.5,0 L.5,.5 L1,.5"},"\u2518":{1:"M.5,0 L.5,.5 L0,.5"},"\u251B":{3:"M.5,0 L.5,.5 L0,.5"},"\u251C":{1:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2523":{3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u2524":{1:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252B":{3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u252C":{1:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2533":{3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2534":{1:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253B":{3:"M0,.5 L1,.5 M.5,.5 L.5,0"},"\u253C":{1:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u254B":{3:"M0,.5 L1,.5 M.5,0 L.5,1"},"\u2574":{1:"M.5,.5 L0,.5"},"\u2578":{3:"M.5,.5 L0,.5"},"\u2575":{1:"M.5,.5 L.5,0"},"\u2579":{3:"M.5,.5 L.5,0"},"\u2576":{1:"M.5,.5 L1,.5"},"\u257A":{3:"M.5,.5 L1,.5"},"\u2577":{1:"M.5,.5 L.5,1"},"\u257B":{3:"M.5,.5 L.5,1"},"\u2550":{1:(u,a)=>`M0,${.5-a} L1,${.5-a} M0,${.5+a} L1,${.5+a}`},"\u2551":{1:(u,a)=>`M${.5-u},0 L${.5-u},1 M${.5+u},0 L${.5+u},1`},"\u2552":{1:(u,a)=>`M.5,1 L.5,${.5-a} L1,${.5-a} M.5,${.5+a} L1,${.5+a}`},"\u2553":{1:(u,a)=>`M${.5-u},1 L${.5-u},.5 L1,.5 M${.5+u},.5 L${.5+u},1`},"\u2554":{1:(u,a)=>`M1,${.5-a} L${.5-u},${.5-a} L${.5-u},1 M1,${.5+a} L${.5+u},${.5+a} L${.5+u},1`},"\u2555":{1:(u,a)=>`M0,${.5-a} L.5,${.5-a} L.5,1 M0,${.5+a} L.5,${.5+a}`},"\u2556":{1:(u,a)=>`M${.5+u},1 L${.5+u},.5 L0,.5 M${.5-u},.5 L${.5-u},1`},"\u2557":{1:(u,a)=>`M0,${.5+a} L${.5-u},${.5+a} L${.5-u},1 M0,${.5-a} L${.5+u},${.5-a} L${.5+u},1`},"\u2558":{1:(u,a)=>`M.5,0 L.5,${.5+a} L1,${.5+a} M.5,${.5-a} L1,${.5-a}`},"\u2559":{1:(u,a)=>`M1,.5 L${.5-u},.5 L${.5-u},0 M${.5+u},.5 L${.5+u},0`},"\u255A":{1:(u,a)=>`M1,${.5-a} L${.5+u},${.5-a} L${.5+u},0 M1,${.5+a} L${.5-u},${.5+a} L${.5-u},0`},"\u255B":{1:(u,a)=>`M0,${.5+a} L.5,${.5+a} L.5,0 M0,${.5-a} L.5,${.5-a}`},"\u255C":{1:(u,a)=>`M0,.5 L${.5+u},.5 L${.5+u},0 M${.5-u},.5 L${.5-u},0`},"\u255D":{1:(u,a)=>`M0,${.5-a} L${.5-u},${.5-a} L${.5-u},0 M0,${.5+a} L${.5+u},${.5+a} L${.5+u},0`},"\u255E":{1:(u,a)=>`M.5,0 L.5,1 M.5,${.5-a} L1,${.5-a} M.5,${.5+a} L1,${.5+a}`},"\u255F":{1:(u,a)=>`M${.5-u},0 L${.5-u},1 M${.5+u},0 L${.5+u},1 M${.5+u},.5 L1,.5`},"\u2560":{1:(u,a)=>`M${.5-u},0 L${.5-u},1 M1,${.5+a} L${.5+u},${.5+a} L${.5+u},1 M1,${.5-a} L${.5+u},${.5-a} L${.5+u},0`},"\u2561":{1:(u,a)=>`M.5,0 L.5,1 M0,${.5-a} L.5,${.5-a} M0,${.5+a} L.5,${.5+a}`},"\u2562":{1:(u,a)=>`M0,.5 L${.5-u},.5 M${.5-u},0 L${.5-u},1 M${.5+u},0 L${.5+u},1`},"\u2563":{1:(u,a)=>`M${.5+u},0 L${.5+u},1 M0,${.5+a} L${.5-u},${.5+a} L${.5-u},1 M0,${.5-a} L${.5-u},${.5-a} L${.5-u},0`},"\u2564":{1:(u,a)=>`M0,${.5-a} L1,${.5-a} M0,${.5+a} L1,${.5+a} M.5,${.5+a} L.5,1`},"\u2565":{1:(u,a)=>`M0,.5 L1,.5 M${.5-u},.5 L${.5-u},1 M${.5+u},.5 L${.5+u},1`},"\u2566":{1:(u,a)=>`M0,${.5-a} L1,${.5-a} M0,${.5+a} L${.5-u},${.5+a} L${.5-u},1 M1,${.5+a} L${.5+u},${.5+a} L${.5+u},1`},"\u2567":{1:(u,a)=>`M.5,0 L.5,${.5-a} M0,${.5-a} L1,${.5-a} M0,${.5+a} L1,${.5+a}`},"\u2568":{1:(u,a)=>`M0,.5 L1,.5 M${.5-u},.5 L${.5-u},0 M${.5+u},.5 L${.5+u},0`},"\u2569":{1:(u,a)=>`M0,${.5+a} L1,${.5+a} M0,${.5-a} L${.5-u},${.5-a} L${.5-u},0 M1,${.5-a} L${.5+u},${.5-a} L${.5+u},0`},"\u256A":{1:(u,a)=>`M.5,0 L.5,1 M0,${.5-a} L1,${.5-a} M0,${.5+a} L1,${.5+a}`},"\u256B":{1:(u,a)=>`M0,.5 L1,.5 M${.5-u},0 L${.5-u},1 M${.5+u},0 L${.5+u},1`},"\u256C":{1:(u,a)=>`M0,${.5+a} L${.5-u},${.5+a} L${.5-u},1 M1,${.5+a} L${.5+u},${.5+a} L${.5+u},1 M0,${.5-a} L${.5-u},${.5-a} L${.5-u},0 M1,${.5-a} L${.5+u},${.5-a} L${.5+u},0`},"\u2571":{1:"M1,0 L0,1"},"\u2572":{1:"M0,0 L1,1"},"\u2573":{1:"M1,0 L0,1 M0,0 L1,1"},"\u257C":{1:"M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u257D":{1:"M.5,.5 L.5,0",3:"M.5,.5 L.5,1"},"\u257E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u257F":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u250D":{1:"M.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u250E":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2511":{1:"M.5,.5 L.5,1",3:"M.5,.5 L0,.5"},"\u2512":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2515":{1:"M.5,.5 L.5,0",3:"M.5,.5 L1,.5"},"\u2516":{1:"M.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2519":{1:"M.5,.5 L.5,0",3:"M.5,.5 L0,.5"},"\u251A":{1:"M.5,.5 L0,.5",3:"M.5,.5 L.5,0"},"\u251D":{1:"M.5,0 L.5,1",3:"M.5,.5 L1,.5"},"\u251E":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u251F":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2520":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2521":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2522":{1:"M.5,.5 L.5,0",3:"M0.5,1 L.5,.5 L1,.5"},"\u2525":{1:"M.5,0 L.5,1",3:"M.5,.5 L0,.5"},"\u2526":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2527":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L.5,1"},"\u2528":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1"},"\u2529":{1:"M.5,.5 L.5,1",3:"M.5,0 L.5,.5 L0,.5"},"\u252A":{1:"M.5,.5 L.5,0",3:"M0,.5 L.5,.5 L.5,1"},"\u252D":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u252E":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,.5 L1,.5"},"\u252F":{1:"M.5,.5 L.5,1",3:"M0,.5 L1,.5"},"\u2530":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2531":{1:"M.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2532":{1:"M.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2535":{1:"M.5,0 L.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u2536":{1:"M.5,0 L.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u2537":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5"},"\u2538":{1:"M0,.5 L1,.5",3:"M.5,.5 L.5,0"},"\u2539":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u253A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,.5 L1,.5"},"\u253D":{1:"M.5,0 L.5,1 M.5,.5 L1,.5",3:"M.5,.5 L0,.5"},"\u253E":{1:"M.5,0 L.5,1 M.5,.5 L0,.5",3:"M.5,.5 L1,.5"},"\u253F":{1:"M.5,0 L.5,1",3:"M0,.5 L1,.5"},"\u2540":{1:"M0,.5 L1,.5 M.5,.5 L.5,1",3:"M.5,.5 L.5,0"},"\u2541":{1:"M.5,.5 L.5,0 M0,.5 L1,.5",3:"M.5,.5 L.5,1"},"\u2542":{1:"M0,.5 L1,.5",3:"M.5,0 L.5,1"},"\u2543":{1:"M0.5,1 L.5,.5 L1,.5",3:"M.5,0 L.5,.5 L0,.5"},"\u2544":{1:"M0,.5 L.5,.5 L.5,1",3:"M.5,0 L.5,.5 L1,.5"},"\u2545":{1:"M.5,0 L.5,.5 L1,.5",3:"M0,.5 L.5,.5 L.5,1"},"\u2546":{1:"M.5,0 L.5,.5 L0,.5",3:"M0.5,1 L.5,.5 L1,.5"},"\u2547":{1:"M.5,.5 L.5,1",3:"M.5,.5 L.5,0 M0,.5 L1,.5"},"\u2548":{1:"M.5,.5 L.5,0",3:"M0,.5 L1,.5 M.5,.5 L.5,1"},"\u2549":{1:"M.5,.5 L1,.5",3:"M.5,0 L.5,1 M.5,.5 L0,.5"},"\u254A":{1:"M.5,.5 L0,.5",3:"M.5,0 L.5,1 M.5,.5 L1,.5"},"\u254C":{1:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u254D":{3:"M.1,.5 L.4,.5 M.6,.5 L.9,.5"},"\u2504":{1:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2505":{3:"M.0667,.5 L.2667,.5 M.4,.5 L.6,.5 M.7333,.5 L.9333,.5"},"\u2508":{1:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u2509":{3:"M.05,.5 L.2,.5 M.3,.5 L.45,.5 M.55,.5 L.7,.5 M.8,.5 L.95,.5"},"\u254E":{1:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u254F":{3:"M.5,.1 L.5,.4 M.5,.6 L.5,.9"},"\u2506":{1:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u2507":{3:"M.5,.0667 L.5,.2667 M.5,.4 L.5,.6 M.5,.7333 L.5,.9333"},"\u250A":{1:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u250B":{3:"M.5,.05 L.5,.2 M.5,.3 L.5,.45 L.5,.55 M.5,.7 L.5,.95"},"\u256D":{1:(u,a)=>`M.5,1 L.5,${.5+a/.15*.5} C.5,${.5+a/.15*.5},.5,.5,1,.5`},"\u256E":{1:(u,a)=>`M.5,1 L.5,${.5+a/.15*.5} C.5,${.5+a/.15*.5},.5,.5,0,.5`},"\u256F":{1:(u,a)=>`M.5,0 L.5,${.5-a/.15*.5} C.5,${.5-a/.15*.5},.5,.5,0,.5`},"\u2570":{1:(u,a)=>`M.5,0 L.5,${.5-a/.15*.5} C.5,${.5-a/.15*.5},.5,.5,1,.5`}},t.powerlineDefinitions={"\uE0B0":{d:"M0,0 L1,.5 L0,1",type:0,rightPadding:2},"\uE0B1":{d:"M-1,-.5 L1,.5 L-1,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B2":{d:"M1,0 L0,.5 L1,1",type:0,leftPadding:2},"\uE0B3":{d:"M2,-.5 L0,.5 L2,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0B4":{d:"M0,0 L0,1 C0.552,1,1,0.776,1,.5 C1,0.224,0.552,0,0,0",type:0,rightPadding:1},"\uE0B5":{d:"M.2,1 C.422,1,.8,.826,.78,.5 C.8,.174,0.422,0,.2,0",type:1,rightPadding:1},"\uE0B6":{d:"M1,0 L1,1 C0.448,1,0,0.776,0,.5 C0,0.224,0.448,0,1,0",type:0,leftPadding:1},"\uE0B7":{d:"M.8,1 C0.578,1,0.2,.826,.22,.5 C0.2,0.174,0.578,0,0.8,0",type:1,leftPadding:1},"\uE0B8":{d:"M-.5,-.5 L1.5,1.5 L-.5,1.5",type:0},"\uE0B9":{d:"M-.5,-.5 L1.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BA":{d:"M1.5,-.5 L-.5,1.5 L1.5,1.5",type:0},"\uE0BC":{d:"M1.5,-.5 L-.5,1.5 L-.5,-.5",type:0},"\uE0BD":{d:"M1.5,-.5 L-.5,1.5",type:1,leftPadding:1,rightPadding:1},"\uE0BE":{d:"M-.5,-.5 L1.5,1.5 L1.5,-.5",type:0}},t.powerlineDefinitions["\uE0BB"]=t.powerlineDefinitions["\uE0BD"],t.powerlineDefinitions["\uE0BF"]=t.powerlineDefinitions["\uE0B9"],t.tryDrawCustomChar=function(u,a,d,_,p,m,w,b){let S=t.blockElementDefinitions[a];if(S)return function(D,L,T,F,K,N){for(let X=0;X<L.length;X++){let k=L[X],y=K/8,C=N/8;D.fillRect(T+k.x*y,F+k.y*C,k.w*y,k.h*C)}}(u,S,d,_,p,m),!0;let A=g[a];if(A)return function(D,L,T,F,K,N){let X=o.get(L);X||(X=new Map,o.set(L,X));let k=D.fillStyle;if(typeof k!="string")throw new Error(`Unexpected fillStyle type "${k}"`);let y=X.get(k);if(!y){let C=L[0].length,B=L.length,I=D.canvas.ownerDocument.createElement("canvas");I.width=C,I.height=B;let R=(0,h.throwIfFalsy)(I.getContext("2d")),H=new ImageData(C,B),$,q,P,M;if(k.startsWith("#"))$=parseInt(k.slice(1,3),16),q=parseInt(k.slice(3,5),16),P=parseInt(k.slice(5,7),16),M=k.length>7&&parseInt(k.slice(7,9),16)||1;else{if(!k.startsWith("rgba"))throw new Error(`Unexpected fillStyle color format "${k}" when drawing pattern glyph`);[$,q,P,M]=k.substring(5,k.length-1).split(",").map(U=>parseFloat(U))}for(let U=0;U<B;U++)for(let Z=0;Z<C;Z++)H.data[4*(U*C+Z)]=$,H.data[4*(U*C+Z)+1]=q,H.data[4*(U*C+Z)+2]=P,H.data[4*(U*C+Z)+3]=L[U][Z]*(255*M);R.putImageData(H,0,0),y=(0,h.throwIfFalsy)(D.createPattern(I,null)),X.set(k,y)}D.fillStyle=y,D.fillRect(T,F,K,N)}(u,A,d,_,p,m),!0;let x=t.boxDrawingDefinitions[a];if(x)return function(D,L,T,F,K,N,X){D.strokeStyle=D.fillStyle;for(let[k,y]of Object.entries(L)){let C;D.beginPath(),D.lineWidth=X*Number.parseInt(k),C=typeof y=="function"?y(.15,.15/N*K):y;for(let B of C.split(" ")){let I=B[0],R=f[I];if(!R){console.error(`Could not find drawing instructions for "${I}"`);continue}let H=B.substring(1).split(",");H[0]&&H[1]&&R(D,v(H,K,N,T,F,!0,X))}D.stroke(),D.closePath()}}(u,x,d,_,p,m,b),!0;let E=t.powerlineDefinitions[a];return!!E&&(function(D,L,T,F,K,N,X,k){let y=new Path2D;y.rect(T,F,K,N),D.clip(y),D.beginPath();let C=X/12;D.lineWidth=k*C;for(let B of L.d.split(" ")){let I=B[0],R=f[I];if(!R){console.error(`Could not find drawing instructions for "${I}"`);continue}let H=B.substring(1).split(",");H[0]&&H[1]&&R(D,v(H,K,N,T,F,!1,k,(L.leftPadding??0)*(C/2),(L.rightPadding??0)*(C/2)))}L.type===1?(D.strokeStyle=D.fillStyle,D.stroke()):D.fill(),D.closePath()}(u,E,d,_,p,m,w,b),!0)};let o=new Map;function c(u,a,d=0){return Math.max(Math.min(u,a),d)}let f={C:(u,a)=>u.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]),L:(u,a)=>u.lineTo(a[0],a[1]),M:(u,a)=>u.moveTo(a[0],a[1])};function v(u,a,d,_,p,m,w,b=0,S=0){let A=u.map(x=>parseFloat(x)||parseInt(x));if(A.length<2)throw new Error("Too few arguments for instruction");for(let x=0;x<A.length;x+=2)A[x]*=a-b*w-S*w,m&&A[x]!==0&&(A[x]=c(Math.round(A[x]+.5)-.5,a,0)),A[x]+=_+b*w;for(let x=1;x<A.length;x+=2)A[x]*=d,m&&A[x]!==0&&(A[x]=c(Math.round(A[x]+.5)-.5,d,0)),A[x]+=p;return A}},56:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.observeDevicePixelDimensions=void 0;let h=n(859);t.observeDevicePixelDimensions=function(g,o,c){let f=new o.ResizeObserver(v=>{let u=v.find(_=>_.target===g);if(!u)return;if(!("devicePixelContentBoxSize"in u))return f?.disconnect(),void(f=void 0);let a=u.devicePixelContentBoxSize[0].inlineSize,d=u.devicePixelContentBoxSize[0].blockSize;a>0&&d>0&&c(a,d)});try{f.observe(g,{box:["device-pixel-content-box"]})}catch{f.disconnect(),f=void 0}return(0,h.toDisposable)(()=>f?.disconnect())}},374:(l,t)=>{function n(g){return 57508<=g&&g<=57558}function h(g){return g>=128512&&g<=128591||g>=127744&&g<=128511||g>=128640&&g<=128767||g>=9728&&g<=9983||g>=9984&&g<=10175||g>=65024&&g<=65039||g>=129280&&g<=129535||g>=127462&&g<=127487}Object.defineProperty(t,"__esModule",{value:!0}),t.computeNextVariantOffset=t.createRenderDimensions=t.treatGlyphAsBackgroundColor=t.allowRescaling=t.isEmoji=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(g){if(!g)throw new Error("value must not be falsy");return g},t.isPowerlineGlyph=n,t.isRestrictedPowerlineGlyph=function(g){return 57520<=g&&g<=57527},t.isEmoji=h,t.allowRescaling=function(g,o,c,f){return o===1&&c>Math.ceil(1.5*f)&&g!==void 0&&g>255&&!h(g)&&!n(g)&&!function(v){return 57344<=v&&v<=63743}(g)},t.treatGlyphAsBackgroundColor=function(g){return n(g)||function(o){return 9472<=o&&o<=9631}(g)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},t.computeNextVariantOffset=function(g,o,c=0){return(g-(2*Math.round(o)-c))%(2*Math.round(o))}},296:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSelectionRenderModel=void 0;class n{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(g,o,c,f=!1){if(this.selectionStart=o,this.selectionEnd=c,!o||!c||o[0]===c[0]&&o[1]===c[1])return void this.clear();let v=g.buffers.active.ydisp,u=o[1]-v,a=c[1]-v,d=Math.max(u,0),_=Math.min(a,g.rows-1);d>=g.rows||_<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=f,this.viewportStartRow=u,this.viewportEndRow=a,this.viewportCappedStartRow=d,this.viewportCappedEndRow=_,this.startCol=o[0],this.endCol=c[0])}isCellSelected(g,o,c){return!!this.hasSelection&&(c-=g.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?o>=this.startCol&&c>=this.viewportCappedStartRow&&o<this.endCol&&c<=this.viewportCappedEndRow:o<this.startCol&&c>=this.viewportCappedStartRow&&o>=this.endCol&&c<=this.viewportCappedEndRow:c>this.viewportStartRow&&c<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&c===this.viewportStartRow&&o>=this.startCol&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&c===this.viewportEndRow&&o<this.endCol||this.viewportStartRow<this.viewportEndRow&&c===this.viewportStartRow&&o>=this.startCol)}}t.createSelectionRenderModel=function(){return new n}},509:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextureAtlas=void 0;let h=n(237),g=n(860),o=n(374),c=n(160),f=n(345),v=n(485),u=n(385),a=n(147),d=n(855),_={texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},offset:{x:0,y:0},size:{x:0,y:0},sizeClipSpace:{x:0,y:0}},p;class m{get pages(){return this._pages}constructor(x,E,D){this._document=x,this._config=E,this._unicodeService=D,this._didWarmUp=!1,this._cacheMap=new v.FourKeyMap,this._cacheMapCombined=new v.FourKeyMap,this._pages=[],this._activePages=[],this._workBoundingBox={top:0,left:0,bottom:0,right:0},this._workAttributeData=new a.AttributeData,this._textureSize=512,this._onAddTextureAtlasCanvas=new f.EventEmitter,this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=new f.EventEmitter,this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._requestClearModel=!1,this._createNewPage(),this._tmpCanvas=S(x,4*this._config.deviceCellWidth+4,this._config.deviceCellHeight+4),this._tmpCtx=(0,o.throwIfFalsy)(this._tmpCanvas.getContext("2d",{alpha:this._config.allowTransparency,willReadFrequently:!0}))}dispose(){for(let x of this.pages)x.canvas.remove();this._onAddTextureAtlasCanvas.dispose()}warmUp(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)}_doWarmUp(){let x=new u.IdleTaskQueue;for(let E=33;E<126;E++)x.enqueue(()=>{if(!this._cacheMap.get(E,d.DEFAULT_COLOR,d.DEFAULT_COLOR,d.DEFAULT_EXT)){let D=this._drawToCache(E,d.DEFAULT_COLOR,d.DEFAULT_COLOR,d.DEFAULT_EXT);this._cacheMap.set(E,d.DEFAULT_COLOR,d.DEFAULT_COLOR,d.DEFAULT_EXT,D)}})}beginFrame(){return this._requestClearModel}clearTexture(){if(this._pages[0].currentRow.x!==0||this._pages[0].currentRow.y!==0){for(let x of this._pages)x.clear();this._cacheMap.clear(),this._cacheMapCombined.clear(),this._didWarmUp=!1}}_createNewPage(){if(m.maxAtlasPages&&this._pages.length>=Math.max(4,m.maxAtlasPages)){let E=this._pages.filter(X=>2*X.canvas.width<=(m.maxTextureSize||4096)).sort((X,k)=>k.canvas.width!==X.canvas.width?k.canvas.width-X.canvas.width:k.percentageUsed-X.percentageUsed),D=-1,L=0;for(let X=0;X<E.length;X++)if(E[X].canvas.width!==L)D=X,L=E[X].canvas.width;else if(X-D==3)break;let T=E.slice(D,D+4),F=T.map(X=>X.glyphs[0].texturePage).sort((X,k)=>X>k?1:-1),K=this.pages.length-T.length,N=this._mergePages(T,K);N.version++;for(let X=F.length-1;X>=0;X--)this._deletePage(F[X]);this.pages.push(N),this._requestClearModel=!0,this._onAddTextureAtlasCanvas.fire(N.canvas)}let x=new w(this._document,this._textureSize);return this._pages.push(x),this._activePages.push(x),this._onAddTextureAtlasCanvas.fire(x.canvas),x}_mergePages(x,E){let D=2*x[0].canvas.width,L=new w(this._document,D,x);for(let[T,F]of x.entries()){let K=T*F.canvas.width%D,N=Math.floor(T/2)*F.canvas.height;L.ctx.drawImage(F.canvas,K,N);for(let k of F.glyphs)k.texturePage=E,k.sizeClipSpace.x=k.size.x/D,k.sizeClipSpace.y=k.size.y/D,k.texturePosition.x+=K,k.texturePosition.y+=N,k.texturePositionClipSpace.x=k.texturePosition.x/D,k.texturePositionClipSpace.y=k.texturePosition.y/D;this._onRemoveTextureAtlasCanvas.fire(F.canvas);let X=this._activePages.indexOf(F);X!==-1&&this._activePages.splice(X,1)}return L}_deletePage(x){this._pages.splice(x,1);for(let E=x;E<this._pages.length;E++){let D=this._pages[E];for(let L of D.glyphs)L.texturePage--;D.version++}}getRasterizedGlyphCombinedChar(x,E,D,L,T){return this._getFromCacheMap(this._cacheMapCombined,x,E,D,L,T)}getRasterizedGlyph(x,E,D,L,T){return this._getFromCacheMap(this._cacheMap,x,E,D,L,T)}_getFromCacheMap(x,E,D,L,T,F=!1){return p=x.get(E,D,L,T),p||(p=this._drawToCache(E,D,L,T,F),x.set(E,D,L,T,p)),p}_getColorFromAnsiIndex(x){if(x>=this._config.colors.ansi.length)throw new Error("No color found for idx "+x);return this._config.colors.ansi[x]}_getBackgroundColor(x,E,D,L){if(this._config.allowTransparency)return c.NULL_COLOR;let T;switch(x){case 16777216:case 33554432:T=this._getColorFromAnsiIndex(E);break;case 50331648:let F=a.AttributeData.toColorRGB(E);T=c.channels.toColor(F[0],F[1],F[2]);break;default:T=D?c.color.opaque(this._config.colors.foreground):this._config.colors.background}return T}_getForegroundColor(x,E,D,L,T,F,K,N,X,k){let y=this._getMinimumContrastColor(x,E,D,L,T,F,K,X,N,k);if(y)return y;let C;switch(T){case 16777216:case 33554432:this._config.drawBoldTextInBrightColors&&X&&F<8&&(F+=8),C=this._getColorFromAnsiIndex(F);break;case 50331648:let B=a.AttributeData.toColorRGB(F);C=c.channels.toColor(B[0],B[1],B[2]);break;default:C=K?this._config.colors.background:this._config.colors.foreground}return this._config.allowTransparency&&(C=c.color.opaque(C)),N&&(C=c.color.multiplyOpacity(C,h.DIM_OPACITY)),C}_resolveBackgroundRgba(x,E,D){switch(x){case 16777216:case 33554432:return this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return D?this._config.colors.foreground.rgba:this._config.colors.background.rgba}}_resolveForegroundRgba(x,E,D,L){switch(x){case 16777216:case 33554432:return this._config.drawBoldTextInBrightColors&&L&&E<8&&(E+=8),this._getColorFromAnsiIndex(E).rgba;case 50331648:return E<<8;default:return D?this._config.colors.background.rgba:this._config.colors.foreground.rgba}}_getMinimumContrastColor(x,E,D,L,T,F,K,N,X,k){if(this._config.minimumContrastRatio===1||k)return;let y=this._getContrastCache(X),C=y.getColor(x,L);if(C!==void 0)return C||void 0;let B=this._resolveBackgroundRgba(E,D,K),I=this._resolveForegroundRgba(T,F,K,N),R=c.rgba.ensureContrastRatio(B,I,this._config.minimumContrastRatio/(X?2:1));if(!R)return void y.setColor(x,L,null);let H=c.channels.toColor(R>>24&255,R>>16&255,R>>8&255);return y.setColor(x,L,H),H}_getContrastCache(x){return x?this._config.colors.halfContrastCache:this._config.colors.contrastCache}_drawToCache(x,E,D,L,T=!1){let F=typeof x=="number"?String.fromCharCode(x):x,K=Math.min(this._config.deviceCellWidth*Math.max(F.length,2)+4,this._textureSize);this._tmpCanvas.width<K&&(this._tmpCanvas.width=K);let N=Math.min(this._config.deviceCellHeight+8,this._textureSize);if(this._tmpCanvas.height<N&&(this._tmpCanvas.height=N),this._tmpCtx.save(),this._workAttributeData.fg=D,this._workAttributeData.bg=E,this._workAttributeData.extended.ext=L,this._workAttributeData.isInvisible())return _;let X=!!this._workAttributeData.isBold(),k=!!this._workAttributeData.isInverse(),y=!!this._workAttributeData.isDim(),C=!!this._workAttributeData.isItalic(),B=!!this._workAttributeData.isUnderline(),I=!!this._workAttributeData.isStrikethrough(),R=!!this._workAttributeData.isOverline(),H=this._workAttributeData.getFgColor(),$=this._workAttributeData.getFgColorMode(),q=this._workAttributeData.getBgColor(),P=this._workAttributeData.getBgColorMode();if(k){let ie=H;H=q,q=ie;let pe=$;$=P,P=pe}let M=this._getBackgroundColor(P,q,k,y);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=M.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.globalCompositeOperation="source-over";let U=X?this._config.fontWeightBold:this._config.fontWeight,Z=C?"italic":"";this._tmpCtx.font=`${Z} ${U} ${this._config.fontSize*this._config.devicePixelRatio}px ${this._config.fontFamily}`,this._tmpCtx.textBaseline=h.TEXT_BASELINE;let te=F.length===1&&(0,o.isPowerlineGlyph)(F.charCodeAt(0)),ee=F.length===1&&(0,o.isRestrictedPowerlineGlyph)(F.charCodeAt(0)),le=this._getForegroundColor(E,P,q,D,$,H,k,y,X,(0,o.treatGlyphAsBackgroundColor)(F.charCodeAt(0)));this._tmpCtx.fillStyle=le.css;let ne=ee?0:4,ye=!1;this._config.customGlyphs!==!1&&(ye=(0,g.tryDrawCustomChar)(this._tmpCtx,F,ne,ne,this._config.deviceCellWidth,this._config.deviceCellHeight,this._config.fontSize,this._config.devicePixelRatio));let Te,oe=!te;if(Te=typeof x=="number"?this._unicodeService.wcwidth(x):this._unicodeService.getStringCellWidth(x),B){this._tmpCtx.save();let ie=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),pe=ie%2==1?.5:0;if(this._tmpCtx.lineWidth=ie,this._workAttributeData.isUnderlineColorDefault())this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle;else if(this._workAttributeData.isUnderlineColorRGB())oe=!1,this._tmpCtx.strokeStyle=`rgb(${a.AttributeData.toColorRGB(this._workAttributeData.getUnderlineColor()).join(",")})`;else{oe=!1;let Re=this._workAttributeData.getUnderlineColor();this._config.drawBoldTextInBrightColors&&this._workAttributeData.isBold()&&Re<8&&(Re+=8),this._tmpCtx.strokeStyle=this._getColorFromAnsiIndex(Re).css}this._tmpCtx.beginPath();let De=ne,Ce=Math.ceil(ne+this._config.deviceCharHeight)-pe-(T?2*ie:0),wt=Ce+ie,Ge=Ce+2*ie,tt=this._workAttributeData.getUnderlineVariantOffset();for(let Re=0;Re<Te;Re++){this._tmpCtx.save();let Ae=De+Re*this._config.deviceCellWidth,ce=De+(Re+1)*this._config.deviceCellWidth,Fi=Ae+this._config.deviceCellWidth/2;switch(this._workAttributeData.extended.underlineStyle){case 2:this._tmpCtx.moveTo(Ae,Ce),this._tmpCtx.lineTo(ce,Ce),this._tmpCtx.moveTo(Ae,Ge),this._tmpCtx.lineTo(ce,Ge);break;case 3:let Sr=ie<=1?Ge:Math.ceil(ne+this._config.deviceCharHeight-ie/2)-pe,Er=ie<=1?Ce:Math.ceil(ne+this._config.deviceCharHeight+ie/2)-pe,la=new Path2D;la.rect(Ae,Ce,this._config.deviceCellWidth,Ge-Ce),this._tmpCtx.clip(la),this._tmpCtx.moveTo(Ae-this._config.deviceCellWidth/2,wt),this._tmpCtx.bezierCurveTo(Ae-this._config.deviceCellWidth/2,Er,Ae,Er,Ae,wt),this._tmpCtx.bezierCurveTo(Ae,Sr,Fi,Sr,Fi,wt),this._tmpCtx.bezierCurveTo(Fi,Er,ce,Er,ce,wt),this._tmpCtx.bezierCurveTo(ce,Sr,ce+this._config.deviceCellWidth/2,Sr,ce+this._config.deviceCellWidth/2,wt);break;case 4:let kr=tt===0?0:tt>=ie?2*ie-tt:ie-tt;tt>=ie||kr===0?(this._tmpCtx.setLineDash([Math.round(ie),Math.round(ie)]),this._tmpCtx.moveTo(Ae+kr,Ce),this._tmpCtx.lineTo(ce,Ce)):(this._tmpCtx.setLineDash([Math.round(ie),Math.round(ie)]),this._tmpCtx.moveTo(Ae,Ce),this._tmpCtx.lineTo(Ae+kr,Ce),this._tmpCtx.moveTo(Ae+kr+ie,Ce),this._tmpCtx.lineTo(ce,Ce)),tt=(0,o.computeNextVariantOffset)(ce-Ae,ie,tt);break;case 5:let Bd=.6,Ld=.3,en=ce-Ae,ha=Math.floor(Bd*en),ca=Math.floor(Ld*en),Dd=en-ha-ca;this._tmpCtx.setLineDash([ha,ca,Dd]),this._tmpCtx.moveTo(Ae,Ce),this._tmpCtx.lineTo(ce,Ce);break;default:this._tmpCtx.moveTo(Ae,Ce),this._tmpCtx.lineTo(ce,Ce)}this._tmpCtx.stroke(),this._tmpCtx.restore()}if(this._tmpCtx.restore(),!ye&&this._config.fontSize>=12&&!this._config.allowTransparency&&F!==" "){this._tmpCtx.save(),this._tmpCtx.textBaseline="alphabetic";let Re=this._tmpCtx.measureText(F);if(this._tmpCtx.restore(),"actualBoundingBoxDescent"in Re&&Re.actualBoundingBoxDescent>0){this._tmpCtx.save();let Ae=new Path2D;Ae.rect(De,Ce-Math.ceil(ie/2),this._config.deviceCellWidth*Te,Ge-Ce+Math.ceil(ie/2)),this._tmpCtx.clip(Ae),this._tmpCtx.lineWidth=3*this._config.devicePixelRatio,this._tmpCtx.strokeStyle=M.css,this._tmpCtx.strokeText(F,ne,ne+this._config.deviceCharHeight),this._tmpCtx.restore()}}}if(R){let ie=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/15)),pe=ie%2==1?.5:0;this._tmpCtx.lineWidth=ie,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(ne,ne+pe),this._tmpCtx.lineTo(ne+this._config.deviceCharWidth*Te,ne+pe),this._tmpCtx.stroke()}if(ye||this._tmpCtx.fillText(F,ne,ne+this._config.deviceCharHeight),F==="_"&&!this._config.allowTransparency){let ie=b(this._tmpCtx.getImageData(ne,ne,this._config.deviceCellWidth,this._config.deviceCellHeight),M,le,oe);if(ie)for(let pe=1;pe<=5&&(this._tmpCtx.save(),this._tmpCtx.fillStyle=M.css,this._tmpCtx.fillRect(0,0,this._tmpCanvas.width,this._tmpCanvas.height),this._tmpCtx.restore(),this._tmpCtx.fillText(F,ne,ne+this._config.deviceCharHeight-pe),ie=b(this._tmpCtx.getImageData(ne,ne,this._config.deviceCellWidth,this._config.deviceCellHeight),M,le,oe),ie);pe++);}if(I){let ie=Math.max(1,Math.floor(this._config.fontSize*this._config.devicePixelRatio/10)),pe=this._tmpCtx.lineWidth%2==1?.5:0;this._tmpCtx.lineWidth=ie,this._tmpCtx.strokeStyle=this._tmpCtx.fillStyle,this._tmpCtx.beginPath(),this._tmpCtx.moveTo(ne,ne+Math.floor(this._config.deviceCharHeight/2)-pe),this._tmpCtx.lineTo(ne+this._config.deviceCharWidth*Te,ne+Math.floor(this._config.deviceCharHeight/2)-pe),this._tmpCtx.stroke()}this._tmpCtx.restore();let dt=this._tmpCtx.getImageData(0,0,this._tmpCanvas.width,this._tmpCanvas.height),hi;if(hi=this._config.allowTransparency?function(ie){for(let pe=0;pe<ie.data.length;pe+=4)if(ie.data[pe+3]>0)return!1;return!0}(dt):b(dt,M,le,oe),hi)return _;let ve=this._findGlyphBoundingBox(dt,this._workBoundingBox,K,ee,ye,ne),ue,de;for(;;){if(this._activePages.length===0){let ie=this._createNewPage();ue=ie,de=ie.currentRow,de.height=ve.size.y;break}ue=this._activePages[this._activePages.length-1],de=ue.currentRow;for(let ie of this._activePages)ve.size.y<=ie.currentRow.height&&(ue=ie,de=ie.currentRow);for(let ie=this._activePages.length-1;ie>=0;ie--)for(let pe of this._activePages[ie].fixedRows)pe.height<=de.height&&ve.size.y<=pe.height&&(ue=this._activePages[ie],de=pe);if(de.y+ve.size.y>=ue.canvas.height||de.height>ve.size.y+2){let ie=!1;if(ue.currentRow.y+ue.currentRow.height+ve.size.y>=ue.canvas.height){let pe;for(let De of this._activePages)if(De.currentRow.y+De.currentRow.height+ve.size.y<De.canvas.height){pe=De;break}if(pe)ue=pe;else if(m.maxAtlasPages&&this._pages.length>=m.maxAtlasPages&&de.y+ve.size.y<=ue.canvas.height&&de.height>=ve.size.y&&de.x+ve.size.x<=ue.canvas.width)ie=!0;else{let De=this._createNewPage();ue=De,de=De.currentRow,de.height=ve.size.y,ie=!0}}ie||(ue.currentRow.height>0&&ue.fixedRows.push(ue.currentRow),de={x:0,y:ue.currentRow.y+ue.currentRow.height,height:ve.size.y},ue.fixedRows.push(de),ue.currentRow={x:0,y:de.y+de.height,height:0})}if(de.x+ve.size.x<=ue.canvas.width)break;de===ue.currentRow?(de.x=0,de.y+=de.height,de.height=0):ue.fixedRows.splice(ue.fixedRows.indexOf(de),1)}return ve.texturePage=this._pages.indexOf(ue),ve.texturePosition.x=de.x,ve.texturePosition.y=de.y,ve.texturePositionClipSpace.x=de.x/ue.canvas.width,ve.texturePositionClipSpace.y=de.y/ue.canvas.height,ve.sizeClipSpace.x/=ue.canvas.width,ve.sizeClipSpace.y/=ue.canvas.height,de.height=Math.max(de.height,ve.size.y),de.x+=ve.size.x,ue.ctx.putImageData(dt,ve.texturePosition.x-this._workBoundingBox.left,ve.texturePosition.y-this._workBoundingBox.top,this._workBoundingBox.left,this._workBoundingBox.top,ve.size.x,ve.size.y),ue.addGlyph(ve),ue.version++,ve}_findGlyphBoundingBox(x,E,D,L,T,F){E.top=0;let K=L?this._config.deviceCellHeight:this._tmpCanvas.height,N=L?this._config.deviceCellWidth:D,X=!1;for(let k=0;k<K;k++){for(let y=0;y<N;y++){let C=k*this._tmpCanvas.width*4+4*y+3;if(x.data[C]!==0){E.top=k,X=!0;break}}if(X)break}E.left=0,X=!1;for(let k=0;k<F+N;k++){for(let y=0;y<K;y++){let C=y*this._tmpCanvas.width*4+4*k+3;if(x.data[C]!==0){E.left=k,X=!0;break}}if(X)break}E.right=N,X=!1;for(let k=F+N-1;k>=F;k--){for(let y=0;y<K;y++){let C=y*this._tmpCanvas.width*4+4*k+3;if(x.data[C]!==0){E.right=k,X=!0;break}}if(X)break}E.bottom=K,X=!1;for(let k=K-1;k>=0;k--){for(let y=0;y<N;y++){let C=k*this._tmpCanvas.width*4+4*y+3;if(x.data[C]!==0){E.bottom=k,X=!0;break}}if(X)break}return{texturePage:0,texturePosition:{x:0,y:0},texturePositionClipSpace:{x:0,y:0},size:{x:E.right-E.left+1,y:E.bottom-E.top+1},sizeClipSpace:{x:E.right-E.left+1,y:E.bottom-E.top+1},offset:{x:-E.left+F+(L||T?Math.floor((this._config.deviceCellWidth-this._config.deviceCharWidth)/2):0),y:-E.top+F+(L||T?this._config.lineHeight===1?0:Math.round((this._config.deviceCellHeight-this._config.deviceCharHeight)/2):0)}}}}t.TextureAtlas=m;class w{get percentageUsed(){return this._usedPixels/(this.canvas.width*this.canvas.height)}get glyphs(){return this._glyphs}addGlyph(x){this._glyphs.push(x),this._usedPixels+=x.size.x*x.size.y}constructor(x,E,D){if(this._usedPixels=0,this._glyphs=[],this.version=0,this.currentRow={x:0,y:0,height:0},this.fixedRows=[],D)for(let L of D)this._glyphs.push(...L.glyphs),this._usedPixels+=L._usedPixels;this.canvas=S(x,E,E),this.ctx=(0,o.throwIfFalsy)(this.canvas.getContext("2d",{alpha:!0}))}clear(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.currentRow.x=0,this.currentRow.y=0,this.currentRow.height=0,this.fixedRows.length=0,this.version++}}function b(A,x,E,D){let L=x.rgba>>>24,T=x.rgba>>>16&255,F=x.rgba>>>8&255,K=E.rgba>>>24,N=E.rgba>>>16&255,X=E.rgba>>>8&255,k=Math.floor((Math.abs(L-K)+Math.abs(T-N)+Math.abs(F-X))/12),y=!0;for(let C=0;C<A.data.length;C+=4)A.data[C]===L&&A.data[C+1]===T&&A.data[C+2]===F||D&&Math.abs(A.data[C]-L)+Math.abs(A.data[C+1]-T)+Math.abs(A.data[C+2]-F)<k?A.data[C+3]=0:y=!1;return y}function S(A,x,E){let D=A.createElement("canvas");return D.width=x,D.height=E,D}},160:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;let n=0,h=0,g=0,o=0;var c,f,v,u,a;function d(p){let m=p.toString(16);return m.length<2?"0"+m:m}function _(p,m){return p<m?(m+.05)/(p+.05):(p+.05)/(m+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(p){p.toCss=function(m,w,b,S){return S!==void 0?`#${d(m)}${d(w)}${d(b)}${d(S)}`:`#${d(m)}${d(w)}${d(b)}`},p.toRgba=function(m,w,b,S=255){return(m<<24|w<<16|b<<8|S)>>>0},p.toColor=function(m,w,b,S){return{css:p.toCss(m,w,b,S),rgba:p.toRgba(m,w,b,S)}}}(c||(t.channels=c={})),function(p){function m(w,b){return o=Math.round(255*b),[n,h,g]=a.toChannels(w.rgba),{css:c.toCss(n,h,g,o),rgba:c.toRgba(n,h,g,o)}}p.blend=function(w,b){if(o=(255&b.rgba)/255,o===1)return{css:b.css,rgba:b.rgba};let S=b.rgba>>24&255,A=b.rgba>>16&255,x=b.rgba>>8&255,E=w.rgba>>24&255,D=w.rgba>>16&255,L=w.rgba>>8&255;return n=E+Math.round((S-E)*o),h=D+Math.round((A-D)*o),g=L+Math.round((x-L)*o),{css:c.toCss(n,h,g),rgba:c.toRgba(n,h,g)}},p.isOpaque=function(w){return(255&w.rgba)==255},p.ensureContrastRatio=function(w,b,S){let A=a.ensureContrastRatio(w.rgba,b.rgba,S);if(A)return c.toColor(A>>24&255,A>>16&255,A>>8&255)},p.opaque=function(w){let b=(255|w.rgba)>>>0;return[n,h,g]=a.toChannels(b),{css:c.toCss(n,h,g),rgba:b}},p.opacity=m,p.multiplyOpacity=function(w,b){return o=255&w.rgba,m(w,o*b/255)},p.toColorRGB=function(w){return[w.rgba>>24&255,w.rgba>>16&255,w.rgba>>8&255]}}(f||(t.color=f={})),function(p){let m,w;try{let b=document.createElement("canvas");b.width=1,b.height=1;let S=b.getContext("2d",{willReadFrequently:!0});S&&(m=S,m.globalCompositeOperation="copy",w=m.createLinearGradient(0,0,1,1))}catch{}p.toColor=function(b){if(b.match(/#[\da-f]{3,8}/i))switch(b.length){case 4:return n=parseInt(b.slice(1,2).repeat(2),16),h=parseInt(b.slice(2,3).repeat(2),16),g=parseInt(b.slice(3,4).repeat(2),16),c.toColor(n,h,g);case 5:return n=parseInt(b.slice(1,2).repeat(2),16),h=parseInt(b.slice(2,3).repeat(2),16),g=parseInt(b.slice(3,4).repeat(2),16),o=parseInt(b.slice(4,5).repeat(2),16),c.toColor(n,h,g,o);case 7:return{css:b,rgba:(parseInt(b.slice(1),16)<<8|255)>>>0};case 9:return{css:b,rgba:parseInt(b.slice(1),16)>>>0}}let S=b.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return n=parseInt(S[1]),h=parseInt(S[2]),g=parseInt(S[3]),o=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),c.toColor(n,h,g,o);if(!m||!w)throw new Error("css.toColor: Unsupported css format");if(m.fillStyle=w,m.fillStyle=b,typeof m.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(m.fillRect(0,0,1,1),[n,h,g,o]=m.getImageData(0,0,1,1).data,o!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:c.toRgba(n,h,g,o),css:b}}}(v||(t.css=v={})),function(p){function m(w,b,S){let A=w/255,x=b/255,E=S/255;return .2126*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))+.7152*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.0722*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))}p.relativeLuminance=function(w){return m(w>>16&255,w>>8&255,255&w)},p.relativeLuminance2=m}(u||(t.rgb=u={})),function(p){function m(b,S,A){let x=b>>24&255,E=b>>16&255,D=b>>8&255,L=S>>24&255,T=S>>16&255,F=S>>8&255,K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));for(;K<A&&(L>0||T>0||F>0);)L-=Math.max(0,Math.ceil(.1*L)),T-=Math.max(0,Math.ceil(.1*T)),F-=Math.max(0,Math.ceil(.1*F)),K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));return(L<<24|T<<16|F<<8|255)>>>0}function w(b,S,A){let x=b>>24&255,E=b>>16&255,D=b>>8&255,L=S>>24&255,T=S>>16&255,F=S>>8&255,K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));for(;K<A&&(L<255||T<255||F<255);)L=Math.min(255,L+Math.ceil(.1*(255-L))),T=Math.min(255,T+Math.ceil(.1*(255-T))),F=Math.min(255,F+Math.ceil(.1*(255-F))),K=_(u.relativeLuminance2(L,T,F),u.relativeLuminance2(x,E,D));return(L<<24|T<<16|F<<8|255)>>>0}p.blend=function(b,S){if(o=(255&S)/255,o===1)return S;let A=S>>24&255,x=S>>16&255,E=S>>8&255,D=b>>24&255,L=b>>16&255,T=b>>8&255;return n=D+Math.round((A-D)*o),h=L+Math.round((x-L)*o),g=T+Math.round((E-T)*o),c.toRgba(n,h,g)},p.ensureContrastRatio=function(b,S,A){let x=u.relativeLuminance(b>>8),E=u.relativeLuminance(S>>8);if(_(x,E)<A){if(E<x){let T=m(b,S,A),F=_(x,u.relativeLuminance(T>>8));if(F<A){let K=w(b,S,A);return F>_(x,u.relativeLuminance(K>>8))?T:K}return T}let D=w(b,S,A),L=_(x,u.relativeLuminance(D>>8));if(L<A){let T=m(b,S,A);return L>_(x,u.relativeLuminance(T>>8))?D:T}return D}},p.reduceLuminance=m,p.increaseLuminance=w,p.toChannels=function(b){return[b>>24&255,b>>16&255,b>>8&255,255&b]}}(a||(t.rgba=a={})),t.toPaddedHex=d,t.contrastRatio=_},345:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===n)return void this._listeners.splice(h,1)}}})),this._event}fire(n,h){let g=[];for(let o=0;o<this._listeners.length;o++)g.push(this._listeners[o]);for(let o=0;o<g.length;o++)g[o].call(void 0,n,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(n,h){return n(g=>h.fire(g))},t.runAndSubscribe=function(n,h){return h(void 0),n(g=>h(g))}},859:(l,t)=>{function n(h){for(let g of h)g.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let g=this._disposables.indexOf(h);g!==-1&&this._disposables.splice(g,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){this._isDisposed||h===this._value||(this._value?.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=n,t.getDisposeArrayDisposable=function(h){return{dispose:()=>n(h)}}},485:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class n{constructor(){this._data={}}set(g,o,c){this._data[g]||(this._data[g]={}),this._data[g][o]=c}get(g,o){return this._data[g]?this._data[g][o]:void 0}clear(){this._data={}}}t.TwoKeyMap=n,t.FourKeyMap=class{constructor(){this._data=new n}set(h,g,o,c,f){this._data.get(h,g)||this._data.set(h,g,new n),this._data.get(h,g).set(o,c,f)}get(h,g,o,c){return this._data.get(h,g)?.get(o,c)}clear(){this._data.clear()}}},399:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof process<"u"&&"title"in process;let n=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=n.includes("Firefox"),t.isLegacyEdge=n.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(n),t.getSafariVersion=function(){if(!t.isSafari)return 0;let g=n.match(/Version\/(\d+)/);return g===null||g.length<2?0:parseInt(g[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(n)},385:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;let h=n(399);class g{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let v=0,u=0,a=f.timeRemaining(),d=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),u=Math.max(v,u),d=f.timeRemaining(),1.5*u>d)return a-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(a-v))}ms`),void this._start();a=d}this.clear()}}class o extends g{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){let v=Date.now()+f;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}t.PriorityTaskQueue=o,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends g{_requestCallback(c){return requestIdleCallback(c)}_cancelCallback(c){cancelIdleCallback(c)}}:o,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(c){this._queue.clear(),this._queue.enqueue(c)}flush(){this._queue.flush()}}},147:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class n{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(o){return[o>>>16&255,o>>>8&255,255&o]}static fromColorRGB(o){return(255&o[0])<<16|(255&o[1])<<8|255&o[2]}clone(){let o=new n;return o.fg=this.fg,o.bg=this.bg,o.extended=this.extended.clone(),o}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}t.AttributeData=n;class h{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(o){this._ext=o}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(o){this._ext&=-469762049,this._ext|=o<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(o){this._ext&=-67108864,this._ext|=67108863&o}get urlId(){return this._urlId}set urlId(o){this._urlId=o}get underlineVariantOffset(){let o=(3758096384&this._ext)>>29;return o<0?4294967288^o:o}set underlineVariantOffset(o){this._ext&=536870911,this._ext|=o<<29&3758096384}constructor(o=0,c=0){this._ext=0,this._urlId=0,this._ext=o,this._urlId=c}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},782:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;let h=n(133),g=n(855),o=n(147);class c extends o.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new o.ExtendedAttrs,this.combinedData=""}static fromCharData(v){let u=new c;return u.setFromCharData(v),u}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[g.CHAR_DATA_ATTR_INDEX],this.bg=0;let u=!1;if(v[g.CHAR_DATA_CHAR_INDEX].length>2)u=!0;else if(v[g.CHAR_DATA_CHAR_INDEX].length===2){let a=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=a&&a<=56319){let d=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=d&&d<=57343?this.content=1024*(a-55296)+d-56320+65536|v[g.CHAR_DATA_WIDTH_INDEX]<<22:u=!0}else u=!0}else this.content=v[g.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[g.CHAR_DATA_WIDTH_INDEX]<<22;u&&(this.combinedData=v[g.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[g.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=c},855:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},133:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(n){return n>65535?(n-=65536,String.fromCharCode(55296+(n>>10))+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)},t.utf32ToString=function(n,h=0,g=n.length){let o="";for(let c=h;c<g;++c){let f=n[c];f>65535?(f-=65536,o+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):o+=String.fromCharCode(f)}return o},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(n,h){let g=n.length;if(!g)return 0;let o=0,c=0;if(this._interim){let f=n.charCodeAt(c++);56320<=f&&f<=57343?h[o++]=1024*(this._interim-55296)+f-56320+65536:(h[o++]=this._interim,h[o++]=f),this._interim=0}for(let f=c;f<g;++f){let v=n.charCodeAt(f);if(55296<=v&&v<=56319){if(++f>=g)return this._interim=v,o;let u=n.charCodeAt(f);56320<=u&&u<=57343?h[o++]=1024*(v-55296)+u-56320+65536:(h[o++]=v,h[o++]=u)}else v!==65279&&(h[o++]=v)}return o}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(n,h){let g=n.length;if(!g)return 0;let o,c,f,v,u=0,a=0,d=0;if(this.interim[0]){let m=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let b,S=0;for(;(b=63&this.interim[++S])&&S<4;)w<<=6,w|=b;let A=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,x=A-S;for(;d<x;){if(d>=g)return 0;if(b=n[d++],(192&b)!=128){d--,m=!0;break}this.interim[S++]=b,w<<=6,w|=63&b}m||(A===2?w<128?d--:h[u++]=w:A===3?w<2048||w>=55296&&w<=57343||w===65279||(h[u++]=w):w<65536||w>1114111||(h[u++]=w)),this.interim.fill(0)}let _=g-4,p=d;for(;p<g;){for(;!(!(p<_)||128&(o=n[p])||128&(c=n[p+1])||128&(f=n[p+2])||128&(v=n[p+3]));)h[u++]=o,h[u++]=c,h[u++]=f,h[u++]=v,p+=4;if(o=n[p++],o<128)h[u++]=o;else if((224&o)==192){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(a=(31&o)<<6|63&c,a<128){p--;continue}h[u++]=a}else if((240&o)==224){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,u;if(f=n[p++],(192&f)!=128){p--;continue}if(a=(15&o)<<12|(63&c)<<6|63&f,a<2048||a>=55296&&a<=57343||a===65279)continue;h[u++]=a}else if((248&o)==240){if(p>=g)return this.interim[0]=o,u;if(c=n[p++],(192&c)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,u;if(f=n[p++],(192&f)!=128){p--;continue}if(p>=g)return this.interim[0]=o,this.interim[1]=c,this.interim[2]=f,u;if(v=n[p++],(192&v)!=128){p--;continue}if(a=(7&o)<<18|(63&c)<<12|(63&f)<<6|63&v,a<65536||a>1114111)continue;h[u++]=a}}return u}}},776:function(l,t,n){var h=this&&this.__decorate||function(a,d,_,p){var m,w=arguments.length,b=w<3?d:p===null?p=Object.getOwnPropertyDescriptor(d,_):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(a,d,_,p);else for(var S=a.length-1;S>=0;S--)(m=a[S])&&(b=(w<3?m(b):w>3?m(d,_,b):m(d,_))||b);return w>3&&b&&Object.defineProperty(d,_,b),b},g=this&&this.__param||function(a,d){return function(_,p){d(_,p,a)}};Object.defineProperty(t,"__esModule",{value:!0}),t.traceCall=t.setTraceLogger=t.LogService=void 0;let o=n(859),c=n(97),f={trace:c.LogLevelEnum.TRACE,debug:c.LogLevelEnum.DEBUG,info:c.LogLevelEnum.INFO,warn:c.LogLevelEnum.WARN,error:c.LogLevelEnum.ERROR,off:c.LogLevelEnum.OFF},v,u=t.LogService=class extends o.Disposable{get logLevel(){return this._logLevel}constructor(a){super(),this._optionsService=a,this._logLevel=c.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),v=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(a){for(let d=0;d<a.length;d++)typeof a[d]=="function"&&(a[d]=a[d]())}_log(a,d,_){this._evalLazyOptionalParams(_),a.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+d,..._)}trace(a,...d){this._logLevel<=c.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,a,d)}debug(a,...d){this._logLevel<=c.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,a,d)}info(a,...d){this._logLevel<=c.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,a,d)}warn(a,...d){this._logLevel<=c.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,a,d)}error(a,...d){this._logLevel<=c.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,a,d)}};t.LogService=u=h([g(0,c.IOptionsService)],u),t.setTraceLogger=function(a){v=a},t.traceCall=function(a,d,_){if(typeof _.value!="function")throw new Error("not supported");let p=_.value;_.value=function(...m){if(v.logLevel!==c.LogLevelEnum.TRACE)return p.apply(this,m);v.trace(`GlyphRenderer#${p.name}(${m.map(b=>JSON.stringify(b)).join(", ")})`);let w=p.apply(this,m);return v.trace(`GlyphRenderer#${p.name} return`,w),w}}},726:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0;let n="di$target",h="di$dependencies";t.serviceRegistry=new Map,t.getServiceDependencies=function(g){return g[h]||[]},t.createDecorator=function(g){if(t.serviceRegistry.has(g))return t.serviceRegistry.get(g);let o=function(c,f,v){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(u,a,d){a[n]===a?a[h].push({id:u,index:d}):(a[h]=[{id:u,index:d}],a[n]=a)})(o,c,v)};return o.toString=()=>g,t.serviceRegistry.set(g,o),o}},97:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;let h=n(726);var g;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),function(o){o[o.TRACE=0]="TRACE",o[o.DEBUG=1]="DEBUG",o[o.INFO=2]="INFO",o[o.WARN=3]="WARN",o[o.ERROR=4]="ERROR",o[o.OFF=5]="OFF"}(g||(t.LogLevelEnum=g={})),t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l].call(n.exports,n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.WebglAddon=void 0;let t=r(345),n=r(859),h=r(399),g=r(666),o=r(776);class c extends n.Disposable{constructor(v){if(h.isSafari&&(0,h.getSafariVersion)()<16){let u={antialias:!1,depth:!1,preserveDrawingBuffer:!0};if(!document.createElement("canvas").getContext("webgl2",u))throw new Error("Webgl2 is only supported on Safari 16 and above")}super(),this._preserveDrawingBuffer=v,this._onChangeTextureAtlas=this.register(new t.EventEmitter),this.onChangeTextureAtlas=this._onChangeTextureAtlas.event,this._onAddTextureAtlasCanvas=this.register(new t.EventEmitter),this.onAddTextureAtlasCanvas=this._onAddTextureAtlasCanvas.event,this._onRemoveTextureAtlasCanvas=this.register(new t.EventEmitter),this.onRemoveTextureAtlasCanvas=this._onRemoveTextureAtlasCanvas.event,this._onContextLoss=this.register(new t.EventEmitter),this.onContextLoss=this._onContextLoss.event}activate(v){let u=v._core;if(!v.element)return void this.register(u.onWillOpen(()=>this.activate(v)));this._terminal=v;let a=u.coreService,d=u.optionsService,_=u,p=_._renderService,m=_._characterJoinerService,w=_._charSizeService,b=_._coreBrowserService,S=_._decorationService,A=_._logService,x=_._themeService;(0,o.setTraceLogger)(A),this._renderer=this.register(new g.WebglRenderer(v,m,w,b,a,S,d,x,this._preserveDrawingBuffer)),this.register((0,t.forwardEvent)(this._renderer.onContextLoss,this._onContextLoss)),this.register((0,t.forwardEvent)(this._renderer.onChangeTextureAtlas,this._onChangeTextureAtlas)),this.register((0,t.forwardEvent)(this._renderer.onAddTextureAtlasCanvas,this._onAddTextureAtlasCanvas)),this.register((0,t.forwardEvent)(this._renderer.onRemoveTextureAtlasCanvas,this._onRemoveTextureAtlasCanvas)),p.setRenderer(this._renderer),this.register((0,n.toDisposable)(()=>{let E=this._terminal._core._renderService;E.setRenderer(this._terminal._core._createRenderer()),E.handleResize(v.cols,v.rows)}))}get textureAtlas(){return this._renderer?.textureAtlas}clearTextureAtlas(){this._renderer?.clearTextureAtlas()}}l.WebglAddon=c})(),s})())});var Vu=se((Gs,Vo)=>{(function(e,i){typeof Gs=="object"&&typeof Vo=="object"?Vo.exports=i():typeof define=="function"&&define.amd?define([],i):typeof Gs=="object"?Gs.WebLinksAddon=i():e.WebLinksAddon=i()})(self,()=>(()=>{"use strict";var e={6:(l,t)=>{function n(g){try{let o=new URL(g),c=o.password&&o.username?`${o.protocol}//${o.username}:${o.password}@${o.host}`:o.username?`${o.protocol}//${o.username}@${o.host}`:`${o.protocol}//${o.host}`;return g.toLocaleLowerCase().startsWith(c.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(t,"__esModule",{value:!0}),t.LinkComputer=t.WebLinkProvider=void 0,t.WebLinkProvider=class{constructor(g,o,c,f={}){this._terminal=g,this._regex=o,this._handler=c,this._options=f}provideLinks(g,o){let c=h.computeLink(g,this._regex,this._terminal,this._handler);o(this._addCallbacks(c))}_addCallbacks(g){return g.map(o=>(o.leave=this._options.leave,o.hover=(c,f)=>{if(this._options.hover){let{range:v}=o;this._options.hover(c,f,v)}},o))}};class h{static computeLink(o,c,f,v){let u=new RegExp(c.source,(c.flags||"")+"g"),[a,d]=h._getWindowedLineStrings(o-1,f),_=a.join(""),p,m=[];for(;p=u.exec(_);){let w=p[0];if(!n(w))continue;let[b,S]=h._mapStrIdx(f,d,0,p.index),[A,x]=h._mapStrIdx(f,b,S,w.length);if(b===-1||S===-1||A===-1||x===-1)continue;let E={start:{x:S+1,y:b+1},end:{x,y:A+1}};m.push({range:E,text:w,activate:v})}return m}static _getWindowedLineStrings(o,c){let f,v=o,u=o,a=0,d="",_=[];if(f=c.buffer.active.getLine(o)){let p=f.translateToString(!0);if(f.isWrapped&&p[0]!==" "){for(a=0;(f=c.buffer.active.getLine(--v))&&a<2048&&(d=f.translateToString(!0),a+=d.length,_.push(d),f.isWrapped&&d.indexOf(" ")===-1););_.reverse()}for(_.push(p),a=0;(f=c.buffer.active.getLine(++u))&&f.isWrapped&&a<2048&&(d=f.translateToString(!0),a+=d.length,_.push(d),d.indexOf(" ")===-1););}return[_,v]}static _mapStrIdx(o,c,f,v){let u=o.buffer.active,a=u.getNullCell(),d=f;for(;v;){let _=u.getLine(c);if(!_)return[-1,-1];for(let p=d;p<_.length;++p){_.getCell(p,a);let m=a.getChars();if(a.getWidth()&&(v-=m.length||1,p===_.length-1&&m==="")){let w=u.getLine(c+1);w&&w.isWrapped&&(w.getCell(0,a),a.getWidth()===2&&(v+=1))}if(v<0)return[c,p]}c++,d=0}return[c,d]}}t.LinkComputer=h}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l](n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.WebLinksAddon=void 0;let t=r(6),n=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function h(g,o){let c=window.open();if(c){try{c.opener=null}catch{}c.location.href=o}else console.warn("Opening link blocked as opener could not be cleared")}l.WebLinksAddon=class{constructor(g=h,o={}){this._handler=g,this._options=o}activate(g){this._terminal=g;let o=this._options,c=o.urlRegex||n;this._linkProvider=this._terminal.registerLinkProvider(new t.WebLinkProvider(this._terminal,c,this._handler,o))}dispose(){this._linkProvider?.dispose()}}})(),s})())});var Yu=se((Cr,Yo)=>{(function(e,i){typeof Cr=="object"&&typeof Yo=="object"?Yo.exports=i():typeof define=="function"&&define.amd?define([],i):typeof Cr=="object"?Cr.Unicode11Addon=i():e.Unicode11Addon=i()})(Cr,()=>(()=>{"use strict";var e={433:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV11=void 0;let h=n(938),g=[[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1541],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1757],[1759,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2045,2045],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2259,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2558,2558],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2902,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3076,3076],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6158],[6277,6278],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6846],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7673],[7675,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43204,43205],[43232,43249],[43263,43263],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43453],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531]],o=[[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[68900,68903],[69446,69456],[69633,69633],[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69821,69821],[69837,69837],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70089,70092],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70367,70367],[70371,70378],[70400,70401],[70459,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70750,70750],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[71727,71735],[71737,71738],[72148,72151],[72154,72155],[72160,72160],[72193,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[73104,73105],[73109,73109],[73111,73111],[73459,73460],[78896,78904],[92912,92916],[92976,92982],[94031,94031],[94095,94098],[113821,113822],[113824,113827],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[123184,123190],[123628,123631],[125136,125142],[125252,125258],[917505,917505],[917536,917631],[917760,917999]],c=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,11929],[11931,12019],[12032,12245],[12272,12283],[12288,12329],[12334,12350],[12353,12438],[12443,12543],[12549,12591],[12593,12686],[12688,12730],[12736,12771],[12784,12830],[12832,12871],[12880,19903],[19968,42124],[42128,42182],[43360,43388],[44032,55203],[63744,64255],[65040,65049],[65072,65106],[65108,65126],[65128,65131],[65281,65376],[65504,65510]],f=[[94176,94179],[94208,100343],[100352,101106],[110592,110878],[110928,110930],[110948,110951],[110960,111355],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128725,128725],[128747,128748],[128756,128762],[128992,129003],[129293,129393],[129395,129398],[129402,129442],[129445,129450],[129454,129482],[129485,129535],[129648,129651],[129656,129658],[129664,129666],[129680,129685],[131072,196605],[196608,262141]],v;function u(a,d){let _,p=0,m=d.length-1;if(a<d[0][0]||a>d[m][1])return!1;for(;m>=p;)if(_=p+m>>1,a>d[_][1])p=_+1;else{if(!(a<d[_][0]))return!0;m=_-1}return!1}t.UnicodeV11=class{constructor(){if(this.version="11",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160);for(let a=0;a<g.length;++a)v.fill(0,g[a][0],g[a][1]+1);for(let a=0;a<c.length;++a)v.fill(2,c[a][0],c[a][1]+1)}}wcwidth(a){return a<32?0:a<127?1:a<65536?v[a]:u(a,o)?0:u(a,f)?2:1}charProperties(a,d){let _=this.wcwidth(a),p=_===0&&d!==0;if(p){let m=h.UnicodeService.extractWidth(d);m===0?p=!1:m>_&&(_=m)}return h.UnicodeService.createPropertyValue(0,_,p)}}},345:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===n)return void this._listeners.splice(h,1)}}})),this._event}fire(n,h){let g=[];for(let o=0;o<this._listeners.length;o++)g.push(this._listeners[o]);for(let o=0;o<g.length;o++)g[o].call(void 0,n,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(n,h){return n(g=>h.fire(g))},t.runAndSubscribe=function(n,h){return h(void 0),n(g=>h(g))}},490:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;let h=n(938),g=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],o=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],c;t.UnicodeV6=class{constructor(){if(this.version="6",!c){c=new Uint8Array(65536),c.fill(1),c[0]=0,c.fill(0,1,32),c.fill(0,127,160),c.fill(2,4352,4448),c[9001]=2,c[9002]=2,c.fill(2,11904,42192),c[12351]=1,c.fill(2,44032,55204),c.fill(2,63744,64256),c.fill(2,65040,65050),c.fill(2,65072,65136),c.fill(2,65280,65377),c.fill(2,65504,65511);for(let f=0;f<g.length;++f)c.fill(0,g[f][0],g[f][1]+1)}}wcwidth(f){return f<32?0:f<127?1:f<65536?c[f]:function(v,u){let a,d=0,_=u.length-1;if(v<u[0][0]||v>u[_][1])return!1;for(;_>=d;)if(a=d+_>>1,v>u[a][1])d=a+1;else{if(!(v<u[a][0]))return!0;_=a-1}return!1}(f,o)?0:f>=131072&&f<=196605||f>=196608&&f<=262141?2:1}charProperties(f,v){let u=this.wcwidth(f),a=u===0&&v!==0;if(a){let d=h.UnicodeService.extractWidth(v);d===0?a=!1:d>u&&(u=d)}return h.UnicodeService.createPropertyValue(0,u,a)}}},938:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;let h=n(345),g=n(490);class o{static extractShouldJoin(f){return(1&f)!=0}static extractWidth(f){return f>>1&3}static extractCharKind(f){return f>>3}static createPropertyValue(f,v,u=!1){return(16777215&f)<<3|(3&v)<<1|(u?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;let f=new g.UnicodeV6;this.register(f),this._active=f.version,this._activeProvider=f}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(f){if(!this._providers[f])throw new Error(`unknown Unicode version "${f}"`);this._active=f,this._activeProvider=this._providers[f],this._onChange.fire(f)}register(f){this._providers[f.version]=f}wcwidth(f){return this._activeProvider.wcwidth(f)}getStringCellWidth(f){let v=0,u=0,a=f.length;for(let d=0;d<a;++d){let _=f.charCodeAt(d);if(55296<=_&&_<=56319){if(++d>=a)return v+this.wcwidth(_);let w=f.charCodeAt(d);56320<=w&&w<=57343?_=1024*(_-55296)+w-56320+65536:v+=this.wcwidth(w)}let p=this.charProperties(_,u),m=o.extractWidth(p);o.extractShouldJoin(p)&&(m-=o.extractWidth(u)),v+=m,u=p}return v}charProperties(f,v){return this._activeProvider.charProperties(f,v)}}t.UnicodeService=o}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l](n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.Unicode11Addon=void 0;let t=r(433);l.Unicode11Addon=class{activate(n){n.unicode.register(new t.UnicodeV11)}dispose(){}}})(),s})())});var Ju=se((qs,Jo)=>{(function(e,i){typeof qs=="object"&&typeof Jo=="object"?Jo.exports=i():typeof define=="function"&&define.amd?define([],i):typeof qs=="object"?qs.AttachAddon=i():e.AttachAddon=i()})(self,()=>(()=>{"use strict";var e={};return(()=>{var i=e;function r(s,l,t){return s.addEventListener(l,t),{dispose:()=>{t&&s.removeEventListener(l,t)}}}Object.defineProperty(i,"__esModule",{value:!0}),i.AttachAddon=void 0,i.AttachAddon=class{constructor(s,l){this._disposables=[],this._socket=s,this._socket.binaryType="arraybuffer",this._bidirectional=!(l&&l.bidirectional===!1)}activate(s){this._disposables.push(r(this._socket,"message",l=>{let t=l.data;s.write(typeof t=="string"?t:new Uint8Array(t))})),this._bidirectional&&(this._disposables.push(s.onData(l=>this._sendData(l))),this._disposables.push(s.onBinary(l=>this._sendBinary(l)))),this._disposables.push(r(this._socket,"close",()=>this.dispose())),this._disposables.push(r(this._socket,"error",()=>this.dispose()))}dispose(){for(let s of this._disposables)s.dispose()}_sendData(s){this._checkOpenSocket()&&this._socket.send(s)}_sendBinary(s){if(!this._checkOpenSocket())return;let l=new Uint8Array(s.length);for(let t=0;t<s.length;++t)l[t]=255&s.charCodeAt(t);this._socket.send(l)}_checkOpenSocket(){switch(this._socket.readyState){case WebSocket.OPEN:return!0;case WebSocket.CONNECTING:throw new Error("Attach addon was loaded before socket was open");case WebSocket.CLOSING:return console.warn("Attach addon socket is closing"),!1;case WebSocket.CLOSED:throw new Error("Attach addon socket is closed");default:throw new Error("Unexpected socket state")}}}})(),e})())});var Zu=se((Vs,Zo)=>{(function(e,i){typeof Vs=="object"&&typeof Zo=="object"?Zo.exports=i():typeof define=="function"&&define.amd?define([],i):typeof Vs=="object"?Vs.SearchAddon=i():e.SearchAddon=i()})(self,()=>(()=>{"use strict";var e={345:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.runAndSubscribe=t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=n=>(this._listeners.push(n),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===n)return void this._listeners.splice(h,1)}}})),this._event}fire(n,h){let g=[];for(let o=0;o<this._listeners.length;o++)g.push(this._listeners[o]);for(let o=0;o<g.length;o++)g[o].call(void 0,n,h)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},t.forwardEvent=function(n,h){return n(g=>h.fire(g))},t.runAndSubscribe=function(n,h){return h(void 0),n(g=>h(g))}},859:(l,t)=>{function n(h){for(let g of h)g.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let g=this._disposables.indexOf(h);g!==-1&&this._disposables.splice(g,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){this._isDisposed||h===this._value||(this._value?.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=n,t.getDisposeArrayDisposable=function(h){return{dispose:()=>n(h)}}}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l](n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.SearchAddon=void 0;let t=r(345),n=r(859),h=" ~!@#$%^&*()+`-=[]{}|\\;:\"',./<>?";class g extends n.Disposable{constructor(c){super(),this._highlightedLines=new Set,this._highlightDecorations=[],this._selectedDecoration=this.register(new n.MutableDisposable),this._linesCacheTimeoutId=0,this._linesCacheDisposables=new n.MutableDisposable,this._onDidChangeResults=this.register(new t.EventEmitter),this.onDidChangeResults=this._onDidChangeResults.event,this._highlightLimit=c?.highlightLimit??1e3}activate(c){this._terminal=c,this.register(this._terminal.onWriteParsed(()=>this._updateMatches())),this.register(this._terminal.onResize(()=>this._updateMatches())),this.register((0,n.toDisposable)(()=>this.clearDecorations()))}_updateMatches(){this._highlightTimeout&&window.clearTimeout(this._highlightTimeout),this._cachedSearchTerm&&this._lastSearchOptions?.decorations&&(this._highlightTimeout=setTimeout(()=>{let c=this._cachedSearchTerm;this._cachedSearchTerm=void 0,this.findPrevious(c,{...this._lastSearchOptions,incremental:!0,noScroll:!0})},200))}clearDecorations(c){this._selectedDecoration.clear(),(0,n.disposeArray)(this._highlightDecorations),this._highlightDecorations=[],this._highlightedLines.clear(),c||(this._cachedSearchTerm=void 0)}clearActiveDecoration(){this._selectedDecoration.clear()}findNext(c,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let v=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,f);this._lastSearchOptions=f,f?.decorations&&(this._cachedSearchTerm===void 0||c!==this._cachedSearchTerm||v)&&this._highlightAllMatches(c,f);let u=this._findNextAndSelect(c,f);return this._fireResults(f),this._cachedSearchTerm=c,u}_highlightAllMatches(c,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!c||c.length===0)return void this.clearDecorations();f=f||{},this.clearDecorations(!0);let v=[],u,a=this._find(c,0,0,f);for(;a&&(u?.row!==a.row||u?.col!==a.col)&&!(v.length>=this._highlightLimit);)u=a,v.push(u),a=this._find(c,u.col+u.term.length>=this._terminal.cols?u.row+1:u.row,u.col+u.term.length>=this._terminal.cols?0:u.col+1,f);for(let d of v){let _=this._createResultDecoration(d,f.decorations);_&&(this._highlightedLines.add(_.marker.line),this._highlightDecorations.push({decoration:_,match:d,dispose(){_.dispose()}}))}}_find(c,f,v,u){if(!this._terminal||!c||c.length===0)return this._terminal?.clearSelection(),void this.clearDecorations();if(v>this._terminal.cols)throw new Error(`Invalid col: ${v} to search in terminal of ${this._terminal.cols} cols`);let a;this._initLinesCache();let d={startRow:f,startCol:v};if(a=this._findInLine(c,d,u),!a)for(let _=f+1;_<this._terminal.buffer.active.baseY+this._terminal.rows&&(d.startRow=_,d.startCol=0,a=this._findInLine(c,d,u),!a);_++);return a}_findNextAndSelect(c,f){if(!this._terminal||!c||c.length===0)return this._terminal?.clearSelection(),this.clearDecorations(),!1;let v=this._terminal.getSelectionPosition();this._terminal.clearSelection();let u=0,a=0;v&&(this._cachedSearchTerm===c?(u=v.end.x,a=v.end.y):(u=v.start.x,a=v.start.y)),this._initLinesCache();let d={startRow:a,startCol:u},_=this._findInLine(c,d,f);if(!_)for(let p=a+1;p<this._terminal.buffer.active.baseY+this._terminal.rows&&(d.startRow=p,d.startCol=0,_=this._findInLine(c,d,f),!_);p++);if(!_&&a!==0)for(let p=0;p<a&&(d.startRow=p,d.startCol=0,_=this._findInLine(c,d,f),!_);p++);return!_&&v&&(d.startRow=v.start.y,d.startCol=0,_=this._findInLine(c,d,f)),this._selectResult(_,f?.decorations,f?.noScroll)}findPrevious(c,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");let v=!this._lastSearchOptions||this._didOptionsChange(this._lastSearchOptions,f);this._lastSearchOptions=f,f?.decorations&&(this._cachedSearchTerm===void 0||c!==this._cachedSearchTerm||v)&&this._highlightAllMatches(c,f);let u=this._findPreviousAndSelect(c,f);return this._fireResults(f),this._cachedSearchTerm=c,u}_didOptionsChange(c,f){return!!f&&(c.caseSensitive!==f.caseSensitive||c.regex!==f.regex||c.wholeWord!==f.wholeWord)}_fireResults(c){if(c?.decorations){let f=-1;if(this._selectedDecoration.value){let v=this._selectedDecoration.value.match;for(let u=0;u<this._highlightDecorations.length;u++){let a=this._highlightDecorations[u].match;if(a.row===v.row&&a.col===v.col&&a.size===v.size){f=u;break}}}this._onDidChangeResults.fire({resultIndex:f,resultCount:this._highlightDecorations.length})}}_findPreviousAndSelect(c,f){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!this._terminal||!c||c.length===0)return this._terminal?.clearSelection(),this.clearDecorations(),!1;let v=this._terminal.getSelectionPosition();this._terminal.clearSelection();let u=this._terminal.buffer.active.baseY+this._terminal.rows-1,a=this._terminal.cols,d=!0;this._initLinesCache();let _={startRow:u,startCol:a},p;if(v&&(_.startRow=u=v.start.y,_.startCol=a=v.start.x,this._cachedSearchTerm!==c&&(p=this._findInLine(c,_,f,!1),p||(_.startRow=u=v.end.y,_.startCol=a=v.end.x))),p||(p=this._findInLine(c,_,f,d)),!p){_.startCol=Math.max(_.startCol,this._terminal.cols);for(let m=u-1;m>=0&&(_.startRow=m,p=this._findInLine(c,_,f,d),!p);m--);}if(!p&&u!==this._terminal.buffer.active.baseY+this._terminal.rows-1)for(let m=this._terminal.buffer.active.baseY+this._terminal.rows-1;m>=u&&(_.startRow=m,p=this._findInLine(c,_,f,d),!p);m--);return this._selectResult(p,f?.decorations,f?.noScroll)}_initLinesCache(){let c=this._terminal;this._linesCache||(this._linesCache=new Array(c.buffer.active.length),this._linesCacheDisposables.value=(0,n.getDisposeArrayDisposable)([c.onLineFeed(()=>this._destroyLinesCache()),c.onCursorMove(()=>this._destroyLinesCache()),c.onResize(()=>this._destroyLinesCache())])),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(()=>this._destroyLinesCache(),15e3)}_destroyLinesCache(){this._linesCache=void 0,this._linesCacheDisposables.clear(),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)}_isWholeWord(c,f,v){return(c===0||h.includes(f[c-1]))&&(c+v.length===f.length||h.includes(f[c+v.length]))}_findInLine(c,f,v={},u=!1){let a=this._terminal,d=f.startRow,_=f.startCol;if(a.buffer.active.getLine(d)?.isWrapped)return u?void(f.startCol+=a.cols):(f.startRow--,f.startCol+=a.cols,this._findInLine(c,f,v));let m=this._linesCache?.[d];m||(m=this._translateBufferLineToStringWithWrap(d,!0),this._linesCache&&(this._linesCache[d]=m));let[w,b]=m,S=this._bufferColsToStringOffset(d,_),A=v.caseSensitive?c:c.toLowerCase(),x=v.caseSensitive?w:w.toLowerCase(),E=-1;if(v.regex){let D=RegExp(A,"g"),L;if(u)for(;L=D.exec(x.slice(0,S));)E=D.lastIndex-L[0].length,c=L[0],D.lastIndex-=c.length-1;else L=D.exec(x.slice(S)),L&&L[0].length>0&&(E=S+(D.lastIndex-L[0].length),c=L[0])}else u?S-A.length>=0&&(E=x.lastIndexOf(A,S-A.length)):E=x.indexOf(A,S);if(E>=0){if(v.wholeWord&&!this._isWholeWord(E,x,c))return;let D=0;for(;D<b.length-1&&E>=b[D+1];)D++;let L=D;for(;L<b.length-1&&E+c.length>=b[L+1];)L++;let T=E-b[D],F=E+c.length-b[L],K=this._stringLengthToBufferSize(d+D,T);return{term:c,col:K,row:d+D,size:this._stringLengthToBufferSize(d+L,F)-K+a.cols*(L-D)}}}_stringLengthToBufferSize(c,f){let v=this._terminal.buffer.active.getLine(c);if(!v)return 0;for(let u=0;u<f;u++){let a=v.getCell(u);if(!a)break;let d=a.getChars();d.length>1&&(f-=d.length-1);let _=v.getCell(u+1);_&&_.getWidth()===0&&f++}return f}_bufferColsToStringOffset(c,f){let v=this._terminal,u=c,a=0,d=v.buffer.active.getLine(u);for(;f>0&&d;){for(let _=0;_<f&&_<v.cols;_++){let p=d.getCell(_);if(!p)break;p.getWidth()&&(a+=p.getCode()===0?1:p.getChars().length)}if(u++,d=v.buffer.active.getLine(u),d&&!d.isWrapped)break;f-=v.cols}return a}_translateBufferLineToStringWithWrap(c,f){let v=this._terminal,u=[],a=[0],d=v.buffer.active.getLine(c);for(;d;){let _=v.buffer.active.getLine(c+1),p=!!_&&_.isWrapped,m=d.translateToString(!p&&f);if(p&&_){let w=d.getCell(d.length-1);w&&w.getCode()===0&&w.getWidth()===1&&_.getCell(0)?.getWidth()===2&&(m=m.slice(0,-1))}if(u.push(m),!p)break;a.push(a[a.length-1]+m.length),c++,d=_}return[u.join(""),a]}_selectResult(c,f,v){let u=this._terminal;if(this._selectedDecoration.clear(),!c)return u.clearSelection(),!1;if(u.select(c.col,c.row,c.size),f){let a=u.registerMarker(-u.buffer.active.baseY-u.buffer.active.cursorY+c.row);if(a){let d=u.registerDecoration({marker:a,x:c.col,width:c.size,backgroundColor:f.activeMatchBackground,layer:"top",overviewRulerOptions:{color:f.activeMatchColorOverviewRuler}});if(d){let _=[];_.push(a),_.push(d.onRender(p=>this._applyStyles(p,f.activeMatchBorder,!0))),_.push(d.onDispose(()=>(0,n.disposeArray)(_))),this._selectedDecoration.value={decoration:d,match:c,dispose(){d.dispose()}}}}}if(!v&&(c.row>=u.buffer.active.viewportY+u.rows||c.row<u.buffer.active.viewportY)){let a=c.row-u.buffer.active.viewportY;a-=Math.floor(u.rows/2),u.scrollLines(a)}return!0}_applyStyles(c,f,v){c.classList.contains("xterm-find-result-decoration")||(c.classList.add("xterm-find-result-decoration"),f&&(c.style.outline=`1px solid ${f}`)),v&&c.classList.add("xterm-find-active-result-decoration")}_createResultDecoration(c,f){let v=this._terminal,u=v.registerMarker(-v.buffer.active.baseY-v.buffer.active.cursorY+c.row);if(!u)return;let a=v.registerDecoration({marker:u,x:c.col,width:c.size,backgroundColor:f.matchBackground,overviewRulerOptions:this._highlightedLines.has(u.line)?void 0:{color:f.matchOverviewRuler,position:"center"}});if(a){let d=[];d.push(u),d.push(a.onRender(_=>this._applyStyles(_,f.matchBorder,!1))),d.push(a.onDispose(()=>(0,n.disposeArray)(d)))}return a}}l.SearchAddon=g})(),s})())});var ed=se((Ys,ea)=>{(function(e,i){typeof Ys=="object"&&typeof ea=="object"?ea.exports=i():typeof define=="function"&&define.amd?define([],i):typeof Ys=="object"?Ys.ImageAddon=i():e.ImageAddon=i()})(self,()=>(()=>{"use strict";var e={615:(l,t)=>{function n(h){if(typeof Buffer<"u")return Buffer.from(h,"base64");let g=atob(h),o=new Uint8Array(g.length);for(let c=0;c<o.length;++c)o[c]=g.charCodeAt(c);return o}Object.defineProperty(t,"__esModule",{value:!0}),t.InWasm=void 0,t.InWasm=function(h){if(h.d){let{t:g,s:o,d:c}=h,f,v,u=WebAssembly;return g===2?o?()=>f||(f=n(c)):()=>Promise.resolve(f||(f=n(c))):g===1?o?()=>v||(v=new u.Module(f||(f=n(c)))):()=>v?Promise.resolve(v):u.compile(f||(f=n(c))).then(a=>v=a):o?a=>new u.Instance(v||(v=new u.Module(f||(f=n(c)))),a):a=>v?u.instantiate(v,a):u.instantiate(f||(f=n(c)),a).then(d=>(v=d.module)&&d.instance)}if(typeof _wasmCtx>"u")throw new Error('must run "inwasm"');_wasmCtx.add(h)}},477:(l,t)=>{function n(u){return 255&u}function h(u){return u>>>8&255}function g(u){return u>>>16&255}function o(u,a,d,_=255){return((255&_)<<24|(255&d)<<16|(255&a)<<8|255&u)>>>0}function c(u,a,d){return Math.max(u,Math.min(d,a))}function f(u,a,d){return d<0&&(d+=1),d>1&&(d-=1),6*d<1?a+6*(u-a)*d:2*d<1?u:3*d<2?a+(u-a)*(4-6*d):a}function v(u,a,d){return(4278190080|Math.round(d/100*255)<<16|Math.round(a/100*255)<<8|Math.round(u/100*255))>>>0}Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_FOREGROUND=t.DEFAULT_BACKGROUND=t.PALETTE_ANSI_256=t.PALETTE_VT340_GREY=t.PALETTE_VT340_COLOR=t.normalizeHLS=t.normalizeRGB=t.nearestColorIndex=t.fromRGBA8888=t.toRGBA8888=t.alpha=t.blue=t.green=t.red=t.BIG_ENDIAN=void 0,t.BIG_ENDIAN=new Uint8Array(new Uint32Array([4278190080]).buffer)[0]===255,t.BIG_ENDIAN&&console.warn("BE platform detected. This version of node-sixel works only on LE properly."),t.red=n,t.green=h,t.blue=g,t.alpha=function(u){return u>>>24&255},t.toRGBA8888=o,t.fromRGBA8888=function(u){return[255&u,u>>8&255,u>>16&255,u>>>24]},t.nearestColorIndex=function(u,a){let d=n(u),_=h(u),p=g(u),m=Number.MAX_SAFE_INTEGER,w=-1;for(let b=0;b<a.length;++b){let S=d-a[b][0],A=_-a[b][1],x=p-a[b][2],E=S*S+A*A+x*x;if(!E)return b;E<m&&(m=E,w=b)}return w},t.normalizeRGB=v,t.normalizeHLS=function(u,a,d){return function(_,p,m){if(!m){let S=Math.round(255*p);return o(S,S,S)}let w=p<.5?p*(1+m):p+m-p*m,b=2*p-w;return o(c(0,255,Math.round(255*f(w,b,_+.3333333333333333))),c(0,255,Math.round(255*f(w,b,_))),c(0,255,Math.round(255*f(w,b,_-.3333333333333333))))}((u+240)/360,a/100,d/100)},t.PALETTE_VT340_COLOR=new Uint32Array([v(0,0,0),v(20,20,80),v(80,13,13),v(20,80,20),v(80,20,80),v(20,80,80),v(80,80,20),v(53,53,53),v(26,26,26),v(33,33,60),v(60,26,26),v(33,60,33),v(60,33,60),v(33,60,60),v(60,60,33),v(80,80,80)]),t.PALETTE_VT340_GREY=new Uint32Array([v(0,0,0),v(13,13,13),v(26,26,26),v(40,40,40),v(6,6,6),v(20,20,20),v(33,33,33),v(46,46,46),v(0,0,0),v(13,13,13),v(26,26,26),v(40,40,40),v(6,6,6),v(20,20,20),v(33,33,33),v(46,46,46)]),t.PALETTE_ANSI_256=(()=>{let u=[o(0,0,0),o(205,0,0),o(0,205,0),o(205,205,0),o(0,0,238),o(205,0,205),o(0,250,205),o(229,229,229),o(127,127,127),o(255,0,0),o(0,255,0),o(255,255,0),o(92,92,255),o(255,0,255),o(0,255,255),o(255,255,255)],a=[0,95,135,175,215,255];for(let d=0;d<6;++d)for(let _=0;_<6;++_)for(let p=0;p<6;++p)u.push(o(a[d],a[_],a[p]));for(let d=8;d<=238;d+=10)u.push(o(d,d,d));return new Uint32Array(u)})(),t.DEFAULT_BACKGROUND=o(0,0,0,255),t.DEFAULT_FOREGROUND=o(255,255,255,255)},710:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.decodeAsync=t.decode=t.Decoder=t.DecoderAsync=void 0;let h=n(477),g=n(343),o=function(_){if(typeof Buffer<"u")return Buffer.from(_,"base64");let p=atob(_),m=new Uint8Array(p.length);for(let w=0;w<m.length;++w)m[w]=p.charCodeAt(w);return m}(g.LIMITS.BYTES),c,f=new Uint32Array;class v{constructor(){this.bandHandler=p=>1,this.modeHandler=p=>1}handle_band(p){return this.bandHandler(p)}mode_parsed(p){return this.modeHandler(p)}}let u={memoryLimit:134217728,sixelColor:h.DEFAULT_FOREGROUND,fillColor:h.DEFAULT_BACKGROUND,palette:h.PALETTE_VT340_COLOR,paletteLimit:g.LIMITS.PALETTE_SIZE,truncate:!0};function a(_){let p=new v,m={env:{handle_band:p.handle_band.bind(p),mode_parsed:p.mode_parsed.bind(p)}};return WebAssembly.instantiate(c||o,m).then(w=>(c=c||w.module,new d(_,w.instance||w,p)))}t.DecoderAsync=a;class d{constructor(p,m,w){if(this._PIXEL_OFFSET=g.LIMITS.MAX_WIDTH+4,this._canvas=f,this._bandWidths=[],this._maxWidth=0,this._minWidth=g.LIMITS.MAX_WIDTH,this._lastOffset=0,this._currentHeight=0,this._opts=Object.assign({},u,p),this._opts.paletteLimit>g.LIMITS.PALETTE_SIZE)throw new Error(`DecoderOptions.paletteLimit must not exceed ${g.LIMITS.PALETTE_SIZE}`);if(m)w.bandHandler=this._handle_band.bind(this),w.modeHandler=this._initCanvas.bind(this);else{let b=c||(c=new WebAssembly.Module(o));m=new WebAssembly.Instance(b,{env:{handle_band:this._handle_band.bind(this),mode_parsed:this._initCanvas.bind(this)}})}this._instance=m,this._wasm=this._instance.exports,this._chunk=new Uint8Array(this._wasm.memory.buffer,this._wasm.get_chunk_address(),g.LIMITS.CHUNK_SIZE),this._states=new Uint32Array(this._wasm.memory.buffer,this._wasm.get_state_address(),12),this._palette=new Uint32Array(this._wasm.memory.buffer,this._wasm.get_palette_address(),g.LIMITS.PALETTE_SIZE),this._palette.set(this._opts.palette),this._pSrc=new Uint32Array(this._wasm.memory.buffer,this._wasm.get_p0_address()),this._wasm.init(h.DEFAULT_FOREGROUND,0,this._opts.paletteLimit,0)}get _fillColor(){return this._states[0]}get _truncate(){return this._states[8]}get _rasterWidth(){return this._states[6]}get _rasterHeight(){return this._states[7]}get _width(){return this._states[2]?this._states[2]-4:0}get _height(){return this._states[3]}get _level(){return this._states[9]}get _mode(){return this._states[10]}get _paletteLimit(){return this._states[11]}_initCanvas(p){if(p===2){let m=this.width*this.height;if(m>this._canvas.length){if(this._opts.memoryLimit&&4*m>this._opts.memoryLimit)throw this.release(),new Error("image exceeds memory limit");this._canvas=new Uint32Array(m)}this._maxWidth=this._width}else if(p===1)if(this._level===2){let m=Math.min(this._rasterWidth,g.LIMITS.MAX_WIDTH)*this._rasterHeight;if(m>this._canvas.length){if(this._opts.memoryLimit&&4*m>this._opts.memoryLimit)throw this.release(),new Error("image exceeds memory limit");this._canvas=new Uint32Array(m)}}else this._canvas.length<65536&&(this._canvas=new Uint32Array(65536));return 0}_realloc(p,m){let w=p+m;if(w>this._canvas.length){if(this._opts.memoryLimit&&4*w>this._opts.memoryLimit)throw this.release(),new Error("image exceeds memory limit");let b=new Uint32Array(65536*Math.ceil(w/65536));b.set(this._canvas),this._canvas=b}}_handle_band(p){let m=this._PIXEL_OFFSET,w=this._lastOffset;if(this._mode===2){let b=this.height-this._currentHeight,S=0;for(;S<6&&b>0;)this._canvas.set(this._pSrc.subarray(m*S,m*S+p),w+p*S),S++,b--;this._lastOffset+=p*S,this._currentHeight+=S}else if(this._mode===1){this._realloc(w,6*p),this._maxWidth=Math.max(this._maxWidth,p),this._minWidth=Math.min(this._minWidth,p);for(let b=0;b<6;++b)this._canvas.set(this._pSrc.subarray(m*b,m*b+p),w+p*b);this._bandWidths.push(p),this._lastOffset+=6*p,this._currentHeight+=6}return 0}get width(){return this._mode!==1?this._width:Math.max(this._maxWidth,this._wasm.current_width())}get height(){return this._mode!==1?this._height:this._wasm.current_width()?6*this._bandWidths.length+this._wasm.current_height():6*this._bandWidths.length}get palette(){return this._palette.subarray(0,this._paletteLimit)}get memoryUsage(){return this._canvas.byteLength+this._wasm.memory.buffer.byteLength+8*this._bandWidths.length}get properties(){return{width:this.width,height:this.height,mode:this._mode,level:this._level,truncate:!!this._truncate,paletteLimit:this._paletteLimit,fillColor:this._fillColor,memUsage:this.memoryUsage,rasterAttributes:{numerator:this._states[4],denominator:this._states[5],width:this._rasterWidth,height:this._rasterHeight}}}init(p=this._opts.fillColor,m=this._opts.palette,w=this._opts.paletteLimit,b=this._opts.truncate){this._wasm.init(this._opts.sixelColor,p,w,b?1:0),m&&this._palette.set(m.subarray(0,g.LIMITS.PALETTE_SIZE)),this._bandWidths.length=0,this._maxWidth=0,this._minWidth=g.LIMITS.MAX_WIDTH,this._lastOffset=0,this._currentHeight=0}decode(p,m=0,w=p.length){let b=m;for(;b<w;){let S=Math.min(w-b,g.LIMITS.CHUNK_SIZE);this._chunk.set(p.subarray(b,b+=S)),this._wasm.decode(0,S)}}decodeString(p,m=0,w=p.length){let b=m;for(;b<w;){let S=Math.min(w-b,g.LIMITS.CHUNK_SIZE);for(let A=0,x=b;A<S;++A,++x)this._chunk[A]=p.charCodeAt(x);b+=S,this._wasm.decode(0,S)}}get data32(){if(this._mode===0||!this.width||!this.height)return f;let p=this._wasm.current_width();if(this._mode===2){let m=this.height-this._currentHeight;if(m>0){let w=this._PIXEL_OFFSET,b=this._lastOffset,S=0;for(;S<6&&m>0;)this._canvas.set(this._pSrc.subarray(w*S,w*S+p),b+p*S),S++,m--;m&&this._canvas.fill(this._fillColor,b+p*S)}return this._canvas.subarray(0,this.width*this.height)}if(this._mode===1){if(this._minWidth===this._maxWidth){let S=!1;if(p)if(p!==this._minWidth)S=!0;else{let A=this._PIXEL_OFFSET,x=this._lastOffset;this._realloc(x,6*p);for(let E=0;E<6;++E)this._canvas.set(this._pSrc.subarray(A*E,A*E+p),x+p*E)}if(!S)return this._canvas.subarray(0,this.width*this.height)}let m=new Uint32Array(this.width*this.height);m.fill(this._fillColor);let w=0,b=0;for(let S=0;S<this._bandWidths.length;++S){let A=this._bandWidths[S];for(let x=0;x<6;++x)m.set(this._canvas.subarray(b,b+=A),w),w+=this.width}if(p){let S=this._PIXEL_OFFSET,A=this._wasm.current_height();for(let x=0;x<A;++x)m.set(this._pSrc.subarray(S*x,S*x+p),w+this.width*x)}return m}return f}get data8(){return new Uint8ClampedArray(this.data32.buffer,0,this.width*this.height*4)}release(){this._canvas=f,this._bandWidths.length=0,this._maxWidth=0,this._minWidth=g.LIMITS.MAX_WIDTH,this._wasm.init(h.DEFAULT_FOREGROUND,0,this._opts.paletteLimit,0)}}t.Decoder=d,t.decode=function(_,p){let m=new d(p);return m.init(),typeof _=="string"?m.decodeString(_):m.decode(_),{width:m.width,height:m.height,data32:m.data32,data8:m.data8}},t.decodeAsync=async function(_,p){let m=await a(p);return m.init(),typeof _=="string"?m.decodeString(_):m.decode(_),{width:m.width,height:m.height,data32:m.data32,data8:m.data8}}},343:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LIMITS=void 0,t.LIMITS={CHUNK_SIZE:16384,PALETTE_SIZE:4096,MAX_WIDTH:16384,BYTES:"AGFzbQEAAAABJAdgAAF/YAJ/fwBgA39/fwF/YAF/AX9gAABgBH9/f38AYAF/AAIlAgNlbnYLaGFuZGxlX2JhbmQAAwNlbnYLbW9kZV9wYXJzZWQAAwMTEgQAAAAAAQQBAQUBAAACAgAGAwQFAXABBwcFBAEBBwcGCAF/AUGAihoLB9wBDgZtZW1vcnkCABFnZXRfc3RhdGVfYWRkcmVzcwADEWdldF9jaHVua19hZGRyZXNzAAQOZ2V0X3AwX2FkZHJlc3MABRNnZXRfcGFsZXR0ZV9hZGRyZXNzAAYEaW5pdAALBmRlY29kZQAMDWN1cnJlbnRfd2lkdGgADQ5jdXJyZW50X2hlaWdodAAOGV9faW5kaXJlY3RfZnVuY3Rpb25fdGFibGUBAAtfaW5pdGlhbGl6ZQACCXN0YWNrU2F2ZQARDHN0YWNrUmVzdG9yZQASCnN0YWNrQWxsb2MAEwkMAQBBAQsGCgcJDxACDAEBCq5UEgMAAQsFAEGgCAsGAEGQiQELBgBBsIkCCwUAQZAJC+okAQh/QeQIKAIAIQVB4AgoAgAhA0HoCCgCACEIIAFBkIkBaiIJQf8BOgAAIAAgAUgEQCAAQZCJAWohBgNAIAMhBCAGQQFqIQECQCAGLQAAQf8AcSIDQTBrQQlLBEAgASEGDAELQewIKAIAQQJ0QewIaiICKAIAIQADQCACIAMgAEEKbGpBMGsiADYCACABLQAAIQMgAUEBaiIGIQEgA0H/AHEiA0Ewa0EKSQ0ACwsCQAJAAkACQAJAAkACQAJ/AkACQCADQT9rIgBBP00EQCAERQ0BIARBIUYEQAJAQfAIKAIAIgFBASABGyIHIAhqIgFB1AgoAgAiA0gNACADQf//AEoNAANAIANBAnQiAkGgiQJqIgRBoAgpAwA3AwAgAkGoiQJqQaAIKQMANwMAIAJBsIkCakGgCCkDADcDACACQbiJAmpBoAgpAwA3AwAgAkHAiQJqQaAIKQMANwMAIAJByIkCakGgCCkDADcDACACQdCJAmpBoAgpAwA3AwAgAkHYiQJqQaAIKQMANwMAIAJB4IkCakGgCCkDADcDACACQeiJAmpBoAgpAwA3AwAgAkHwiQJqQaAIKQMANwMAIAJB+IkCakGgCCkDADcDACACQYCKAmpBoAgpAwA3AwAgAkGIigJqQaAIKQMANwMAIAJBkIoCakGgCCkDADcDACACQZiKAmpBoAgpAwA3AwAgAkGgigJqQaAIKQMANwMAIAJBqIoCakGgCCkDADcDACACQbCKAmpBoAgpAwA3AwAgAkG4igJqQaAIKQMANwMAIAJBwIoCakGgCCkDADcDACACQciKAmpBoAgpAwA3AwAgAkHQigJqQaAIKQMANwMAIAJB2IoCakGgCCkDADcDACACQeCKAmpBoAgpAwA3AwAgAkHoigJqQaAIKQMANwMAIAJB8IoCakGgCCkDADcDACACQfiKAmpBoAgpAwA3AwAgAkGAiwJqQaAIKQMANwMAIAJBiIsCakGgCCkDADcDACACQZCLAmpBoAgpAwA3AwAgAkGYiwJqQaAIKQMANwMAIAJBoIsCakGgCCkDADcDACACQaiLAmpBoAgpAwA3AwAgAkGwiwJqQaAIKQMANwMAIAJBuIsCakGgCCkDADcDACACQcCLAmpBoAgpAwA3AwAgAkHIiwJqQaAIKQMANwMAIAJB0IsCakGgCCkDADcDACACQdiLAmpBoAgpAwA3AwAgAkHgiwJqQaAIKQMANwMAIAJB6IsCakGgCCkDADcDACACQfCLAmpBoAgpAwA3AwAgAkH4iwJqQaAIKQMANwMAIAJBgIwCakGgCCkDADcDACACQYiMAmpBoAgpAwA3AwAgAkGQjAJqQaAIKQMANwMAIAJBmIwCakGgCCkDADcDACACQaCMAmpBoAgpAwA3AwAgAkGojAJqQaAIKQMANwMAIAJBsIwCakGgCCkDADcDACACQbiMAmpBoAgpAwA3AwAgAkHAjAJqQaAIKQMANwMAIAJByIwCakGgCCkDADcDACACQdCMAmpBoAgpAwA3AwAgAkHYjAJqQaAIKQMANwMAIAJB4IwCakGgCCkDADcDACACQeiMAmpBoAgpAwA3AwAgAkHwjAJqQaAIKQMANwMAIAJB+IwCakGgCCkDADcDACACQYCNAmpBoAgpAwA3AwAgAkGIjQJqQaAIKQMANwMAIAJBkI0CakGgCCkDADcDACACQZiNAmpBoAgpAwA3AwAgAkGwiQZqIARBgAT8CgAAQdQIKAIAQQJ0QcCJCmogBEGABPwKAABB1AgoAgBBAnRB0IkOaiAEQYAE/AoAAEHUCCgCAEECdEHgiRJqIARBgAT8CgAAQdQIKAIAQQJ0QfCJFmogBEGABPwKAABB1AhB1AgoAgAiAkGAAWoiAzYCACABIANIDQEgAkGA/wBIDQALCwJAIABFDQAgCEH//wBLDQBBgIABIAhrIAcgAUH//wBLGyECAkAgAEEBcUUNACACRQ0AIAhBAnRBoIkCaiEDIAIhBCACQQdxIgcEQANAIAMgBTYCACADQQRqIQMgBEEBayEEIAdBAWsiBw0ACwsgAkEBa0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgBEEIayIEDQALCwJAIABBAnFFDQAgAkUNACAIQQJ0QbCJBmohAyACIQQgAkEHcSIHBEADQCADIAU2AgAgA0EEaiEDIARBAWshBCAHQQFrIgcNAAsLIAJBAWtBB0kNAANAIAMgBTYCHCADIAU2AhggAyAFNgIUIAMgBTYCECADIAU2AgwgAyAFNgIIIAMgBTYCBCADIAU2AgAgA0EgaiEDIARBCGsiBA0ACwsCQCAAQQRxRQ0AIAJFDQAgCEECdEHAiQpqIQMgAiEEIAJBB3EiBwRAA0AgAyAFNgIAIANBBGohAyAEQQFrIQQgB0EBayIHDQALCyACQQFrQQdJDQADQCADIAU2AhwgAyAFNgIYIAMgBTYCFCADIAU2AhAgAyAFNgIMIAMgBTYCCCADIAU2AgQgAyAFNgIAIANBIGohAyAEQQhrIgQNAAsLAkAgAEEIcUUNACACRQ0AIAhBAnRB0IkOaiEDIAIhBCACQQdxIgcEQANAIAMgBTYCACADQQRqIQMgBEEBayEEIAdBAWsiBw0ACwsgAkEBa0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgBEEIayIEDQALCwJAIABBEHFFDQAgAkUNACAIQQJ0QeCJEmohAyACIQQgAkEHcSIHBEADQCADIAU2AgAgA0EEaiEDIARBAWshBCAHQQFrIgcNAAsLIAJBAWtBB0kNAANAIAMgBTYCHCADIAU2AhggAyAFNgIUIAMgBTYCECADIAU2AgwgAyAFNgIIIAMgBTYCBCADIAU2AgAgA0EgaiEDIARBCGsiBA0ACwsgAEEgcUUNACACRQ0AIAJBAWshByAIQQJ0QfCJFmohAyACQQdxIgQEQANAIAMgBTYCACADQQRqIQMgAkEBayECIARBAWsiBA0ACwsgB0EHSQ0AA0AgAyAFNgIcIAMgBTYCGCADIAU2AhQgAyAFNgIQIAMgBTYCDCADIAU2AgggAyAFNgIEIAMgBTYCACADQSBqIQMgAkEIayICDQALC0HcCEHcCCgCACAAcjYCACAGQQFqIgIgBi0AAEH/AHEiA0E/ayIAQT9LDQQaDAMLAkBB7AgoAgAiBEEBRgRAQfAIKAIAIgNBzAgoAgAiAUkNASADIAFwIQMMAQtB+AgoAgAhAkH0CCgCACEBAkACQCAEQQVHDQAgAUEBRw0AIAJB6QJODQQMAQsgAkHkAEoNA0H8CCgCAEHkAEoNA0GACSgCAEHkAEoNAwsCQCABRQ0AIAFBAkoNACACQfwIKAIAQYAJKAIAIAFBAnRBiAhqKAIAEQIAIQFB8AgoAgAiA0HMCCgCACICTwR/IAMgAnAFIAMLQQJ0QZAJaiABNgIAC0HwCCgCACIDQcwIKAIAIgFJDQAgAyABcCEDCyADQQJ0QZAJaigCACEFDAELIANB/QBxQSFHBEAgCCEBIAYhAgwECyAEQSNHDQQCQEHsCCgCACICQQFGBEBB8AgoAgAiAUHMCCgCACIASQ0BIAEgAHAhAQwBC0H4CCgCACEBQfQIKAIAIQACQAJAIAJBBUcNACAAQQFHDQAgAUHpAkgNAQwHCyABQeQASg0GQfwIKAIAQeQASg0GQYAJKAIAQeQASg0GCwJAIABFDQAgAEECSg0AIAFB/AgoAgBBgAkoAgAgAEECdEGICGooAgARAgAhAEHwCCgCACIBQcwIKAIAIgJPBH8gASACcAUgAQtBAnRBkAlqIAA2AgALQfAIKAIAIgFBzAgoAgAiAEkNACABIABwIQELIAFBAnRBkAlqKAIAIQUMBAsgCCEBIAYhAgtB1AgoAgAhBgNAAkAgASAGSA0AIAZB//8ASg0AIAZBAnQiBEGgiQJqIgZBoAgpAwA3AwAgBEGoiQJqQaAIKQMANwMAIARBsIkCakGgCCkDADcDACAEQbiJAmpBoAgpAwA3AwAgBEHAiQJqQaAIKQMANwMAIARByIkCakGgCCkDADcDACAEQdCJAmpBoAgpAwA3AwAgBEHYiQJqQaAIKQMANwMAIARB4IkCakGgCCkDADcDACAEQeiJAmpBoAgpAwA3AwAgBEHwiQJqQaAIKQMANwMAIARB+IkCakGgCCkDADcDACAEQYCKAmpBoAgpAwA3AwAgBEGIigJqQaAIKQMANwMAIARBkIoCakGgCCkDADcDACAEQZiKAmpBoAgpAwA3AwAgBEGgigJqQaAIKQMANwMAIARBqIoCakGgCCkDADcDACAEQbCKAmpBoAgpAwA3AwAgBEG4igJqQaAIKQMANwMAIARBwIoCakGgCCkDADcDACAEQciKAmpBoAgpAwA3AwAgBEHQigJqQaAIKQMANwMAIARB2IoCakGgCCkDADcDACAEQeCKAmpBoAgpAwA3AwAgBEHoigJqQaAIKQMANwMAIARB8IoCakGgCCkDADcDACAEQfiKAmpBoAgpAwA3AwAgBEGAiwJqQaAIKQMANwMAIARBiIsCakGgCCkDADcDACAEQZCLAmpBoAgpAwA3AwAgBEGYiwJqQaAIKQMANwMAIARBoIsCakGgCCkDADcDACAEQaiLAmpBoAgpAwA3AwAgBEGwiwJqQaAIKQMANwMAIARBuIsCakGgCCkDADcDACAEQcCLAmpBoAgpAwA3AwAgBEHIiwJqQaAIKQMANwMAIARB0IsCakGgCCkDADcDACAEQdiLAmpBoAgpAwA3AwAgBEHgiwJqQaAIKQMANwMAIARB6IsCakGgCCkDADcDACAEQfCLAmpBoAgpAwA3AwAgBEH4iwJqQaAIKQMANwMAIARBgIwCakGgCCkDADcDACAEQYiMAmpBoAgpAwA3AwAgBEGQjAJqQaAIKQMANwMAIARBmIwCakGgCCkDADcDACAEQaCMAmpBoAgpAwA3AwAgBEGojAJqQaAIKQMANwMAIARBsIwCakGgCCkDADcDACAEQbiMAmpBoAgpAwA3AwAgBEHAjAJqQaAIKQMANwMAIARByIwCakGgCCkDADcDACAEQdCMAmpBoAgpAwA3AwAgBEHYjAJqQaAIKQMANwMAIARB4IwCakGgCCkDADcDACAEQeiMAmpBoAgpAwA3AwAgBEHwjAJqQaAIKQMANwMAIARB+IwCakGgCCkDADcDACAEQYCNAmpBoAgpAwA3AwAgBEGIjQJqQaAIKQMANwMAIARBkI0CakGgCCkDADcDACAEQZiNAmpBoAgpAwA3AwAgBEGwiQZqIAZBgAT8CgAAQdQIKAIAQQJ0QcCJCmogBkGABPwKAABB1AgoAgBBAnRB0IkOaiAGQYAE/AoAAEHUCCgCAEECdEHgiRJqIAZBgAT8CgAAQdQIKAIAQQJ0QfCJFmogBkGABPwKAABB1AhB1AgoAgBBgAFqIgY2AgALIAFB//8ATQRAIABBAXEgAWxBAnRBoIkCaiAFNgIAIABBAXZBAXEgAWxBAnRBsIkGaiAFNgIAIABBAnZBAXEgAWxBAnRBwIkKaiAFNgIAIABBA3ZBAXEgAWxBAnRB0IkOaiAFNgIAIABBBHZBAXEgAWxBAnRB4IkSaiAFNgIAIABBBXYgAWxBAnRB8IkWaiAFNgIAQdQIKAIAIQYLIAFBAWohAUHcCEHcCCgCACAAcjYCACACLQAAIQAgAkEBaiIEIQIgAEH/AHEiA0E/ayIAQcAASQ0ACyAECyECQQAhBCACIQYgASEIIANB/QBxQSFGDQELIANBJGsOCgEDAwMDAwMDAwIDC0HsCEIBNwIADAQLQdgIIAFB2AgoAgAiACAAIAFIGyIAQYCAASAAQYCAAUgbNgIADAILQegIIAFB2AgoAgAiACAAIAFIGyIAQYCAASAAQYCAAUgbIgA2AgBB2AggADYCACAAQQRrEAAEQEHoCEEENgIAQdgIQQQ2AgBB0AhBATYCAA8LEAgMAQsCQCADQTtHDQBB7AgoAgAiAEEHSg0AQewIIABBAWo2AgAgAEECdEHwCGpBADYCAAsgAiEGIAQhAyABIQgMAQtBBCEIIAIhBiAEIQMLIAYgCUkNAAsLQeQIIAU2AgBB4AggAzYCAEHoCCAINgIAC9ELAgF+CH9B2AhCBDcDAEGojQJBoAgpAwAiADcDAEGgjQIgADcDAEGYjQIgADcDAEGQjQIgADcDAEGIjQIgADcDAEGAjQIgADcDAEH4jAIgADcDAEHwjAIgADcDAEHojAIgADcDAEHgjAIgADcDAEHYjAIgADcDAEHQjAIgADcDAEHIjAIgADcDAEHAjAIgADcDAEG4jAIgADcDAEGwjAIgADcDAEGojAIgADcDAEGgjAIgADcDAEGYjAIgADcDAEGQjAIgADcDAEGIjAIgADcDAEGAjAIgADcDAEH4iwIgADcDAEHwiwIgADcDAEHoiwIgADcDAEHgiwIgADcDAEHYiwIgADcDAEHQiwIgADcDAEHIiwIgADcDAEHAiwIgADcDAEG4iwIgADcDAEGwiwIgADcDAEGoiwIgADcDAEGgiwIgADcDAEGYiwIgADcDAEGQiwIgADcDAEGIiwIgADcDAEGAiwIgADcDAEH4igIgADcDAEHwigIgADcDAEHoigIgADcDAEHgigIgADcDAEHYigIgADcDAEHQigIgADcDAEHIigIgADcDAEHAigIgADcDAEG4igIgADcDAEGwigIgADcDAEGoigIgADcDAEGgigIgADcDAEGYigIgADcDAEGQigIgADcDAEGIigIgADcDAEGAigIgADcDAEH4iQIgADcDAEHwiQIgADcDAEHoiQIgADcDAEHgiQIgADcDAEHYiQIgADcDAEHQiQIgADcDAEHIiQIgADcDAEHAiQIgADcDAEG4iQIgADcDAEGwiQIgADcDAEGoCCgCACIEQf8AakGAAW0hCAJAIARBgQFIDQBBASEBIAhBAiAIQQJKG0EBayICQQFxIQMgBEGBAk4EQCACQX5xIQIDQCABQQl0IgdBEHJBoIkCakGwiQJBgAT8CgAAIAdBsI0CakGwiQJBgAT8CgAAIAFBAmohASACQQJrIgINAAsLIANFDQAgAUEJdEEQckGgiQJqQbCJAkGABPwKAAALAkAgBEEBSA0AIAhBASAIQQFKGyIDQQFxIQUCQCADQQFrIgdFBEBBACEBDAELIANB/v///wdxIQJBACEBA0AgAUEJdCIGQRByQbCJBmpBsIkCQYAE/AoAACAGQZAEckGwiQZqQbCJAkGABPwKAAAgAUECaiEBIAJBAmsiAg0ACwsgBQRAIAFBCXRBEHJBsIkGakGwiQJBgAT8CgAACyAEQQFIDQAgA0EBcSEFIAcEfyADQf7///8HcSECQQAhAQNAIAFBCXQiBkEQckHAiQpqQbCJAkGABPwKAAAgBkGQBHJBwIkKakGwiQJBgAT8CgAAIAFBAmohASACQQJrIgINAAsgAUEHdEEEcgVBBAshASAFBEAgAUECdEHAiQpqQbCJAkGABPwKAAALIARBAUgNACADQQFxIQUgBwR/IANB/v///wdxIQJBACEBA0AgAUEJdCIGQRByQdCJDmpBsIkCQYAE/AoAACAGQZAEckHQiQ5qQbCJAkGABPwKAAAgAUECaiEBIAJBAmsiAg0ACyABQQd0QQRyBUEECyEBIAUEQCABQQJ0QdCJDmpBsIkCQYAE/AoAAAsgBEEBSA0AIANBAXEhBSAHBH8gA0H+////B3EhAkEAIQEDQCABQQl0IgZBEHJB4IkSakGwiQJBgAT8CgAAIAZBkARyQeCJEmpBsIkCQYAE/AoAACABQQJqIQEgAkECayICDQALIAFBB3RBBHIFQQQLIQEgBQRAIAFBAnRB4IkSakGwiQJBgAT8CgAACyAEQQFIDQAgA0EBcSEEIAcEfyADQf7///8HcSECQQAhAQNAIAFBCXQiA0EQckHwiRZqQbCJAkGABPwKAAAgA0GQBHJB8IkWakGwiQJBgAT8CgAAIAFBAmohASACQQJrIgINAAsgAUEHdEEEcgVBBAshASAERQ0AIAFBAnRB8IkWakGwiQJBgAT8CgAAC0HUCCAIQQd0QQRyNgIAC58TAgh/AX5B5AgoAgAhA0HgCCgCACECQegIKAIAIQcgAUGQiQFqIglB/wE6AAAgACABSARAIABBkIkBaiEIA0AgAiEEIAhBAWohAQJAIAgtAABB/wBxIgJBMGtBCUsEQCABIQgMAQtB7AgoAgBBAnRB7AhqIgUoAgAhAANAIAUgAiAAQQpsakEwayIANgIAIAEtAAAhAiABQQFqIgghASACQf8AcSICQTBrQQpJDQALCwJAAkACQAJAAkACQAJ/AkAgAkE/ayIAQT9NBEAgBEUNASAEQSFGBEBB8AgoAgAiAUEBIAEbIgQgB2ohAQJAIABFDQAgB0H//wBLDQBBgIABIAdrIAQgAUH//wBLGyEFAkAgAEEBcUUNACAHQQJ0QaCJAmohAiAFIgRBB3EiBgRAA0AgAiADNgIAIAJBBGohAiAEQQFrIQQgBkEBayIGDQALCyAFQQFrQQdJDQADQCACIAM2AhwgAiADNgIYIAIgAzYCFCACIAM2AhAgAiADNgIMIAIgAzYCCCACIAM2AgQgAiADNgIAIAJBIGohAiAEQQhrIgQNAAsLAkAgAEECcUUNACAHQQJ0QbCJBmohAiAFIgRBB3EiBgRAA0AgAiADNgIAIAJBBGohAiAEQQFrIQQgBkEBayIGDQALCyAFQQFrQQdJDQADQCACIAM2AhwgAiADNgIYIAIgAzYCFCACIAM2AhAgAiADNgIMIAIgAzYCCCACIAM2AgQgAiADNgIAIAJBIGohAiAEQQhrIgQNAAsLAkAgAEEEcUUNACAHQQJ0QcCJCmohAiAFIgRBB3EiBgRAA0AgAiADNgIAIAJBBGohAiAEQQFrIQQgBkEBayIGDQALCyAFQQFrQQdJDQADQCACIAM2AhwgAiADNgIYIAIgAzYCFCACIAM2AhAgAiADNgIMIAIgAzYCCCACIAM2AgQgAiADNgIAIAJBIGohAiAEQQhrIgQNAAsLAkAgAEEIcUUNACAHQQJ0QdCJDmohAiAFIgRBB3EiBgRAA0AgAiADNgIAIAJBBGohAiAEQQFrIQQgBkEBayIGDQALCyAFQQFrQQdJDQADQCACIAM2AhwgAiADNgIYIAIgAzYCFCACIAM2AhAgAiADNgIMIAIgAzYCCCACIAM2AgQgAiADNgIAIAJBIGohAiAEQQhrIgQNAAsLAkAgAEEQcUUNACAHQQJ0QeCJEmohAiAFIgRBB3EiBgRAA0AgAiADNgIAIAJBBGohAiAEQQFrIQQgBkEBayIGDQALCyAFQQFrQQdJDQADQCACIAM2AhwgAiADNgIYIAIgAzYCFCACIAM2AhAgAiADNgIMIAIgAzYCCCACIAM2AgQgAiADNgIAIAJBIGohAiAEQQhrIgQNAAsLIABBIHFFDQAgBUEBayEEIAdBAnRB8IkWaiEAIAVBB3EiAgRAA0AgACADNgIAIABBBGohACAFQQFrIQUgAkEBayICDQALCyAEQQdJDQADQCAAIAM2AhwgACADNgIYIAAgAzYCFCAAIAM2AhAgACADNgIMIAAgAzYCCCAAIAM2AgQgACADNgIAIABBIGohACAFQQhrIgUNAAsLIAhBAWoiBSAILQAAQf8AcSICQT9rIgBBP00NAxoMBAsCQEHsCCgCACIFQQFGBEBB8AgoAgAiAUHMCCgCACIESQ0BIAEgBHAhAQwBC0H4CCgCACEEQfQIKAIAIQECQAJAIAVBBUcNACABQQFHDQAgBEHpAk4NBAwBCyAEQeQASg0DQfwIKAIAQeQASg0DQYAJKAIAQeQASg0DCwJAIAFFDQAgAUECSg0AIARB/AgoAgBBgAkoAgAgAUECdEGICGooAgARAgAhBEHwCCgCACIBQcwIKAIAIgVPBH8gASAFcAUgAQtBAnRBkAlqIAQ2AgALQfAIKAIAIgFBzAgoAgAiBEkNACABIARwIQELIAFBAnRBkAlqKAIAIQMMAQsgAkH9AHFBIUcEQCAHIQEgAiEADAQLIARBI0cNBAJAQewIKAIAIgRBAUYEQEHwCCgCACIBQcwIKAIAIgBJDQEgASAAcCEBDAELQfgIKAIAIQFB9AgoAgAhAAJAAkAgBEEFRw0AIABBAUcNACABQekCSA0BDAcLIAFB5ABKDQZB/AgoAgBB5ABKDQZBgAkoAgBB5ABKDQYLAkAgAEUNACAAQQJKDQAgAUH8CCgCAEGACSgCACAAQQJ0QYgIaigCABECACEAQfAIKAIAIgFBzAgoAgAiBE8EfyABIARwBSABC0ECdEGQCWogADYCAAtB8AgoAgAiAUHMCCgCACIASQ0AIAEgAHAhAQsgAUECdEGQCWooAgAhAwwECyAHIQEgCAshBQNAIAFB//8ATQRAIABBAXEgAWxBAnRBoIkCaiADNgIAIABBAXZBAXEgAWxBAnRBsIkGaiADNgIAIABBAnZBAXEgAWxBAnRBwIkKaiADNgIAIABBA3ZBAXEgAWxBAnRB0IkOaiADNgIAIABBBHZBAXEgAWxBAnRB4IkSaiADNgIAIABBBXYgAWxBAnRB8IkWaiADNgIACyABQQFqIQEgBS0AACEAIAVBAWoiBCEFIABB/wBxIgJBP2siAEHAAEkNAAsgBCEFC0EAIQQgBSEIIAEhByACIQAgAkH9AHFBIUYNAQtBBCEHIAQhAiAAQSRrDgoDAgICAgICAgIBAgtB7AhCATcCAAwCC0GoCCgCAEEEaxAABEBB0AhBATYCAA8LAkBBqAgoAgAiBkEFSA0AQaAIKQMAIQogBkEDa0EBdiIBQQdxIQJBACEAIAFBAWtBB08EQCABQfj///8HcSEFA0AgAEEDdCIBQbCJAmogCjcDACABQQhyQbCJAmogCjcDACABQRByQbCJAmogCjcDACABQRhyQbCJAmogCjcDACABQSByQbCJAmogCjcDACABQShyQbCJAmogCjcDACABQTByQbCJAmogCjcDACABQThyQbCJAmogCjcDACAAQQhqIQAgBUEIayIFDQALCyACRQ0AA0AgAEEDdEGwiQJqIAo3AwAgAEEBaiEAIAJBAWsiAg0ACwtBwIkGQbCJAiAGQQJ0IgD8CgAAQdCJCkGwiQIgAPwKAABB4IkOQbCJAiAA/AoAAEHwiRJBsIkCIAD8CgAAQYCKFkGwiQIgAPwKAAAgBCECDAELAkAgAEE7Rw0AQewIKAIAIgBBB0oNAEHsCCAAQQFqNgIAIABBAnRB8AhqQQA2AgALIAEhBwsgCCAJSQ0ACwtB5AggAzYCAEHgCCACNgIAQegIIAc2AgAL4gcCBX8BfgJAQdAIAn8CQAJAIAAgAU4NACABQZCJAWohBiAAQZCJAWohBQNAIAUtAAAiA0H/AHEhAgJAAkACQAJAAkACQAJAQeAIKAIAIgRBIkcEQCAEDQcgAkEiRgRAQewIQgE3AgBB4AhBIjYCAAwICyACQT9rQcAASQ0GIANBIWsiAkEMTQ0BDAULAkAgAkEwayIEQQlNBEBB7AgoAgBBAnRB7AhqIgIgBCACKAIAQQpsajYCAAwBC0HsCCgCACEEIAJBO0YEQCAEQQdKDQFB7AggBEEBajYCACAEQQJ0QfAIakEANgIADAELIARBBEYEQEHECEECNgIAQbAIQfAIKQMANwMAQbgIQfgIKAIAIgI2AgBBvAhB/AgoAgAiBDYCAEHICEECQQFBwAgoAgAiAxs2AgBBrAggBEEAIAMbNgIAQagIIAJBgIABIAJBgIABSBtBBGpBACADGzYCAEHgCEEANgIADAoLIAJBP2tBwABJDQQLIANBIWsiAkEMTQ0BDAILQQEgAnRBjSBxRQ0DDAQLQQEgAnRBjSBxDQELIANBoQFrIgJBDEsNA0EBIAJ0QY0gcUUNAwtBxAhCgYCAgBA3AgBBsAhB8AgoAgBBAEHsCCgCACICQQBKGzYCAEG0CEH0CCgCAEEAIAJBAUobNgIAQbgIQfgIKAIAQQAgAkECShs2AgBB4AhBADYCAEG8CEEANgIADAQLIANBoQFrIgJBDEsNAUEBIAJ0QY0gcUUNAQtBxAhCgYCAgBA3AgBBsAhCADcDAEG4CEIANwMADAMLIAVBAWoiBSAGSQ0ACwsCQEHICCgCAA4DAwEAAQsCQEGoCCgCACIFQQVIDQBBoAgpAwAhByAFQQNrQQF2IgNBB3EhBEEAIQIgA0EBa0EHTwRAIANB+P///wdxIQYDQCACQQN0IgNBsIkCaiAHNwMAIANBCHJBsIkCaiAHNwMAIANBEHJBsIkCaiAHNwMAIANBGHJBsIkCaiAHNwMAIANBIHJBsIkCaiAHNwMAIANBKHJBsIkCaiAHNwMAIANBMHJBsIkCaiAHNwMAIANBOHJBsIkCaiAHNwMAIAJBCGohAiAGQQhrIgYNAAsLIARFDQADQCACQQN0QbCJAmogBzcDACACQQFqIQIgBEEBayIEDQALC0HAiQZBsIkCIAVBAnQiA/wKAABB0IkKQbCJAiAD/AoAAEHgiQ5BsIkCIAP8CgAAQfCJEkGwiQIgA/wKAABBgIoWQbCJAiAD/AoAAEECDAELEAhByAgoAgALEAEiAjYCACACDQAgACABQcgIKAIAQQJ0QYAIaigCABEBAAsLdABB6AhBBDYCAEHkCCAANgIAQewIQgE3AgBBxAhCADcCAEHACCADNgIAQdwIQgA3AgBBqAhCADcDAEGwCEIANwMAQbgIQgA3AwBBzAggAkGAICACQYAgSRs2AgBBoAggAa1CgYCAgBB+NwMAQdAIQQA2AgALIwBB0AgoAgBFBEAgACABQcgIKAIAQQJ0QYAIaigCABEBAAsLWgECfwJAAkACQEHICCgCAEEBaw4CAAECC0HYCEHoCCgCACIAQdgIKAIAIgEgACABShsiAEGAgAEgAEGAgAFIGyIANgIAIABBBGsPC0GoCCgCAEEEayEACyAAC0IBAX8Cf0EGQdwIKAIAIgBBIHENABpBBSAAQRBxDQAaQQQgAEEIcQ0AGkEDIABBBHENABpBAiAAQQFxIABBAnEbCwu9BQEFfQJ/IAJFBEAgAUH/AWxBMmpB5ABtIgBBCHQgAHIgAEEQdHIMAQsgArJDAADIQpUhBiAAQfABarJDAAC0Q5UhBQJ9IAGyQwAAyEKVIgNDAAAAP10EQCADIAZDAACAP5KUDAELIAYgA0MAAIA/IAaTlJILIQcgAyADkiEGAkAgBUOrqqo+kiIEQwAAAABdBEAgBEMAAIA/kiEEDAELIARDAACAP15FDQAgBEMAAIC/kiEECyAGIAeTIQMgBUMAAAAAXSEAAn8CfSADIAcgA5NDAADAQJQgBJSSIARDq6oqPl0NABogByAEQwAAAD9dDQAaIAMgBEOrqio/XUUNABogAyAHIAOTIARDAADAwJRDAACAQJKUkgtDAAB/Q5RDAAAAP5IiBkMAAIBPXSAGQwAAAABgcQRAIAapDAELQQALIQECQCAABEAgBUMAAIA/kiEEDAELIAUiBEMAAIA/XkUNACAFQwAAgL+SIQQLIAVDq6qqvpIiBUMAAAAAXSECAn8CfSADIAcgA5NDAADAQJQgBJSSIARDq6oqPl0NABogByAEQwAAAD9dDQAaIAMgBEOrqio/XUUNABogAyAHIAOTIARDAADAwJRDAACAQJKUkgtDAAB/Q5RDAAAAP5IiBkMAAIBPXSAGQwAAAABgcQRAIAapDAELQQALIQACQCACBEAgBUMAAIA/kiEFDAELIAVDAACAP15FDQAgBUMAAIC/kiEFCwJAIAVDq6oqPl0EQCADIAcgA5NDAADAQJQgBZSSIQcMAQsgBUMAAAA/XQ0AIAVDq6oqP11FBEAgAyEHDAELIAMgByADkyAFQwAAwMCUQwAAgECSlJIhBwsgAEEIdAJ/IAdDAAB/Q5RDAAAAP5IiBkMAAIBPXSAGQwAAAABgcQRAIAapDAELQQALQRB0ciABcgtBgICAeHILNwAgAEH/AWxBMmpB5ABtIAFB/wFsQTJqQeQAbUEIdHIgAkH/AWxBMmpB5ABtQRB0ckGAgIB4cgsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwsYAQBBgAgLEQEAAAACAAAAAwAAAAQAAAAF"}},280:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});let h=(0,n(615).InWasm)({s:1,t:0,d:"AGFzbQEAAAABBQFgAAF/Ag8BA2VudgZtZW1vcnkCAAEDAwIAAAcNAgNkZWMAAANlbmQAAQqxAwKuAQEFf0GIKCgCAEGgKGohAUGEKCgCACIAQYAoKAIAQQFrQXxxIgJIBEAgAkGgKGohAyAAQaAoaiEAA0AgAC0AA0ECdCgCgCAgAC0AAkECdCgCgBggAC0AAUECdCgCgBAgAC0AAEECdCgCgAhycnIiBEH///8HSwRAQQEPCyABIAQ2AgAgAUEDaiEBIABBBGoiACADSQ0ACwtBhCggAjYCAEGIKCABQaAoazYCAEEAC/4BAQZ/AkBBgCgoAgAiAUGEKCgCACIAa0EFTgRAQQEhAxAADQFBgCgoAgAhAUGEKCgCACEAC0EBIQMgASAAayIEQQJIDQAgAEGhKGotAABBAnQoAoAQIABBoChqLQAAQQJ0KAKACHIhAQJAIARBAkYEQEEBIQIMAQtBASECIAAtAKIoIgVBPUcEQEECIQIgBUECdCgCgBggAXIhAQsgBEEERw0AIAAtAKMoIgBBPUYNACACQQFqIQIgAEECdCgCgCAgAXIhAQsgAUH///8HSw0AQYgoKAIAQaAoaiABNgIAQYgoQYgoKAIAIAJqIgA2AgAgAEGQKCgCAEchAwsgAwsAdglwcm9kdWNlcnMBDHByb2Nlc3NlZC1ieQEFY2xhbmdWMTguMC4wIChodHRwczovL2dpdGh1Yi5jb20vbGx2bS9sbHZtLXByb2plY3QgZDFlNjg1ZGY0NWRjNTk0NGI0M2QyNTQ3ZDAxMzhjZDRhM2VlNGVmZSkALA90YXJnZXRfZmVhdHVyZXMCKw9tdXRhYmxlLWdsb2JhbHMrCHNpZ24tZXh0"}),g=new Uint8Array("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("").map(f=>f.charCodeAt(0))),o=new Uint32Array(1024);o.fill(4278190080);for(let f=0;f<g.length;++f)o[g[f]]=f<<2;for(let f=0;f<g.length;++f)o[256+g[f]]=f>>4|(f<<4&255)<<8;for(let f=0;f<g.length;++f)o[512+g[f]]=f>>2<<8|(f<<6&255)<<16;for(let f=0;f<g.length;++f)o[768+g[f]]=f<<16;let c=new Uint8Array(0);t.default=class{constructor(f){this.keepSize=f}get data8(){return this._inst?this._d.subarray(0,this._m32[1282]):c}release(){this._inst&&(this._mem.buffer.byteLength>this.keepSize?this._inst=this._m32=this._d=this._mem=null:(this._m32[1280]=0,this._m32[1281]=0,this._m32[1282]=0))}init(f){let v=this._m32,u=4*(Math.ceil(f/3)+1288);this._inst?this._mem.buffer.byteLength<u&&(this._mem.grow(Math.ceil((u-this._mem.buffer.byteLength)/65536)),v=new Uint32Array(this._mem.buffer,0),this._d=new Uint8Array(this._mem.buffer,5152)):(this._mem=new WebAssembly.Memory({initial:Math.ceil(u/65536)}),this._inst=h({env:{memory:this._mem}}),v=new Uint32Array(this._mem.buffer,0),v.set(o,256),this._d=new Uint8Array(this._mem.buffer,5152)),v[1284]=f,v[1283]=4*Math.ceil(f/3),v[1280]=0,v[1281]=0,v[1282]=0,this._m32=v}put(f,v,u){if(!this._inst)return 1;let a=this._m32;return u-v+a[1280]>a[1283]?1:(this._d.set(f.subarray(v,u),a[1280]),a[1280]+=u-v,a[1280]-a[1281]>=131072?this._inst.exports.dec():0)}end(){return this._inst?this._inst.exports.end():1}}},125:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IIPHandler=void 0;let h=n(782),g=n(216),o=n(280),c=n(769),f=n(326),v={name:"Unnamed file",size:0,width:"auto",height:"auto",preserveAspectRatio:1,inline:0};t.IIPHandler=class{constructor(u,a,d,_){this._opts=u,this._renderer=a,this._storage=d,this._coreTerminal=_,this._aborted=!1,this._hp=new c.HeaderParser,this._header=v,this._dec=new o.default(4194304),this._metrics=f.UNSUPPORTED_TYPE}reset(){}start(){this._aborted=!1,this._header=v,this._metrics=f.UNSUPPORTED_TYPE,this._hp.reset()}put(u,a,d){if(!this._aborted)if(this._hp.state===4)this._dec.put(u,a,d)&&(this._dec.release(),this._aborted=!0);else{let _=this._hp.parse(u,a,d);if(_===-1)return void(this._aborted=!0);if(_>0){if(this._header=Object.assign({},v,this._hp.fields),!this._header.inline||!this._header.size||this._header.size>this._opts.iipSizeLimit)return void(this._aborted=!0);this._dec.init(this._header.size),this._dec.put(u,_,d)&&(this._dec.release(),this._aborted=!0)}}}end(u){if(this._aborted)return!0;let a=0,d=0,_=!0;if((_=u)&&(_=!this._dec.end())&&(this._metrics=(0,f.imageType)(this._dec.data8),(_=this._metrics.mime!=="unsupported")&&(a=this._metrics.width,d=this._metrics.height,(_=a&&d&&a*d<this._opts.pixelLimit)&&([a,d]=this._resize(a,d).map(Math.floor),_=a&&d&&a*d<this._opts.pixelLimit))),!_)return this._dec.release(),!0;let p=new Blob([this._dec.data8],{type:this._metrics.mime});if(this._dec.release(),!window.createImageBitmap){let m=URL.createObjectURL(p),w=new Image;return new Promise(b=>{w.addEventListener("load",()=>{var S;URL.revokeObjectURL(m);let A=h.ImageRenderer.createCanvas(window.document,a,d);(S=A.getContext("2d"))===null||S===void 0||S.drawImage(w,0,0,a,d),this._storage.addImage(A),b(!0)}),w.src=m,setTimeout(()=>b(!0),1e3)})}return createImageBitmap(p,{resizeWidth:a,resizeHeight:d}).then(m=>(this._storage.addImage(m),!0))}_resize(u,a){var d,_,p,m;let w=((d=this._renderer.dimensions)===null||d===void 0?void 0:d.css.cell.width)||g.CELL_SIZE_DEFAULT.width,b=((_=this._renderer.dimensions)===null||_===void 0?void 0:_.css.cell.height)||g.CELL_SIZE_DEFAULT.height,S=((p=this._renderer.dimensions)===null||p===void 0?void 0:p.css.canvas.width)||w*this._coreTerminal.cols,A=((m=this._renderer.dimensions)===null||m===void 0?void 0:m.css.canvas.height)||b*this._coreTerminal.rows,x=this._dim(this._header.width,S,w),E=this._dim(this._header.height,A,b);if(!x&&!E){let D=S/u,L=(A-b)/a,T=Math.min(D,L);return T<1?[u*T,a*T]:[u,a]}return x?!this._header.preserveAspectRatio&&x&&E?[x,E]:[x,a*x/u]:[u*E/a,E]}_dim(u,a,d){return u==="auto"?0:u.endsWith("%")?parseInt(u.slice(0,-1))*a/100:u.endsWith("px")?parseInt(u.slice(0,-2)):parseInt(u)*d}}},769:(l,t)=>{function n(v){let u="";for(let a=0;a<v.length;++a)u+=String.fromCharCode(v[a]);return u}function h(v){let u=0;for(let a=0;a<v.length;++a){if(v[a]<48||v[a]>57)throw new Error("illegal char");u=10*u+v[a]-48}return u}function g(v){let u=n(v);if(!u.match(/^((auto)|(\d+?((px)|(%)){0,1}))$/))throw new Error("illegal size");return u}Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderParser=void 0;let o={inline:h,size:h,name:function(v){if(typeof Buffer<"u")return Buffer.from(n(v),"base64").toString();let u=atob(n(v)),a=new Uint8Array(u.length);for(let d=0;d<a.length;++d)a[d]=u.charCodeAt(d);return new TextDecoder().decode(a)},width:g,height:g,preserveAspectRatio:h},c=[70,105,108,101],f=1024;t.HeaderParser=class{constructor(){this.state=0,this._buffer=new Uint32Array(f),this._position=0,this._key="",this.fields={}}reset(){this._buffer.fill(0),this.state=0,this._position=0,this.fields={},this._key=""}parse(v,u,a){let d=this.state,_=this._position,p=this._buffer;if(d===1||d===4||d===0&&_>6)return-1;for(let m=u;m<a;++m){let w=v[m];switch(w){case 59:if(!this._storeValue(_))return this._a();d=2,_=0;break;case 61:if(d===0){for(let b=0;b<c.length;++b)if(p[b]!==c[b])return this._a();d=2,_=0}else if(d===2){if(!this._storeKey(_))return this._a();d=3,_=0}else if(d===3){if(_>=f)return this._a();p[_++]=w}break;case 58:return d!==3||this._storeValue(_)?(this.state=4,m+1):this._a();default:if(_>=f)return this._a();p[_++]=w}}return this.state=d,this._position=_,-2}_a(){return this.state=1,-1}_storeKey(v){let u=n(this._buffer.subarray(0,v));return!!u&&(this._key=u,this.fields[u]=null,!0)}_storeValue(v){if(this._key){try{let u=this._buffer.slice(0,v);this.fields[this._key]=o[this._key]?o[this._key](u):u}catch{return!1}return!0}return!1}}},326:(l,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imageType=t.UNSUPPORTED_TYPE=void 0,t.UNSUPPORTED_TYPE={mime:"unsupported",width:0,height:0},t.imageType=function(n){if(n.length<24)return t.UNSUPPORTED_TYPE;let h=new Uint32Array(n.buffer,n.byteOffset,6);if(h[0]===1196314761&&h[1]===169478669&&h[3]===1380206665)return{mime:"image/png",width:n[16]<<24|n[17]<<16|n[18]<<8|n[19],height:n[20]<<24|n[21]<<16|n[22]<<8|n[23]};if((h[0]===3774863615||h[0]===3791640831)&&(n[6]===74&&n[7]===70&&n[8]===73&&n[9]===70||n[6]===69&&n[7]===120&&n[8]===105&&n[9]===102)){let[g,o]=function(c){let f=c.length,v=4,u=c[v]<<8|c[v+1];for(;;){if(v+=u,v>=f)return[0,0];if(c[v]!==255)return[0,0];if(c[v+1]===192||c[v+1]===194)return v+8<f?[c[v+7]<<8|c[v+8],c[v+5]<<8|c[v+6]]:[0,0];v+=2,u=c[v]<<8|c[v+1]}}(n);return{mime:"image/jpeg",width:g,height:o}}return h[0]!==944130375||n[4]!==55&&n[4]!==57||n[5]!==97?t.UNSUPPORTED_TYPE:{mime:"image/gif",width:n[7]<<8|n[6],height:n[9]<<8|n[8]}}},782:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageRenderer=void 0;let h=n(477),g=n(859);class o extends g.Disposable{static createCanvas(f,v,u){let a=(f||document).createElement("canvas");return a.width=0|v,a.height=0|u,a}static createImageData(f,v,u,a){if(typeof ImageData!="function"){let d=f.createImageData(v,u);return a&&d.data.set(new Uint8ClampedArray(a,0,v*u*4)),d}return a?new ImageData(new Uint8ClampedArray(a,0,v*u*4),v,u):new ImageData(v,u)}static createImageBitmap(f){return typeof createImageBitmap!="function"?Promise.resolve(void 0):createImageBitmap(f)}constructor(f){super(),this._terminal=f,this._optionsRefresh=this.register(new g.MutableDisposable),this._oldOpen=this._terminal._core.open,this._terminal._core.open=v=>{var u;(u=this._oldOpen)===null||u===void 0||u.call(this._terminal._core,v),this._open()},this._terminal._core.screenElement&&this._open(),this._optionsRefresh.value=this._terminal._core.optionsService.onOptionChange(v=>{var u;v==="fontSize"&&(this.rescaleCanvas(),(u=this._renderService)===null||u===void 0||u.refreshRows(0,this._terminal.rows))}),this.register((0,g.toDisposable)(()=>{var v;this.removeLayerFromDom(),this._terminal._core&&this._oldOpen&&(this._terminal._core.open=this._oldOpen,this._oldOpen=void 0),this._renderService&&this._oldSetRenderer&&(this._renderService.setRenderer=this._oldSetRenderer,this._oldSetRenderer=void 0),this._renderService=void 0,this.canvas=void 0,this._ctx=void 0,(v=this._placeholderBitmap)===null||v===void 0||v.close(),this._placeholderBitmap=void 0,this._placeholder=void 0}))}showPlaceholder(f){var v,u;f?this._placeholder||this.cellSize.height===-1||this._createPlaceHolder(Math.max(this.cellSize.height+1,24)):((v=this._placeholderBitmap)===null||v===void 0||v.close(),this._placeholderBitmap=void 0,this._placeholder=void 0),(u=this._renderService)===null||u===void 0||u.refreshRows(0,this._terminal.rows)}get dimensions(){var f;return(f=this._renderService)===null||f===void 0?void 0:f.dimensions}get cellSize(){var f,v;return{width:((f=this.dimensions)===null||f===void 0?void 0:f.css.cell.width)||-1,height:((v=this.dimensions)===null||v===void 0?void 0:v.css.cell.height)||-1}}clearLines(f,v){var u,a,d,_;(u=this._ctx)===null||u===void 0||u.clearRect(0,f*(((a=this.dimensions)===null||a===void 0?void 0:a.css.cell.height)||0),((d=this.dimensions)===null||d===void 0?void 0:d.css.canvas.width)||0,(++v-f)*(((_=this.dimensions)===null||_===void 0?void 0:_.css.cell.height)||0))}clearAll(){var f,v,u;(f=this._ctx)===null||f===void 0||f.clearRect(0,0,((v=this.canvas)===null||v===void 0?void 0:v.width)||0,((u=this.canvas)===null||u===void 0?void 0:u.height)||0)}draw(f,v,u,a,d=1){if(!this._ctx)return;let{width:_,height:p}=this.cellSize;if(_===-1||p===-1)return;this._rescaleImage(f,_,p);let m=f.actual,w=Math.ceil(m.width/_),b=v%w*_,S=Math.floor(v/w)*p,A=u*_,x=a*p,E=d*_+b>m.width?m.width-b:d*_,D=S+p>m.height?m.height-S:p;this._ctx.drawImage(m,Math.floor(b),Math.floor(S),Math.ceil(E),Math.ceil(D),Math.floor(A),Math.floor(x),Math.ceil(E),Math.ceil(D))}extractTile(f,v){let{width:u,height:a}=this.cellSize;if(u===-1||a===-1)return;this._rescaleImage(f,u,a);let d=f.actual,_=Math.ceil(d.width/u),p=v%_*u,m=Math.floor(v/_)*a,w=u+p>d.width?d.width-p:u,b=m+a>d.height?d.height-m:a,S=o.createCanvas(this.document,w,b),A=S.getContext("2d");return A?(A.drawImage(d,Math.floor(p),Math.floor(m),Math.floor(w),Math.floor(b),0,0,Math.floor(w),Math.floor(b)),S):void 0}drawPlaceholder(f,v,u=1){if(this._ctx){let{width:a,height:d}=this.cellSize;if(a===-1||d===-1||(this._placeholder?d>=this._placeholder.height&&this._createPlaceHolder(d+1):this._createPlaceHolder(Math.max(d+1,24)),!this._placeholder))return;this._ctx.drawImage(this._placeholderBitmap||this._placeholder,f*a,v*d%2?0:1,a*u,d,f*a,v*d,a*u,d)}}rescaleCanvas(){this.canvas&&(this.canvas.width===this.dimensions.css.canvas.width&&this.canvas.height===this.dimensions.css.canvas.height||(this.canvas.width=this.dimensions.css.canvas.width||0,this.canvas.height=this.dimensions.css.canvas.height||0))}_rescaleImage(f,v,u){if(v===f.actualCellSize.width&&u===f.actualCellSize.height)return;let{width:a,height:d}=f.origCellSize;if(v===a&&u===d)return f.actual=f.orig,f.actualCellSize.width=a,void(f.actualCellSize.height=d);let _=o.createCanvas(this.document,Math.ceil(f.orig.width*v/a),Math.ceil(f.orig.height*u/d)),p=_.getContext("2d");p&&(p.drawImage(f.orig,0,0,_.width,_.height),f.actual=_,f.actualCellSize.width=v,f.actualCellSize.height=u)}_open(){this._renderService=this._terminal._core._renderService,this._oldSetRenderer=this._renderService.setRenderer.bind(this._renderService),this._renderService.setRenderer=f=>{var v;this.removeLayerFromDom(),(v=this._oldSetRenderer)===null||v===void 0||v.call(this._renderService,f)}}insertLayerToDom(){var f,v;this.document&&this._terminal._core.screenElement?this.canvas||(this.canvas=o.createCanvas(this.document,((f=this.dimensions)===null||f===void 0?void 0:f.css.canvas.width)||0,((v=this.dimensions)===null||v===void 0?void 0:v.css.canvas.height)||0),this.canvas.classList.add("xterm-image-layer"),this._terminal._core.screenElement.appendChild(this.canvas),this._ctx=this.canvas.getContext("2d",{alpha:!0,desynchronized:!0}),this.clearAll()):console.warn("image addon: cannot insert output canvas to DOM, missing document or screenElement")}removeLayerFromDom(){this.canvas&&(this._ctx=void 0,this.canvas.remove(),this.canvas=void 0)}_createPlaceHolder(f=24){var v;(v=this._placeholderBitmap)===null||v===void 0||v.close(),this._placeholderBitmap=void 0;let u=32,a=o.createCanvas(this.document,u,f),d=a.getContext("2d",{alpha:!1});if(!d)return;let _=o.createImageData(d,u,f),p=new Uint32Array(_.data.buffer),m=(0,h.toRGBA8888)(0,0,0),w=(0,h.toRGBA8888)(255,255,255);p.fill(m);for(let A=0;A<f;++A){let x=A%2,E=A*u;for(let D=0;D<u;D+=2)p[E+D+x]=w}d.putImageData(_,0,0);let b=screen.width+u-1&-32||4096;this._placeholder=o.createCanvas(this.document,b,f);let S=this._placeholder.getContext("2d",{alpha:!1});if(S){for(let A=0;A<b;A+=u)S.drawImage(a,A,0);o.createImageBitmap(this._placeholder).then(A=>this._placeholderBitmap=A)}else this._placeholder=void 0}get document(){var f;return(f=this._terminal._core._coreBrowserService)===null||f===void 0?void 0:f.window.document}}t.ImageRenderer=o},216:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageStorage=t.CELL_SIZE_DEFAULT=void 0;let h=n(782);t.CELL_SIZE_DEFAULT={width:7,height:14};class g{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(f){this._ext=f}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(f){this._ext&=-469762049,this._ext|=f<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(f){this._ext&=-67108864,this._ext|=67108863&f}get underlineVariantOffset(){let f=(3758096384&this._ext)>>29;return f<0?4294967288^f:f}set underlineVariantOffset(f){this._ext&=536870911,this._ext|=f<<29&3758096384}get urlId(){return this._urlId}set urlId(f){this._urlId=f}constructor(f=0,v=0,u=-1,a=-1){this.imageId=u,this.tileId=a,this._ext=0,this._urlId=0,this._ext=f,this._urlId=v}clone(){return new g(this._ext,this._urlId,this.imageId,this.tileId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0&&this.imageId===-1}}let o=new g;t.ImageStorage=class{constructor(c,f,v){this._terminal=c,this._renderer=f,this._opts=v,this._images=new Map,this._lastId=0,this._lowestId=0,this._fullyCleared=!1,this._needsFullClear=!1,this._pixelLimit=25e5;try{this.setLimit(this._opts.storageLimit)}catch(u){console.error(u.message),console.warn(`storageLimit is set to ${this.getLimit()} MB`)}this._viewportMetrics={cols:this._terminal.cols,rows:this._terminal.rows}}dispose(){this.reset()}reset(){var c;for(let f of this._images.values())(c=f.marker)===null||c===void 0||c.dispose();this._images.clear(),this._renderer.clearAll()}getLimit(){return 4*this._pixelLimit/1e6}setLimit(c){if(c<.5||c>1e3)throw RangeError("invalid storageLimit, should be at least 0.5 MB and not exceed 1G");this._pixelLimit=c/4*1e6>>>0,this._evictOldest(0)}getUsage(){return 4*this._getStoredPixels()/1e6}_getStoredPixels(){let c=0;for(let f of this._images.values())f.orig&&(c+=f.orig.width*f.orig.height,f.actual&&f.actual!==f.orig&&(c+=f.actual.width*f.actual.height));return c}_delImg(c){let f=this._images.get(c);this._images.delete(c),f&&window.ImageBitmap&&f.orig instanceof ImageBitmap&&f.orig.close()}wipeAlternate(){var c;let f=[];for(let[v,u]of this._images.entries())u.bufferType==="alternate"&&((c=u.marker)===null||c===void 0||c.dispose(),f.push(v));for(let v of f)this._delImg(v);this._needsFullClear=!0,this._fullyCleared=!1}advanceCursor(c){if(this._opts.sixelScrolling){let f=this._renderer.cellSize;f.width!==-1&&f.height!==-1||(f=t.CELL_SIZE_DEFAULT);let v=Math.ceil(c/f.height);for(let u=1;u<v;++u)this._terminal._core._inputHandler.lineFeed()}}addImage(c){var f;this._evictOldest(c.width*c.height);let v=this._renderer.cellSize;v.width!==-1&&v.height!==-1||(v=t.CELL_SIZE_DEFAULT);let u=Math.ceil(c.width/v.width),a=Math.ceil(c.height/v.height),d=++this._lastId,_=this._terminal._core.buffer,p=this._terminal.cols,m=this._terminal.rows,w=_.x,b=_.y,S=w,A=0;this._opts.sixelScrolling||(_.x=0,_.y=0,S=0),this._terminal._core._inputHandler._dirtyRowTracker.markDirty(_.y);for(let L=0;L<a;++L){let T=_.lines.get(_.y+_.ybase);for(let F=0;F<u&&!(S+F>=p);++F)this._writeToCell(T,S+F,d,L*u+F),A++;if(this._opts.sixelScrolling)L<a-1&&this._terminal._core._inputHandler.lineFeed();else if(++_.y>=m)break;_.x=S}this._terminal._core._inputHandler._dirtyRowTracker.markDirty(_.y),this._opts.sixelScrolling?_.x=S:(_.x=w,_.y=b);let x=[];for(let[L,T]of this._images.entries())T.tileCount<1&&((f=T.marker)===null||f===void 0||f.dispose(),x.push(L));for(let L of x)this._delImg(L);let E=this._terminal.registerMarker(0);E?.onDispose(()=>{this._images.get(d)&&this._delImg(d)}),this._terminal.buffer.active.type==="alternate"&&this._evictOnAlternate();let D={orig:c,origCellSize:v,actual:c,actualCellSize:Object.assign({},v),marker:E||void 0,tileCount:A,bufferType:this._terminal.buffer.active.type};this._images.set(d,D)}render(c){if(!this._renderer.canvas&&this._images.size&&(this._renderer.insertLayerToDom(),!this._renderer.canvas))return;if(this._renderer.rescaleCanvas(),!this._images.size)return this._fullyCleared||(this._renderer.clearAll(),this._fullyCleared=!0,this._needsFullClear=!1),void(this._renderer.canvas&&this._renderer.removeLayerFromDom());this._needsFullClear&&(this._renderer.clearAll(),this._fullyCleared=!0,this._needsFullClear=!1);let{start:f,end:v}=c,u=this._terminal._core.buffer,a=this._terminal._core.cols;this._renderer.clearLines(f,v);for(let d=f;d<=v;++d){let _=u.lines.get(d+u.ydisp);if(!_)return;for(let p=0;p<a;++p)if(268435456&_.getBg(p)){let m=_._extendedAttrs[p]||o,w=m.imageId;if(w===void 0||w===-1)continue;let b=this._images.get(w);if(m.tileId!==-1){let S=m.tileId,A=p,x=1;for(;++p<a&&268435456&_.getBg(p)&&(m=_._extendedAttrs[p]||o)&&m.imageId===w&&m.tileId===S+x;)x++;p--,b?b.actual&&this._renderer.draw(b,S,A,d,x):this._opts.showPlaceholder&&this._renderer.drawPlaceholder(A,d,x),this._fullyCleared=!1}}}}viewportResize(c){var f;if(!this._images.size)return void(this._viewportMetrics=c);if(this._viewportMetrics.cols>=c.cols)return void(this._viewportMetrics=c);let v=this._terminal._core.buffer,u=v.lines.length,a=this._viewportMetrics.cols-1;for(let d=0;d<u;++d){let _=v.lines.get(d);if(268435456&_.getBg(a)){let p=_._extendedAttrs[a]||o,m=p.imageId;if(m===void 0||m===-1)continue;let w=this._images.get(m);if(!w)continue;let b=Math.ceil((((f=w.actual)===null||f===void 0?void 0:f.width)||0)/w.actualCellSize.width);if(p.tileId%b+1>=b)continue;let S=!1;for(let E=a+1;E>c.cols;++E)if(4194303&_._data[3*E+0]){S=!0;break}if(S)continue;let A=Math.min(c.cols,b-p.tileId%b+a),x=p.tileId;for(let E=a+1;E<A;++E)this._writeToCell(_,E,m,++x),w.tileCount++}}this._viewportMetrics=c}getImageAtBufferCell(c,f){var v,u;let a=this._terminal._core.buffer.lines.get(f);if(a&&268435456&a.getBg(c)){let d=a._extendedAttrs[c]||o;if(d.imageId&&d.imageId!==-1){let _=(v=this._images.get(d.imageId))===null||v===void 0?void 0:v.orig;if(window.ImageBitmap&&_ instanceof ImageBitmap){let p=h.ImageRenderer.createCanvas(window.document,_.width,_.height);return(u=p.getContext("2d"))===null||u===void 0||u.drawImage(_,0,0,_.width,_.height),p}return _}}}extractTileAtBufferCell(c,f){let v=this._terminal._core.buffer.lines.get(f);if(v&&268435456&v.getBg(c)){let u=v._extendedAttrs[c]||o;if(u.imageId&&u.imageId!==-1&&u.tileId!==-1){let a=this._images.get(u.imageId);if(a)return this._renderer.extractTile(a,u.tileId)}}}_evictOldest(c){var f;let v=this._getStoredPixels(),u=v;for(;this._pixelLimit<u+c&&this._images.size;){let a=this._images.get(++this._lowestId);a&&a.orig&&(u-=a.orig.width*a.orig.height,a.actual&&a.orig!==a.actual&&(u-=a.actual.width*a.actual.height),(f=a.marker)===null||f===void 0||f.dispose(),this._delImg(this._lowestId))}return v-u}_writeToCell(c,f,v,u){if(268435456&c._data[3*f+2]){let a=c._extendedAttrs[f];if(a){if(a.imageId!==void 0){let d=this._images.get(a.imageId);return d&&d.tileCount--,a.imageId=v,void(a.tileId=u)}return void(c._extendedAttrs[f]=new g(a.ext,a.urlId,v,u))}}c._data[3*f+2]|=268435456,c._extendedAttrs[f]=new g(0,0,v,u)}_evictOnAlternate(){var c,f;for(let a of this._images.values())a.bufferType==="alternate"&&(a.tileCount=0);let v=this._terminal._core.buffer;for(let a=0;a<this._terminal.rows;++a){let d=v.lines.get(a);if(d){for(let _=0;_<this._terminal.cols;++_)if(268435456&d._data[3*_+2]){let p=(c=d._extendedAttrs[_])===null||c===void 0?void 0:c.imageId;if(p){let m=this._images.get(p);m&&m.tileCount++}}}}let u=[];for(let[a,d]of this._images.entries())d.bufferType!=="alternate"||d.tileCount||((f=d.marker)===null||f===void 0||f.dispose(),u.push(a));for(let a of u)this._delImg(a)}}},973:(l,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SixelHandler=void 0;let h=n(477),g=n(782),o=n(710),c=h.PALETTE_ANSI_256;function f(v){return h.BIG_ENDIAN?v:(255&v)<<24|(v>>>8&255)<<16|(v>>>16&255)<<8|v>>>24&255}c.set(h.PALETTE_VT340_COLOR),t.SixelHandler=class{constructor(v,u,a){this._opts=v,this._storage=u,this._coreTerminal=a,this._size=0,this._aborted=!1,(0,o.DecoderAsync)({memoryLimit:4*this._opts.pixelLimit,palette:c,paletteLimit:this._opts.sixelPaletteLimit}).then(d=>this._dec=d)}reset(){this._dec&&(this._dec.release(),this._dec._palette.fill(0),this._dec.init(0,c,this._opts.sixelPaletteLimit))}hook(v){var u;if(this._size=0,this._aborted=!1,this._dec){let a=v.params[1]===1?0:function(d,_){let p=0;if(!_)return p;if(d.isInverse())if(d.isFgDefault())p=f(_.foreground.rgba);else if(d.isFgRGB()){let m=d.constructor.toColorRGB(d.getFgColor());p=(0,h.toRGBA8888)(...m)}else p=f(_.ansi[d.getFgColor()].rgba);else if(d.isBgDefault())p=f(_.background.rgba);else if(d.isBgRGB()){let m=d.constructor.toColorRGB(d.getBgColor());p=(0,h.toRGBA8888)(...m)}else p=f(_.ansi[d.getBgColor()].rgba);return p}(this._coreTerminal._core._inputHandler._curAttrData,(u=this._coreTerminal._core._themeService)===null||u===void 0?void 0:u.colors);this._dec.init(a,null,this._opts.sixelPaletteLimit)}}put(v,u,a){if(!this._aborted&&this._dec){if(this._size+=a-u,this._size>this._opts.sixelSizeLimit)return console.warn("SIXEL: too much data, aborting"),this._aborted=!0,void this._dec.release();try{this._dec.decode(v,u,a)}catch(d){console.warn(`SIXEL: error while decoding image - ${d}`),this._aborted=!0,this._dec.release()}}}unhook(v){var u;if(this._aborted||!v||!this._dec)return!0;let a=this._dec.width,d=this._dec.height;if(!a||!d)return d&&this._storage.advanceCursor(d),!0;let _=g.ImageRenderer.createCanvas(void 0,a,d);return(u=_.getContext("2d"))===null||u===void 0||u.putImageData(new ImageData(this._dec.data8,a,d),0,0),this._dec.memoryUsage>4194304&&this._dec.release(),this._storage.addImage(_),!0}}},859:(l,t)=>{function n(h){for(let g of h)g.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.MutableDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(let h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){let g=this._disposables.indexOf(h);g!==-1&&this._disposables.splice(g,1)}},t.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(h){this._isDisposed||h===this._value||(this._value?.dispose(),this._value=h)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=n,t.getDisposeArrayDisposable=function(h){return{dispose:()=>n(h)}}}},i={};function r(l){var t=i[l];if(t!==void 0)return t.exports;var n=i[l]={exports:{}};return e[l](n,n.exports,r),n.exports}var s={};return(()=>{var l=s;Object.defineProperty(l,"__esModule",{value:!0}),l.ImageAddon=void 0;let t=r(125),n=r(782),h=r(216),g=r(973),o={enableSizeReports:!0,pixelLimit:16777216,sixelSupport:!0,sixelScrolling:!0,sixelPaletteLimit:256,sixelSizeLimit:25e6,storageLimit:128,showPlaceholder:!0,iipSupport:!0,iipSizeLimit:2e7};l.ImageAddon=class{constructor(c){this._disposables=[],this._handlers=new Map,this._opts=Object.assign({},o,c),this._defaultOpts=Object.assign({},o,c)}dispose(){for(let c of this._disposables)c.dispose();this._disposables.length=0,this._handlers.clear()}_disposeLater(...c){for(let f of c)this._disposables.push(f)}activate(c){if(this._terminal=c,this._renderer=new n.ImageRenderer(c),this._storage=new h.ImageStorage(c,this._renderer,this._opts),this._opts.enableSizeReports){let f=c.options.windowOptions||{};f.getWinSizePixels=!0,f.getCellSizePixels=!0,f.getWinSizeChars=!0,c.options.windowOptions=f}if(this._disposeLater(this._renderer,this._storage,c.parser.registerCsiHandler({prefix:"?",final:"h"},f=>this._decset(f)),c.parser.registerCsiHandler({prefix:"?",final:"l"},f=>this._decrst(f)),c.parser.registerCsiHandler({final:"c"},f=>this._da1(f)),c.parser.registerCsiHandler({prefix:"?",final:"S"},f=>this._xtermGraphicsAttributes(f)),c.onRender(f=>{var v;return(v=this._storage)===null||v===void 0?void 0:v.render(f)}),c.parser.registerCsiHandler({intermediates:"!",final:"p"},()=>this.reset()),c.parser.registerEscHandler({final:"c"},()=>this.reset()),c._core._inputHandler.onRequestReset(()=>this.reset()),c.buffer.onBufferChange(()=>{var f;return(f=this._storage)===null||f===void 0?void 0:f.wipeAlternate()}),c.onResize(f=>{var v;return(v=this._storage)===null||v===void 0?void 0:v.viewportResize(f)})),this._opts.sixelSupport){let f=new g.SixelHandler(this._opts,this._storage,c);this._handlers.set("sixel",f),this._disposeLater(c._core._inputHandler._parser.registerDcsHandler({final:"q"},f))}if(this._opts.iipSupport){let f=new t.IIPHandler(this._opts,this._renderer,this._storage,c);this._handlers.set("iip",f),this._disposeLater(c._core._inputHandler._parser.registerOscHandler(1337,f))}}reset(){var c;this._opts.sixelScrolling=this._defaultOpts.sixelScrolling,this._opts.sixelPaletteLimit=this._defaultOpts.sixelPaletteLimit,(c=this._storage)===null||c===void 0||c.reset();for(let f of this._handlers.values())f.reset();return!1}get storageLimit(){var c;return((c=this._storage)===null||c===void 0?void 0:c.getLimit())||-1}set storageLimit(c){var f;(f=this._storage)===null||f===void 0||f.setLimit(c),this._opts.storageLimit=c}get storageUsage(){return this._storage?this._storage.getUsage():-1}get showPlaceholder(){return this._opts.showPlaceholder}set showPlaceholder(c){var f;this._opts.showPlaceholder=c,(f=this._renderer)===null||f===void 0||f.showPlaceholder(c)}getImageAtBufferCell(c,f){var v;return(v=this._storage)===null||v===void 0?void 0:v.getImageAtBufferCell(c,f)}extractTileAtBufferCell(c,f){var v;return(v=this._storage)===null||v===void 0?void 0:v.extractTileAtBufferCell(c,f)}_report(c){var f;(f=this._terminal)===null||f===void 0||f._core.coreService.triggerDataEvent(c)}_decset(c){for(let f=0;f<c.length;++f)c[f]===80&&(this._opts.sixelScrolling=!1);return!1}_decrst(c){for(let f=0;f<c.length;++f)c[f]===80&&(this._opts.sixelScrolling=!0);return!1}_da1(c){return!!c[0]||!!this._opts.sixelSupport&&(this._report("\x1B[?62;4;9;22c"),!0)}_xtermGraphicsAttributes(c){var f,v,u,a,d,_;if(c.length<2)return!0;if(c[0]===1)switch(c[1]){case 1:return this._report(`\x1B[?${c[0]};0;${this._opts.sixelPaletteLimit}S`),!0;case 2:this._opts.sixelPaletteLimit=this._defaultOpts.sixelPaletteLimit,this._report(`\x1B[?${c[0]};0;${this._opts.sixelPaletteLimit}S`);for(let p of this._handlers.values())p.reset();return!0;case 3:return c.length>2&&!(c[2]instanceof Array)&&c[2]<=4096?(this._opts.sixelPaletteLimit=c[2],this._report(`\x1B[?${c[0]};0;${this._opts.sixelPaletteLimit}S`)):this._report(`\x1B[?${c[0]};2S`),!0;case 4:return this._report(`\x1B[?${c[0]};0;4096S`),!0;default:return this._report(`\x1B[?${c[0]};2S`),!0}if(c[0]===2)switch(c[1]){case 1:let p=(v=(f=this._renderer)===null||f===void 0?void 0:f.dimensions)===null||v===void 0?void 0:v.css.canvas.width,m=(a=(u=this._renderer)===null||u===void 0?void 0:u.dimensions)===null||a===void 0?void 0:a.css.canvas.height;if(!p||!m){let b=h.CELL_SIZE_DEFAULT;p=(((d=this._terminal)===null||d===void 0?void 0:d.cols)||80)*b.width,m=(((_=this._terminal)===null||_===void 0?void 0:_.rows)||24)*b.height}if(p*m<this._opts.pixelLimit)this._report(`\x1B[?${c[0]};0;${p.toFixed(0)};${m.toFixed(0)}S`);else{let b=Math.floor(Math.sqrt(this._opts.pixelLimit));this._report(`\x1B[?${c[0]};0;${b};${b}S`)}return!0;case 4:let w=Math.floor(Math.sqrt(this._opts.pixelLimit));return this._report(`\x1B[?${c[0]};0;${w};${w}S`),!0;default:return this._report(`\x1B[?${c[0]};2S`),!0}return this._report(`\x1B[?${c[0]};1S`),!0}}})(),s})())});var Ct={$schema:"https://acode.app/schema/plugin/v0.1.0.json",id:"bajrangcoder.acodex",name:"AcodeX - Terminal",main:"dist/main.js",version:"3.2.0",readme:"readme.md",icon:"icon.png",files:[],minVersionCode:290,license:"MIT",keywords:["terminal","acodex","termux"],changelogs:"ChangeLog.md",contributors:[],author:{name:"Raunak Raj",email:"bajrangcoders@gmail.com",url:"https://github.com/bajrangCoder/acode-plugin-acodex",github:"bajrangCoder"}};function da(e){let r=window.getComputedStyle(e).backgroundColor.match(/\d+/g),s=Number.parseFloat(r[3])||1;return`rgba(${r[0]}, ${r[1]}, ${r[2]}, 0.5)`}function fa(e){let i="";for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);(s>=32&&s<=126||s===13||s===8)&&(i+=e[r])}return i}function Br(e){return e.startsWith("content://com.termux.documents/tree")?e.split("::")[1].substring(0,e.split("::")[1].lastIndexOf("/")).replace(/^\/data\/data\/com\.termux\/files\/home/,"$HOME"):e.startsWith("file:///storage/emulated/0/")?`/sdcard${e.substr(26).replace(/\.[^/.]+$/,"").split("/").slice(0,-1).join("/")}/`:e.startsWith("content://com.android.externalstorage.documents/tree/primary")?`/sdcard/${e.split("::primary:")[1].substring(0,e.split("::primary:")[1].lastIndexOf("/"))}`:!1}function _a(e,i){let r=e.replace("#",""),s=Number.parseInt(r.substring(0,2),16),l=Number.parseInt(r.substring(2,4),16),t=Number.parseInt(r.substring(4,6),16);return`rgba(${s}, ${l}, ${t}, ${i})`}var Ee={snazzy:{background:"#282A36",foreground:"#EFF0EB",cursor:"#EFF0EB",black:"#0C0D13",red:"#FF5C57",green:"#5AF78E",yellow:"#F3F99D",blue:"#57C7FF",magenta:"#FF6AC1",cyan:"#9AEDFE",white:"#EFF0EB",brightBlack:"#686868",brightRed:"#FF5C57",brightGreen:"#5AF78E",brightYellow:"#F3F99D",brightBlue:"#57C7FF",brightMagenta:"#FF6AC1",brightCyan:"#9AEDFE",brightWhite:"#EFF0EB"},xterm:{foreground:"#F8F8F8",background:"#2D2E2C",selectionBackground:"#5DA5D533",black:"#1E1E1D",brightBlack:"#262625",red:"#CE5C5C",brightRed:"#FF7272",green:"#5BCC5B",brightGreen:"#72FF72",yellow:"#CCCC5B",brightYellow:"#FFFF72",blue:"#5D5DD3",brightBlue:"#7279FF",magenta:"#BC5ED1",brightMagenta:"#E572FF",cyan:"#5DA5D5",brightCyan:"#72F0FF",white:"#F8F8F8",brightWhite:"#FFFFFF"},sapphire:{background:"#1c2431",foreground:"#cccccc",selectionBackground:"#399ef440",black:"#666666",blue:"#399ef4",brightBlack:"#666666",brightBlue:"#399ef4",brightCyan:"#21c5c7",brightGreen:"#4eb071",brightMagenta:"#b168df",brightRed:"#da6771",brightWhite:"#efefef",brightYellow:"#fff099",cyan:"#21c5c7",green:"#4eb071",magenta:"#b168df",red:"#da6771",white:"#efefef",yellow:"#fff099"},light:{background:"#ffffff",foreground:"#333333",cursor:"#333333",cursorAccent:"#ffffff",selectionBackground:"#add6ff",black:"#000000",blue:"#0451a5",brightBlack:"#666666",brightBlue:"#0451a5",brightCyan:"#0598bc",brightGreen:"#14ce14",brightMagenta:"#bc05bc",brightRed:"#cd3131",brightWhite:"#a5a5a5",brightYellow:"#b5ba00",cyan:"#0598bc",green:"#00bc00",magenta:"#bc05bc",red:"#cd3131",white:"#555555",yellow:"#949800"},custom:{background:"#1c2431",foreground:"#cccccc",cursor:"#ffffff",cursorAccent:"#fff",selectionBackground:"#399ef440",black:"#666666",blue:"#399ef4",brightBlack:"#666666",brightBlue:"#399ef4",brightCyan:"#21c5c7",brightGreen:"#4eb071",brightMagenta:"#b168df",brightRed:"#da6771",brightWhite:"#efefef",brightYellow:"#fff099",cyan:"#21c5c7",green:"#4eb071",magenta:"#b168df",red:"#da6771",white:"#efefef",yellow:"#fff099"},ayuDark:{background:"#090D13",foreground:"#FEFEFE",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#C6C6C6",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#FEFEFE"},catppuccin:{background:"#1e1e2e",foreground:"#cdd6f4",cursor:"#f5e0dc",cursorAccent:"#1e1e2e",selection:"#585b70",black:"#45475a",red:"#f38ba8",green:"#a6e3a1",yellow:"#f9e2af",blue:"#89b4fa",magenta:"#f5c2e7",cyan:"#94e2d5",white:"#bac2de",brightBlack:"#585b70",brightRed:"#f38ba8",brightGreen:"#a6e3a1",brightYellow:"#f9e2af",brightBlue:"#89b4fa",brightMagenta:"#f5c2e7",brightCyan:"#94e2d5",brightWhite:"#a6adc8"},wal:{background:"#181820",foreground:"#e5e7eb",cursor:"#6366f1",cursorAccent:"#181820",selection:"#374151",black:"#0f0f14",red:"#f87171",green:"#4ade80",yellow:"#fbbf24",blue:"#6366f1",magenta:"#a78bfa",cyan:"#22d3ee",white:"#e5e7eb",brightBlack:"#1f1f2a",brightRed:"#fca5a5",brightGreen:"#86efac",brightYellow:"#fcd34d",brightBlue:"#818cf8",brightMagenta:"#c4b5fd",brightCyan:"#67e8f9",brightWhite:"#f3f4f6"},oneDark:{background:"#1E2127",foreground:"#5C6370",cursor:"#5C6370",black:"#000000",red:"#E06C75",green:"#98C379",yellow:"#D19A66",blue:"#61AFEF",magenta:"#C678DD",cyan:"#56B6C2",white:"#ABB2BF",brightBlack:"#5C6370",brightRed:"#E06C75",brightGreen:"#98C379",brightYellow:"#D19A66",brightBlue:"#61AFEF",brightMagenta:"#C678DD",brightCyan:"#56B6C2",brightWhite:"#FFFEFE"},material:{background:"#1E282C",foreground:"#C3C7D1",cursor:"#657B83",black:"#073641",red:"#EB606B",green:"#C3E88D",yellow:"#F7EB95",blue:"#80CBC3",magenta:"#FF2490",cyan:"#AEDDFF",white:"#FFFFFF",brightBlack:"#002B36",brightRed:"#EB606B",brightGreen:"#C3E88D",brightYellow:"#F7EB95",brightBlue:"#7DC6BF",brightMagenta:"#6C71C3",brightCyan:"#34434D",brightWhite:"#FFFFFF"},nekonakoDjancoeg:{background:"#2a2c3a",foreground:"#eeeeee",cursor:"#fd6b85",black:"#2f343f",red:"#fd6b85",green:"#63e0be",yellow:"#fed270",blue:"#67d4f2",magenta:"#ff8167",cyan:"#63e0be",white:"#eeeeee",brightBlack:"#4f4f5b",brightRed:"#fd6b85",brightGreen:"#63e0be",brightYellow:"#fed270",brightBlue:"#67d4f2",brightMagenta:"#ff8167",brightCyan:"#63e0be",brightWhite:"#eeeeee"},dracula:{background:"#282a36",foreground:"#94A3A5",cursor:"#94A3A5",black:"#44475a",red:"#ff5555",green:"#50fa7b",yellow:"#ffb86c",blue:"#8be9fd",magenta:"#bd93f9",cyan:"#ff79c6",white:"#94A3A5",brightBlack:"#000000",brightRed:"#ff5555",brightGreen:"#50fa7b",brightYellow:"#ffb86c",brightBlue:"#8be9fd",brightMagenta:"#bd93f9",brightCyan:"#ff79c6",brightWhite:"#ffffff"},ayuMirage:{background:"#1F2430",foreground:"#E5E0CE",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#C6C6C6",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#FEFEFE"},siduckOneDark:{background:"#1e222a",foreground:"#c8ccd4",cursor:"#e06c75",black:"#1e222a",red:"#e06c75",green:"#98c379",yellow:"#e5c07b",blue:"#61afef",magenta:"#c678dd",cyan:"#56b6c2",white:"#D8DEE9",brightBlack:"#545862",brightRed:"#e06c75",brightGreen:"#98c379",brightYellow:"#e5c07b",brightBlue:"#61afef",brightMagenta:"#c678dd",brightCyan:"#56b6c2",brightWhite:"#c8ccd4"},elementary:{background:"#101010",foreground:"#f2f2f2",cursor:"#f2f2f2",black:"#303030",red:"#e1321a",green:"#6ab017",yellow:"#ffc005",blue:"#004f9e",magenta:"#ec0048",cyan:"#2aa7e7",white:"#f2f2f2",brightBlack:"#5d5d5d",brightRed:"#ff361e",brightGreen:"#7bc91f",brightYellow:"#ffd00a",brightBlue:"#0071ff",brightMagenta:"#ff1d62",brightCyan:"#4bb8fd",brightWhite:"#a020f0"},ayuLight:{background:"#FEFEFE",foreground:"#090D13",cursor:"#E96B72",black:"#00050D",red:"#E96B72",green:"#90B261",yellow:"#F8AE4E",blue:"#52BCF9",magenta:"#F9E893",cyan:"#8FE0C5",white:"#c6c6c694",brightBlack:"#676767",brightRed:"#EF7077",brightGreen:"#C1D84B",brightYellow:"#FEB353",brightBlue:"#58C1FE",brightMagenta:"#FEED98",brightCyan:"#94E5CA",brightWhite:"#dacaca"},everblush:{name:"Everblush",background:"#141b1e",foreground:"#dadada",cursor:"#3b4244",black:"#232a2d",red:"#e57474",green:"#8ccf7e",yellow:"#e5c76b",blue:"#67b0e8",magenta:"#c47fd5",cyan:"#6cbfbf",white:"#b3b9b8",brightBlack:"#2d3437",brightRed:"#ef7e7e",brightGreen:"#96d988",brightYellow:"#f4d67a",brightBlue:"#71baf2",brightMagenta:"#ce89df",brightCyan:"#67cbe7",brightWhite:"#bdc3c2"}};var Qe=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},We={searchParams:"URLSearchParams"in Qe,iterable:"Symbol"in Qe&&"iterator"in Symbol,blob:"FileReader"in Qe&&"Blob"in Qe&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Qe,arrayBuffer:"ArrayBuffer"in Qe};function Qd(e){return e&&DataView.prototype.isPrototypeOf(e)}We.arrayBuffer&&(ga=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],va=ArrayBuffer.isView||function(e){return e&&ga.indexOf(Object.prototype.toString.call(e))>-1});var ga,va;function ci(e){if(typeof e!="string"&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||e==="")throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function rn(e){return typeof e!="string"&&(e=String(e)),e}function sn(e){var i={next:function(){var r=e.shift();return{done:r===void 0,value:r}}};return We.iterable&&(i[Symbol.iterator]=function(){return i}),i}function Oe(e){this.map={},e instanceof Oe?e.forEach(function(i,r){this.append(r,i)},this):Array.isArray(e)?e.forEach(function(i){if(i.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+i.length);this.append(i[0],i[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(i){this.append(i,e[i])},this)}Oe.prototype.append=function(e,i){e=ci(e),i=rn(i);var r=this.map[e];this.map[e]=r?r+", "+i:i};Oe.prototype.delete=function(e){delete this.map[ci(e)]};Oe.prototype.get=function(e){return e=ci(e),this.has(e)?this.map[e]:null};Oe.prototype.has=function(e){return this.map.hasOwnProperty(ci(e))};Oe.prototype.set=function(e,i){this.map[ci(e)]=rn(i)};Oe.prototype.forEach=function(e,i){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(i,this.map[r],r,this)};Oe.prototype.keys=function(){var e=[];return this.forEach(function(i,r){e.push(r)}),sn(e)};Oe.prototype.values=function(){var e=[];return this.forEach(function(i){e.push(i)}),sn(e)};Oe.prototype.entries=function(){var e=[];return this.forEach(function(i,r){e.push([r,i])}),sn(e)};We.iterable&&(Oe.prototype[Symbol.iterator]=Oe.prototype.entries);function tn(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}}function ma(e){return new Promise(function(i,r){e.onload=function(){i(e.result)},e.onerror=function(){r(e.error)}})}function Kd(e){var i=new FileReader,r=ma(i);return i.readAsArrayBuffer(e),r}function Xd(e){var i=new FileReader,r=ma(i),s=/charset=([A-Za-z0-9_-]+)/.exec(e.type),l=s?s[1]:"utf-8";return i.readAsText(e,l),r}function Nd(e){for(var i=new Uint8Array(e),r=new Array(i.length),s=0;s<i.length;s++)r[s]=String.fromCharCode(i[s]);return r.join("")}function pa(e){if(e.slice)return e.slice(0);var i=new Uint8Array(e.byteLength);return i.set(new Uint8Array(e)),i.buffer}function ya(){return this.bodyUsed=!1,this._initBody=function(e){this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?typeof e=="string"?this._bodyText=e:We.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:We.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:We.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():We.arrayBuffer&&We.blob&&Qd(e)?(this._bodyArrayBuffer=pa(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):We.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||va(e))?this._bodyArrayBuffer=pa(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof e=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):We.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},We.blob&&(this.blob=function(){var e=tn(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var e=tn(this);return e||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(We.blob)return this.blob().then(Kd);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var e=tn(this);if(e)return e;if(this._bodyBlob)return Xd(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(Nd(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},We.formData&&(this.formData=function(){return this.text().then(Wd)}),this.json=function(){return this.text().then(JSON.parse)},this}var Ud=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function $d(e){var i=e.toUpperCase();return Ud.indexOf(i)>-1?i:e}function qt(e,i){if(!(this instanceof qt))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');i=i||{};var r=i.body;if(e instanceof qt){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,i.headers||(this.headers=new Oe(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,!r&&e._bodyInit!=null&&(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=i.credentials||this.credentials||"same-origin",(i.headers||!this.headers)&&(this.headers=new Oe(i.headers)),this.method=$d(i.method||this.method||"GET"),this.mode=i.mode||this.mode||null,this.signal=i.signal||this.signal||function(){if("AbortController"in Qe){var t=new AbortController;return t.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),(this.method==="GET"||this.method==="HEAD")&&(i.cache==="no-store"||i.cache==="no-cache")){var s=/([?&])_=[^&]*/;if(s.test(this.url))this.url=this.url.replace(s,"$1_="+new Date().getTime());else{var l=/\?/;this.url+=(l.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}qt.prototype.clone=function(){return new qt(this,{body:this._bodyInit})};function Wd(e){var i=new FormData;return e.trim().split("&").forEach(function(r){if(r){var s=r.split("="),l=s.shift().replace(/\+/g," "),t=s.join("=").replace(/\+/g," ");i.append(decodeURIComponent(l),decodeURIComponent(t))}}),i}function zd(e){var i=new Oe,r=e.replace(/\r?\n[\t ]+/g," ");return r.split("\r").map(function(s){return s.indexOf(`
`)===0?s.substr(1,s.length):s}).forEach(function(s){var l=s.split(":"),t=l.shift().trim();if(t){var n=l.join(":").trim();try{i.append(t,n)}catch(h){console.warn("Response "+h.message)}}}),i}ya.call(qt.prototype);function ft(e,i){if(!(this instanceof ft))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(i||(i={}),this.type="default",this.status=i.status===void 0?200:i.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=i.statusText===void 0?"":""+i.statusText,this.headers=new Oe(i.headers),this.url=i.url||"",this._initBody(e)}ya.call(ft.prototype);ft.prototype.clone=function(){return new ft(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Oe(this.headers),url:this.url})};ft.error=function(){var e=new ft(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var jd=[301,302,303,307,308];ft.redirect=function(e,i){if(jd.indexOf(i)===-1)throw new RangeError("Invalid status code");return new ft(null,{status:i,headers:{location:e}})};var Gt=Qe.DOMException;try{new Gt}catch{Gt=function(i,r){this.message=i,this.name=r;var s=Error(i);this.stack=s.stack},Gt.prototype=Object.create(Error.prototype),Gt.prototype.constructor=Gt}function ba(e,i){return new Promise(function(r,s){var l=new qt(e,i);if(l.signal&&l.signal.aborted)return s(new Gt("Aborted","AbortError"));var t=new XMLHttpRequest;function n(){t.abort()}t.onload=function(){var o={statusText:t.statusText,headers:zd(t.getAllResponseHeaders()||"")};l.url.indexOf("file://")===0&&(t.status<200||t.status>599)?o.status=200:o.status=t.status,o.url="responseURL"in t?t.responseURL:o.headers.get("X-Request-URL");var c="response"in t?t.response:t.responseText;setTimeout(function(){r(new ft(c,o))},0)},t.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},t.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},t.onabort=function(){setTimeout(function(){s(new Gt("Aborted","AbortError"))},0)};function h(o){try{return o===""&&Qe.location.href?Qe.location.href:o}catch{return o}}if(t.open(l.method,h(l.url),!0),l.credentials==="include"?t.withCredentials=!0:l.credentials==="omit"&&(t.withCredentials=!1),"responseType"in t&&(We.blob?t.responseType="blob":We.arrayBuffer&&(t.responseType="arraybuffer")),i&&typeof i.headers=="object"&&!(i.headers instanceof Oe||Qe.Headers&&i.headers instanceof Qe.Headers)){var g=[];Object.getOwnPropertyNames(i.headers).forEach(function(o){g.push(ci(o)),t.setRequestHeader(o,rn(i.headers[o]))}),l.headers.forEach(function(o,c){g.indexOf(c)===-1&&t.setRequestHeader(c,o)})}else l.headers.forEach(function(o,c){t.setRequestHeader(c,o)});l.signal&&(l.signal.addEventListener("abort",n),t.onreadystatechange=function(){t.readyState===4&&l.signal.removeEventListener("abort",n)}),t.send(typeof l._bodyInit>"u"?null:l._bodyInit)})}ba.polyfill=!0;Qe.fetch||(Qe.fetch=ba,Qe.Headers=Oe,Qe.Request=qt,Qe.Response=ft);var Gd="0.5.13",wa="11434",Ca=`http://127.0.0.1:${wa}`,qd=Object.defineProperty,Vd=(e,i,r)=>i in e?qd(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,nn=(e,i,r)=>(Vd(e,typeof i!="symbol"?i+"":i,r),r),an=class e extends Error{constructor(i,r){super(i),this.error=i,this.status_code=r,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,e)}},ln=class{constructor(i,r,s){nn(this,"abortController"),nn(this,"itr"),nn(this,"doneCallback"),this.abortController=i,this.itr=r,this.doneCallback=s}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(let i of this.itr){if("error"in i)throw new Error(i.error);if(yield i,i.done||i.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}},hn=async e=>{if(e.ok)return;let i=`Error ${e.status}: ${e.statusText}`,r=null;if(e.headers.get("content-type")?.includes("application/json"))try{r=await e.json(),i=r.error||i}catch{console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),i=await e.text()||i}catch{console.log("Failed to get text from error response")}throw new an(i,e.status)};function Yd(){return typeof window<"u"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process<"u"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}var cn=async(e,i,r={})=>{let s={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${Gd} (${Yd()})`};r.headers||(r.headers={});let l=Object.fromEntries(Object.entries(r.headers).filter(([t])=>!Object.keys(s).some(n=>n.toLowerCase()===t.toLowerCase())));return r.headers={...s,...l},e(i,r)},Aa=async(e,i,r)=>{let s=await cn(e,i,{headers:r?.headers});return await hn(s),s},ui=async(e,i,r,s)=>{let t=(h=>h!==null&&typeof h=="object"&&!Array.isArray(h))(r)?JSON.stringify(r):r,n=await cn(e,i,{method:"POST",body:t,signal:s?.signal,headers:s?.headers});return await hn(n),n},Jd=async(e,i,r,s)=>{let l=await cn(e,i,{method:"DELETE",body:JSON.stringify(r),headers:s?.headers});return await hn(l),l},Zd=async function*(e){let i=new TextDecoder("utf-8"),r="",s=e.getReader();for(;;){let{done:l,value:t}=await s.read();if(l)break;r+=i.decode(t);let n=r.split(`
`);r=n.pop()??"";for(let h of n)try{yield JSON.parse(h)}catch{console.warn("invalid json: ",h)}}for(let l of r.split(`
`).filter(t=>t!==""))try{yield JSON.parse(l)}catch{console.warn("invalid json: ",l)}},ef=e=>{if(!e)return Ca;let i=e.includes("://");e.startsWith(":")&&(e=`http://127.0.0.1${e}`,i=!0),i||(e=`http://${e}`);let r=new URL(e),s=r.port;s||(i?s=r.protocol==="https:"?"443":"80":s=wa);let l=`${r.protocol}//${r.hostname}:${s}${r.pathname}`;return l.endsWith("/")&&(l=l.slice(0,-1)),l},tf=Object.defineProperty,rf=(e,i,r)=>i in e?tf(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,on=(e,i,r)=>(rf(e,typeof i!="symbol"?i+"":i,r),r),un=class{constructor(i){on(this,"config"),on(this,"fetch"),on(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:i?.headers},i?.proxy||(this.config.host=ef(i?.host??Ca)),this.fetch=i?.fetch??fetch}abort(){for(let i of this.ongoingStreamedRequests)i.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(i,r){r.stream=r.stream??!1;let s=`${this.config.host}/api/${i}`;if(r.stream){let t=new AbortController,n=await ui(this.fetch,s,r,{signal:t.signal,headers:this.config.headers});if(!n.body)throw new Error("Missing body");let h=Zd(n.body),g=new ln(t,h,()=>{let o=this.ongoingStreamedRequests.indexOf(g);o>-1&&this.ongoingStreamedRequests.splice(o,1)});return this.ongoingStreamedRequests.push(g),g}return await(await ui(this.fetch,s,r,{headers:this.config.headers})).json()}async encodeImage(i){if(typeof i!="string"){let r=new Uint8Array(i),s="",l=r.byteLength;for(let t=0;t<l;t++)s+=String.fromCharCode(r[t]);return btoa(s)}return i}async generate(i){return i.images&&(i.images=await Promise.all(i.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",i)}async chat(i){if(i.messages)for(let r of i.messages)r.images&&(r.images=await Promise.all(r.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",i)}async create(i){return this.processStreamableRequest("create",{...i})}async pull(i){return this.processStreamableRequest("pull",{name:i.model,stream:i.stream,insecure:i.insecure})}async push(i){return this.processStreamableRequest("push",{name:i.model,stream:i.stream,insecure:i.insecure})}async delete(i){return await Jd(this.fetch,`${this.config.host}/api/delete`,{name:i.model},{headers:this.config.headers}),{status:"success"}}async copy(i){return await ui(this.fetch,`${this.config.host}/api/copy`,{...i},{headers:this.config.headers}),{status:"success"}}async list(){return await(await Aa(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers})).json()}async show(i){return await(await ui(this.fetch,`${this.config.host}/api/show`,{...i},{headers:this.config.headers})).json()}async embed(i){return await(await ui(this.fetch,`${this.config.host}/api/embed`,{...i},{headers:this.config.headers})).json()}async embeddings(i){return await(await ui(this.fetch,`${this.config.host}/api/embeddings`,{...i},{headers:this.config.headers})).json()}async ps(){return await(await Aa(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers})).json()}},em=new un;var dn=class{constructor(i=null){if(this.apiKey=i,this.deepseekAPI="https://api.deepseek.com/v1/chat/completions",this.chatgptAPI="https://api.openai.com/v1/chat/completions",this.geminiAPI=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-lite:generateContent?key=${this.apiKey}`,!i){let r=localStorage.getItem("Ollama-Host")||"http://localhost:11434";this.ollama=new un({host:r})}}getSystemPrompt(){return`You are a terminal command assistant designed to help users with command-line tasks. Only respond with the exact command(s) needed, with no explanations or markdown formatting. Examples:
    - 'Show current directory': pwd
    - 'List all files': ls -la
    - 'Create new folder docs': mkdir docs
    If a query is not related to terminal commands, do not respond. Multiple commands should be separated by semicolons. Keep responses minimal and focused only on valid terminal commands.`}async generateDeepseekResponse(i){let r={model:"deepseek-chat",messages:[{role:"system",content:this.getSystemPrompt()},{role:"user",content:i}]};return this._fetchAndProcessResponse(this.deepseekAPI,r,this.apiKey)}async generateChatgptResponse(i){let r={model:"gpt-3.5-turbo-0125",messages:[{role:"system",content:this.getSystemPrompt()},{role:"user",content:i}]};return this._fetchAndProcessResponse(this.chatgptAPI,r,this.apiKey)}async generateGeminiResponse(i){let s={contents:[{parts:[{text:`${this.getSystemPrompt()} My query: ${i}`}]}]};return this._fetchAndProcessResponse(this.geminiAPI,s,null)}async getListOfOllamaModels(){try{return(await this.ollama.list()).models.map(s=>s.model)}catch(i){return i}}async generateOllamaResponse(i,r){try{return await this.ollama.generate({model:i,system:this.getSystemPrompt(),prompt:r})}catch(s){return s}}async _fetchAndProcessResponse(i,r,s){try{let l={"Content-Type":"application/json"};s&&(l.Authorization=`Bearer ${s}`);let t=await fetch(i,{method:"POST",headers:l,body:JSON.stringify(r)}),n=await t.json();if(t.ok)return{response:n};throw new Error(n.detail?n.detail:n.error.message||"Failed to fetch response")}catch(l){return{error:l.message}}}},xa=dn;var Pi=class{constructor(i,r,s={},l={}){this.terminal=i,this.terminalContent=r,this.settings=s,this.options={tapHoldDuration:600,moveThreshold:8,handleSize:24,fingerOffset:40,hapticFeedback:!!s?.selectionHaptics,showContextMenu:!0,zoomThrottle:50,minFontSize:8,maxFontSize:48,onFontSizeChange:null,...l},this.options.minFontSize=Number(this.options.minFontSize)||8,this.options.maxFontSize=Number(this.options.maxFontSize)||48,this.options.minFontSize>this.options.maxFontSize&&([this.options.minFontSize,this.options.maxFontSize]=[this.options.maxFontSize,this.options.minFontSize]),typeof this.options.onFontSizeChange!="function"&&(this.options.onFontSizeChange=t=>{this.terminal.options.fontSize=t,this.terminal.refresh?.(0,this.terminal.rows-1)}),this.isSelecting=!1,this.isHandleDragging=!1,this.selectionStart=null,this.selectionEnd=null,this.currentSelection=null,this.dragHandle=null,this.isSelectionTouchActive=!1,this.pendingSelectionClearTouch=null,this.touchStartTime=0,this.touchStartPos={x:0,y:0},this.initialTouchPos={x:0,y:0},this.tapHoldTimeout=null,this.isPinching=!1,this.pinchStartDistance=0,this.lastPinchDistance=0,this.initialFontSize=0,this.lastZoomTime=0,this.selectionOverlay=null,this.startHandle=null,this.endHandle=null,this.contextMenu=null,this.contextMenuShouldStayVisible=!1,this.cellDimensions={width:0,height:0},this.boundHandlers={},this.wasFocusedBeforeSelection=!1,this.selectionProtected=!1,this.protectionTimeout=null,this.scrollElement=null,this.isTerminalScrolling=!1,this.scrollEndTimeout=null,this.scrollEndDelay=100,this.selectionChangeDisposable=null,this.resizeDisposable=null,this.init()}init(){this.createSelectionOverlay(),this.createHandles(),this.attachEventListeners(),this.updateCellDimensions()}createSelectionOverlay(){this.selectionOverlay=document.createElement("div"),this.selectionOverlay.className="terminal-selection-overlay",this.selectionOverlay.style.cssText=`
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
      overflow: hidden;
    `,this.terminalContent.appendChild(this.selectionOverlay)}createHandles(){this.startHandle=this.createHandle("start"),this.startHandle.style.cssText+=`
      border-radius: 50% 50% 50% 0;
    `,this.setHandleOrientation(this.startHandle,"start"),this.endHandle=this.createHandle("end"),this.endHandle.style.cssText+=`
      border-radius: 50% 50% 50% 0;
    `,this.setHandleOrientation(this.endHandle,"end"),this.selectionOverlay.appendChild(this.startHandle),this.selectionOverlay.appendChild(this.endHandle)}createHandle(i){let r=document.createElement("div");return r.className=`terminal-selection-handle terminal-selection-handle-${i}`,r.style.cssText=`
      position: absolute;
      width: ${this.options.handleSize}px;
      height: ${this.options.handleSize}px;
      background: #2196F3;
      border: 2px solid #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      display: none;
      pointer-events: auto;
      touch-action: none;
      z-index: 101;
      cursor: grab;
    `,r.dataset.handleType=i,r}attachEventListeners(){this.boundHandlers.terminalTouchStart=this.onTerminalTouchStart.bind(this),this.boundHandlers.terminalTouchMove=this.onTerminalTouchMove.bind(this),this.boundHandlers.terminalTouchEnd=this.onTerminalTouchEnd.bind(this),this.terminal.element.addEventListener("touchstart",this.boundHandlers.terminalTouchStart,{passive:!1}),this.terminal.element.addEventListener("touchmove",this.boundHandlers.terminalTouchMove,{passive:!1}),this.terminal.element.addEventListener("touchend",this.boundHandlers.terminalTouchEnd,{passive:!1}),this.boundHandlers.handleTouchStart=this.onHandleTouchStart.bind(this),this.boundHandlers.handleTouchMove=this.onHandleTouchMove.bind(this),this.boundHandlers.handleTouchEnd=this.onHandleTouchEnd.bind(this),this.startHandle.addEventListener("touchstart",this.boundHandlers.handleTouchStart,{passive:!1}),this.startHandle.addEventListener("touchmove",this.boundHandlers.handleTouchMove,{passive:!1}),this.startHandle.addEventListener("touchend",this.boundHandlers.handleTouchEnd,{passive:!1}),this.endHandle.addEventListener("touchstart",this.boundHandlers.handleTouchStart,{passive:!1}),this.endHandle.addEventListener("touchmove",this.boundHandlers.handleTouchMove,{passive:!1}),this.endHandle.addEventListener("touchend",this.boundHandlers.handleTouchEnd,{passive:!1}),this.boundHandlers.selectionChange=this.onSelectionChange.bind(this),this.selectionChangeDisposable=this.terminal.onSelectionChange?this.terminal.onSelectionChange(this.boundHandlers.selectionChange):null,this.boundHandlers.orientationChange=this.onOrientationChange.bind(this),window.addEventListener("orientationchange",this.boundHandlers.orientationChange),window.addEventListener("resize",this.boundHandlers.orientationChange),this.boundHandlers.terminalScroll=this.onTerminalScroll.bind(this),this.scrollElement=this.terminal.element.querySelector(".xterm-viewport")||this.terminal.element,this.scrollElement.addEventListener("scroll",this.boundHandlers.terminalScroll,{passive:!0}),this.boundHandlers.terminalResize=this.onTerminalResize.bind(this),this.resizeDisposable=this.terminal.onResize?this.terminal.onResize(this.boundHandlers.terminalResize):null,this.boundHandlers.documentTouchStart=this.onDocumentTouchStart.bind(this),document.addEventListener("touchstart",this.boundHandlers.documentTouchStart,{passive:!0})}onTerminalTouchStart(i){if(i.touches.length===2){i.preventDefault(),this.startPinchZoom(i);return}if(i.touches.length!==1)return;let r=i.touches[0];if(this.touchStartTime=Date.now(),this.touchStartPos={x:r.clientX,y:r.clientY},this.initialTouchPos={x:r.clientX,y:r.clientY},this.isSelecting){this.isSelectionTouchActive=!1,this.pendingSelectionClearTouch={x:r.clientX,y:r.clientY,moved:!1},this.hideContextMenu(!0);return}this.isEdgeGesture(r)||(this.tapHoldTimeout&&clearTimeout(this.tapHoldTimeout),this.pendingSelectionClearTouch=null,this.isSelectionTouchActive=!1,this.tapHoldTimeout=setTimeout(()=>{!this.isSelecting&&!this.isPinching&&this.startSelection(r)},this.options.tapHoldDuration))}onTerminalTouchMove(i){if(i.touches.length===2){i.preventDefault(),this.handlePinchZoom(i);return}if(i.touches.length!==1||this.isPinching)return;let r=i.touches[0],s=Math.abs(r.clientX-this.touchStartPos.x),l=Math.abs(r.clientY-this.touchStartPos.y),t=r.clientX-this.touchStartPos.x,n=this.pendingSelectionClearTouch;if(n){let h=Math.abs(r.clientX-n.x),g=Math.abs(r.clientY-n.y);(h>this.options.moveThreshold||g>this.options.moveThreshold)&&(n.moved=!0)}if(this.isEdgeGesture(this.initialTouchPos)&&Math.abs(t)>l&&s>this.options.moveThreshold){this.tapHoldTimeout&&(clearTimeout(this.tapHoldTimeout),this.tapHoldTimeout=null);return}(s>this.options.moveThreshold||l>this.options.moveThreshold)&&(this.tapHoldTimeout&&(clearTimeout(this.tapHoldTimeout),this.tapHoldTimeout=null),this.isSelecting&&!this.isHandleDragging&&this.isSelectionTouchActive&&(i.preventDefault(),this.extendSelection(r)))}onTerminalTouchEnd(i){if(this.isPinching){this.endPinchZoom();return}this.tapHoldTimeout&&(clearTimeout(this.tapHoldTimeout),this.tapHoldTimeout=null);let r=this.isSelecting&&!this.isHandleDragging&&this.pendingSelectionClearTouch&&!this.pendingSelectionClearTouch.moved&&!this.isTerminalScrolling&&!this.selectionProtected;if(this.pendingSelectionClearTouch=null,this.isSelectionTouchActive=!1,r){this.clearSelection();return}if(this.isSelecting&&!this.isHandleDragging){if(this.isTerminalScrolling)return;this.finalizeSelection()}else this.isSelecting||this.isTerminalFocused()&&this.terminal.focus()}onHandleTouchStart(i){if(i.preventDefault(),i.stopPropagation(),i.touches.length!==1)return;let r=i.target.dataset.handleType;if(r||(i.target===this.startHandle||this.startHandle.contains(i.target)?r="start":(i.target===this.endHandle||this.endHandle.contains(i.target))&&(r="end")),!r)return;this.isHandleDragging=!0,this.dragHandle=r,this.isSelectionTouchActive=!1,this.pendingSelectionClearTouch=null;let s=i.touches[0];this.initialTouchPos={x:s.clientX,y:s.clientY};let l=r==="start"?this.startHandle:this.endHandle;l.style.cursor="grabbing",l.style.transform.includes("scale")||(l.style.transform+=" scale(1.2)")}onHandleTouchMove(i){if(!this.isHandleDragging||i.touches.length!==1)return;i.preventDefault(),i.stopPropagation();let r=i.touches[0],s=Math.abs(r.clientX-this.initialTouchPos.x),l=Math.abs(r.clientY-this.initialTouchPos.y);if(s<this.options.moveThreshold&&l<this.options.moveThreshold)return;let t={clientX:r.clientX,clientY:r.clientY-this.options.fingerOffset},n=this.touchToTerminalCoords(t);if(n){if(this.dragHandle==="start"){if(this.selectionStart=n,this.selectionEnd&&(n.row>this.selectionEnd.row||n.row===this.selectionEnd.row&&n.col>this.selectionEnd.col)){let h=this.selectionStart;this.selectionStart=this.selectionEnd,this.selectionEnd=h,this.dragHandle="end"}}else if(this.selectionEnd=n,this.selectionStart&&(n.row<this.selectionStart.row||n.row===this.selectionStart.row&&n.col<this.selectionStart.col)){let h=this.selectionEnd;this.selectionEnd=this.selectionStart,this.selectionStart=h,this.dragHandle="start"}this.updateSelection()}}onHandleTouchEnd(i){this.isHandleDragging&&(i.preventDefault(),i.stopPropagation(),this.isHandleDragging=!1,this.dragHandle=null,[this.startHandle,this.endHandle].forEach(r=>{r.style.cursor="grab",r.style.transform=r.style.transform.replace(/\s*scale\([^)]*\)/g,"").trim()}),this.finalizeSelection())}onSelectionChange(){if(!this.isSelecting)return;let i=this.terminal.getSelection?.();i&&i.length>0&&(this.currentSelection=i,this.updateHandlePositions())}onDocumentTouchStart(i){this.isSelecting&&i.target&&(this.terminalContent.contains(i.target)||this.forceClearSelection())}onOrientationChange(){setTimeout(()=>{this.updateCellDimensions(),this.isSelecting&&this.updateHandlePositions()},100)}onTerminalScroll(){!this.isSelecting||this.isHandleDragging||(this.isTerminalScrolling=!0,this.hideHandles(),this.hideContextMenu(!0),this.scrollEndTimeout&&clearTimeout(this.scrollEndTimeout),this.scrollEndTimeout=setTimeout(()=>{this.onTerminalScrollEnd()},this.scrollEndDelay))}onTerminalScrollEnd(){this.scrollEndTimeout=null,this.isTerminalScrolling=!1,!(!this.isSelecting||this.isHandleDragging)&&(this.updateHandlePositions(),this.contextMenuShouldStayVisible&&this.options.showContextMenu&&this.showContextMenu())}onTerminalResize(i){setTimeout(()=>{if(this.updateCellDimensions(),!!this.isSelecting){if(this.selectionProtected){this.updateHandlePositions();return}if(this.selectionStart&&this.selectionEnd&&(this.selectionStart.row>=i.rows||this.selectionEnd.row>=i.rows)){this.clearSelection();return}this.updateHandlePositions(),this.contextMenu&&this.contextMenu.style.display==="flex"&&(this.hideContextMenu(!0),setTimeout(()=>{this.isSelecting&&this.options.showContextMenu&&this.showContextMenu()},100))}},50)}startSelection(i){let r=this.touchToTerminalCoords(i);if(!r)return;this.wasFocusedBeforeSelection=this.isTerminalFocused(),this.selectionProtected=!0,this.protectionTimeout&&clearTimeout(this.protectionTimeout),this.protectionTimeout=setTimeout(()=>{this.selectionProtected=!1},1e3),this.isSelecting=!0,this.isSelectionTouchActive=!0,this.pendingSelectionClearTouch=null;let s=this.getWordBoundsAt(r);s?(this.selectionStart=s.start,this.selectionEnd=s.end):(this.selectionStart=r,this.selectionEnd=r),this.terminal.clearSelection?.(),this.updateSelection(),this.currentSelection=this.terminal.getSelection?.(),this.showHandles(),this.options.showContextMenu&&this.showContextMenu(),this.options.hapticFeedback&&navigator?.vibrate&&navigator.vibrate(50)}extendSelection(i){let r=this.touchToTerminalCoords(i);r&&(this.selectionEnd=r,this.updateSelection())}updateSelection(){if(!this.selectionStart||!this.selectionEnd)return;let i=this.selectionStart,r=this.selectionEnd,s=i.row,l=i.col,t=r.row,n=r.col;(s>t||s===t&&l>n)&&([s,l,t,n]=[t,n,s,l]);let h=this.calculateSelectionLength(s,l,t,n);this.terminal.clearSelection?.(),this.terminal.select?.(l,s,h),this.updateHandlePositions(),this.contextMenuShouldStayVisible&&this.options.showContextMenu&&this.showContextMenu()}calculateSelectionLength(i,r,s,l){if(i===s)return l-r+1;let t=this.terminal.cols,n=t-r;return n+=(s-i-1)*t,n+=l+1,n}finalizeSelection(){this.options.showContextMenu&&this.currentSelection&&this.showContextMenu()}showHandles(){this.startHandle.style.display="block",this.endHandle.style.display="block",this.updateHandlePositions()}hideHandles(){this.startHandle.style.display="none",this.endHandle.style.display="none"}getHandleBaseTransform(i){return i==="start"?"rotate(180deg) translateX(87%)":"rotate(90deg) translateY(-13%)"}setHandleOrientation(i,r){if(!i)return;let s=this.getHandleBaseTransform(r),l=/\bscale\(/.test(i.style.transform||"");i.dataset.orientation=r,i.style.transform=l?`${s} scale(1.2)`:s}updateHandleOrientationForViewportEdges(){let i=this.selectionOverlay.getBoundingClientRect();this.startHandle.style.display!=="none"&&(this.setHandleOrientation(this.startHandle,"start"),this.startHandle.getBoundingClientRect().left<i.left&&this.setHandleOrientation(this.startHandle,"end")),this.endHandle.style.display!=="none"&&(this.setHandleOrientation(this.endHandle,"end"),this.endHandle.getBoundingClientRect().right>i.right&&this.setHandleOrientation(this.endHandle,"start"))}updateHandlePositions(){if(!this.selectionStart||!this.selectionEnd)return;let i,r;this.selectionStart.row<this.selectionEnd.row||this.selectionStart.row===this.selectionEnd.row&&this.selectionStart.col<=this.selectionEnd.col?(i=this.selectionStart,r=this.selectionEnd):(i=this.selectionEnd,r=this.selectionStart);let s=this.terminalCoordsToPixels(i),l=this.terminalCoordsToPixels(r);s?(this.startHandle.style.display="block",this.startHandle.style.left=`${s.x}px`,this.startHandle.style.top=`${s.y+this.cellDimensions.height+4}px`):this.startHandle.style.display="none",l?(this.endHandle.style.display="block",this.endHandle.style.left=`${l.x+this.cellDimensions.width}px`,this.endHandle.style.top=`${l.y+this.cellDimensions.height+4}px`):this.endHandle.style.display="none",this.updateHandleOrientationForViewportEdges()}showContextMenu(){this.contextMenu||this.createContextMenu(),this.contextMenuShouldStayVisible=!0;let i=this.selectionStart?this.terminalCoordsToPixels(this.selectionStart):null,r=this.selectionEnd?this.terminalCoordsToPixels(this.selectionEnd):null,s=this.contextMenu.offsetWidth||200,l=this.contextMenu.offsetHeight||50,t=this.terminalContent.getBoundingClientRect(),n,h;if(i||r){let v,u;i&&r?(v=(i.x+r.x)/2,u=Math.max(i.y,r.y)):i?(v=i.x,u=i.y):(v=r.x,u=r.y),n=v-s/2,h=u+this.cellDimensions.height+40;let a=t.height-l-10;h>a&&(h=(i&&r?Math.min(i.y,r.y):u)-l-10)}else n=(t.width-s)/2,h=t.height-l-20;let g=10,o=t.width-s-10;n=Math.max(g,Math.min(n,o));let c=10,f=t.height-l-10;h=Math.max(c,Math.min(h,f)),this.contextMenu.style.left=`${n}px`,this.contextMenu.style.top=`${h}px`,this.contextMenu.style.display="flex"}createContextMenu(){this.contextMenu=document.createElement("div"),this.contextMenu.className="terminal-context-menu",[{label:this.getString("copy","Copy"),action:this.copySelection.bind(this)},{label:this.getString("paste","Paste"),action:this.pasteFromClipboard.bind(this)},{label:this.getString("select all","Select All"),action:this.selectAllText.bind(this)}].forEach(r=>{let s=document.createElement("button");s.textContent=r.label;let l=!1,t=n=>{n.preventDefault(),n.stopPropagation(),l||(l=!0,r.action())};s.addEventListener("touchstart",n=>{n.preventDefault(),n.stopPropagation(),l=!1}),s.addEventListener("touchend",t),s.addEventListener("mousedown",n=>{n.preventDefault(),n.stopPropagation(),l=!1}),s.addEventListener("mouseup",t),s.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation()}),this.contextMenu.appendChild(s)}),this.selectionOverlay.appendChild(this.contextMenu)}hideContextMenu(i=!1){this.contextMenu&&(i||!this.contextMenuShouldStayVisible)&&(this.contextMenu.style.display="none")}forceHideContextMenu(){this.contextMenu&&(this.contextMenu.style.display="none",this.contextMenuShouldStayVisible=!1)}copySelection(){let i=this.currentSelection||this.terminal.getSelection?.();i&&cordova?.plugins?.clipboard&&cordova.plugins.clipboard.copy(i),this.forceClearSelection()}pasteFromClipboard(){cordova?.plugins?.clipboard&&cordova.plugins.clipboard.paste(i=>{i&&this.terminal.paste?.(i),this.forceClearSelection()})}selectAllText(){this.terminal?.selectAll&&(this.terminal.selectAll(),this.currentSelection=this.terminal.getSelection?.(),this.isSelecting=!!this.currentSelection,this.selectionStart=null,this.selectionEnd=null,this.hideHandles(),this.options.showContextMenu&&this.currentSelection&&this.showContextMenu())}clearSelection(){if(this.selectionProtected)return;let i=this.wasFocusedBeforeSelection&&this.isSelecting;this.isSelecting=!1,this.isHandleDragging=!1,this.selectionStart=null,this.selectionEnd=null,this.currentSelection=null,this.dragHandle=null,this.pendingSelectionClearTouch=null,this.isSelectionTouchActive=!1,this.isTerminalScrolling=!1,this.terminal.clearSelection?.(),this.hideHandles(),this.forceHideContextMenu(),this.tapHoldTimeout&&(clearTimeout(this.tapHoldTimeout),this.tapHoldTimeout=null),this.scrollEndTimeout&&(clearTimeout(this.scrollEndTimeout),this.scrollEndTimeout=null),this.protectionTimeout&&(clearTimeout(this.protectionTimeout),this.protectionTimeout=null),this.selectionProtected=!1,i&&!this.isTerminalFocused()&&setTimeout(()=>{this.isSelecting||this.terminal.focus?.()},150),this.wasFocusedBeforeSelection=!1}forceClearSelection(){this.selectionProtected=!1,this.clearSelection()}touchToTerminalCoords(i){let r=this.terminal.element.getBoundingClientRect(),s=i.clientX-r.left,l=i.clientY-r.top;if(s<0||l<0||s>r.width||l>r.height||((!this.cellDimensions.width||!this.cellDimensions.height)&&this.updateCellDimensions(),!this.cellDimensions.width||!this.cellDimensions.height))return null;let t=Math.floor(s/this.cellDimensions.width),n=Math.floor(l/this.cellDimensions.height)+this.terminal.buffer.active.viewportY;return{col:Math.max(0,Math.min(t,this.terminal.cols-1)),row:Math.max(0,n)}}terminalCoordsToPixels(i){if(!i)return null;(!this.cellDimensions.width||!this.cellDimensions.height)&&this.updateCellDimensions();let r=this.terminal.element.getBoundingClientRect(),s=this.terminalContent.getBoundingClientRect(),l=i.col*this.cellDimensions.width+(r.left-s.left),t=(i.row-this.terminal.buffer.active.viewportY)*this.cellDimensions.height+(r.top-s.top);return i.row>=this.terminal.buffer.active.viewportY&&i.row<this.terminal.buffer.active.viewportY+this.terminal.rows?{x:l,y:t}:null}updateCellDimensions(){let i=this.terminal?._core?._renderService?.dimensions;if(i?.css?.cell){this.cellDimensions={width:i.css.cell.width,height:i.css.cell.height};return}let r=this.terminal.element.getBoundingClientRect(),s=this.terminal.cols||1,l=this.terminal.rows||1;this.cellDimensions={width:r.width/s,height:r.height/l}}isTerminalFocused(){try{return document.activeElement===this.terminal.element||this.terminal.element.contains(document.activeElement)||this.terminal._core?._hasFocus}catch{return!1}}getWordBoundsAt(i){try{let s=this.terminal.buffer.active.getLine(i.row);if(!s)return null;let l=s.translateToString(!1);if(!l||i.col>=l.length)return null;let t=l[i.col];if(!this.isWordCharacter(t))return null;let n=i.col;for(;n>0&&this.isWordCharacter(l[n-1]);)n--;let h=i.col;for(;h<l.length-1&&this.isWordCharacter(l[h+1]);)h++;return h>=n?{start:{row:i.row,col:n},end:{row:i.row,col:h}}:null}catch(r){return console.warn("Error finding word bounds:",r),null}}isWordCharacter(i){return i?/[a-zA-Z0-9_\-.]/.test(i):!1}startPinchZoom(i){if(i.touches.length!==2)return;this.isPinching=!0,this.initialFontSize=this.terminal.options.fontSize;let r=i.touches[0],s=i.touches[1];this.pinchStartDistance=this.getDistance(r,s),this.lastPinchDistance=this.pinchStartDistance,this.tapHoldTimeout&&(clearTimeout(this.tapHoldTimeout),this.tapHoldTimeout=null)}handlePinchZoom(i){if(!this.isPinching||i.touches.length!==2)return;let r=Date.now();if(r-this.lastZoomTime<this.options.zoomThrottle)return;this.lastZoomTime=r;let s=i.touches[0],l=i.touches[1],n=this.getDistance(s,l)/this.pinchStartDistance,h=Math.round(this.initialFontSize*n),g=this.options.minFontSize,o=this.options.maxFontSize,c=Math.max(g,Math.min(o,h));c!==this.terminal.options.fontSize&&typeof this.options.onFontSizeChange=="function"&&this.options.onFontSizeChange(c)}endPinchZoom(){this.isPinching=!1,this.pinchStartDistance=0,this.lastPinchDistance=0,this.initialFontSize=0}getDistance(i,r){let s=r.clientX-i.clientX,l=r.clientY-i.clientY;return Math.hypot(s,l)}isEdgeGesture(i){let s=window.innerWidth;return i.clientX<=30||i.clientX>=s-30}getString(i,r){try{if(typeof window<"u"&&window?.strings?.[i])return window.strings[i]}catch{}return r}updateHandles(){this.updateHandlePositions()}destroy(){this.forceClearSelection(),this.terminal.element.removeEventListener("touchstart",this.boundHandlers.terminalTouchStart),this.terminal.element.removeEventListener("touchmove",this.boundHandlers.terminalTouchMove),this.terminal.element.removeEventListener("touchend",this.boundHandlers.terminalTouchEnd),this.startHandle.removeEventListener("touchstart",this.boundHandlers.handleTouchStart),this.startHandle.removeEventListener("touchmove",this.boundHandlers.handleTouchMove),this.startHandle.removeEventListener("touchend",this.boundHandlers.handleTouchEnd),this.endHandle.removeEventListener("touchstart",this.boundHandlers.handleTouchStart),this.endHandle.removeEventListener("touchmove",this.boundHandlers.handleTouchMove),this.endHandle.removeEventListener("touchend",this.boundHandlers.handleTouchEnd),this.scrollElement&&(this.scrollElement.removeEventListener("scroll",this.boundHandlers.terminalScroll),this.scrollElement=null),window.removeEventListener("orientationchange",this.boundHandlers.orientationChange),window.removeEventListener("resize",this.boundHandlers.orientationChange),document.removeEventListener("touchstart",this.boundHandlers.documentTouchStart),this.scrollEndTimeout&&(clearTimeout(this.scrollEndTimeout),this.scrollEndTimeout=null),this.selectionChangeDisposable?.dispose&&this.selectionChangeDisposable.dispose(),this.resizeDisposable?.dispose&&this.resizeDisposable.dispose(),this.selectionOverlay?.parentNode&&this.selectionOverlay.parentNode.removeChild(this.selectionOverlay)}};acode.addIcon("deepseek","https://raw.githubusercontent.com/deepseek-ai/DeepSeek-Coder/main/pictures/home.png");acode.addIcon("chatgpt","https://upload.wikimedia.org/wikipedia/commons/0/04/ChatGPT_logo.svg");acode.addIcon("gemini","https://upload.wikimedia.org/wikipedia/commons/4/45/Gemini_language_model_logo.png");var Sa=!1,Ea=!1,ka=!1,Ba=!0,La=!0,Da=!0,fn=["block","underline","bar"],_n=["outline","block","bar","underline","none"],gn=11,Ia="MesloLGS NF Regular",pn=["normal","bold","100","200","300","400","500","600","700","800","900"],Ta=1e3,Ra=1e3,vn=0,Ma=35,Fa=!0,Le="catppuccin",mn=["ayuDark","ayuLight","ayuMirage","catppuccin","dracula","elementary","everblush","light","material","nekonakoDjancoeg","oneDark","sapphire","siduckOneDark","snazzy","xterm","wal","custom"],Pa="deepseek",yn=[["deepseek","Deepseek","deepseek",!0],["chatgpt","ChatGPT","chatgpt",!0],["gemini-pro","Gemini Flash Lite","gemini",!0],["local-llm","Local LLM(ollama)","icon phone_android",!0]];var md=lt(Iu()),yd=lt(wi()),bd=lt(vo());var Us,we,Pu,kv,li,Tu,Ou,Hu,Qu,Uo,Ko,Xo,Bv,Ks={},Xs=[],Lv=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,$s=Array.isArray;function Dt(e,i){for(var r in i)e[r]=i[r];return e}function $o(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function ge(e,i,r){var s,l,t,n={};for(t in i)t=="key"?s=i[t]:t=="ref"?l=i[t]:n[t]=i[t];if(arguments.length>2&&(n.children=arguments.length>3?Us.call(arguments,2):r),typeof e=="function"&&e.defaultProps!=null)for(t in e.defaultProps)n[t]===void 0&&(n[t]=e.defaultProps[t]);return Hs(e,n,s,l,null)}function Hs(e,i,r,s,l){var t={type:e,props:i,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:l??++Pu,__i:-1,__u:0};return l==null&&we.vnode!=null&&we.vnode(t),t}function Ti(e){return e.children}function Qs(e,i){this.props=e,this.context=i}function Ii(e,i){if(i==null)return e.__?Ii(e.__,e.__i+1):null;for(var r;i<e.__k.length;i++)if((r=e.__k[i])!=null&&r.__e!=null)return r.__e;return typeof e.type=="function"?Ii(e):null}function Dv(e){if(e.__P&&e.__d){var i=e.__v,r=i.__e,s=[],l=[],t=Dt({},i);t.__v=i.__v+1,we.vnode&&we.vnode(t),Wo(e.__P,t,i,e.__n,e.__P.namespaceURI,32&i.__u?[r]:null,s,r??Ii(i),!!(32&i.__u),l),t.__v=i.__v,t.__.__k[t.__i]=t,Uu(s,t,l),i.__e=i.__=null,t.__e!=r&&Ku(t)}}function Ku(e){if((e=e.__)!=null&&e.__c!=null)return e.__e=e.__c.base=null,e.__k.some(function(i){if(i!=null&&i.__e!=null)return e.__e=e.__c.base=i.__e}),Ku(e)}function Ru(e){(!e.__d&&(e.__d=!0)&&li.push(e)&&!Ns.__r++||Tu!=we.debounceRendering)&&((Tu=we.debounceRendering)||Ou)(Ns)}function Ns(){for(var e,i=1;li.length;)li.length>i&&li.sort(Hu),e=li.shift(),i=li.length,Dv(e);Ns.__r=0}function Xu(e,i,r,s,l,t,n,h,g,o,c){var f,v,u,a,d,_,p,m=s&&s.__k||Xs,w=i.length;for(g=Iv(r,i,m,g,w),f=0;f<w;f++)(u=r.__k[f])!=null&&(v=u.__i!=-1&&m[u.__i]||Ks,u.__i=f,_=Wo(e,u,v,l,t,n,h,g,o,c),a=u.__e,u.ref&&v.ref!=u.ref&&(v.ref&&zo(v.ref,null,u),c.push(u.ref,u.__c||a,u)),d==null&&a!=null&&(d=a),(p=!!(4&u.__u))||v.__k===u.__k?g=Nu(u,g,e,p):typeof u.type=="function"&&_!==void 0?g=_:a&&(g=a.nextSibling),u.__u&=-7);return r.__e=d,g}function Iv(e,i,r,s,l){var t,n,h,g,o,c=r.length,f=c,v=0;for(e.__k=new Array(l),t=0;t<l;t++)(n=i[t])!=null&&typeof n!="boolean"&&typeof n!="function"?(typeof n=="string"||typeof n=="number"||typeof n=="bigint"||n.constructor==String?n=e.__k[t]=Hs(null,n,null,null,null):$s(n)?n=e.__k[t]=Hs(Ti,{children:n},null,null,null):n.constructor===void 0&&n.__b>0?n=e.__k[t]=Hs(n.type,n.props,n.key,n.ref?n.ref:null,n.__v):e.__k[t]=n,g=t+v,n.__=e,n.__b=e.__b+1,h=null,(o=n.__i=Tv(n,r,g,f))!=-1&&(f--,(h=r[o])&&(h.__u|=2)),h==null||h.__v==null?(o==-1&&(l>c?v--:l<c&&v++),typeof n.type!="function"&&(n.__u|=4)):o!=g&&(o==g-1?v--:o==g+1?v++:(o>g?v--:v++,n.__u|=4))):e.__k[t]=null;if(f)for(t=0;t<c;t++)(h=r[t])!=null&&(2&h.__u)==0&&(h.__e==s&&(s=Ii(h)),Wu(h,h));return s}function Nu(e,i,r,s){var l,t;if(typeof e.type=="function"){for(l=e.__k,t=0;l&&t<l.length;t++)l[t]&&(l[t].__=e,i=Nu(l[t],i,r,s));return i}e.__e!=i&&(s&&(i&&e.type&&!i.parentNode&&(i=Ii(e)),r.insertBefore(e.__e,i||null)),i=e.__e);do i=i&&i.nextSibling;while(i!=null&&i.nodeType==8);return i}function Tv(e,i,r,s){var l,t,n,h=e.key,g=e.type,o=i[r],c=o!=null&&(2&o.__u)==0;if(o===null&&h==null||c&&h==o.key&&g==o.type)return r;if(s>(c?1:0)){for(l=r-1,t=r+1;l>=0||t<i.length;)if((o=i[n=l>=0?l--:t++])!=null&&(2&o.__u)==0&&h==o.key&&g==o.type)return n}return-1}function Mu(e,i,r){i[0]=="-"?e.setProperty(i,r??""):e[i]=r==null?"":typeof r!="number"||Lv.test(i)?r:r+"px"}function Os(e,i,r,s,l){var t,n;e:if(i=="style")if(typeof r=="string")e.style.cssText=r;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(i in s)r&&i in r||Mu(e.style,i,"");if(r)for(i in r)s&&r[i]==s[i]||Mu(e.style,i,r[i])}else if(i[0]=="o"&&i[1]=="n")t=i!=(i=i.replace(Qu,"$1")),n=i.toLowerCase(),i=n in e||i=="onFocusOut"||i=="onFocusIn"?n.slice(2):i.slice(2),e.l||(e.l={}),e.l[i+t]=r,r?s?r.u=s.u:(r.u=Uo,e.addEventListener(i,t?Xo:Ko,t)):e.removeEventListener(i,t?Xo:Ko,t);else{if(l=="http://www.w3.org/2000/svg")i=i.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(i!="width"&&i!="height"&&i!="href"&&i!="list"&&i!="form"&&i!="tabIndex"&&i!="download"&&i!="rowSpan"&&i!="colSpan"&&i!="role"&&i!="popover"&&i in e)try{e[i]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&i[4]!="-"?e.removeAttribute(i):e.setAttribute(i,i=="popover"&&r==1?"":r))}}function Fu(e){return function(i){if(this.l){var r=this.l[i.type+e];if(i.t==null)i.t=Uo++;else if(i.t<r.u)return;return r(we.event?we.event(i):i)}}}function Wo(e,i,r,s,l,t,n,h,g,o){var c,f,v,u,a,d,_,p,m,w,b,S,A,x,E,D=i.type;if(i.constructor!==void 0)return null;128&r.__u&&(g=!!(32&r.__u),t=[h=i.__e=r.__e]),(c=we.__b)&&c(i);e:if(typeof D=="function")try{if(p=i.props,m="prototype"in D&&D.prototype.render,w=(c=D.contextType)&&s[c.__c],b=c?w?w.props.value:c.__:s,r.__c?_=(f=i.__c=r.__c).__=f.__E:(m?i.__c=f=new D(p,b):(i.__c=f=new Qs(p,b),f.constructor=D,f.render=Mv),w&&w.sub(f),f.state||(f.state={}),f.__n=s,v=f.__d=!0,f.__h=[],f._sb=[]),m&&f.__s==null&&(f.__s=f.state),m&&D.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=Dt({},f.__s)),Dt(f.__s,D.getDerivedStateFromProps(p,f.__s))),u=f.props,a=f.state,f.__v=i,v)m&&D.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),m&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(m&&D.getDerivedStateFromProps==null&&p!==u&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(p,b),i.__v==r.__v||!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(p,f.__s,b)===!1){i.__v!=r.__v&&(f.props=p,f.state=f.__s,f.__d=!1),i.__e=r.__e,i.__k=r.__k,i.__k.some(function(L){L&&(L.__=i)}),Xs.push.apply(f.__h,f._sb),f._sb=[],f.__h.length&&n.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(p,f.__s,b),m&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(u,a,d)})}if(f.context=b,f.props=p,f.__P=e,f.__e=!1,S=we.__r,A=0,m)f.state=f.__s,f.__d=!1,S&&S(i),c=f.render(f.props,f.state,f.context),Xs.push.apply(f.__h,f._sb),f._sb=[];else do f.__d=!1,S&&S(i),c=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++A<25);f.state=f.__s,f.getChildContext!=null&&(s=Dt(Dt({},s),f.getChildContext())),m&&!v&&f.getSnapshotBeforeUpdate!=null&&(d=f.getSnapshotBeforeUpdate(u,a)),x=c!=null&&c.type===Ti&&c.key==null?$u(c.props.children):c,h=Xu(e,$s(x)?x:[x],i,r,s,l,t,n,h,g,o),f.base=i.__e,i.__u&=-161,f.__h.length&&n.push(f),_&&(f.__E=f.__=null)}catch(L){if(i.__v=null,g||t!=null)if(L.then){for(i.__u|=g?160:128;h&&h.nodeType==8&&h.nextSibling;)h=h.nextSibling;t[t.indexOf(h)]=null,i.__e=h}else{for(E=t.length;E--;)$o(t[E]);No(i)}else i.__e=r.__e,i.__k=r.__k,L.then||No(i);we.__e(L,i,r)}else t==null&&i.__v==r.__v?(i.__k=r.__k,i.__e=r.__e):h=i.__e=Rv(r.__e,i,r,s,l,t,n,g,o);return(c=we.diffed)&&c(i),128&i.__u?void 0:h}function No(e){e&&(e.__c&&(e.__c.__e=!0),e.__k&&e.__k.some(No))}function Uu(e,i,r){for(var s=0;s<r.length;s++)zo(r[s],r[++s],r[++s]);we.__c&&we.__c(i,e),e.some(function(l){try{e=l.__h,l.__h=[],e.some(function(t){t.call(l)})}catch(t){we.__e(t,l.__v)}})}function $u(e){return typeof e!="object"||e==null||e.__b>0?e:$s(e)?e.map($u):Dt({},e)}function Rv(e,i,r,s,l,t,n,h,g){var o,c,f,v,u,a,d,_=r.props||Ks,p=i.props,m=i.type;if(m=="svg"?l="http://www.w3.org/2000/svg":m=="math"?l="http://www.w3.org/1998/Math/MathML":l||(l="http://www.w3.org/1999/xhtml"),t!=null){for(o=0;o<t.length;o++)if((u=t[o])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){e=u,t[o]=null;break}}if(e==null){if(m==null)return document.createTextNode(p);e=document.createElementNS(l,m,p.is&&p),h&&(we.__m&&we.__m(i,t),h=!1),t=null}if(m==null)_===p||h&&e.data==p||(e.data=p);else{if(t=t&&Us.call(e.childNodes),!h&&t!=null)for(_={},o=0;o<e.attributes.length;o++)_[(u=e.attributes[o]).name]=u.value;for(o in _)u=_[o],o=="dangerouslySetInnerHTML"?f=u:o=="children"||o in p||o=="value"&&"defaultValue"in p||o=="checked"&&"defaultChecked"in p||Os(e,o,null,u,l);for(o in p)u=p[o],o=="children"?v=u:o=="dangerouslySetInnerHTML"?c=u:o=="value"?a=u:o=="checked"?d=u:h&&typeof u!="function"||_[o]===u||Os(e,o,u,_[o],l);if(c)h||f&&(c.__html==f.__html||c.__html==e.innerHTML)||(e.innerHTML=c.__html),i.__k=[];else if(f&&(e.innerHTML=""),Xu(i.type=="template"?e.content:e,$s(v)?v:[v],i,r,s,m=="foreignObject"?"http://www.w3.org/1999/xhtml":l,t,n,t?t[0]:r.__k&&Ii(r,0),h,g),t!=null)for(o=t.length;o--;)$o(t[o]);h||(o="value",m=="progress"&&a==null?e.removeAttribute("value"):a!=null&&(a!==e[o]||m=="progress"&&!a||m=="option"&&a!=_[o])&&Os(e,o,a,_[o],l),o="checked",d!=null&&d!=e[o]&&Os(e,o,d,_[o],l))}return e}function zo(e,i,r){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&i==null||(e.__u=e(i))}else e.current=i}catch(l){we.__e(l,r)}}function Wu(e,i,r){var s,l;if(we.unmount&&we.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||zo(s,null,i)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(t){we.__e(t,i)}s.base=s.__P=null}if(s=e.__k)for(l=0;l<s.length;l++)s[l]&&Wu(s[l],i,r||typeof e.type!="function");r||$o(e.__e),e.__c=e.__=e.__e=void 0}function Mv(e,i,r){return this.constructor(e,r)}function wr(e,i,r){var s,l,t,n;i==document&&(i=document.documentElement),we.__&&we.__(e,i),l=(s=typeof r=="function")?null:r&&r.__k||i.__k,t=[],n=[],Wo(i,e=(!s&&r||i).__k=ge(Ti,null,[e]),l||Ks,Ks,i.namespaceURI,!s&&r?[r]:l?null:i.firstChild?Us.call(i.childNodes):null,t,!s&&r?r:l?l.__e:i.firstChild,s,n),Uu(t,e,n)}Us=Xs.slice,we={__e:function(e,i,r,s){for(var l,t,n;i=i.__;)if((l=i.__c)&&!l.__)try{if((t=l.constructor)&&t.getDerivedStateFromError!=null&&(l.setState(t.getDerivedStateFromError(e)),n=l.__d),l.componentDidCatch!=null&&(l.componentDidCatch(e,s||{}),n=l.__d),n)return l.__E=l}catch(h){e=h}throw e}},Pu=0,kv=function(e){return e!=null&&e.constructor===void 0},Qs.prototype.setState=function(e,i){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=Dt({},this.state),typeof e=="function"&&(e=e(Dt({},r),this.props)),e&&Dt(r,e),e!=null&&this.__v&&(i&&this._sb.push(i),Ru(this))},Qs.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Ru(this))},Qs.prototype.render=Ti,li=[],Ou=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Hu=function(e,i){return e.__v.__b-i.__v.__b},Ns.__r=0,Qu=/(PointerCapture)$|Capture$/i,Uo=0,Ko=Fu(!1),Xo=Fu(!0),Bv=0;var Ad=lt(ju()),wd=lt(Gu()),Cd=lt(qu()),xd=lt(Vu()),Sd=lt(Yu()),Ed=lt(Ju()),kd=lt(Zu()),aa=lt(ed());var Ri=class{constructor(i={}){this._fallbackLigatures=i.fallbackLigatures||["<--","<---","<<-","<-","->","->>","-->","--->","<==","<===","<<=","<=","=>","=>>","==>","===>",">=",">>=","<->","<-->","<--->","<---->","<=>","<==>","<===>","<====>","<~~","<~","~>","~~>","::",":::","==","!=","===","!==",":=",":-",":+","<*","<*>","*>","<|","<|>","|>","+:","-:","=:",":>","++","+++","<!--","<!---","<***>"].sort((r,s)=>s.length-r.length),this._characterJoinerId=void 0,this._terminal=void 0}activate(i){this._terminal=i,this._characterJoinerId=i.registerCharacterJoiner(this._joinCharacters.bind(this)),i.element.style.fontFeatureSettings='"liga" on, "calt" on'}dispose(){this._characterJoinerId!==void 0&&(this._terminal?.deregisterCharacterJoiner(this._characterJoinerId),this._characterJoinerId=void 0),this._terminal?.element&&(this._terminal.element.style.fontFeatureSettings="")}_joinCharacters(i){return this._findLigatureRanges(i,this._fallbackLigatures)}_findLigatureRanges(i,r){let s=[];for(let l=0;l<i.length;l++)for(let t of r)if(i.startsWith(t,l)){s.push([l,l+t.length]),l+=t.length-1;break}return s}};var Zs,Ye,ta,td,ia=0,hd=[],Pe=we,id=Pe.__b,rd=Pe.__r,sd=Pe.diffed,nd=Pe.__c,od=Pe.unmount,ad=Pe.__;function cd(e,i){Pe.__h&&Pe.__h(Ye,e,ia||i),ia=0;var r=Ye.__H||(Ye.__H={__:[],__h:[]});return e>=r.__.length&&r.__.push({}),r.__[e]}function sa(e,i){var r=cd(Zs++,3);!Pe.__s&&dd(r.__H,i)&&(r.__=e,r.u=i,Ye.__H.__h.push(r))}function ud(e){return ia=5,Fv(function(){return{current:e}},[])}function Fv(e,i){var r=cd(Zs++,7);return dd(r.__H,i)&&(r.__=e(),r.__H=i,r.__h=e),r.__}function Pv(){for(var e;e=hd.shift();){var i=e.__H;if(e.__P&&i)try{i.__h.some(Js),i.__h.some(ra),i.__h=[]}catch(r){i.__h=[],Pe.__e(r,e.__v)}}}Pe.__b=function(e){Ye=null,id&&id(e)},Pe.__=function(e,i){e&&i.__k&&i.__k.__m&&(e.__m=i.__k.__m),ad&&ad(e,i)},Pe.__r=function(e){rd&&rd(e),Zs=0;var i=(Ye=e.__c).__H;i&&(ta===Ye?(i.__h=[],Ye.__h=[],i.__.some(function(r){r.__N&&(r.__=r.__N),r.u=r.__N=void 0})):(i.__h.some(Js),i.__h.some(ra),i.__h=[],Zs=0)),ta=Ye},Pe.diffed=function(e){sd&&sd(e);var i=e.__c;i&&i.__H&&(i.__H.__h.length&&(hd.push(i)!==1&&td===Pe.requestAnimationFrame||((td=Pe.requestAnimationFrame)||Ov)(Pv)),i.__H.__.some(function(r){r.u&&(r.__H=r.u),r.u=void 0})),ta=Ye=null},Pe.__c=function(e,i){i.some(function(r){try{r.__h.some(Js),r.__h=r.__h.filter(function(s){return!s.__||ra(s)})}catch(s){i.some(function(l){l.__h&&(l.__h=[])}),i=[],Pe.__e(s,r.__v)}}),nd&&nd(e,i)},Pe.unmount=function(e){od&&od(e);var i,r=e.__c;r&&r.__H&&(r.__H.__.some(function(s){try{Js(s)}catch(l){i=l}}),r.__H=void 0,i&&Pe.__e(i,r.__v))};var ld=typeof requestAnimationFrame=="function";function Ov(e){var i,r=function(){clearTimeout(s),ld&&cancelAnimationFrame(i),setTimeout(e)},s=setTimeout(r,35);ld&&(i=requestAnimationFrame(r))}function Js(e){var i=Ye,r=e.__c;typeof r=="function"&&(e.__c=void 0,r()),Ye=i}function ra(e){var i=Ye;e.__c=e.__(),Ye=i}function dd(e,i){return!e||e.length!==i.length||i.some(function(r,s){return r!==e[s]})}var Hv={terminal:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="4 17 10 11 4 5"/><line x1="12" x2="20" y1="19" y2="19"/></svg>',findNext:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>',findPrevious:'<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>',close:'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M24 26.1 13.5 36.6q-.45.45-1.05.45-.6 0-1.05-.45-.45-.45-.45-1.05 0-.6.45-1.05L21.9 24 11.4 13.5q-.45-.45-.45-1.05 0-.6.45-1.05.45-.45 1.05-.45.6 0 1.05.45L24 21.9l10.5-10.5q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05L26.1 24l10.5 10.5q.45.45.45 1.05 0 .6-.45 1.05-.45.45-1.05.45-.6 0-1.05-.45Z"/></svg>',minimise:'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M24 24.75q-.3 0-.55-.1-.25-.1-.5-.35l-9.9-9.9q-.45-.45-.45-1.05 0-.6.45-1.05.45-.45 1.05-.45.6 0 1.05.45L24 21.15l8.85-8.85q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05l-9.9 9.9q-.25.25-.5.35-.25.1-.55.1Zm0 12.65q-.3 0-.55-.1-.25-.1-.5-.35l-9.9-9.9q-.45-.45-.45-1.05 0-.6.45-1.05.45-.45 1.05-.45.6 0 1.05.45L24 33.8l8.85-8.85q.45-.45 1.05-.45.6 0 1.05.45.45.45.45 1.05 0 .6-.45 1.05l-9.9 9.9q-.25.25-.5.35-.25.1-.55.1Z"/></svg>',folder:'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M1 3.5A1.5 1.5 0 0 1 2.5 2h2.764c.958 0 1.76.56 2.311 1.184C7.985 3.648 8.48 4 9 4h4.5A1.5 1.5 0 0 1 15 5.5v.64c.57.265.94.876.856 1.546l-.64 5.124A2.5 2.5 0 0 1 12.733 15H3.266a2.5 2.5 0 0 1-2.481-2.19l-.64-5.124A1.5 1.5 0 0 1 1 6.14V3.5zM2 6h12v-.5a.5.5 0 0 0-.5-.5H9c-.964 0-1.71-.629-2.174-1.154C6.374 3.334 5.82 3 5.264 3H2.5a.5.5 0 0 0-.5.5V6zm-.367 1a.5.5 0 0 0-.496.562l.64 5.124A1.5 1.5 0 0 0 3.266 14h9.468a1.5 1.5 0 0 0 1.489-1.314l.64-5.124A.5.5 0 0 0 14.367 7H1.633z"/></svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m13 13.5 2-2.5-2-2.5"/><path d="m21 21-4.3-4.3"/><path d="M9 8.5 7 11l2 2.5"/><circle cx="11" cy="11" r="8"/></svg>',plus:'<svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg" height="1.5em" width="1.5em"><path fill="currentColor" d="M24 38q-.65 0-1.075-.425-.425-.425-.425-1.075v-11h-11q-.65 0-1.075-.425Q10 24.65 10 24q0-.65.425-1.075.425-.425 1.075-.425h11v-11q0-.65.425-1.075Q23.35 10 24 10q.65 0 1.075.425.425.425.425 1.075v11h11q.65 0 1.075.425Q38 23.35 38 24q0 .65-.425 1.075-.425.425-1.075.425h-11v11q0 .65-.425 1.075Q24.65 38 24 38Z"/></svg>',imagePlay:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m11 16-5 5"/><path d="M11 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6.5"/><path d="M15.765 22a.5.5 0 0 1-.765-.424V13.38a.5.5 0 0 1 .765-.424l5.878 3.674a1 1 0 0 1 0 1.696z"/><circle cx="9" cy="9" r="2"/></svg>'},at=Hv;function na({markup:e}){return ge("span",{class:"icon-markup",dangerouslySetInnerHTML:{__html:e}})}function It({className:e="",label:i,markup:r,onClick:s,hidden:l=!1,disabled:t=!1}){return ge("button",{type:"button",class:`action-button ${e}`.trim(),"aria-label":i,onClick:s,hidden:l,disabled:t},ge(na,{markup:r}))}function fd(){return ge("span",{class:"header-divider","aria-hidden":"true"})}function _d({bindSearchInput:e,searchVisible:i,searchQuery:r,sessionName:s,enableGuiViewer:l,onSessionSelect:t,onCreateSession:n,onToggleSearch:h,onNavigateToDir:g,onMinimize:o,onClose:c,onOpenGuiViewer:f,onSearchChange:v,onSearchNext:u,onSearchPrevious:a}){let d=ud(null);return sa(()=>{e?.(d.current)},[e]),sa(()=>{i&&(d.current?.focus(),d.current?.select())},[i]),ge(Ti,null,ge("div",{class:"left-section"},ge("div",{class:"session-info",role:"button",tabIndex:0,onClick:t,onKeyDown:_=>{(_.key==="Enter"||_.key===" ")&&(_.preventDefault(),t())}},ge("span",{class:"pointer-indicator","aria-hidden":"true"}),ge("h3",{class:"session-name"},s))),ge("div",{class:"btn-section"},!i&&ge("div",{class:"default-actions"},ge(It,{className:"new-session",label:"New session",markup:at.plus,onClick:n}),l&&ge(It,{className:"gui-viewer",label:"Open GUI viewer",markup:at.imagePlay,onClick:f}),ge(fd,null),ge(It,{className:"search-btn",label:"Search",markup:at.search,onClick:h}),ge(It,{className:"folder-icon",label:"Navigate to active folder",markup:at.folder,onClick:g}),ge(fd,null),ge(It,{className:"minimize",label:"Minimize terminal",markup:at.minimise,onClick:o}),ge(It,{className:"close",label:"Close terminal",markup:at.close,onClick:c})),i&&ge("div",{class:"search-bar"},ge("div",{class:"search-field"},ge("span",{class:"search-icon"},ge(na,{markup:at.search})),ge("input",{ref:d,type:"text",value:r,placeholder:"Find in terminal...","aria-label":"Search input",onInput:_=>v(_.currentTarget.value),onKeyDown:_=>{_.key==="Escape"&&(_.preventDefault(),h())}})),ge("div",{class:"search-nav"},ge(It,{className:"find-previous",label:"Find previous",markup:at.findPrevious,onClick:a,disabled:!r}),ge(It,{className:"find-next",label:"Find next",markup:at.findNext,onClick:u,disabled:!r}),ge(It,{className:"close-search",label:"Close search",markup:at.close,onClick:h})))))}function gd(){return ge(na,{markup:at.terminal})}var pd=acode.require("confirm"),Be=acode.require("settings"),Qv=acode.require("fsOperation"),Kv=acode.require("toInternalUrl"),vd=acode.require("select"),Tt=acode.require("loader"),Xv=acode.require("dialogBox"),Nv=acode.require("page"),Uv=acode.require("actionStack"),Mi=acode.require("fonts"),{clipboard:oa}=cordova.plugins,et="https://cdn.jsdelivr.net/gh/bajrangCoder/acode-plugin-acodex@main/fonts/",$v=[{name:"Fira Code Bold Nerd Font",url:`${et}Fira Code Bold Nerd Font.ttf`,format:"truetype",weight:"bold",style:"normal"},{name:"Fira Code Medium Nerd Font",url:`${et}Fira Code Medium Nerd Font Complete Mono.ttf`,format:"truetype",weight:"normal",style:"normal"},{name:"JetBrains Mono Bold Nerd Font",url:`${et}JetBrains Mono Bold Nerd Font Complete.ttf`,format:"truetype",weight:"bold",style:"normal"},{name:"JetBrains Mono Medium Nerd Font",url:`${et}JetBrains Mono Medium Nerd Font Complete.ttf`,format:"truetype",weight:"normal",style:"normal"},{name:"VictorMonoNerdFont Bold",url:`${et}VictorMonoNerdFont-Bold.ttf`,format:"truetype",weight:"bold",style:"normal"},{name:"VictorMonoNerdFont BoldItalic",url:`${et}VictorMonoNerdFont-BoldItalic.ttf`,format:"truetype",weight:"bold",style:"italic"},{name:"VictorMonoNerdFont Medium",url:`${et}VictorMonoNerdFont-Medium.ttf`,format:"truetype",weight:"normal",style:"normal"},{name:"VictorMonoNerdFont Italic",url:`${et}VictorMonoNerdFont-Italic.ttf`,format:"truetype",weight:"normal",style:"italic"},{name:"SauceCodeProNerdFont Bold",url:`${et}SauceCodeProNerdFont-Bold.ttf`,format:"truetype",weight:"bold",style:"normal"},{name:"SauceCodeProNerdFont Medium",url:`${et}SauceCodeProNerdFont-Medium.ttf`,format:"truetype",weight:"normal",style:"normal"},{name:"MesloLGS NF Bold Italic",url:`${et}MesloLGS NF Bold Italic.ttf`,format:"truetype",weight:"bold",style:"italic"},{name:"MesloLGS NF Bold",url:`${et}MesloLGS NF Bold.ttf`,format:"truetype",weight:"bold",style:"normal"},{name:"MesloLGS NF Italic",url:`${et}MesloLGS NF Italic.ttf`,format:"truetype",weight:"normal",style:"italic"}];function Wv(){typeof Mi?.add=="function"&&$v.forEach(({name:e,url:i,format:r,weight:s,style:l})=>{if(Mi?.has?.(e))return;let t=encodeURI(i),n=`@font-face {
  font-family: '${e}';
  src: url('${t}') format('${r}');
  font-weight: ${s};
  font-style: ${l};
}`;Mi.add(e,n)})}var xr=class{isDragging=!1;startY;startHeight;isFlotBtnDragging=!1;btnStartPosX;btnStartPosY;isTerminalMinimized=!1;isTerminalOpened=!1;previousTerminalHeight;pid;terminal=null;socket=null;$fitAddon=void 0;selectionManager=null;constructor(){Be.value[Ct.id]?Object.prototype.hasOwnProperty.call(this.settings,"fontLigatures")||(delete Be.value[Ct.id],Be.update(!1),this._saveSetting()):this._saveSetting(),typeof this.settings?.terminalPadding>"u"&&(this.settings.terminalPadding=vn,Be.update(!1)),this.uiState={sessionName:localStorage.getItem("AcodeX_Current_Session")||"AcodeX1",searchVisible:!1,searchQuery:""},this.handleResize=this.handleResize.bind(this),this.handleDrag=this.drag.bind(this),this.handleStopDragging=this.stopDragging.bind(this),this.handleStartDragging=this.startDragging.bind(this),this.handleDragFloatingBtn=this.dragFlotButton.bind(this),this.handleStopDraggingFloatingBtn=this.stopDraggingFlotBtn.bind(this),this.handleStartDraggingFloatingBtn=this.startDraggingFloatingBtn.bind(this),this.handleOpenTerminalCommand=this.handleOpenTerminalCommand.bind(this),this.handleCloseTerminalCommand=this.closeTerminal.bind(this),this.handleToggleTerminalCommand=this.handleToggleTerminalCommand.bind(this),this.handleMaximiseClick=this.maxmise.bind(this),this.handleSessionSelect=this.handleSessionSelect.bind(this),this.handleToggleSearch=this.handleToggleSearch.bind(this),this.handleSearchChange=this.handleSearchChange.bind(this),this.handleCreateSession=this.createSession.bind(this),this.handleOpenGuiViewer=this.openViewerPage.bind(this),this.handleNavigateToDir=this._cdToActiveDir.bind(this),this.handleBackButton=this.handleBackButton.bind(this)}renderUI(){!this.$terminalHeader||!this.$showTermBtn||(wr(ge(_d,{bindSearchInput:i=>{this.$searchInput=i},searchVisible:this.uiState.searchVisible,searchQuery:this.uiState.searchQuery,sessionName:this.uiState.sessionName,enableGuiViewer:this.settings.enableGuiViewer,onSessionSelect:this.handleSessionSelect,onCreateSession:this.handleCreateSession,onToggleSearch:this.handleToggleSearch,onNavigateToDir:this.handleNavigateToDir,onMinimize:this.minimise.bind(this),onClose:this.handleCloseTerminalCommand,onOpenGuiViewer:this.handleOpenGuiViewer,onSearchChange:this.handleSearchChange,onSearchNext:this._findNextMatchofSearch.bind(this),onSearchPrevious:this._findPreviousMatchofSearch.bind(this)}),this.$terminalHeader),wr(ge(gd,null),this.$showTermBtn),this.$showTermBtn.dataset.state=this.isTerminalMinimized?"minimized":"hidden")}setUiState(i){this.uiState={...this.uiState,...i},this.renderUI()}handleOpenTerminalCommand(){if(this.isTerminalOpened&&this.isTerminalMinimized){this.maxmise();return}this.openTerminalPanel(270,this.settings.port)}handleToggleTerminalCommand(){if(this.isTerminalOpened&&this.isTerminalMinimized){this.maxmise();return}this.minimise()}async handleSessionSelect(){let i,r=await this.$cacheFile.readFile("utf8"),s=r?JSON.parse(r):[];Array.isArray(s)?i=s.map(n=>n.name):i=[];let l={hideOnSelect:!0,default:localStorage.getItem("AcodeX_Current_Session")},t=await vd("AcodeX Sessions",i,l);t&&this.changeSession(t)}handleToggleSearch(){let i=!this.uiState.searchVisible;this.setUiState({searchVisible:i,searchQuery:i?this.uiState.searchQuery:""}),i||(this.$searchAddon?.clearDecorations(),this.$searchAddon?.clearActiveDecoration())}handleSearchChange(i){if(this.setUiState({searchQuery:i}),!i){this.$searchAddon?.clearDecorations(),this.$searchAddon?.clearActiveDecoration();return}this.$searchAddon?.findNext(i)}handleResize(){if(this.$terminalContainer&&!this.$terminalContainer.classList.contains("hide")){let r=document.querySelector("#root header")?.offsetHeight,s=document.querySelector("#root ul")?.offsetHeight||0,l=r+s,t=document.querySelector("#quick-tools")?.offsetHeight||0,n=window.innerHeight-(l+t),h=Number.parseInt(this.$terminalContainer.style.height);if(Number.isNaN(h))return;let g=Math.min(h,n);this.$terminalContainer.style.height=`${g}px`,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight)}let i=this.$terminal?.getSelection();if(i&&i.length>0&&this.selectionManager?.updateHandles(),this.$showTermBtn&&this.settings.showTerminalBtn&&!this.$showTermBtn.classList.contains("hide")){let r=document.querySelector("#root header")?.offsetHeight,s=document.querySelector("#root ul")?.offsetHeight||0,l=r+s,t=window.innerHeight-l-this.$showTermBtn.offsetHeight,n=Number.parseInt(this.$showTermBtn.style.bottom);this.$showTermBtn.style.bottom=`${Math.max(0,Math.min(t,n))}px`}}handleBackButton(){!this.$page||!document.contains(this.$page)||(this.rfb?.disconnect(),this.$page.querySelector(".gui-viewer-canvas").innerHTML="",this.$page.hide())}async init(i,r,s){try{Wv(),this.xtermCss=tag("link",{rel:"stylesheet",href:`${this.baseUrl}xterm.css`}),this.$style=tag("link",{rel:"stylesheet",href:`${this.baseUrl}main.css`}),this._loadCustomFontStyleSheet(),document.head.append(this.xtermCss,this.$style),editorManager.editor.commands.addCommand({name:"acodex:open_terminal",description:"Open Terminal",bindKey:{win:"Ctrl-K"},exec:this.handleOpenTerminalCommand}),editorManager.editor.commands.addCommand({name:"acodex:close_terminal",description:"Close Terminal",bindKey:{win:"Ctrl-J"},exec:this.handleCloseTerminalCommand}),editorManager.editor.commands.addCommand({name:"acodex:maximise_terminal",description:"Maximise Terminal",bindKey:{win:"Ctrl-Shift-T"},exec:this.handleToggleTerminalCommand}),this.$terminalContainer=tag("div",{className:"terminal-panel"}),this.$terminalHeader=tag("div",{className:"terminal-title-bar"}),this.$terminalContent=tag("div",{className:"terminal-content"}),this.$showTermBtn=tag("button",{className:"show-terminal-btn",ariaLabel:"Restore terminal"}),this.settings.enableGuiViewer&&this.setupGUIViewerPage(),this.$terminalHeader.addEventListener("mousedown",this.handleStartDragging),this.$terminalHeader.addEventListener("touchstart",this.handleStartDragging),this.$terminalContainer.append(this.$terminalHeader,this.$terminalContent),this.renderUI(),app.get("main")&&app.get("main").append(this.$terminalContainer,this.settings.showTerminalBtn?this.$showTermBtn:""),this.$showTermBtn?.classList.add("hide"),this.$terminalContainer?.classList.add("hide"),this.settings.showTerminalBtnSize&&this.settings.showTerminalBtn&&(this.$showTermBtn.style.height=`${this.settings.showTerminalBtnSize}px`,this.$showTermBtn.style.width=`${this.settings.showTerminalBtnSize}px`),this.$cacheFile=r,this.$showTermBtn.addEventListener("mousedown",this.handleStartDraggingFloatingBtn),this.$showTermBtn.addEventListener("touchstart",this.handleStartDraggingFloatingBtn),this.$showTermBtn.addEventListener("click",this.handleMaximiseClick),document.addEventListener("mousemove",this.handleDragFloatingBtn),document.addEventListener("mouseup",this.handleStopDraggingFloatingBtn),document.addEventListener("touchmove",this.handleDragFloatingBtn),document.addEventListener("touchend",this.handleStopDraggingFloatingBtn),window.addEventListener("mousemove",this.handleDrag),window.addEventListener("touchmove",this.handleDrag),window.addEventListener("mouseup",this.handleStopDragging),window.addEventListener("touchend",this.handleStopDragging),window.addEventListener("resize",this.handleResize),localStorage.getItem("AcodeX_Is_Opened")==="true"&&localStorage.getItem("AcodeX_Current_Session")&&await this.openTerminalPanel(localStorage.getItem("AcodeX_Terminal_Cont_Height")||270,this.settings.port),acode.define("acodex",{execute:(l,t=!0)=>{try{if(!this.isTerminalOpened)return;this.socket?.send(t?`${l}\r`:l)}catch(n){throw Error(n)}},isMinimized:()=>this.isTerminalMinimized,isTerminalOpened:()=>this.isTerminalOpened,maximiseTerminal:()=>{this.isTerminalOpened&&this.isTerminalMinimized&&this.maxmise()},openTerminal:async(l=270,t=this.settings.port)=>{if(!this.isTerminalOpened){let n=await this.openTerminalPanel(l,t);return{onmessage:h=>{n&&(n.onmessage=g=>h(typeof g.data=="string"?g.data:new Uint8Array(g.data)))},write:(h,g=!0)=>{let o=g?`${h}\r`:h;n.send(o)}}}},createSession:async()=>{if(this.isTerminalOpened){let l=await this.createSession();return{onmessage:t=>{l&&(l.onmessage=n=>t(typeof n.data=="string"?n.data:new Uint8Array(n.data)))},write:(t,n=!0)=>{let h=n?`${t}\r`:t;l.send(h)}}}},changeSession:async l=>{if(this.isTerminalOpened){let t=await this.changeSession(l);return{onmessage:n=>{t&&(t.onmessage=h=>n(typeof h.data=="string"?h.data:new Uint8Array(h.data)))},write:(n,h=!0)=>{let g=h?`${n}\r`:n;t.send(g)}}}},closeTerminal:()=>{this.isTerminalOpened&&this.closeTerminal()},convertAcodeUriToTermReadable:l=>Br(l),addTheme:(l,t)=>{mn.push(l),Ee[l]=t},applyTheme:l=>{this.settings.theme=l,Be.update()}})}catch(l){console.log(l)}}setupGUIViewerPage(){let i=tag("span",{className:"icon clearclose",dataset:{action:"close-btn"}});this.displayVar=tag("span",{textContent:"Display: ",dataset:{action:"copy-display-num"}}),this.displayVar.onclick=()=>{oa.copy(`export DISPLAY=${this.displayVariable};`),acode.alert("AcodeX","Copied the display, just execute the copied command in your current terminal session.")},this.$page=Nv("AcodeX GUI Viewer",{lead:i,tail:this.displayVar}),this.$page.id="acodex-gui-viewer",this.$page.show=()=>{Uv.push({id:Ct.id,action:this.$page.hide}),app.append(this.$page),this.$page.querySelector(".gui-viewer-canvas").appendChild(this._hiddenInput)},i.onclick=()=>{this.rfb.disconnect(),s.innerHTML="",this.$page.hide()},document.addEventListener("backbutton",this.handleBackButton,!1);let r=tag("span",{className:"icon keyboard_hide",dataset:{action:"show-keyboard"}});this.$page.header.append(r);let s=tag("div",{className:"gui-viewer-canvas"});this.$page.body.append(s),this._hiddenInput=tag("textarea",{autocapitalize:"off",autocomplete:"off",spellcheck:"false",tabindex:"-1"}),this._hiddenInput.style.position="absolute",this._hiddenInput.style.opacity="0",this._hiddenInput.style.height="0px",this._hiddenInput.style.width="0px",this._hiddenInput.style.zIndex="-1",this._hiddenInput.style.imeMode="disabled",this.$page.querySelector(".gui-viewer-canvas").appendChild(this._hiddenInput),r.onclick=()=>{this._hiddenInput.focus()};function l(t){let n=t.target.value,h=t.target.dataset.lastValue||"",g;try{g=Math.max(t.target.selectionStart,n.length)}catch{g=n.length}let o=h.length,c=g-o,f=c<0?-c:0;for(let v=0;v<Math.min(o,g);v++)if(n.charAt(v)!==h.charAt(v)){c=g-v,f=o-v;break}for(let v=0;v<f;v++)this.rfb.sendKey(yd.default.XK_BackSpace,"Backspace");for(let v=g-c;v<g;v++){let u=n.charCodeAt(v),a=bd.default.lookup(u);a&&this.rfb.sendKey(a)}t.target.dataset.lastValue=n}this._hiddenInput.addEventListener("input",l.bind(this))}async openViewerPage(){Tt.showTitleLoader();let i=/(?:bash|zsh|sh|.*):(?:\s*line \d+:)?\s*\w+:? command not found|not found/;try{if(this.rfb)Tt?.removeTitleLoader(),this.$page.show();else{let r=await this.executeCommandOnPty("vncserver --help");if(i.test(r.output))Tt?.removeTitleLoader(),acode.alert("AcodeX Error","vncserver not found, First go head and read readme of acodex regarding 'Gui Setup'. To setup it");else{let s=await this.executeCommandOnPty("vncserver -list");if(/:\d+\s+\t+\d+/.test(s.output))this.displayVariable=s.output.match(/:(\d+)/)[0],this.connectVncServer(this.displayVariable);else if(/TigerVNC server sessions:\s+X DISPLAY #\tPROCESS ID/.test(s.output)){let l=await this.executeCommandOnPty("vncserver"),t=/New 'localhost:(\d+)/,n=l.output.match(t);n?(this.displayVariable=`:${n[1]}`,this.connectVncServer(this.displayVariable)):(Tt?.removeTitleLoader(),acode.alert("AcodeX Error","Failed to create new vnc server session, try creating it manually by executing: `vncserver` command"))}else throw new Error("Unexpected output from vncserver -list.")}}}catch(r){Tt?.removeTitleLoader(),console.error("Error executing command:",r),acode.alert("AcodeX Error",r.message)}}async connectVncServer(i){try{let r=/(?:bash|zsh|sh|.*):(?:\s*line \d+:)?\s*\w+:? command not found|not found/,s=await this.executeCommandOnPty("websockify_rs");if(r.test(s.output)&&acode.alert("AcodeX Warning","websockify_rs not found, which acts as a proxy. Go ahead and install it(Check readme for guide)."),(await this.executeCommandOnPty("ps aux | grep websockify_rs | grep -v grep")).output===""){let t=5900+Number.parseInt(i.split(":")[1]),n=localStorage.getItem("AcodeX_Current_Session");await(await this.createSession()).send(`websockify_rs localhost:6778 localhost:${t}\r`),await this.changeSession(n),await this.waitForWebsockifyToStart()}this.bindNoVnc()}catch(r){Tt?.removeTitleLoader(),console.error("Error in connecting to vnc server:",r),acode.alert("AcodeX Error",r.message)}}async waitForWebsockifyToStart(){let i=5,r=s=>new Promise(l=>setTimeout(l,s));for(;i>0;){if((await this.executeCommandOnPty("ps aux | grep websockify_rs | grep -v grep")).output!==""){console.log("AcodeX: Websockify_rs started successfully.");return}i--,console.log("AcodeX: Waiting for websockify_rs to start..."),await r(1e3)}throw new Error("AcodeX: Failed to start websockify_rs within the timeout period.")}async bindNoVnc(){try{this.rfb=new md.default(this.$page.querySelector(".gui-viewer-canvas"),"ws://localhost:6778/"),this.rfb.scaleViewport=!0,this.rfb.clipViewport=!0;let r=getComputedStyle(document.documentElement).getPropertyValue("--secondary-color").trim();this.rfb.background=r||"",this.rfb.addEventListener("connect",()=>{this.$page.show(),Tt?.removeTitleLoader(),this.displayVar.textContent=`Display: ${this.displayVariable.split(":")[1]}`}),this.rfb.addEventListener("disconnect",()=>{this.rfb=void 0,this.$page?.hide(),Tt?.removeTitleLoader()}),this.rfb.addEventListener("credentialsrequired",async()=>{let s;if(localStorage.getItem("VNC_PASS"))s=localStorage.getItem("VNC_PASS");else{if(s=await acode.prompt("Enter vncserver password:","","text"),!s)return;localStorage.setItem("VNC_PASS",s)}this.rfb?.sendCredentials({password:s})}),this.rfb.addEventListener("securityfailure",s=>{acode.alert("AcodeX Error",`Security failure: ${s.detail.reason}`),console.error("Security failure:",s.detail),localStorage.removeItem("VNC_PASS")}),this.rfb.addEventListener("serververification",s=>{acode.alert("AcodeX Error",`Server verification failed: ${JSON.stringify(s.detail)}`),console.error("Server verification failed:",s)})}catch(i){Tt?.removeTitleLoader(),console.error("Error novnc:",i),acode.alert("AcodeX Error",i.message)}}async executeCommandOnPty(i){let r=await fetch(`http://${this.settings.serverHost}:${this.settings.port}/execute-command`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:i})});if(!r.ok)throw new Error(`Request failed with status: ${r.status}`);return await r.json()}async openTerminalPanel(i,r){if(!r)return;document.querySelector(".terminal-panel")||app.get("main").append(this.$terminalContainer,this.$showTermBtn),this.settings.port=r,Be.update(!1),this.$terminalContainer.classList.remove("hide"),this.isTerminalOpened=!0,this.$terminalContainer.style.height=`${i}px`,this.$terminalContent.style.width="100%",this.$terminalContent.style.height="100%",await Mi.loadFont(this.settings.fontFamily),this.settings.transparency?(this.$terminalContainer.style.background="transparent",this.$terminalContainer.style.backdropFilter=`blur(${this.settings.blurValue})`,this.$terminalHeader.style.background=da(this.$terminalHeader),this.$terminalHeader.style.backdropFilter=`blur(${this.settings.blurValue})`):(this.$terminalContainer.style.background="var(--popup-background-color)",this.$terminalHeader.style.background="var(--primary-color)");let s;return localStorage.getItem("AcodeX_Current_Session")?s=await this.changeSession(localStorage.getItem("AcodeX_Current_Session"),!0):(this.$terminalContent.innerHTML="",s=await this.createSession()),s}async createXtermTerminal(i){if(this.$terminal=this.terminalObj,this.$fitAddon=new wd.FitAddon,this.$webglAddon=new Cd.WebglAddon,this.$unicode11Addon=new Sd.Unicode11Addon,this.$webLinkAddon=new xd.WebLinksAddon(async(r,s)=>{await pd("AcodeX Link",`Do you want to open ${s} in browser?`)&&system.openInBrowser(s)}),this.$searchAddon=new kd.SearchAddon,this.settings.imageRendering&&(this.$imageAddon=new aa.ImageAddon,this.$terminal.loadAddon(this.$imageAddon)),this.$terminal.loadAddon(this.$fitAddon),this.$terminal.loadAddon(this.$unicode11Addon),this.$terminal.loadAddon(this.$webLinkAddon),this.$terminal.loadAddon(this.$searchAddon),this.$webglAddon)try{this.$terminal.loadAddon(this.$webglAddon),this.$terminal.open(this.$terminalContent)}catch(r){window.toast(`error during loading webgl addon: ${r}`,4e3),this.$webglAddon.dispose(),this.$webglAddon=void 0}this.$terminal.element||this.$terminal.open(this.$terminalContent),this.$terminal.element&&(this._setTerminalPadding(this.settings.terminalPadding),this.fitTerminal()),this.settings.fontLigatures&&(this.$ligatureAddon=new Ri,this.$terminal.loadAddon(this.$ligatureAddon)),this.$terminal.focus(),this._updateTerminalHeight()}async attachSocketToXterm(i,r){this.$terminal.onResize(async t=>{if(!r)return;let n=t.cols.toString(),h=t.rows.toString(),g=`http://${this.settings.serverHost}:${i}/terminals/${r}/resize`;await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cols:n,rows:h})})}),this.socket=new WebSocket(`ws://${this.settings.serverHost}:${i}/terminals/${r}`),this.socket.onopen=()=>{this.$attachAddon=new Ed.AttachAddon(this.socket),this.$terminal.loadAddon(this.$attachAddon),this.$terminal.unicode.activeVersion="11",this._updateTerminalHeight(),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.getItem("AcodeX_Terminal_Is_Minimised")==="true"&&this.minimise(),this._updateTerminalHeight();let t=Number(this.settings.fontSize)||gn,n=Math.max(1,t-10),h=Math.max(t+16,32);this.selectionManager=new Pi(this.$terminal,this.$terminalContent,this.settings,{minFontSize:n,maxFontSize:h,onFontSizeChange:g=>this.applyTerminalFontSize(g)})},this.socket.onclose=async t=>{try{let n=await fetch(`http://${this.settings.serverHost}:${i}/`);n.ok||console.warn("Server responded with an error:",n.status,n.statusText);return}catch{this.removeTerminal(),acode.alert("AcodeX Server","Disconnected from server because server gets closed \u{1F61E}!")}},this.socket.onerror=t=>{acode.alert("AcodeX Error",JSON.stringify(t))},this.$terminal.attachCustomKeyEventHandler(async t=>{if(t.type==="keydown"){let n=await this.$cacheFile.readFile("utf8"),h=n?JSON.parse(n):[];if(t.ctrlKey&&(t.key==="N"||t.key==="n"))return this.createSession(),!1;if(t.ctrlKey&&(t.key==="W"||t.key==="w"))return this.closeTerminal(),!1;if(t.ctrlKey&&t.shiftKey&&(t.key==="T"||t.key==="t"))return this.isTerminalMinimized||this.minimise(),!1;if(t.ctrlKey&&t.shiftKey&&(t.key==="V"||t.key==="v"))return oa.paste(g=>{this.$terminal?.paste(g)}),!1;if(t.ctrlKey&&t.keyCode>=49&&t.keyCode<=53){let g=t.keyCode-49;if(h.length>g){let o=h[g];return this.changeSession(o.name),!1}}if(t.ctrlKey&&t.key==="ArrowLeft"){let g=h.findIndex(o=>o.name===localStorage.getItem("AcodeX_Current_Session"));if(g>0){let o=h[g-1];return this.changeSession(o.name),!1}}if(t.ctrlKey&&t.key==="ArrowRight"){let g=h.findIndex(o=>o.name===localStorage.getItem("AcodeX_Current_Session"));if(g<h.length-1){let o=h[g+1];return this.changeSession(o.name),!1}}if(t.ctrlKey&&t.key==="+"){let g=this.$terminal.options.fontSize+1;return this.applyTerminalFontSize(g),!1}if(t.ctrlKey&&t.key==="-"){let g=this.$terminal.options.fontSize-1;return g<1||this.applyTerminalFontSize(g),!1}if(t.ctrlKey&&t.shiftKey&&(t.key==="c"||t.key==="C")){if(!this.$terminal?.hasSelection())return;let g=this.$terminal?.getSelection();return g&&oa.copy(g),window.toast("Copied \u2705",3e3),this.$terminal.focus(),!1}if(t.ctrlKey&&t.shiftKey&&(t.key==="i"||t.key==="I"))return this.$terminal?.clear(),this.socket?.send("clear\r"),!1;if(t.ctrlKey&&(t.key==="a"||t.key==="A"))return this.$terminal?.selectAll(),!1}});let s="",l=!0;this.$terminal.onData(t=>{if(t==="\x7F"){s.trim()===""?l=!0:(s=s.slice(0,-1),l=s.trim()==="");return}let n=fa(t);s+=n,n.startsWith("#")&&l&&this.openAIPromptPopup(),t==="\r"&&(s.trim().toLowerCase()==="exit"&&(console.log("Exiting current session..."),this.terminalCloseHandler()),s="",l=!0),l=s.trim()===""})}async getOllamaModel(i){let r=localStorage.getItem("ACODEX_LOCAL_LLM_MODEL");if(r)return r;try{let s=await i.getListOfOllamaModels();if(!Array.isArray(s))throw new Error("Failed to fetch Ollama models");let l=await vd("Select Local Model",s);return l?(localStorage.setItem("ACODEX_LOCAL_LLM_MODEL",l),l):null}catch(s){return console.error("Error getting Ollama models:",s),acode.alert("Error","Failed to fetch Ollama models"),null}}async openAIPromptPopup(){let i=new xa(this.settings.aiModel===yn[3][0]?null:this.settings.aiApiKey),r;if(this.settings.aiModel==="local-llm"&&(r=await this.getOllamaModel(i),!r))return;let s=Xv("\u26A1 Ask  AcodeX Ai",`<textarea id="acodeXAiPromptBox" rows="2" placeholder="for eg: delete sample.txt file"></textarea>
			<div class="ai-loader-container">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
			</div>`,"Start Magic \u2728");s.ok(async()=>{let l=document.querySelector("#acodeXAiPromptBox"),t=document.querySelector(".ai-loader-container"),n=l?.value;if(!n){s.hide();return}t&&(t.style.display="flex"),window.toast("Wait! To see the magic of AcodeX AI \u2728",2e3);try{let h="";switch(this.settings.aiModel){case"deepseek":{let{response:g,error:o}=await i.generateDeepseekResponse(n);if(o){t&&(t.style.display="none"),s.hide(),acode.alert("AcodeX AI Error",o.toString()),console.error("AcodeX AI Error:",o);return}h=g.choices[0].message.content;break}case"chatgpt":{let{response:g,error:o}=await i.generateChatgptResponse(n);if(o){t&&(t.style.display="none"),s.hide(),acode.alert("AcodeX AI Error",o.toString()),console.error("AcodeX AI Error:",o);return}h=g.choices[0].message.content;break}case"gemini-pro":{let{response:g,error:o}=await i.generateGeminiResponse(n);if(o){t&&(t.style.display="none"),s.hide(),acode.alert("AcodeX AI Error",o.toString()),console.error("AcodeX AI Error:",o);return}h=g.candidates[0].content.parts[0].text;break}case"local-llm":{h=(await i.generateOllamaResponse(r,n)).response;break}}if(!h){t&&(t.style.display="none"),s.hide();return}this.socket?.send("\b"),this.socket?.send(h.trim()),t&&(t.style.display="none"),s.hide()}catch(h){t&&(t.style.display="none"),s?.hide(),console.error(h),acode.alert("AcodeX AI Error",JSON.stringify(h))}})}async createSession(){let i,r=await this.$cacheFile.readFile("utf8"),s=r?JSON.parse(r):[];if(s.length===0){if(await this.createXtermTerminal(this.settings.port),i=await this._generateProcessId(),!i)return;s=[{name:"AcodeX1",pid:i}]}else{this._hideTerminalSession();let n=`AcodeX${s.reduce((h,g)=>{let c=g.name.match(/^AcodeX(\d+)$/);if(c){let f=Number.parseInt(c[1],10);return Math.max(h,f)}return h},0)+1}`;if(await this.createXtermTerminal(this.settings.port),i=await this._generateProcessId(),!i)return;s.push({name:n,pid:i})}return await Promise.all([this.$cacheFile.writeFile(s),this.attachSocketToXterm(this.settings.port,i)]),this._updateTerminalHeight(),localStorage.setItem("AcodeX_Current_Session",s[s.length-1].name),this.setUiState({sessionName:s[s.length-1].name,searchVisible:!1,searchQuery:""}),window.toast(`Created Session: ${s[s.length-1].name}`,3e3),this.socket}_hideTerminalSession(){this.cleanupSelectionManager(),this.$attachAddon?.dispose(),this.$fitAddon?.dispose(),this.$unicode11Addon?.dispose(),this.$webLinkAddon?.dispose(),this.$searchAddon?.dispose(),this.$imageAddon?.dispose(),this.$ligatureAddon?.dispose(),this.$webglAddon?.dispose(),this.$terminal?.dispose(),this.socket?.close(),this.socket=null,this.$terminal=void 0,this.$attachAddon=void 0,this.$fitAddon=void 0,this.$unicode11Addon=void 0,this.$webLinkAddon=void 0,this.$searchAddon=void 0,this.$imageAddon=void 0,this.$ligatureAddon=void 0,this.$webglAddon=void 0,this.$terminalContent.innerHTML=""}async _generateProcessId(){try{let i=this.$terminal.cols.toString(),r=this.$terminal.rows.toString(),s=await fetch(`http://${this.settings.serverHost}:${this.settings.port}/terminals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cols:i,rows:r})});if(!s.ok)throw new Error("Failed to create terminal");return await s.text()}catch{this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.removeItem("AcodeX_Current_Session"),window.toast("Start the acodex server in termux first!",4e3)}}async changeSession(i,r=!1){if(r){await this.createXtermTerminal(this.settings.port);let l=await this._getPidBySessionName(i);if(!l){this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.removeItem("AcodeX_Current_Session"),window.toast("Oops! Something went wrong in the Core \u{1F614}",4e3);return}return await this.attachSocketToXterm(this.settings.port,l),localStorage.setItem("AcodeX_Current_Session",i),this.setUiState({sessionName:i,searchVisible:!1,searchQuery:""}),this.socket}if(i===localStorage.getItem("AcodeX_Current_Session"))return;let s=await this._getPidBySessionName(i);if(s)return this._hideTerminalSession(),await this.createXtermTerminal(this.settings.port),await this.attachSocketToXterm(this.settings.port,s),localStorage.setItem("AcodeX_Current_Session",i),this.setUiState({sessionName:i,searchVisible:!1,searchQuery:""}),this.socket}async _getPidBySessionName(i){let r=await this.$cacheFile.readFile("utf8"),s=r?JSON.parse(r):[];if(Array.isArray(s)){let l=s.find(t=>t.name===i);return l?l.pid:(console.log(`Error: Session '${i}' not found in JSON file.`),null)}return console.log("Error: Sessions data is not an array in JSON file."),null}_saveSetting(){Be.value[Ct.id]={port:8767,serverHost:"localhost",aiApiKey:"",aiModel:Pa,transparency:ka,selectionHaptics:Ba,fontLigatures:La,enableGuiViewer:Sa,imageRendering:Ea,showTerminalBtnSize:Ma,showTerminalBtn:Fa,blurValue:"4px",cursorBlink:Da,cursorStyle:fn[0],cursorInactiveStyle:_n[0],fontSize:gn,fontFamily:Ia,letterSpacing:0,terminalPadding:vn,fontWeight:pn[0],customFontStyleSheet:"",scrollBack:Ta,scrollSensitivity:Ra,theme:Le,background:Ee[Le].background,foreground:Ee[Le].foreground,cursor:Ee[Le].cursor||"",cursorAccent:Ee[Le].cursorAccent||"",selectionBackground:Ee[Le].selectionBackground,black:Ee[Le].black,blue:Ee[Le].blue,brightBlack:Ee[Le].brightBlack,brightBlue:Ee[Le].brightBlue,brightCyan:Ee[Le].brightCyan,brightGreen:Ee[Le].brightGreen,brightMagenta:Ee[Le].brightMagenta,brightRed:Ee[Le].brightWhite,brightWhite:Ee[Le].brightWhite,brightYellow:Ee[Le].brightYellow,cyan:Ee[Le].cyan,green:Ee[Le].green,magenta:Ee[Le].magenta,red:Ee[Le].red,white:Ee[Le].white,yellow:Ee[Le].yellow},Be.update(!1)}_loadCustomFontStyleSheet(){if(this.settings.customFontStyleSheet!=="")if(document.querySelector("#customFontAcodeXStyleSheet"))document.querySelector("#customFontAcodeXStyleSheet").href=this.settings.customFontStyleSheet;else{let i=tag("link",{href:this.settings.customFontStyleSheet,rel:"stylesheet",id:"customFontAcodeXStyleSheet"});document.head.append(i)}}_setTerminalPadding(i){if(!this.$terminal?.element)return;let r=Number(i),l=`${Number.isNaN(r)?0:Math.max(0,r)}px`,t=this.$terminal.element;t.style.boxSizing="border-box",t.style.padding=l,this.$fitAddon&&this.fitTerminal()}_updateTerminalHeight(){this.$terminalContent&&(this.$terminalContent.style.height="100%",localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.fitTerminal())}fitTerminal(){if(!(!this.$fitAddon||!this.$terminal||!this.$terminal.element||!this.$terminalContent?.isConnected||this.$terminalContainer?.classList.contains("hide")))try{let i=this.$fitAddon.proposeDimensions();if(!i?.cols||!i?.rows)return;this.$terminal.resize(i.cols+2,i.rows+1)}catch(i){console.warn("AcodeX fitTerminal skipped:",i)}}applyTerminalFontSize(i){if(!this.$terminal)return;let r=Number(i);if(Number.isNaN(r))return;let l=Math.max(1,r);this.$terminal.options.fontSize!==l&&(this.$terminal.options.fontSize=l,typeof this.$terminal.refresh=="function"&&this.$terminal.refresh(0,this.$terminal.rows-1),this.settings.fontSize=l,Be.update(!1))}async _getLastSessionName(){try{let i=await this.$cacheFile.readFile("utf8"),r=i?JSON.parse(i):[];return Array.isArray(r)&&r.length>0?r[r.length-1].name:(console.error("Error: No sessions found in JSON file or sessions data is not an array."),null)}catch(i){return console.error("Error reading or parsing JSON file:",i),null}}async removeTerminal(){this.$terminalContainer.classList.contains("hide")||(this.$terminalContainer.style.opacity=1),this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),localStorage.removeItem("AcodeX_Current_Session"),this.setUiState({sessionName:"AcodeX1",searchVisible:!1,searchQuery:""}),await this.$cacheFile.writeFile("")}async terminalCloseHandler(){let i=await this.$cacheFile.readFile("utf8"),r=i?JSON.parse(i):[];if(r=r.filter(s=>s.name!==localStorage.getItem("AcodeX_Current_Session")),await this.$cacheFile.writeFile(r),r.length>0){let s=await this._getLastSessionName();this.changeSession(s)}else this._hideTerminalSession(),this.$terminalContainer.classList.contains("hide")||this.$terminalContainer.classList.add("hide"),this.$showTermBtn.classList.contains("hide")||this.$showTermBtn.classList.add("hide"),this.isTerminalMinimized=!1,this.isTerminalOpened=!1,this.rfb?.disconnect(),this.rfb=void 0,localStorage.removeItem("AcodeX_Current_Session"),localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),localStorage.setItem("AcodeX_Is_Opened",this.isTerminalOpened),this.$terminalContainer.style.height=this.previousTerminalHeight,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.setUiState({sessionName:"AcodeX1",searchVisible:!1,searchQuery:""});this.cleanupSelectionManager()}async closeTerminal(){if(await pd("Warning","Are you sure ?")&&this.$terminal!=null&&localStorage.getItem("AcodeX_Current_Session")){let r=await this._getPidBySessionName(localStorage.getItem("AcodeX_Current_Session"));if(!r)return;fetch(`http://${this.settings.serverHost}:${this.settings.port}/terminals/${r}/terminate`,{method:"POST"}).then(async s=>{s.ok?this.terminalCloseHandler():(acode.alert("AcodeX Error",`Failed to close terminal ${this.pid}. Trying to force close it...`),this.removeTerminal())}).catch(async s=>{this.removeTerminal(),acode.alert("AcodeX Server","Disconnected from server because server gets closed \u{1F61E}!"),console.error(`Error while closing terminal ${this.pid}: ${s}`)})}}startDraggingFloatingBtn(i){try{this.isFlotBtnDragging=!0,this.$showTermBtn.style.border="2px solid #fff",i.type==="touchstart"?(this.btnStartPosX=i.touches[0].clientX,this.btnStartPosY=i.touches[0].clientY):(this.btnStartPosX=i.clientX,this.btnStartPosY=i.clientY)}catch(r){window.alert(r)}}dragFlotButton(i){try{if(!this.isFlotBtnDragging)return;i.preventDefault();let r,s;i.type==="touchmove"?(r=i.touches[0].clientX,s=i.touches[0].clientY):(r=i.clientX,s=i.clientY);let l=this.btnStartPosX-r,t=this.btnStartPosY-s;this.btnStartPosX=r,this.btnStartPosY=s;let n=window.innerHeight-(this.$showTermBtn.offsetTop+this.$showTermBtn.offsetHeight)+t,h=this.$showTermBtn.offsetLeft-l,g=document.querySelector("#root header")?.offsetHeight,o=document.querySelector("#root ul")?.offsetHeight||0,c=g+o,f=window.innerWidth-this.$showTermBtn.offsetWidth,v=window.innerHeight-c-this.$showTermBtn.offsetHeight;this.$showTermBtn.style.bottom=`${Math.max(0,Math.min(v,n))}px`,this.$showTermBtn.style.left=`${Math.max(0,Math.min(f,h))}px`}catch(r){window.alert(r)}}stopDraggingFlotBtn(){try{this.isFlotBtnDragging=!1,this.$showTermBtn.style.border="none"}catch(i){window.alert(i)}}startDragging(i){i.type==="touchstart"?this.startY=i.touches[0].clientY:(i.preventDefault(),this.startY=i.clientY),this.startHeight=this.$terminalContainer.clientHeight,this.isDragging=!0,this.$terminalContainer.style.borderTop="1px solid var(--link-text-color)"}drag(i){if(!this.isDragging)return;i.preventDefault();let r;i.type==="touchmove"?r=i.touches[0].clientY:r=i.clientY;let s=r-this.startY,l=this.startHeight-s,t=document.querySelector("#root header")?.offsetHeight,n=document.querySelector("#root ul")?.offsetHeight||0,h=t+n,g=document.querySelector("#quick-tools")?.offsetHeight||0,o=window.innerHeight-(h+g);l=Math.max(100,Math.min(l,o)),this.$terminalContainer.style.height=`${l}px`,localStorage.setItem("AcodeX_Terminal_Cont_Height",l),this._updateTerminalHeight();let f=this.$terminal?.getSelection();f&&f.length>0&&this.selectionManager?.updateHandles()}stopDragging(i){this.isDragging=!1,this.$terminalContainer.style.borderTop="1px solid var(--popup-border-color)"}minimise(){try{this.isTerminalMinimized||(this.previousTerminalHeight=window.getComputedStyle(this.$terminalContainer).height,localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.$terminalContainer.style.height="0px",this.$terminalContainer.classList.add("hide"),this.isTerminalMinimized=!0,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),this.settings.showTerminalBtn&&this.$showTermBtn.classList.remove("hide"),this.$showTermBtn.dataset.state="minimized")}catch(i){window.alert(i)}}maxmise(){if(this.isTerminalMinimized){Number.parseInt(localStorage.getItem("AcodeX_Terminal_Cont_Height"))<=50?this.$terminalContainer.style.height="50px":this.$terminalContainer.style.height=`${localStorage.getItem("AcodeX_Terminal_Cont_Height")}px`,this.$terminalContainer.classList.remove("hide"),this.$terminalContent.style.height="100%",this.fitTerminal(),localStorage.setItem("AcodeX_Terminal_Cont_Height",this.$terminalContainer.offsetHeight),this.settings.showTerminalBtn&&this.$showTermBtn.classList.add("hide"),this.$showTermBtn.dataset.state="hidden",this.isTerminalMinimized=!1,localStorage.setItem("AcodeX_Terminal_Is_Minimised",this.isTerminalMinimized),this._updateTerminalHeight();let i=this.$terminal?.getSelection();i&&i.length>0&&this.selectionManager?.updateHandles()}}_findPreviousMatchofSearch(){let i=this.uiState.searchQuery;this.$searchAddon?.findPrevious(i)}_findNextMatchofSearch(){let i=this.uiState.searchQuery;this.$searchAddon?.findNext(i)}async _cdToActiveDir(){let{activeFile:i}=editorManager;if(i.uri){let r=Br(i.uri);if(!r){navigator.vibrate(300),window.toast("unsupported path type.",3e3);return}this.socket.send(`cd "${r}"\r`)}}cleanupSelectionManager(){this.selectionManager&&(this.selectionManager.destroy(),this.selectionManager=null)}async destroy(){wr(null,this.$terminalHeader),wr(null,this.$showTermBtn),this.$style?.remove(),this.xtermCss?.remove(),this.$fontStyleSheet?.remove(),await Qv(`${window.DATA_STORAGE}acodex_fonts`).delete(),editorManager.editor.commands.removeCommand("acodex:open_terminal"),editorManager.editor.commands.removeCommand("acodex:close_terminal"),editorManager.editor.commands.removeCommand("acodex:maximise_terminal"),this.cleanupSelectionManager(),this.$terminalContainer?.remove(),this.$showTermBtn?.remove(),document.removeEventListener("mousemove",this.handleDragFloatingBtn),document.removeEventListener("mouseup",this.handleStopDraggingFloatingBtn),document.removeEventListener("touchmove",this.handleDragFloatingBtn),document.removeEventListener("touchend",this.handleStopDraggingFloatingBtn),document.removeEventListener("backbutton",this.handleBackButton,!1),this.$showTermBtn?.removeEventListener("mousedown",this.handleStartDraggingFloatingBtn),this.$showTermBtn?.removeEventListener("touchstart",this.handleStartDraggingFloatingBtn),this.$showTermBtn?.removeEventListener("click",this.handleMaximiseClick),this.$terminalHeader?.removeEventListener("mousedown",this.handleStartDragging),this.$terminalHeader?.removeEventListener("touchstart",this.handleStartDragging),window.removeEventListener("mousemove",this.handleDrag),window.removeEventListener("touchmove",this.handleDrag),window.removeEventListener("mouseup",this.handleStopDragging),window.removeEventListener("touchend",this.handleStopDragging),window.removeEventListener("resize",this.handleResize),localStorage.removeItem("AcodeX_Terminal_Is_Minimised"),localStorage.removeItem("AcodeX_Current_Session"),localStorage.removeItem("AcodeX_Terminal_Cont_Height"),localStorage.removeItem("AcodeX_Is_Opened"),localStorage.getItem("ACODEX_LOCAL_LLM_MODEL")&&localStorage.removeItem("ACODEX_LOCAL_LLM_MODEL")}async setCustomFontFile(){let{url:i}=await acode.fileBrowser("file","select custom font stylesheet");if(!i)return;let r=Br(i);if(r.startsWith("/sdcard"))r=r.replace("/sdcard","file:///storage/emulated/0");else if(r.startsWith("$HOME"))return;let s=i.split("/"),l=s[s.length-1];r=`${r}/${l}`;let t=await Kv(r);this.settings.customFontStyleSheet=t,Be.update()}async applyTheme(i){let r=Ee[i];this.settings.theme=i,this.settings.background=r.background,this.settings.foreground=r.foreground,this.settings.cursor=r.cursor||"#fff",this.settings.cursorAccent=r.cursorAccent||"#fff",this.settings.selectionBackground=r.selectionBackground,this.settings.black=r.black,this.settings.blue=r.blue,this.settings.brightBlack=r.brightBlack,this.settings.brightBlue=r.brightBlue,this.settings.brightCyan=r.brightCyan,this.settings.brightGreen=r.brightGreen,this.settings.brightMagenta=r.brightMagenta,this.settings.brightRed=r.brightRed,this.settings.brightWhite=r.brightWhite,this.settings.brightYellow=r.brightYellow,this.settings.cyan=r.cyan,this.settings.green=r.green,this.settings.magenta=r.magenta,this.settings.red=r.red,this.settings.white=r.white,this.settings.yellow=r.yellow,Be.update()}get terminalThemeObj(){return{background:this.settings.transparency?_a(this.settings.background,.5):this.settings.background,foreground:this.settings.foreground,selectionBackground:this.settings.selectionBackground,cursor:this.settings.cursor,cursorAccent:this.settings.cursorAccent,black:this.settings.black,blue:this.settings.blue,brightBlack:this.settings.brightBlack,brightBlue:this.settings.brightBlue,brightCyan:this.settings.brightCyan,brightGreen:this.settings.brightGreen,brightMagenta:this.settings.brightMagenta,brightRed:this.settings.brightRed,brightWhite:this.settings.brightWhite,brightYellow:this.settings.brightYellow,cyan:this.settings.cyan,green:this.settings.green,magenta:this.settings.magenta,red:this.settings.red,white:this.settings.white,yellow:this.settings.yellow}}get terminalObj(){return new Ad.Terminal({allowTransparency:this.settings.transparency,allowProposedApi:!0,scrollOnUserInput:!0,cursorBlink:this.settings.cursorBlink,cursorStyle:this.settings.cursorStyle,cursorInactiveStyle:this.settings.cursorInactiveStyle,scrollBack:this.settings.scrollBack,scrollSensitivity:this.settings.scrollSensitivity,fontSize:this.settings.fontSize,fontFamily:`${this.settings.fontFamily}, Fira Code, monospace`,fontWeight:this.settings.fontWeight,letterSpacing:this.settings.letterSpacing,theme:this.terminalThemeObj})}async clearCache(){await this.$cacheFile.writeFile(""),window.toast("Cache cleared \u{1F525}",3e3)}get settingsObj(){return this.settings.theme==="custom"?{list:this.settingsList.concat(this.settingsListWithThemeColor),cb:(i,r)=>this.settingsSaveCallback(i,r)}:{list:this.settingsList,cb:(i,r)=>this.settingsSaveCallback(i,r)}}get settingsList(){return[{key:"port",text:"Server Port",value:this.settings.port,info:"Port which is displayed on termux when starting the server",prompt:"Server Port",promptType:"number",promptOption:[{required:!0}]},{key:"letterSpacing",text:"Letter Spacing",value:this.settings.letterSpacing,info:"The spacing in whole pixels between characters.",prompt:"Letter spacing",promptType:"number",promptOption:[{required:!0}]},{key:"terminalPadding",text:"Terminal Padding",value:this.settings.terminalPadding,info:"Padding around the terminal content in pixels.",prompt:"Terminal Padding",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{key:"serverHost",text:"Server Host Name",value:this.settings.serverHost,info:"Hostname which is displayed on termux when starting the server",prompt:"Server Host Name",promptType:"text",promptOption:[{required:!0}]},{key:"aiApiKey",text:"AI API Key",value:this.settings.aiApiKey,info:"API key of your selected model, if your selected model doesn't need any api key then leave it empty. For how to get api key : check the readme of plugin",prompt:"AI API Key",promptType:"text",promptOption:[{required:!0}]},{key:"aiModel",text:"AI Model",value:this.settings.aiModel,info:"ai model to generate terminal suggestions and commands",select:yn},{key:"fontWeight",text:"Font Weight",value:this.settings.fontWeight,info:"The font weight used to render non-bold text.",select:pn},{key:"showTerminalBtnSize",text:"Show Terminal button size",value:this.settings.showTerminalBtnSize,info:"Size of terminal show button (in px)",prompt:"Show Terminal button size",promptType:"number",promptOption:[{required:!0}]},{key:"blurValue",text:"Blur Value(in px)",value:this.settings.blurValue,info:"Blur value for terminal in transparent mode",prompt:"Blur Value",promptType:"text",promptOption:[{required:!0}]},{key:"clearCache",text:"Clear Cache",info:"Helps in clearing cache which contains session details in case of any problems or bug"},{key:"transparency",text:"Allow Transparent Terminal",info:"Makes terminal transparent but it will also led to slightly performance decrement",checkbox:!!this.settings.transparency},{key:"imageRendering",text:"Image Rendering",info:"Enables image rendering inside the terminal but it can reduce performance",checkbox:!!this.settings.imageRendering},{key:"enableGuiViewer",text:"GUI Viewer",info:"Enables gui viewer, to view the output of graphical apps",checkbox:!!this.settings.enableGuiViewer},{key:"selectionHaptics",text:"Selection Haptics",info:"Enable/Disable vibration on selection",checkbox:!!this.settings.selectionHaptics},{key:"fontLigatures",text:"Font Ligatures",info:"Enable/Disable font ligatures in terminal",checkbox:!!this.settings.fontLigatures},{key:"showTerminalBtn",text:"Terminal Maximise Button",info:"Hide/Unhide terminal maximise button",checkbox:!!this.settings.showTerminalBtn},{index:7,key:"customFontStyleSheet",text:"Custom Font Stylesheet file",info:"Select css file in which you have to define about your custom font.",value:this.settings.customFontStyleSheet},{index:0,key:"cursorBlink",text:"Cursor Blink",info:"Whether the cursor blinks.",checkbox:!!this.settings.cursorBlink},{index:1,key:"cursorStyle",text:"Cursor Style",value:this.settings.cursorStyle,info:"The style of the cursor.",select:fn},{key:"cursorInactiveStyle",text:"Cursor Inactive Style",value:this.settings.cursorInactiveStyle,info:"The style of the cursor when the terminal is not focused.",select:_n},{index:2,key:"fontSize",text:"Font Size",value:this.settings.fontSize,info:"The font size used to render text.",prompt:"Font Size",promptType:"text",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:3,key:"fontFamily",text:"Font Family",value:this.settings.fontFamily,info:"The font family used to render text.",get select(){return Mi.getNames()}},{index:4,key:"scrollBack",text:"Scroll Back",value:this.settings.scrollBack,info:"The amount of scrollback in the terminal. Scrollback is the amount of rows that are retained when lines are scrolled beyond the initial viewport.",prompt:"Scroll Back",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:5,key:"scrollSensitivity",text:"Scroll Sensitivity",value:this.settings.scrollSensitivity,info:"The scrolling speed multiplier used for adjusting normal scrolling speed.",prompt:"Scroll Sensitivity",promptType:"number",promptOption:[{match:/^[0-9]+$/,required:!0}]},{index:6,key:"theme",text:"Theme",value:this.settings.theme,info:"Theme of terminal.",select:mn}]}get settingsListWithThemeColor(){return[{index:8,key:"background",text:"Background Color",value:this.settings.background,color:this.settings.background},{index:9,key:"foreground",text:"Foreground Color",value:this.settings.foreground,color:this.settings.foreground},{index:10,key:"selectionBackground",text:"Selection Background Color",value:this.settings.selectionBackground,color:this.settings.selectionBackground},{index:11,key:"cursor",text:"Cursor Color",value:this.settings.cursor,color:this.settings.cursor},{index:12,key:"cursorAccent",text:"Cursor Accent Color",value:this.settings.cursorAccent,color:this.settings.cursorAccent},{index:13,key:"black",text:"Black Color",value:this.settings.black,color:this.settings.black},{index:14,key:"blue",text:"Blue Color",value:this.settings.blue,color:this.settings.blue},{index:15,key:"brightBlack",text:"Bright Black Color",value:this.settings.brightBlack,color:this.settings.brightBlack},{index:16,key:"brightBlue",text:"Bright Blue Color",value:this.settings.brightBlue,color:this.settings.brightBlue},{index:17,key:"brightCyan",text:"Bright Cyan Color",value:this.settings.brightCyan,color:this.settings.brightCyan},{index:18,key:"brightGreen",text:"Bright Green Color",value:this.settings.brightGreen,color:this.settings.brightGreen},{index:19,key:"brightMagenta",text:"Bright Magenta Color",value:this.settings.brightMagenta,color:this.settings.brightMagenta},{index:20,key:"brightRed",text:"Bright Red Color",value:this.settings.brightRed,color:this.settings.brightRed},{index:21,key:"brightWhite",text:"Bright White Color",value:this.settings.brightWhite,color:this.settings.brightWhite},{index:22,key:"brightYellow",text:"Bright Yellow Color",value:this.settings.brightYellow,color:this.settings.brightYellow},{index:23,key:"cyan",text:"Cyan Color",value:this.settings.cyan,color:this.settings.cyan},{index:24,key:"green",text:"Green Color",value:this.settings.green,color:this.settings.green},{index:25,key:"magenta",text:"Magenta Color",value:this.settings.magenta,color:this.settings.magenta},{index:26,key:"red",text:"Red Color",value:this.settings.red,color:this.settings.red},{index:27,key:"white",text:"White Color",value:this.settings.white,color:this.settings.white},{index:28,key:"yellow",text:"Yellow Color",value:this.settings.yellow,color:this.settings.yellow}]}async settingsSaveCallback(i,r){switch(i){case"customFontStyleSheet":this.setCustomFontFile();break;case"theme":this.applyTheme(r),r==="custom"&&acode.alert("AcodeX Warning","Restart the app please"),this.$terminal&&(this.$terminal.options.theme=this.terminalThemeObj);break;case"clearCache":this.clearCache();break;case"showTerminalBtnSize":this.$showTermBtn&&(this.$showTermBtn.style.height=`${r}px`,this.$showTermBtn.style.width=`${r}px`);break;case"fontSize":this.applyTerminalFontSize(r);break;case"fontFamily":try{await Mi.loadFont(r)}catch(s){console.warn(`Failed to load font ${r}:`,s)}this.$terminal&&(this.$terminal.options.fontFamily=r,this.$terminal.refresh(0,this.$terminal.rows-1)),this.settings[i]=r,Be.update();break;case"fontWeight":this.$terminal&&(this.$terminal.options.fontWeight=r),this.settings[i]=r,Be.update();break;case"letterSpacing":this.$terminal&&(this.$terminal.options.letterSpacing=r),this.settings[i]=r,Be.update();break;case"terminalPadding":{let s=Number(r);if(Number.isNaN(s))break;let l=Math.max(0,s);this.settings[i]=l,this.$terminal?.element&&this._setTerminalPadding(l),Be.update();break}case"cursorBlink":this.$terminal&&(this.$terminal.options.cursorBlink=r),this.settings[i]=r,Be.update();break;case"cursorStyle":this.$terminal&&(this.$terminal.options.cursorStyle=r),this.settings[i]=r,Be.update();break;case"cursorInactiveStyle":this.$terminal&&(this.$terminal.options.cursorInactiveStyle=r),this.settings[i]=r,Be.update();break;case"imageRendering":this.$terminal&&(r?(this.$imageAddon=new aa.ImageAddon,this.$terminal.loadAddon(this.$imageAddon)):this.$imageAddon?.dispose()),this.settings[i]=r,Be.update();break;case"fontLigatures":this.$terminal&&(r?(this.$ligatureAddon=new Ri,this.$terminal.loadAddon(this.$ligatureAddon)):this.$ligatureAddon?.dispose()),this.settings[i]=r,Be.update();break;case"enableGuiViewer":this.settings[i]=r,Be.update(),r&&!this.$page&&this.setupGUIViewerPage(),this.renderUI();break;case"showTerminalBtn":this.settings[i]=r,Be.update(),this.$showTermBtn&&(r&&!document.contains(this.$showTermBtn)&&app.get("main")&&app.get("main").append(this.$showTermBtn),this.$showTermBtn.style.display=r?"":"none",r?this.isTerminalMinimized&&this.$showTermBtn.classList.remove("hide"):this.$showTermBtn.classList.add("hide"));break;default:this.settings[i]=r,i==="selectionHaptics"&&this.selectionManager&&(this.selectionManager.options.hapticFeedback=!!r),Be.update()}}get settings(){return Be.value[Ct.id]}};if(window.acode){let e=new xr;acode.setPluginInit(Ct.id,async(i,r,{cacheFileUrl:s,cacheFile:l})=>{let t=i.endsWith("/")?i:`${i}/`;e.baseUrl=t,await e.init(r,l,s)},e.settingsObj),acode.setPluginUnmount(Ct.id,()=>{e.destroy()})}})();
/*! Bundled license information:

@novnc/novnc/lib/crypto/aes.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

@novnc/novnc/lib/crypto/rsa.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

@novnc/novnc/lib/crypto/md5.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

@novnc/novnc/lib/ra2.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

@novnc/novnc/lib/rfb.js:
  (*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE *)

@xterm/addon-image/lib/addon-image.js:
  (*! For license information please see addon-image.js.LICENSE.txt *)
*/
